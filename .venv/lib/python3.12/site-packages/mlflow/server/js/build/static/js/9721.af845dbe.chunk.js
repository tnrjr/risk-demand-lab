"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[9721],{1998:function(e,t,s){s.r(t),s.d(t,{CompareModelVersionsPage:function(){return be},CompareModelVersionsPageImpl:function(){return ye},default:function(){return Ye}});var r=s(31014),a=s(51079),i=s.n(a),n=s(10811),o=s(26809),l=s(7204),c=s(69708),d=s(68621),h=s(89555),p=s(48624),u=s(9133),m=s.n(u),g=s(88443),y=s(64912),f=s(68048),v=s(59403),b=s(26458),Y=(s(71832),s(23823)),x=s(76010),M=s(85017),S=s(24406),A=s(79445),N=s(50111);const w=e=>(0,N.FD)("div",{css:k.wrapper,children:[(0,N.Y)("div",{css:k.controls,children:e.controls}),(0,N.Y)("div",{css:k.plotWrapper,children:e.children})]}),k={plotWrapper:{overflow:"hidden",width:"100%",height:"100%",minHeight:450},wrapper:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr) 3fr"},controls:e=>({padding:`0 ${e.spacing.xs}px`})};class K extends r.Component{constructor(e){super(e),this.metricKeys=void 0,this.paramKeys=void 0,this.metricKeys=S.A.getKeys(this.props.metricLists,!1),this.paramKeys=S.A.getKeys(this.props.paramLists,!1),this.paramKeys.length+this.metricKeys.length<2?this.state={disabled:!0}:this.state={disabled:!1,x:this.paramKeys.length>0?{key:this.paramKeys[0],isMetric:!1}:{key:this.metricKeys[1],isMetric:!0},y:this.metricKeys.length>0?{key:this.metricKeys[0],isMetric:!0}:{key:this.paramKeys[1],isMetric:!1}}}getValue(e,{key:t,isMetric:s}){const r=S.A.findInList((s?this.props.metricLists:this.props.paramLists)[e],t);return void 0===r?r:r.value}render(){if(this.state.disabled)return(0,N.Y)("div",{});const e=K.MAX_PLOT_KEY_LENGTH,t=[],s=[],r=[];return this.props.runInfos.forEach(((e,a)=>{const i=this.getValue(a,this.state.x),n=this.getValue(a,this.state.y);void 0!==i&&void 0!==n&&(t.push(i),s.push(n),r.push(this.getPlotlyTooltip(a)))})),(0,N.Y)(w,{controls:(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{children:[(0,N.Y)(f.FormUI.Label,{htmlFor:"x-axis-selector",children:(0,N.Y)(g.A,{id:"1/M8+x",defaultMessage:"X-axis:"})}),this.renderSelect("x")]}),(0,N.Y)(Y.S,{}),(0,N.FD)("div",{children:[(0,N.Y)(f.FormUI.Label,{htmlFor:"y-axis-selector",children:(0,N.Y)(g.A,{id:"eNUbaN",defaultMessage:"Y-axis:"})}),this.renderSelect("y")]})]}),children:(0,N.Y)(A.W,{data:[{x:t,y:s,text:r,hoverinfo:"text",type:"scattergl",mode:"markers",marker:{size:10,color:"rgba(200, 50, 100, .75)"}}],layout:{margin:{t:30},hovermode:"closest",xaxis:{title:(0,u.escape)(x.A.truncateString(this.state.x.key,e))},yaxis:{title:(0,u.escape)(x.A.truncateString(this.state.y.key,e))}},css:I.plot,config:{responsive:!0,displaylogo:!1,scrollZoom:!0,modeBarButtonsToRemove:["sendDataToCloud","select2d","lasso2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian"]},useResizeHandler:!0})})}renderSelect(e){return(0,N.FD)(f.SimpleSelect,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_comparerunscatter.tsx_182",css:I.select,id:e+"-axis-selector",onChange:({target:t})=>{const{value:s}=t,[r,...a]=s.split("-"),i=a.join("-"),n="metric"===r;this.setState({[e]:{isMetric:n,key:i}})},value:(this.state[e].isMetric?"metric-":"param-")+this.state[e].key,children:[(0,N.Y)(f.SimpleSelectOptionGroup,{label:"Parameter",children:this.paramKeys.map((e=>(0,N.Y)(f.SimpleSelectOption,{value:"param-"+e,children:e},"param-"+e)))}),(0,N.Y)(f.SimpleSelectOptionGroup,{label:"Metric",children:this.metricKeys.map((e=>(0,N.Y)(f.SimpleSelectOption,{value:"metric-"+e,children:e},"metric-"+e)))})]})}getPlotlyTooltip(e){const t=K.MAX_PLOT_KEY_LENGTH,s=K.MAX_PLOT_VALUE_LENGTH,r=this.props.runDisplayNames[e];let a=`<b>${(0,u.escape)(r)}</b><br>`;const i=this.props.paramLists[e];i.forEach((e=>{a+=(0,u.escape)(x.A.truncateString(e.key,t))+": "+(0,u.escape)(x.A.truncateString(e.value,s))+"<br>"}));const n=this.props.metricLists[e];return n.length>0&&(a+=i.length>0?"<br>":"",n.forEach((e=>{a+=(0,u.escape)(x.A.truncateString(e.key,t))+": "+x.A.formatMetric(e.value)+"<br>"}))),a}}K.MAX_PLOT_KEY_LENGTH=40,K.MAX_PLOT_VALUE_LENGTH=60;const I={select:{width:"100%"},plot:{width:"100%"}},L=(0,n.Ng)(((e,t)=>{const s=[],r=[],a=[],{runUuids:i}=t;return i.forEach((t=>{s.push((0,b.K4)(t,e)),r.push(Object.values((0,M.d0)(t,e))),a.push(Object.values((0,b.tI)(t,e)))})),{runInfos:s,metricLists:r,paramLists:a}}))(K);var C=s(88464);const T="param-";var _={name:"1vbruv4",styles:"width:100%;margin-bottom:16px"};const F=({id:e,onChange:t,paramKeys:s,metricKeys:r})=>{const a=(0,C.A)();return(0,N.FD)(f.SimpleSelect,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_comparerunbox.tsx_46",id:e,css:_,placeholder:a.formatMessage({id:"9dX4XQ",defaultMessage:"Select parameter or metric"}),onChange:({target:e})=>{const{value:s}=e,[r,a]=s.split("-"),i=s.startsWith(T);t({key:a,isParam:i})},children:[(0,N.Y)(f.SimpleSelectOptionGroup,{label:"Parameters",children:s.map((e=>(0,N.Y)(f.SimpleSelectOption,{value:T+e,children:e},e)))}),(0,N.Y)(f.SimpleSelectOptionGroup,{label:"Metrics",children:r.map((e=>(0,N.Y)(f.SimpleSelectOption,{value:"metric-"+e,children:e},e)))})]})};var D={name:"t6p6gz",styles:"display:flex;width:100%;height:100%;justify-content:center;align-items:center"},R={name:"wo4y18",styles:"width:100%;height:100%;min-height:35vw"};const P=({runInfos:e,metricLists:t,paramLists:s})=>{const[a,i]=(0,r.useState)({key:void 0,isParam:void 0}),[n,o]=(0,r.useState)({key:void 0,isParam:void 0}),l=Array.from(new Set(s.flat().map((({key:e})=>e)))).sort(),c=Array.from(new Set(t.flat().map((({key:e})=>e)))).sort(),d=()=>{const r={};return e.forEach(((e,i)=>{const o=s[i],l=t[i],c=(a.isParam?o:l).find((({key:e})=>e===a.key)),d=(n.isParam?o:l).find((({key:e})=>e===n.key));void 0!==c&&void 0!==d&&(c.value in r?r[c.value].push(d.value):r[c.value]=[d.value])})),Object.entries(r).map((([e,t])=>({y:t,type:"box",name:e,jitter:.3,pointpos:-1.5,boxpoints:"all"})))};return(0,N.FD)(f.Row,{children:[(0,N.Y)(f.Col,{span:6,children:(0,N.FD)("div",{css:E.borderSpacer,children:[(0,N.Y)("div",{children:(0,N.Y)(f.FormUI.Label,{htmlFor:"x-axis-selector",children:(0,N.Y)(g.A,{id:"8xji5J",defaultMessage:"X-axis:"})})}),(0,N.Y)(F,{id:"x-axis-selector",onChange:i,paramKeys:l,metricKeys:c}),(0,N.Y)("div",{children:(0,N.Y)(f.FormUI.Label,{htmlFor:"y-axis-selector",children:(0,N.Y)(g.A,{id:"Hk0RSH",defaultMessage:"Y-axis:"})})}),(0,N.Y)(F,{id:"y-axis-selector",onChange:o,paramKeys:l,metricKeys:c})]})}),(0,N.Y)(f.Col,{span:18,children:a.key&&n.key?(0,N.Y)(A.W,{css:R,data:d(),layout:{margin:{t:30},hovermode:"closest",xaxis:{title:a.key},yaxis:{title:n.key}},config:{responsive:!0,displaylogo:!1,scrollZoom:!0,modeBarButtonsToRemove:["sendDataToCloud","select2d","lasso2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian"]},useResizeHandler:!0}):(0,N.Y)("div",{css:D,children:(0,N.Y)(v.T.Text,{size:"xl",children:(0,N.Y)(g.A,{id:"XaD7FM",defaultMessage:"Select parameters/metrics to plot."})})})})]})},E={borderSpacer:e=>({paddingLeft:e.spacing.xs})};var q={name:"1d3w5wq",styles:"width:100%"};class O extends r.Component{constructor(e){if(super(e),this.metricKeys=void 0,this.paramKeys=void 0,this.metricKeys=S.A.getKeys(this.props.metricLists,!0),this.paramKeys=S.A.getKeys(this.props.paramLists,!0),this.paramKeys.length+this.metricKeys.length<3)this.state={disabled:!0};else{const e={disabled:!1,reverseColor:!1};0===this.metricKeys.length?this.state={...e,xaxis:{key:this.paramKeys[0],isMetric:!1},yaxis:{key:this.paramKeys[1],isMetric:!1},zaxis:{key:this.paramKeys[2],isMetric:!1}}:0===this.paramKeys.length?this.state={...e,xaxis:{key:this.metricKeys[0],isMetric:!0},yaxis:{key:this.metricKeys[1],isMetric:!0},zaxis:{key:this.metricKeys[2],isMetric:!0}}:1===this.paramKeys.length?this.state={...e,xaxis:{key:this.paramKeys[0],isMetric:!1},yaxis:{key:this.metricKeys[0],isMetric:!0},zaxis:{key:this.metricKeys[1],isMetric:!0}}:this.state={...e,xaxis:{key:this.paramKeys[0],isMetric:!1},yaxis:{key:this.paramKeys[1],isMetric:!1},zaxis:{key:this.metricKeys[0],isMetric:!0}}}}getValue(e,{key:t,isMetric:s}){const r=S.A.findInList((s?this.props.metricLists:this.props.paramLists)[e],t);return void 0===r?r:r.value}getColorscale(){const e=[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]];return this.state.reverseColor?e:e.map((([t],s)=>[t,e[e.length-1-s][1]]))}render(){if(this.state.disabled)return(0,N.Y)("div",{children:(0,N.Y)(g.A,{id:"81DxPY",defaultMessage:"Contour plots can only be rendered when comparing a group of runs with three or more unique metrics or params. Log more metrics or params to your runs to visualize them using the contour plot."})});const e=O.MAX_PLOT_KEY_LENGTH,t=[],s=[],r=[],a=[];this.props.runInfos.forEach(((e,i)=>{const n=this.getValue(i,this.state.xaxis),o=this.getValue(i,this.state.yaxis),l=this.getValue(i,this.state.zaxis);void 0!==n&&void 0!==o&&void 0!==l&&(t.push(parseFloat(n)),s.push(parseFloat(o)),r.push(parseFloat(l)),a.push(this.getPlotlyTooltip(i)))}));return(0,N.Y)(w,{controls:(0,N.FD)(N.FK,{children:[(0,N.FD)("div",{children:[(0,N.Y)(f.FormUI.Label,{htmlFor:"xaxis-selector",children:(0,N.Y)(g.A,{id:"UGAKJp",defaultMessage:"X-axis:"})}),this.renderSelect("xaxis")]}),(0,N.Y)(Y.S,{}),(0,N.FD)("div",{children:[(0,N.Y)(f.FormUI.Label,{htmlFor:"yaxis-selector",children:(0,N.Y)(g.A,{id:"0ElvS9",defaultMessage:"Y-axis:"})}),this.renderSelect("yaxis")]}),(0,N.Y)(Y.S,{}),(0,N.FD)("div",{children:[(0,N.Y)(f.FormUI.Label,{htmlFor:"zaxis-selector",children:(0,N.Y)(g.A,{id:"WJF+wY",defaultMessage:"Z-axis:"})}),this.renderSelect("zaxis")]}),(0,N.Y)(Y.S,{}),(0,N.FD)("div",{className:"inline-control",children:[(0,N.Y)(g.A,{id:"fZPf0W",defaultMessage:"Reverse color:"})," ",(0,N.Y)(f.Switch,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_compareruncontour.tsx_282",className:"show-point-toggle",checked:this.state.reverseColor,onChange:e=>this.setState({reverseColor:e})})]})]}),children:(()=>{const i=[];if(new Set(t).size<2&&i.push("X"),new Set(s).size<2&&i.push("Y"),i.length>0){const e=i.length>1?`The ${i.join(" and ")} axes don't`:`The ${i[0]} axis doesn't`;return(0,N.Y)("div",{css:U.noDataMessage,children:`${e} have enough unique data points to render the contour plot.`})}return(0,N.Y)(A.W,{css:U.plot,data:[{z:r,x:t,y:s,type:"contour",hoverinfo:"none",colorscale:this.getColorscale(),connectgaps:!0,contours:{coloring:"heatmap"}},{x:t,y:s,text:a,hoverinfo:"text",type:"scattergl",mode:"markers",marker:{size:10,color:"rgba(200, 50, 100, .75)"}}],layout:{margin:{t:30},hovermode:"closest",xaxis:{title:(0,u.escape)(x.A.truncateString(this.state.xaxis.key,e)),range:[Math.min(...t),Math.max(...t)]},yaxis:{title:(0,u.escape)(x.A.truncateString(this.state.yaxis.key,e)),range:[Math.min(...s),Math.max(...s)]}},config:{responsive:!0,displaylogo:!1,scrollZoom:!0,modeBarButtonsToRemove:["sendDataToCloud","select2d","lasso2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian"]},useResizeHandler:!0})})()})}renderSelect(e){return(0,N.FD)(f.SimpleSelect,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_compareruncontour.tsx_299",css:q,id:e+"-selector",onChange:({target:t})=>{const{value:s}=t,[r,...a]=s.split("-"),i=a.join("-"),n="metric"===r;this.setState({[e]:{isMetric:n,key:i}})},value:(this.state[e].isMetric?"metric-":"param-")+this.state[e].key,children:[(0,N.Y)(f.SimpleSelectOptionGroup,{label:"Parameter",children:this.paramKeys.map((e=>(0,N.Y)(f.SimpleSelectOption,{value:"param-"+e,children:e},"param-"+e)))}),(0,N.Y)(f.SimpleSelectOptionGroup,{label:"Metric",children:this.metricKeys.map((e=>(0,N.Y)(f.SimpleSelectOption,{value:"metric-"+e,children:e},"metric-"+e)))})]})}getPlotlyTooltip(e){const t=O.MAX_PLOT_KEY_LENGTH,s=O.MAX_PLOT_VALUE_LENGTH,r=this.props.runDisplayNames[e];let a=`<b>${(0,u.escape)(r)}</b><br>`;const i=this.props.paramLists[e];i.forEach((e=>{a+=(0,u.escape)(x.A.truncateString(e.key,t))+": "+(0,u.escape)(x.A.truncateString(e.value,s))+"<br>"}));const n=this.props.metricLists[e];return n.length>0&&(a+=i.length>0?"<br>":"",n.forEach((e=>{a+=(0,u.escape)(x.A.truncateString(e.key,t))+": "+x.A.formatMetric(e.value)+"<br>"}))),a}}O.MAX_PLOT_KEY_LENGTH=40,O.MAX_PLOT_VALUE_LENGTH=60;const U={plot:{width:"100%"},noDataMessage:e=>({padding:e.spacing.sm,display:"flex",justifyContent:"center"})};var V=(0,n.Ng)(((e,t)=>{const s=[],r=[],a=[],{runUuids:i}=t;return i.forEach((t=>{s.push((0,b.K4)(t,e)),r.push(Object.values((0,M.d0)(t,e))),a.push(Object.values((0,b.tI)(t,e)))})),{runInfos:s,metricLists:r,paramLists:a}}))(O),H=s(58481);const B="unknown";class z extends r.Component{constructor(...e){super(...e),this.state={sequence:[...this.props.paramKeys,...this.props.metricKeys]},this.updateMetricAxisLabelStyle=()=>{const e=new Set(this.props.metricKeys);z.getLabelElementsFromDom().filter((t=>e.has(t.innerHTML))).forEach((e=>{e.style.fill="green",e.style.fontWeight="bold"}))},this.maybeUpdateStateForColorScale=e=>{const t=this.findLastKeyFromState(this.props.metricKeys),s=new Set(this.props.metricKeys);t!==m().findLast(e,(e=>s.has(e)))&&this.setState({sequence:e})},this.handlePlotUpdate=({data:[{dimensions:e}]})=>{this.updateMetricAxisLabelStyle(),this.maybeUpdateStateForColorScale(e.map((e=>e.label)))}}static getDerivedStateFromProps(e,t){const s=[...e.paramKeys,...e.metricKeys],r=t.sequence;return m().isEqual(m().sortBy(s),m().sortBy(r))?null:{sequence:s}}getData(){const{sequence:e}=this.state,{paramDimensions:t,metricDimensions:s,metricKeys:r}=this.props,a=this.findLastKeyFromState(r),i=this.props.metricDimensions.find((e=>e.label===a));return[{type:"parcoords",line:{...z.getColorScaleConfigsForDimension(i)},dimensions:z.getDimensionsOrderedBySequence([...t,...s],e)}]}static getDimensionsOrderedBySequence(e,t){return m().sortBy(e,[e=>t.indexOf(e.label)])}findLastKeyFromState(e){const{sequence:t}=this.state,s=new Set(e);return m().findLast(t,(e=>s.has(e)))}static getColorScaleConfigsForDimension(e){if(!e)return null;return{showscale:!0,colorscale:"Jet",cmin:m().min(e.values),cmax:m().max(e.values),color:e.values}}render(){return(0,N.Y)(A.W,{layout:{autosize:!0,margin:{t:50}},useResizeHandler:!0,css:X.plot,data:this.getData(),onUpdate:this.handlePlotUpdate,className:"pcp-plot",config:{displayModeBar:!1}})}}z.getLabelElementsFromDom=()=>Array.from(document.querySelectorAll(".pcp-plot .parcoords .y-axis .axis-heading .axis-title"));const G=(e,t,s)=>{let r={};const a=((e,t,s)=>{for(let r=0;r<t.length;r++)if(s[t[r]][e]){const{value:a}=s[t[r]][e];if("string"===typeof a&&isNaN(Number(a))&&"NaN"!==a)return"string"}return"number"})(e,t,s);if("string"===a)r=(e=>{const t=m().uniq(e).sort();let s=!1;const r=t.filter((e=>(e===B&&(s=!0),e!==B)));s&&r.push(B);const a=m().invert(r),i={};return i.values=e.map((e=>Number(a[e]))),i.tickvals=m().range(r.length),i.ticktext=r.map((e=>e.substring(0,10))),i})(t.map((t=>s[t][e]?s[t][e].value:B)));else{let a=Number.MIN_SAFE_INTEGER;const i=t.map((t=>{if(s[t][e]){const{value:r}=s[t][e],i=Number(r);return a<i&&(a=i),i}return B}));r.values=i.map((e=>e===B?a+.01:e)),r.tickformat=".5f"}return{label:e,...r}},X={plot:{width:"100%"}};var W=(0,n.Ng)(((e,t)=>{const{runUuids:s,paramKeys:r,metricKeys:a}=t,{latestMetricsByRunUuid:i,paramsByRunUuid:n}=e.entities;return{paramDimensions:r.map((e=>G(e,s,n))),metricDimensions:a.map((e=>G(e,s,i)))}}))(z);function j({paramKeys:e,metricKeys:t,selectedParamKeys:s,selectedMetricKeys:r,handleParamsSelectChange:a,handleMetricsSelectChange:i,onClearAllSelect:n}){return(0,N.FD)("div",{css:J.wrapper,children:[(0,N.Y)("div",{children:(0,N.Y)(g.A,{id:"7zNDHj",defaultMessage:"Parameters:"})}),(0,N.Y)(f.LegacySelect,{mode:"multiple",css:J.select,placeholder:(0,N.Y)(g.A,{id:"OzyPl3",defaultMessage:"Please select parameters"}),value:s,onChange:a,children:e.map((e=>(0,N.Y)(f.LegacySelect.Option,{value:e,children:e},e)))}),(0,N.Y)("div",{style:{marginTop:20},children:(0,N.Y)(g.A,{id:"EKyt+3",defaultMessage:"Metrics:"})}),(0,N.Y)(f.LegacySelect,{mode:"multiple",css:J.select,placeholder:(0,N.Y)(g.A,{id:"r5JI+N",defaultMessage:"Please select metrics"}),value:r,onChange:i,children:t.map((e=>(0,N.Y)(f.LegacySelect.Option,{value:e,children:e},e)))}),(0,N.Y)("div",{style:{marginTop:20},children:(0,N.Y)(v.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_parallelcoordinatesplotcontrols.tsx_84","data-testid":"clear-button",onClick:n,children:(0,N.Y)(g.A,{id:"FdDWTo",defaultMessage:"Clear All"})})})]})}const J={wrapper:e=>({padding:`0 ${e.spacing.xs}px`}),select:{width:"100%"}};class $ extends r.Component{constructor(...e){super(...e),this.state={selectedParamKeys:this.props.diffParamKeys.sort().slice(0,3),selectedMetricKeys:this.props.sharedMetricKeys.slice(0,1)},this.handleParamsSelectChange=e=>{this.setState({selectedParamKeys:e})},this.handleMetricsSelectChange=e=>{this.setState({selectedMetricKeys:e})},this.onClearAllSelect=()=>{this.setState({selectedParamKeys:[],selectedMetricKeys:[]})}}render(){const{runUuids:e,allParamKeys:t,allMetricKeys:s}=this.props,{selectedParamKeys:r,selectedMetricKeys:a}=this.state;return(0,N.Y)(w,{controls:(0,N.Y)(j,{paramKeys:t,metricKeys:s,selectedParamKeys:r,selectedMetricKeys:a,handleMetricsSelectChange:this.handleMetricsSelectChange,handleParamsSelectChange:this.handleParamsSelectChange,onClearAllSelect:this.onClearAllSelect}),children:m().isEmpty(r)&&m().isEmpty(a)?(0,N.FD)("div",{css:Z.noValuesSelected,"data-testid":"no-values-selected",children:[(0,N.Y)(v.T.Title,{level:2,children:(0,N.Y)(g.A,{id:"x0K27S",defaultMessage:"Nothing to compare!"})}),(0,N.Y)(g.A,{id:"2NJ8E5",defaultMessage:"Please select parameters and/or metrics to display the comparison."})]}):(0,N.Y)(W,{runUuids:e,paramKeys:r,metricKeys:a})})}}const Z={noValuesSelected:e=>({padding:e.spacing.md,textAlign:"center"})};var Q=(0,n.Ng)(((e,t)=>{const{runUuids:s}=t,r=(null!==s&&void 0!==s?s:[]).filter((t=>(0,b.K4)(t,e))),a=(0,b.XT)(r,e),i=(0,b.gz)(r,e),n=(0,b.EV)(r,e),{paramsByRunUuid:o}=e.entities,l=((e,t,s)=>{const r=[];return e.forEach((e=>{t.map((t=>s[t][e]&&s[t][e].value)).every(((e,t,s)=>e===s[0]))||r.push(e)})),r})(a,r,o);return{allParamKeys:a,allMetricKeys:i,sharedMetricKeys:n,diffParamKeys:l}}))($),ee=s(69869),te=s(65871),se=s(79085);const{TabPane:re}=f.LegacyTabs;function ae(e){const{theme:t}=(0,v.u)();return(0,N.Y)("div",{css:(0,h.AH)({textAlign:"center",color:t.colors.textSecondary},""),...e})}function ie(e){const{theme:t}=(0,v.u)();return(0,N.Y)("table",{className:"mlflow-compare-table table",css:(0,h.AH)({"th.main-table-header":{backgroundColor:t.colors.white,padding:0},"td.highlight-data":{backgroundColor:t.colors.backgroundValidationWarning}},""),...e})}function ne(e){const{theme:t}=(0,v.u)();return(0,N.Y)("button",{css:(0,h.AH)({textAlign:"left",display:"flex",alignItems:"center",border:"none",backgroundColor:t.colors.white,paddingLeft:0,cursor:"pointer"},""),...e})}class oe extends r.Component{constructor(...e){super(...e),this.state={inputActive:!0,outputActive:!0,paramsToggle:!0,paramsActive:!0,schemaToggle:!0,compareByColumnNameToggle:!1,schemaActive:!0,metricToggle:!0,metricActive:!0},this.icons={plusIcon:(0,N.Y)("i",{className:"fa fa-plus-square-o"}),minusIcon:(0,N.Y)("i",{className:"fa fa-minus-square-o"}),downIcon:(0,N.Y)("i",{className:"fa fa-caret-down"}),rightIcon:(0,N.Y)("i",{className:"fa fa-caret-right"}),chartIcon:(0,N.Y)("i",{className:"fa fa-line-chart padding-left-text"})},this.onToggleClick=e=>{this.setState((t=>({[e]:!t[e]})))}}render(){const{inputsListByIndex:e,inputsListByName:t,modelName:s,outputsListByIndex:r,outputsListByName:a,runInfos:i,runUuids:n,runDisplayNames:o,paramLists:l,metricLists:c}=this.props,d=(0,N.Y)(g.A,{id:"6kSKRk",defaultMessage:"Comparing {numVersions} Versions",values:{numVersions:this.props.runInfos.length}}),u=[(0,N.Y)(p.N_,{to:ee.fM.modelListPageRoute,children:(0,N.Y)(g.A,{id:"U82iv6",defaultMessage:"Registered Models"})}),(0,N.Y)(p.N_,{to:ee.fM.getModelPageRoute(s),children:s})];return(0,N.FD)("div",{className:"CompareModelVersionsView",css:(0,h.AH)({...de.compareModelVersionsView,...de.wrapper(i.length)},""),children:[(0,N.Y)(se.z,{title:d,breadcrumbs:u}),(0,N.Y)("div",{className:"mlflow-responsive-table-container",children:(0,N.FD)(ie,{children:[this.renderTableHeader(),this.renderModelVersionInfo(),this.renderSectionHeader("paramsActive","paramsToggle",(0,N.Y)(g.A,{id:"bSx/er",defaultMessage:"Parameters"})),this.renderParams(),this.renderSectionHeader("schemaActive","schemaToggle",(0,N.Y)(g.A,{id:"cK6riy",defaultMessage:"Schema"}),!1,(0,N.Y)(f.Switch,{className:"toggle-switch",style:{marginLeft:"auto"},onChange:()=>this.onToggleClick("compareByColumnNameToggle")}),(0,N.Y)("div",{className:"padding-left-text padding-right-text",children:(0,N.Y)("span",{children:(0,N.Y)(g.A,{id:"sXqvoN",defaultMessage:"Ignore column ordering"})})})),this.renderSchemaSectionHeader("inputActive",(0,N.Y)(g.A,{id:"GJWVBA",defaultMessage:"Inputs"})),this.renderSchema("inputActive",(0,N.Y)(g.A,{id:"ThrXMh",defaultMessage:"Inputs"}),e,t),this.renderSchemaSectionHeader("outputActive",(0,N.Y)(g.A,{id:"aB6xFd",defaultMessage:"Outputs"})),this.renderSchema("outputActive",(0,N.Y)(g.A,{id:"bqn2bk",defaultMessage:"Outputs"}),r,a),this.renderSectionHeader("metricActive","metricToggle",(0,N.Y)(g.A,{id:"CpLnGS",defaultMessage:"Metrics"})),this.renderMetrics()]})}),(0,N.FD)(f.LegacyTabs,{children:[(0,N.Y)(re,{tab:(0,N.Y)(g.A,{id:"QuU1sl",defaultMessage:"Parallel Coordinates Plot"}),children:(0,N.Y)(Q,{runUuids:n})},"parallel-coordinates-plot"),(0,N.Y)(re,{tab:(0,N.Y)(g.A,{id:"4NEPlV",defaultMessage:"Scatter Plot"}),children:(0,N.Y)(L,{runUuids:n,runDisplayNames:o})},"scatter-plot"),(0,N.Y)(re,{tab:(0,N.Y)(g.A,{id:"iXb99e",defaultMessage:"Box Plot"}),children:(0,N.Y)(P,{runUuids:n,runInfos:i,paramLists:l,metricLists:c})},"box-plot"),(0,N.Y)(re,{tab:(0,N.Y)(g.A,{id:"dq8MJd",defaultMessage:"Contour Plot"}),children:(0,N.Y)(V,{runUuids:n,runDisplayNames:o})},"contour-plot")]})]})}renderTableHeader(){const{runInfos:e,runInfosValid:t}=this.props;return(0,N.Y)("thead",{children:(0,N.FD)("tr",{className:"table-row",children:[(0,N.Y)("th",{scope:"row",className:"row-header block-content",children:(0,N.Y)(g.A,{id:"bi26D5",defaultMessage:"Run ID:"})}),e.map(((e,s)=>{var r,a;return(0,N.Y)("th",{scope:"column",className:"data-value block-content",children:t[s]?(0,N.Y)(p.N_,{to:H.Ay.getRunPageRoute(null!==(r=e.experimentId)&&void 0!==r?r:"0",null!==(a=e.runUuid)&&void 0!==a?a:""),children:e.runUuid}):e.runUuid},e.runUuid)}))]})})}renderModelVersionInfo(){const{runInfos:e,runInfosValid:t,versionsToRuns:s,runNames:r,modelName:a}=this.props;return(0,N.FD)("tbody",{className:"scrollable-table",children:[(0,N.FD)("tr",{className:"table-row",children:[(0,N.Y)("th",{scope:"row",className:"data-value block-content",children:(0,N.Y)(g.A,{id:"xmPKKq",defaultMessage:"Model Version:"})}),Object.keys(s).map((e=>{const t=s[e];return(0,N.Y)("td",{className:"meta-info block-content",children:(0,N.Y)(p.N_,{to:ee.fM.getModelVersionPageRoute(a,e),children:e})},t)}))]}),(0,N.FD)("tr",{className:"table-row",children:[(0,N.Y)("th",{scope:"row",className:"data-value block-content",children:(0,N.Y)(g.A,{id:"erqoIC",defaultMessage:"Run Name:"})}),r.map(((t,s)=>(0,N.Y)("td",{className:"meta-info block-content",children:(0,N.Y)("div",{className:"truncate-text single-line cell-content",children:t})},e[s].runUuid)))]}),(0,N.FD)("tr",{className:"table-row",children:[(0,N.Y)("th",{scope:"row",className:"data-value block-content",children:(0,N.Y)(g.A,{id:"GKiPV1",defaultMessage:"Start Time:"})}),e.map(((e,s)=>{const r=e.startTime&&t[s]?x.A.formatTimestamp(e.startTime,this.props.intl):"(unknown)";return(0,N.Y)("td",{className:"meta-info block-content",children:r},e.runUuid)}))]})]})}renderSectionHeader(e,t,s,r=!0,a=null,i=null){const{runInfos:n}=this.props,o=this.state[e],{downIcon:l,rightIcon:c}=this.icons;return(0,N.Y)("tbody",{children:(0,N.Y)("tr",{children:(0,N.Y)("th",{scope:"rowgroup",className:"block-content main-table-header",colSpan:n.length+1,children:(0,N.FD)("div",{className:"switch-button-container",children:[(0,N.FD)(ne,{onClick:()=>this.onToggleClick(e),children:[o?l:c,(0,N.Y)("span",{className:"header",children:s})]}),a,i,(0,N.Y)(f.Switch,{defaultChecked:!0,className:"toggle-switch",style:r?{marginLeft:"auto"}:{},onChange:()=>this.onToggleClick(t)}),(0,N.Y)("div",{className:"padding-left-text",children:(0,N.Y)("span",{children:(0,N.Y)(g.A,{id:"H+4gFh",defaultMessage:"Show diff only"})})})]})})})})}renderParams(){return(0,N.Y)("tbody",{className:"scrollable-table",children:this.renderDataRows(this.props.paramLists,(0,N.Y)(g.A,{id:"EK5JxG",defaultMessage:"Parameters"}),this.state.paramsActive,this.state.paramsToggle)})}renderSchemaSectionHeader(e,t){const{runInfos:s}=this.props,{schemaActive:r}=this.state,a=this.state[e],{minusIcon:i,plusIcon:n}=this.icons;return(0,N.Y)("tbody",{children:(0,N.Y)("tr",{className:""+(r?"":"hidden-row"),children:(0,N.Y)("th",{scope:"rowgroup",className:"schema-table-header block-content",colSpan:s.length+1,children:(0,N.FD)("button",{className:"schema-collapse-button",onClick:()=>this.onToggleClick(e),children:[a?i:n,(0,N.Y)("strong",{style:{paddingLeft:4},children:t})]})})})})}renderSchema(e,t,s,r){const{schemaActive:a,compareByColumnNameToggle:i,schemaToggle:n}=this.state,o=this.state[e],l=a&&o,c=!i&&!m().isEmpty(s),d=i&&!m().isEmpty(r),h=e=>e,p=(0,N.Y)(g.A,{id:"5RWIet",defaultMessage:"Schema {sectionName}",values:{sectionName:t}});return(0,N.FD)("tbody",{className:"scrollable-table schema-scrollable-table",children:[this.renderDataRows(s,p,l&&c,n,((e,s)=>(0,N.FD)(N.FK,{children:[t," [",e,"]"]})),h),this.renderDataRows(r,p,l&&d,n,((e,t)=>e),h)]})}renderMetrics(){const{runInfos:e,metricLists:t}=this.props,{metricActive:s,metricToggle:r}=this.state,{chartIcon:a}=this.icons;return(0,N.Y)("tbody",{className:"scrollable-table",children:this.renderDataRows(t,(0,N.Y)(g.A,{id:"GDenB3",defaultMessage:"Metrics"}),s,r,((t,s)=>(0,N.FD)(p.N_,{to:H.Ay.getMetricPageRoute(e.map((e=>e.runUuid)).filter(((e,t)=>void 0!==s[t])),t,[e[0].experimentId]),target:"_blank",title:"Plot chart",children:[t,a]})),x.A.formatMetric)})}renderDataRows(e,t,s=!0,r=!1,a=(e,t)=>e,i=e=>isNaN(e)?`"${e}"`:e){const n=S.A.getKeys(e),o={};if(n.forEach((e=>o[e]=[])),e.forEach(((e,t)=>{n.forEach((e=>o[e].push(void 0))),e.forEach((e=>o[e.key][t]=e.value))})),m().isEmpty(n)||m().isEmpty(e))return(0,N.Y)("tr",{className:"table-row "+(s?"":"hidden-row"),children:(0,N.Y)("th",{scope:"row",className:"rowHeader block-content",children:(0,N.Y)(ae,{children:(0,N.Y)(g.A,{id:"47QsAK",defaultMessage:"{fieldName} are empty",values:{fieldName:t}})})})});m().every(n,(e=>!isNaN(e)))?n.sort(((e,t)=>parseInt(e,10)-parseInt(t,10))):n.sort();let l=!0;const c=n.map((e=>{const t=o[e].length>1&&m().uniq(o[e]).length>1;return l=!t&&l,(0,N.FD)("tr",{className:"table-row "+(r&&!t||!s?"hidden-row":""),children:[(0,N.Y)("th",{scope:"row",className:"rowHeader block-content",children:a(e,o[e])}),o[e].map(((e,s)=>(0,N.Y)("td",{className:"data-value block-content "+(t?"highlight-data":""),children:(0,N.Y)("span",{className:"truncate-text single-line cell-content",children:void 0===e?"-":i(e)})},this.props.runInfos[s].runUuid)))]},e)}));return l&&r?(0,N.Y)("tr",{className:"table-row "+(s?"":"hidden-row"),children:(0,N.Y)("th",{scope:"row",className:"rowHeader block-content",children:(0,N.Y)(ae,{children:(0,N.Y)(g.A,{id:"NJ1bYP",defaultMessage:"{fieldName} are identical",values:{fieldName:t}})})})}):c}}const le=e=>{const t={};return e.forEach(((e,s)=>{const r=e.name?e.name:"",a=e.type?e.type:"";t[s]={key:s,value:""!==r&&""!==a?`${r}: ${a}`:`${r}${a}`}})),t},ce=e=>{const t={};return e.forEach((e=>{const s=e.name?e.name:"-",r=e.type?e.type:"-";t[s]={key:s,value:r}})),t},de={wrapper:e=>({".mlflow-compare-table":{minWidth:200*(e+1)}}),compareModelVersionsView:{"button:focus":{outline:"none",boxShadow:"none"},"td.block-content th.block-content":{whiteSpace:"nowrap",textOverflow:"ellipsis",tableLayout:"fixed",boxSizing:"content-box"},"th.schema-table-header":{height:28,padding:0},"tr.table-row":{display:"table",width:"100%",tableLayout:"fixed"},"tr.hidden-row":{display:"none"},"tbody.scrollable-table":{width:"100%",display:"block",border:"none",maxHeight:400,overflowY:"auto"},"tbody.schema-scrollable-table":{maxHeight:200},".switch-button-container":{display:"flex",paddingTop:16,paddingBottom:16},"button.schema-collapse-button":{textAlign:"left",display:"block",width:"100%",height:"100%",border:"none"},".collapse-button":{textAlign:"left",display:"flex",alignItems:"center",border:"none",backgroundColor:"white",paddingLeft:0},".cell-content":{maxWidth:"200px",minWidth:"100px"},".padding-left-text":{paddingLeft:8},".padding-right-text":{paddingRight:16},".toggle-switch":{marginTop:2},".header":{paddingLeft:8,fontSize:16}}},he=(0,n.Ng)(((e,t)=>{const s=[],r=[],a=[],i=[],n=[],o=[],l=[],{modelName:c,versionsToRuns:d}=t,h=[],p=[],u=[],m=[];for(const g in d)if(d&&g in d){const t=d[g],y=(0,b.K4)(t,e);y?(s.push(y),r.push(!0),a.push(Object.values((0,M.d0)(t,e))),i.push(Object.values((0,b.tI)(t,e))),n.push(x.A.getRunName(y)),o.push(x.A.getRunDisplayName(y,t)),l.push(t)):(t?s.push({runUuid:t}):s.push({runUuid:"None"}),r.push(!1),a.push([]),i.push([]),n.push("Invalid Run"));const f=(0,te.SE)(e,c,g);p.push(Object.values(le(f.inputs))),h.push(Object.values(ce(f.inputs))),m.push(Object.values(le(f.outputs))),u.push(Object.values(ce(f.outputs)))}return{runInfos:s,runInfosValid:r,metricLists:a,paramLists:i,runNames:n,runDisplayNames:o,runUuids:l,modelName:c,inputsListByName:h,inputsListByIndex:p,outputsListByName:u,outputsListByIndex:m}}))((0,y.Ay)(oe));var pe=s(48588),ue=s(25869),me=s(20109),ge=s(62448);class ye extends r.Component{constructor(...e){super(...e),this.registeredModelRequestId=(0,l.yk)(),this.versionRequestId=(0,l.yk)(),this.runRequestId=(0,l.yk)(),this.getMlModelFileRequestId=(0,l.yk)(),this.state={requestIds:[this.registeredModelRequestId,this.runRequestId,this.versionRequestId,this.getMlModelFileRequestId],requestIdsWith404ErrorsToIgnore:[this.runRequestId,this.getMlModelFileRequestId]}}removeRunRequestId(){this.setState((e=>({requestIds:m().without(e.requestIds,this.runRequestId)})))}componentDidMount(){this.props.getRegisteredModelApi(this.props.modelName,this.registeredModelRequestId);for(const e in this.props.versionsToRuns)if({}.hasOwnProperty.call(this.props.versionsToRuns,e)){const t=this.props.versionsToRuns[e];t?this.props.getRunApi(t,this.runRequestId).catch((()=>{this.removeRunRequestId()})):this.removeRunRequestId();const{modelName:s}=this.props;this.props.getModelVersionApi(s,e,this.versionRequestId),this.props.getModelVersionArtifactApi(s,e).then((t=>this.props.parseMlModelFile(s,e,t.value,this.getMlModelFileRequestId))).catch((()=>{this.setState((e=>({requestIds:m().without(e.requestIds,this.getMlModelFileRequestId)})))}))}}render(){return(0,N.Y)(pe.L,{children:(0,N.Y)(d.Ay,{requestIds:this.state.requestIds,requestIdsWith404sToIgnore:this.state.requestIdsWith404ErrorsToIgnore,children:(0,N.Y)(he,{modelName:this.props.modelName,versionsToRuns:this.props.versionsToRuns})})})}}const fe={getRunApi:o.aO,getRegisteredModelApi:c.SY,getModelVersionApi:c.s5,getModelVersionArtifactApi:c.ax,parseMlModelFile:c.qI},ve=(0,ue.h)((0,n.Ng)(((e,t)=>{const{location:s}=t,r=i().parse(s.search);return{modelName:decodeURIComponent(JSON.parse(r["?name"])),versionsToRuns:JSON.parse(r.runs)}}),fe)(ye)),be=(0,me.X)(ge.A.mlflowServices.MODEL_REGISTRY,ve);var Ye=be},79445:function(e,t,s){s.d(t,{W:function(){return l}});var r=s(31014),a=s(68048),i=s(27705),n=s(50111);const o=r.lazy((()=>s.e(4850).then(s.bind(s,84850)))),l=({fallback:e,...t})=>(0,n.Y)(i.g,{children:(0,n.Y)(r.Suspense,{fallback:null!==e&&void 0!==e?e:(0,n.Y)(a.LegacySkeleton,{active:!0}),children:(0,n.Y)(o,{...t})})})}}]);
//# sourceMappingURL=9721.af845dbe.chunk.js.map