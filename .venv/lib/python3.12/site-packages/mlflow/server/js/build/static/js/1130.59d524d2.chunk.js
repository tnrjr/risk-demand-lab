"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[1130],{3833:function(e,r,n){n.d(r,{Ld:function(){return l}});var t=n(31014),o=n(96950),a=n(23823),s=n(68048),i=n(7450),c=n(50111);function l(e,r,n){const l=(0,i.tz)(),u=r||l.formatMessage({id:"hBAhI8",defaultMessage:"Copy"}),d=l.formatMessage({id:"g4hHzO",defaultMessage:"Copied"}),f=(0,o.useClipboard)(),p=(0,t.useRef)(),[g,h]=(0,t.useState)(!1),[m,v]=(0,t.useState)(!1);(0,t.useEffect)((()=>()=>{window.clearTimeout(p.current)}),[]);return{actionIcon:g?(0,c.Y)(a.C,{}):(0,c.Y)(s.CopyIcon,{}),tooltipMessage:g?d:u,copy:()=>{f.copy(e),window.clearTimeout(p.current),h(!0),null===n||void 0===n||n(),p.current=window.setTimeout((()=>{h(!1)}),3e3)},copied:g,ariaLabel:u,tooltipOpen:m||g,handleTooltipOpenChange:v}}},17297:function(e,r,n){n.d(r,{KR:function(){return a},nX:function(){return t},wO:function(){return o}});const t=()=>!0,o=()=>!0,a=()=>!0},20897:function(e,r,n){n.d(r,{z7:function(){return S},VE:function(){return b}});var t=n(17729),o=n(67122),a=n(82328),s=n(67699),i=n(42346),c=n(74702),l=n(34939),u=n(72670);var d={'code[class*="language-"]':{fontFamily:'Consolas, Menlo, Monaco, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", "Courier New", Courier, monospace',fontSize:"14px",lineHeight:"1.375",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",background:"#2a2734",color:"#5DFAFC"},'pre[class*="language-"]':{fontFamily:'Consolas, Menlo, Monaco, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", "Courier New", Courier, monospace',fontSize:"14px",lineHeight:"1.375",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",background:"#2a2734",color:"#5DFAFC",padding:"1em",margin:".5em 0",overflow:"auto"},'pre > code[class*="language-"]':{fontSize:"1em"},'pre[class*="language-"]::-moz-selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"] ::-moz-selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"]::-moz-selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"] ::-moz-selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"]::selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"] ::selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"]::selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"] ::selection':{textShadow:"none",background:"#6a51e6"},':not(pre) > code[class*="language-"]':{padding:".1em",borderRadius:".3em"},comment:{color:"#6c6783"},prolog:{color:"#6c6783"},doctype:{color:"#6c6783"},cdata:{color:"#6c6783"},punctuation:{color:"#6c6783"},namespace:{Opacity:".7"},tag:{color:"#3AACE2"},operator:{color:"#3AACE2"},number:{color:"#3AACE2"},property:{color:"#5DFAFC"},function:{color:"#5DFAFC"},"tag-id":{color:"#eeebff"},selector:{color:"#eeebff"},"atrule-id":{color:"#eeebff"},"code.language-javascript":{color:"#c4b9fe"},"attr-name":{color:"#c4b9fe"},"code.language-css":{color:"#ffffff"},"code.language-scss":{color:"#ffffff"},boolean:{color:"#ffffff"},string:{color:"#ffffff"},entity:{color:"#ffffff",cursor:"help"},url:{color:"#ffffff"},".language-css .token.string":{color:"#ffffff"},".language-scss .token.string":{color:"#ffffff"},".style .token.string":{color:"#ffffff"},"attr-value":{color:"#ffffff"},keyword:{color:"#ffffff"},control:{color:"#ffffff"},directive:{color:"#ffffff"},unit:{color:"#ffffff"},statement:{color:"#ffffff"},regex:{color:"#ffffff"},atrule:{color:"#ffffff"},placeholder:{color:"#ffffff"},variable:{color:"#ffffff"},deleted:{textDecoration:"line-through"},inserted:{borderBottom:"1px dotted #eeebff",textDecoration:"none"},italic:{fontStyle:"italic"},important:{fontWeight:"bold",color:"#c4b9fe"},bold:{fontWeight:"bold"},"pre > code.highlight":{Outline:".4em solid #8a75f5",OutlineOffset:".4em"},".line-numbers.line-numbers .line-numbers-rows":{borderRightColor:"#2c2937"},".line-numbers .line-numbers-rows > span:before":{color:"#3c3949"},".line-highlight.line-highlight":{background:"linear-gradient(to right, rgba(224, 145, 66, 0.2) 70%, rgba(224, 145, 66, 0))"}};var f={'code[class*="language-"]':{textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",color:"rgb(77, 77, 76)",background:"#fafafa",fontFamily:"Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace",fontSize:"12px",lineHeight:"1.5em",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",color:"rgb(77, 77, 76)",background:"#fafafa",fontFamily:"Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace",fontSize:"12px",lineHeight:"1.5em",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",overflow:"auto",position:"relative",margin:"0.5em 0",padding:"1.25em 1em"},'code[class*="language-"]::-moz-selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"]::-moz-selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"] ::-moz-selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"] ::-moz-selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"]::selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"]::selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"] ::selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"] ::selection':{background:"#cceae7",color:"#263238"},':not(pre) > code[class*="language-"]':{whiteSpace:"normal",borderRadius:"0.2em",padding:"0.1em"},".language-css > code":{color:"#f5871f"},".language-sass > code":{color:"#f5871f"},".language-scss > code":{color:"#f5871f"},'[class*="language-"] .namespace':{Opacity:"0.7"},atrule:{color:"#7c4dff"},"attr-name":{color:"#39adb5"},"attr-value":{color:"#f6a434"},attribute:{color:"#f6a434"},boolean:{color:"#7c4dff"},builtin:{color:"#39adb5"},cdata:{color:"#39adb5"},char:{color:"#39adb5"},class:{color:"#39adb5"},"class-name":{color:"#6182b8"},comment:{color:"#8e908c"},constant:{color:"#7c4dff"},deleted:{color:"#e53935"},doctype:{color:"#aabfc9"},entity:{color:"#e53935"},function:{color:"#4271ae"},hexcode:{color:"#f5871f"},id:{color:"#7c4dff",fontWeight:"bold"},important:{color:"#7c4dff",fontWeight:"bold"},inserted:{color:"#39adb5"},keyword:{color:"#8959a8"},number:{color:"#f5871f"},operator:{color:"#3e999f"},prolog:{color:"#aabfc9"},property:{color:"#39adb5"},"pseudo-class":{color:"#f6a434"},"pseudo-element":{color:"#f6a434"},punctuation:{color:"rgb(77, 77, 76)"},regex:{color:"#6182b8"},selector:{color:"#e53935"},string:{color:"#3ba85f"},symbol:{color:"#7c4dff"},tag:{color:"#e53935"},unit:{color:"#f5871f"},url:{color:"#e53935"},variable:{color:"#c72d4c"}},p=n(9133),g=n(50111),h=(n(31014),n(3833)),m=n(68048),v=n(59403);var E={name:"1739oy8",styles:"z-index:1"};function y({tooltipMessage:e,...r}){const n=E;return(0,g.Y)(m.LegacyTooltip,{title:e,children:(0,g.Y)(v.B,{componentId:"codegen_web-shared_src_snippet_actions_snippetactionbutton.tsx_33",...r,css:n})})}function b({copyText:e,onClick:r,...n}){const{actionIcon:t,tooltipMessage:o,copy:a}=(0,h.Ld)(e);return(0,g.Y)(y,{tooltipMessage:o,icon:t,onClick:e=>{a(),null===r||void 0===r||r(e)},...n})}t.A.registerLanguage("sql",u.A),t.A.registerLanguage("java",a.A),t.A.registerLanguage("python",c.A),t.A.registerLanguage("go",o.A),t.A.registerLanguage("javascript",s.A),t.A.registerLanguage("yaml",l.A),t.A.registerLanguage("json",i.A);const w="24px",N={light:f,duotoneDark:d};function S({theme:e="light",language:r,actions:n,style:o,children:a,showLineNumbers:s,lineNumberStyle:i,wrapLongLines:c,wrapLines:l,PreTag:u}){const d={border:"none",borderRadius:0,margin:0,padding:w,...o};return(0,g.Y)(t.A,{showLineNumbers:s,lineNumberStyle:i,language:r,style:N[e],customStyle:d,codeTagProps:{style:(0,p.pick)(o,"backgroundColor")},wrapLongLines:c,wrapLines:l,PreTag:u,children:a})}},39416:function(e,r,n){n.d(r,{a$:function(){return c}});var t=n(88443);let o=function(e){return e.UserInputError="UserInputError",e.UnexpectedSystemStateError="UnexpectedSystemStateError",e.ServerError="ServerError",e.SessionError="SessionError",e.NetworkError="NetworkError",e.ApplicationError="ApplicationError",e.UnknownError="UnknownError",e}({}),a=function(e){return e.BadRequestError="BadRequestError",e.DatasetRunNotFoundError="DatasetRunNotFoundError",e.FormValidationError="FormInputError",e.GenericNetworkRequestError="GenericNetworkRequestError",e.GraphQLGenericError="GraphQLGenericError",e.InternalServerError="InternalServerError",e.NotFoundError="NotFoundError",e.PermissionError="PermissionError",e.RateLimitedError="RateLimitedError",e.RouteNotFoundError="RouteNotFoundError",e.ServiceUnavailableError="ServiceUnavailableError",e.UnauthorizedError="UnauthorizedError",e.UnknownError="UnknownError",e}({});var s=n(50111);class i extends Error{constructor(e,r){super(e),this.errorLogType=void 0,this.errorName=void 0,this.displayMessage=void 0,this.isUserError=!1}}const c=e=>e instanceof i?e:e instanceof Error&&("networkError"in e||"graphQLErrors"in e)?l(e):e instanceof Response?u(e):new w(e);const l=e=>{return"networkError"in e&&((r=e.networkError)instanceof Error&&r.hasOwnProperty("response"))?u(e.networkError.response,e.networkError):new p(e);var r},u=(e,r)=>{const n=d.getNetworkRequestErrorDetailsFromResponse(e);switch(e.status){case 400:return new g(n,r);case 401:return new b(n,r);case 403:return new v(n,r);case 404:return new m(n,r);case 429:return new E(n,r);case 500:return new h(n,r);case 503:return new y(n,r);default:return new f(n,r)}};class d extends i{constructor(e,r,n){super(e,n),this.status=void 0,this.response=void 0,this.status=r.status,this.response=r.response}}d.getNetworkRequestErrorDetailsFromResponse=e=>({status:e.status});class f extends d{constructor(e,r){super("A network error occurred.",e,r),this.errorLogType=o.ServerError,this.errorName=a.GenericNetworkRequestError,this.displayMessage=(0,s.Y)(t.A,{id:"/CaNq/",defaultMessage:"A network error occurred."})}}class p extends i{constructor(e){super("A GraphQL error occurred.",e),this.errorLogType=o.ApplicationError,this.errorName=a.GraphQLGenericError,this.displayMessage=(0,s.Y)(t.A,{id:"PPPbd+",defaultMessage:"A GraphQL error occurred."})}}class g extends d{constructor(e,r){super("The request was invalid.",e,r),this.errorLogType=o.UserInputError,this.errorName=a.BadRequestError,this.displayMessage=(0,s.Y)(t.A,{id:"Id2mFI",defaultMessage:"The request was invalid."})}}class h extends d{constructor(e,r){super("Internal server error",e,r),this.errorLogType=o.ServerError,this.errorName=a.InternalServerError,this.displayMessage=(0,s.Y)(t.A,{id:"nY1YrF",defaultMessage:"Internal server error"})}}class m extends d{constructor(e,r){super("The requested resource was not found.",e,r),this.errorLogType=o.UserInputError,this.errorName=a.NotFoundError,this.displayMessage=(0,s.Y)(t.A,{id:"R3Lb6z",defaultMessage:"The requested resource was not found."}),this.isUserError=!0}}class v extends d{constructor(e,r){super("You do not have permission to access this resource.",e,r),this.errorLogType=o.UnexpectedSystemStateError,this.errorName=a.PermissionError,this.displayMessage=(0,s.Y)(t.A,{id:"G6IQTa",defaultMessage:"You do not have permission to access this resource."}),this.isUserError=!0}}class E extends d{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),this.errorLogType=o.ServerError,this.errorName=a.RateLimitedError,this.displayMessage=(0,s.Y)(t.A,{id:"5PlfiT",defaultMessage:"This request exceeds the maximum queries per second limit. Please wait and try again."})}}class y extends d{constructor(e,r){super("Internal server error",e,r),this.errorLogType=o.ServerError,this.errorName=a.InternalServerError,this.displayMessage=(0,s.Y)(t.A,{id:"/XlqZA",defaultMessage:"Service unavailable error"})}}class b extends d{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),this.errorLogType=o.SessionError,this.errorName=a.UnauthorizedError,this.displayMessage=(0,s.Y)(t.A,{id:"gqfk5C",defaultMessage:"User is not authorized."})}}class w extends i{constructor(e){super("An unknown error occurred.",e),this.errorLogType=o.UnknownError,this.errorName=a.UnknownError,this.displayMessage=(0,s.Y)(t.A,{id:"bKSd3c",defaultMessage:"An unknown error occurred."})}}},46932:function(e,r,n){n.d(r,{BS:function(){return p},CL:function(){return Q},CR:function(){return k},Hq:function(){return $},I$:function(){return K},LS:function(){return m},Lq:function(){return I},MF:function(){return L},N7:function(){return H},OS:function(){return D},PC:function(){return W},Q0:function(){return F},UZ:function(){return M},W0:function(){return Y},ZI:function(){return Z},bn:function(){return z},cp:function(){return T},f7:function(){return b},g_:function(){return U},h8:function(){return q},ij:function(){return g},in:function(){return V},jE:function(){return R},jW:function(){return x},tC:function(){return h},vL:function(){return y},vl:function(){return G},wH:function(){return A},x0:function(){return j}});var t=n(89555),o=n(9133),a=n(48563),s=n(86494),i=n(92151),c=n(79912),l=n(76901),u=n(36784),d=n(38237),f=n(50111);const p="model-trace-info-v3",g=e=>{};function h(e){switch(e){case a.UG.LLM:return a.Dy.MODELS;case a.UG.CHAIN:return a.Dy.CHAIN;case a.UG.AGENT:return a.Dy.AGENT;case a.UG.TOOL:return a.Dy.WRENCH;case a.UG.CHAT_MODEL:return a.Dy.MODELS;case a.UG.RETRIEVER:return a.Dy.SEARCH;case a.UG.PARSER:return a.Dy.CODE;case a.UG.EMBEDDING:return a.Dy.NUMBERS;case a.UG.RERANKER:return a.Dy.SORT;case a.UG.MEMORY:return a.Dy.SAVE;case a.UG.FUNCTION:return a.Dy.FUNCTION;case a.UG.UNKNOWN:return a.Dy.UNKNOWN;default:return a.Dy.FUNCTION}}function m(e){switch(e){case a.UG.LLM:return"LLM";case a.UG.CHAIN:return"Chain";case a.UG.AGENT:return"Agent";case a.UG.TOOL:return"Tool";case a.UG.CHAT_MODEL:return"Chat model";case a.UG.RETRIEVER:return"Retriever";case a.UG.PARSER:return"Parser";case a.UG.EMBEDDING:return"Embedding";case a.UG.RERANKER:return"Reranker";case a.UG.MEMORY:return"Memory";case a.UG.FUNCTION:return"Function";case a.UG.UNKNOWN:return"Unknown";default:return e}}function v(e){try{return JSON.parse(e)}catch(r){return e}}const E=(e,r)=>{if(!r)return[];const n=[],t={inputs:null===e||void 0===e?void 0:e.inputs,outputs:null===e||void 0===e?void 0:e.outputs,attributes:null===e||void 0===e?void 0:e.attributes,events:null===e||void 0===e?void 0:e.events};return(0,o.map)(t,((t,o)=>{if("events"===o)return void n.push(...((e,r)=>{const n=e.events;if(!n)return[];const t=[];return n.forEach(((n,o)=>{const a=n.attributes;a&&Object.keys(a).forEach((s=>{const i=s.toLowerCase().includes(r),c=F(n.name,o,s);i&&t.push({span:e,section:"events",key:c,isKeyMatch:!0,matchIndex:0});const l=JSON.stringify(a[s]).toLowerCase().split(r).length-1;for(let r=0;r<l;r++)t.push({span:e,section:"events",key:c,isKeyMatch:!1,matchIndex:r})}))})),t})(e,r));U(t).forEach((t=>{t.key.toLowerCase().includes(r)&&n.push({span:e,section:o,key:t.key,isKeyMatch:!0,matchIndex:0});const a=t.value.toLowerCase().split(r).length-1;for(let r=0;r<a;r++)n.push({span:e,section:o,key:t.key,isKeyMatch:!1,matchIndex:r})}))})),n};function y(e,r,n){var t,o;const a=r.toLowerCase().trim(),s=Object.values(n.spanTypeDisplayState).every((e=>e));if(""===a&&s)return{filteredTreeNodes:[e],matches:[]};const i=null!==(t=e.children)&&void 0!==t?t:[],c=[],l=[];i.forEach((e=>{const{filteredTreeNodes:r,matches:t}=y(e,a,n);c.push(...r),l.push(...t)}));const u=(null!==(o=e.title)&&void 0!==o?o:"").toLowerCase(),d=E(e,a),f=d.length>0||u.includes(a),p=!e.type||n.spanTypeDisplayState[e.type],g=f&&p,h=c.length>0,m=H(e)>0;return g||n.showParents&&h||n.showExceptions&&m?{filteredTreeNodes:[{...e,children:c}],matches:d.concat(l)}:{filteredTreeNodes:c,matches:l}}function b(e,r){var n;if((0,o.isNil)(r)||(0,o.isNil)(e))return;if(e.key===r)return e;const t=null!==(n=e.children)&&void 0!==n?n:[];for(const o of t){const e=b(o,r);if(e)return e}}const w=(e,r,n,t,a,i)=>{var c,l,u,d,p,g,m,E;const y=v(null===(c=e.attributes)||void 0===c?void 0:c["mlflow.spanType"]),b=v(null===(l=e.attributes)||void 0===l?void 0:l["mlflow.spanInputs"]),w=v(null===(u=e.attributes)||void 0===u?void 0:u["mlflow.spanOutputs"]),N=T(e),S=A(e),M=null!==(d=a[S])&&void 0!==d?d:[];var L;N||M.push(...null!==(L=a[""])&&void 0!==L?L:[]);const x=v(null===(p=e.attributes)||void 0===p?void 0:p["mlflow.chat.messages"]),C=v(null===(g=e.attributes)||void 0===g?void 0:g["mlflow.message.format"]),O=((e,r,n,t)=>{var a,s;if(Array.isArray(e)&&e.every(K))return(0,o.compact)(e.map(Z));const i=null!==(a=$(r,null===t||void 0===t?void 0:t["mlflow.message.format"]))&&void 0!==a?a:[],c=null!==(s=$(n,null===t||void 0===t?void 0:t["mlflow.message.format"]))&&void 0!==s?s:[];return 0!==i.length&&0!==c.length?i.concat(c):void 0})(x,b,w,C?{"mlflow.message.format":C}:void 0),_=((e,r)=>{var n;return Array.isArray(e)&&e.every(W)?e:Array.isArray(null===r||void 0===r?void 0:r.tools)&&null!==r&&void 0!==r&&null!==(n=r.tools)&&void 0!==n&&n.every(W)?r.tools:void 0})(v(null===(m=e.attributes)||void 0===m?void 0:m["mlflow.chat.tools"]),b),I=(0,o.mapValues)((0,o.omitBy)(e.attributes,((e,r)=>r.startsWith("mlflow."))),(e=>v(e))),U=e.events,D=(Number(k(e))-r)/1e3,Y=(Number(null!==(E=R(e))&&void 0!==E?E:n)-r)/1e3;return{title:e.name,icon:(0,f.Y)(s.P,{type:h(y),hasException:H(e)>0,isRootSpan:!N}),type:y,key:S,start:D,end:Y,children:t,inputs:b,outputs:w,attributes:I,events:U,chatMessages:O,chatTools:_,parentId:N,assessments:M,traceId:i}},N=(e,r)=>{if(r)try{return(e=>{const r=atob(e),n=r.length;let t="";for(let o=0;o<n;o++)t+=r.charCodeAt(o).toString(16).padStart(2,"0");return t})(e)}catch(n){return e}return e.startsWith("0x")?e.slice(2):e};function S(e){return"trace_metadata"in e}function M(e){return"start_time_unix_nano"in e}function A(e){var r,n;return M(e)?N(e.span_id,!0):N(null!==(r=null===(n=e.context)||void 0===n?void 0:n.span_id)&&void 0!==r?r:"",!1)}function T(e){var r,n;return M(e)?N(null!==(r=e.parent_span_id)&&void 0!==r?r:"",!0):N(null!==(n=e.parent_id)&&void 0!==n?n:"",!1)}function k(e){return M(e)?Number(e.start_time_unix_nano):Number(e.start_time)}function R(e){return M(e)?Number(e.end_time_unix_nano):Number(e.end_time)}function L(e){var r;return S(e.info)?e.info.trace_id:null!==(r=e.info.request_id)&&void 0!==r?r:""}function x(e){var r,n;const t=L(e),i=null!==(r=null===(n=e.trace_data)||void 0===n?void 0:n.spans)&&void 0!==r?r:e.data.spans,c={},l={};i.forEach((e=>{const r=A(e);c[r]=e,l[r]=[]})),i.forEach((e=>{const r=A(e),n=T(e);if(n){if(!l[n])throw new Error("Tree structure is malformed!");l[n].push(r)}}));const u=i.find((e=>!T(e)));if((0,o.isNil)(u))return null;return function r(n){var o,i,d;const p=c[n],g=Number(k(u)),m=Number(R(u)),v=l[n].map(r),E=C(e.info);if(M(p)||"parent_id"in p)return w(p,g,m,v,E,t);const y=null!==(o=p.span_type)&&void 0!==o?o:a.UG.UNKNOWN;return{title:p.name,icon:(0,f.Y)(s.P,{type:h(y)}),type:y,key:p.context.span_id,start:Number(p.start_time)-g,end:Number(null!==(i=p.end_time)&&void 0!==i?i:m)-g,children:v,inputs:p.inputs,outputs:p.outputs,attributes:p.attributes,events:p.events,parentId:null!==(d=p.parent_id)&&void 0!==d?d:p.parent_span_id,assessments:[],traceId:t}}(A(u))}const C=e=>{let r=[];var n;S(e)?r=null!==(n=e.assessments)&&void 0!==n?n:[]:r=O(e.tags);const t=(0,o.keyBy)(r,"assessment_id");Object.values(t).forEach((e=>{if(e.overrides){const r=t[e.overrides];e.overriddenAssessment=r}})),r=Object.values(t);const a=r.reduce(((e,r)=>{var n;const t=null!==(n=r.span_id)&&void 0!==n?n:"";return e[t]||(e[t]=[]),e[t].push(r),e}),{});return Object.keys(a).forEach((e=>{a[e].sort(((e,r)=>new Date(r.last_update_time).getTime()-new Date(e.last_update_time).getTime()))})),a},O=e=>{if(!e)return[];return(Array.isArray(e)?e:Object.entries(e).map((([e,r])=>({key:e,value:r})))).filter((({key:e})=>e.startsWith("mlflow.assessment."))).map((({value:e})=>JSON.parse(e)))};function _(e){var r;if(e)return(0,o.isArray)(e)?null===(r=e.find((e=>e.key===a.jQ)))||void 0===r?void 0:r.value:e[a.jQ]}const I=e=>{var r;const n=null===e||void 0===e?void 0:e.info,t=null===e||void 0===e?void 0:e.data;if(!n||!t||null===t||void 0===t||!t.spans)return!1;const o=null!==(r=null===n||void 0===n?void 0:n.request_metadata)&&void 0!==r?r:null===n||void 0===n?void 0:n.trace_metadata;if(o&&_(o))return!0;const a=null===n||void 0===n?void 0:n.tags;return!(!a||!_(a))},U=e=>(0,o.isNil)(e)?[]:Array.isArray(e)||(0,o.isString)(e)||(0,o.isNumber)(e)||(0,o.isBoolean)(e)?[{key:"",value:JSON.stringify(e,null,2)}]:Object.entries(e).map((([e,r])=>({key:e,value:JSON.stringify(r,null,2)}))),D=({searchFilter:e,data:r,activeMatchBackgroundColor:n,inactiveMatchBackgroundColor:a,containsActiveMatch:s,activeMatch:i,scrollToActiveMatch:c})=>{const l=new RegExp(`(${(0,o.escapeRegExp)(e.trim())})`,"gi"),u=r.split(l),d=[];let p=0;for(let o=0;o<u.length;o++)if(u[o].toLowerCase().includes(e.toLowerCase().trim())){const e=s&&i.matchIndex===p,r=e?n:a,l=(0,f.Y)("span",{ref:e?c:null,css:(0,t.AH)({backgroundColor:r,scrollMarginTop:50},""),children:u[o]},o);p++,d.push(l)}else d.push(u[o]);return d},Y=e=>(0,o.has)(e,"page_content"),G=e=>e.type===a.UG.RETRIEVER&&Array.isArray(e.outputs)&&e.outputs.length>0&&(0,o.every)(e.outputs,Y),F=(e,r,n)=>`${e}-${r}-${n}`,z=e=>{var r;return(null!==(r=e.events)&&void 0!==r?r:[]).filter((e=>"exception"===e.name))},H=e=>z(e).length,P=e=>!(0,o.isNil)(e)&&(!(!(0,o.isNil)(e.type)&&!(0,o.isString)(e.type))&&(!(!(0,o.isNil)(e.description)&&!(0,o.isString)(e.description))&&!(!(0,o.isNil)(e.enum)&&!Array.isArray(e.enum)))),W=e=>{var r;if((0,o.isNil)(e)||"function"!==e.type||!(0,o.has)(e,"function.name"))return!1;const n=null===(r=e.function)||void 0===r?void 0:r.parameters;if(!(0,o.isNil)(n)){const e=n.required;if(!(0,o.isNil)(e)&&(!Array.isArray(e)||!e.every(o.isString)))return!1;const r=n.properties;if(!(0,o.isNil)(r)&&!Object.values(r).every(P))return!1}return!0},q=e=>{var r,n;return e&&(0,o.isString)(e.id)&&(0,o.isString)(null===(r=e.function)||void 0===r?void 0:r.arguments)&&(0,o.isString)(null===(n=e.function)||void 0===n?void 0:n.name)},B=e=>!(!(0,o.isNil)(e)&&!(0,o.isString)(e))||!!(0,o.isArray)(e)&&e.every((e=>(e=>{switch(e.type){case"text":case"input_text":case"output_text":return(0,o.isString)(e.text);case"image_url":const{image_url:r}=e;return!(0,o.isNil)(r)&&(0,o.isString)(r.url)&&((0,o.isNil)(r.detail)||["auto","low","high"].includes(r.detail));case"input_audio":const{input_audio:n}=e;return!(0,o.isNil)(n)&&(0,o.isString)(n.data)&&((0,o.isNil)(n.format)||["wav","mp3"].includes(n.format));default:return!1}})(e))),K=e=>{if(!e)return!1;if(e.tool_calls){if(!Array.isArray(e.tool_calls))return!1;if(!e.tool_calls.every(q))return!1}return"reasoning"===e.type||!!B(e.content)&&("user"===e.role||"assistant"===e.role||"system"===e.role||"tool"===e.role)},j=e=>Array.isArray(e)&&e.length>0&&e.every((e=>{return(0,o.has)(e,"message")&&(r=e.message,!!K(r)&&((0,o.isNil)(r.content)||(0,o.isString)(r.content)));var r})),V=e=>e&&j(e.choices),$=(e,r)=>{var n,t,a,s,f,p,g,h,m,v,E,y;try{if(Array.isArray(e)&&e.length>0&&e.every(K))return(0,o.compact)(e.map(Z));switch(r){case"langchain":const r=null!==(n=(0,i.HD)(e))&&void 0!==n?n:(0,i.oI)(e);if(r)return r;break;case"llamaindex":const o=null!==(t=(0,c.H)(e))&&void 0!==t?t:(0,i.W3)(e);if(o)return o;break;case"openai":const b=null!==(a=null!==(s=null!==(f=(0,i.a8)(e))&&void 0!==f?f:(0,i.bS)(e))&&void 0!==s?s:(0,i.n_)(e))&&void 0!==a?a:(0,i.AG)(e);if(b)return b;break;case"dspy":const w=null!==(p=(0,i.iU)(e))&&void 0!==p?p:(0,i.Pn)(e);if(w)return w;break;case"gemini":const N=null!==(g=(0,i.DE)(e))&&void 0!==g?g:(0,i.Sy)(e);if(N)return N;break;case"anthropic":const S=null!==(h=(0,i.KF)(e))&&void 0!==h?h:(0,i.pL)(e);if(S)return S;break;case"openai-agent":const M=null!==(m=(0,l.xW)(e))&&void 0!==m?m:(0,l.m$)(e);if(M)return M;break;case"autogen":const A=null!==(v=(0,u.n)(e))&&void 0!==v?v:(0,u.u)(e);if(A)return A;break;case"bedrock":const T=null!==(E=(0,d.Y)(e))&&void 0!==E?E:(0,d.f)(e);if(T)return T;break;default:const k=null!==(y=(0,i.a8)(e))&&void 0!==y?y:(0,i.bS)(e);if(k)return k}return null}catch(b){return null}},Q=e=>{var r;let n=null===(r=e.function)||void 0===r?void 0:r.arguments;try{n=JSON.stringify(JSON.parse(n),null,2)}catch(t){}return{id:e.id,function:{arguments:n,name:e.function.name}}},J=e=>{if((0,o.isNil)(e)||(0,o.isString)(e))return e;return e.map((e=>{var r;switch(e.type){case"text":case"input_text":case"output_text":return e.text;case"image_url":const n=null===e||void 0===e||null===(r=e.image_url)||void 0===r?void 0:r.url;return n?`![](${n})`:"[image]";case"input_audio":return"[audio]"}})).filter((e=>void 0!==e)).join("\n\n")},Z=e=>{var r;return"reasoning"===e.type?null:{...e,content:J(e.content),tool_calls:null===(r=e.tool_calls)||void 0===r?void 0:r.map(Q)}}},48563:function(e,r,n){n.d(r,{Dy:function(){return i},O5:function(){return o},So:function(){return a},UG:function(){return s},VZ:function(){return c},cC:function(){return l},jQ:function(){return t}});const t="mlflow.trace_schema.version",o="response",a="trace";let s=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.FUNCTION="FUNCTION",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),i=function(e){return e.MODELS="models",e.DOCUMENT="document",e.CONNECT="connect",e.SEARCH="search",e.SORT="sort",e.UNKNOWN="unknown",e.FUNCTION="function",e.CODE="code",e.NUMBERS="numbers",e.WRENCH="wrench",e.AGENT="agent",e.CHAIN="chain",e.USER="user",e.SYSTEM="system",e.SAVE="save",e}({}),c=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),l=function(e){return e.JSON="json",e.TEXT="text",e.MARKDOWN="markdown",e}({})},75060:function(e,r,n){async function t(e){try{const r=await fetch(`/ajax-api/2.0/mlflow/get-trace-artifact?request_id=${e}`),n=await r.text(),t=JSON.parse(n);return t.spans?{info:{request_id:e},data:t}:t.error_code?t.message:"Unknown error occurred"}catch(r){return r instanceof Error?r.message:"string"===typeof r?r:"Unknown error occurred"}}n.d(r,{g:function(){return t}})},80870:function(e,r,n){n.r(r),n.d(r,{CodeSnippetRenderMode:function(){return m.cC},INFERENCE_TABLE_RESPONSE_COLUMN_KEY:function(){return m.O5},INFERENCE_TABLE_TRACE_COLUMN_KEY:function(){return m.So},MLFLOW_TRACE_SCHEMA_VERSION_KEY:function(){return m.jQ},ModelIconType:function(){return m.Dy},ModelSpanType:function(){return m.UG},ModelTraceExplorer:function(){return t.a},ModelTraceExplorerOSSNotebookRenderer:function(){return p},ModelTraceSpanType:function(){return m.VZ},getIsMlflowTraceUIEnabled:function(){return h.KR},getModelTraceId:function(){return g.MF},getModelTraceSpanEndTime:function(){return g.jE},getModelTraceSpanId:function(){return g.wH},getModelTraceSpanParentId:function(){return g.cp},getModelTraceSpanStartTime:function(){return g.CR},getTraceArtifact:function(){return v.g},isModelTrace:function(){return g.Lq},isV3ModelTraceSpan:function(){return g.UZ}});var t=n(13453),o=n(89555),a=n(31014),s=n(59403),i=n(68048),c=n(7450),l=n(50111);const u=(e,r)=>{const n=new URLSearchParams;return n.append("selectedTraceId",e),n.append("compareRunsMode","TRACES"),`/#/experiments/${r}?${n.toString()}`};var d={name:"1elrbzk",styles:"width:calc(100% - 2px)"},f={name:"inxa61",styles:"flex:1;overflow:hidden"};const p=()=>{const e=(0,a.useMemo)((()=>new URLSearchParams(window.location.search).getAll("trace_id")),[]),r=(0,a.useMemo)((()=>new URLSearchParams(window.location.search).getAll("experiment_id")),[]),[n,p]=(0,a.useState)(e.length>0?0:null),[g,h]=(0,a.useState)(null),[m,E]=(0,a.useState)(!0),[y,b]=(0,a.useState)(null),{theme:w}=(0,s.u)();return(0,a.useEffect)((()=>{(async()=>{if(null===n)return;E(!0);const r=e[n],t=await(0,v.g)(r);"string"===typeof t?b(t):h(t),E(!1)})()}),[n,e]),0===e.length||null===n?null:m?(0,l.Y)("div",{css:d,children:(0,l.Y)(s.T.Text,{color:"secondary",children:(0,l.Y)(c.sA,{id:"JJFZ1V",defaultMessage:"Fetching trace data..."})})}):g?(0,l.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",border:`1px solid ${w.colors.border}`,height:"calc(100% - 2px)"},""),children:[(0,l.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:`${w.spacing.xs}px ${w.spacing.md}px`},""),children:[(0,l.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:w.spacing.sm},""),children:[(0,l.Y)(s.T.Title,{level:4,withoutMargins:!0,children:"MLflow Trace UI"}),(0,l.Y)(i.InfoTooltip,{componentId:"mlflow.notebook.trace-ui-info",iconTitle:"More information",maxWidth:400,content:(0,l.Y)(c.sA,{id:"LED2z5",defaultMessage:"To disable or enable this display, call {disableFunction} or {enableFunction} and re-run the cell",values:{disableFunction:(0,l.Y)("code",{children:"mlflow.tracing.disable_notebook_display()"}),enableFunction:(0,l.Y)("code",{children:"mlflow.tracing.enable_notebook_display()"})}})}),(0,l.Y)(s.T.Link,{componentId:"mlflow.notebook.trace-ui-learn-more-link",href:"https://mlflow.org/docs/latest/llms/tracing/index.html?ref=jupyter-notebook-widget",openInNewTab:!0,title:"Learn More",children:(0,l.Y)(c.sA,{id:"uIY1qq",defaultMessage:"Learn More"})})]}),(0,l.Y)(s.T.Link,{componentId:"mlflow.notebook.trace-ui-see-in-mlflow-link",href:u(e[n],r[n]),openInNewTab:!0,title:"View in MLflow UI",children:(0,l.Y)(c.sA,{id:"4NyhOm",defaultMessage:"View in MLflow UI"})})]}),e.length>1&&(0,l.Y)(i.Pagination,{componentId:"mlflow.notebook.pagination",currentPageIndex:n+1,dangerouslySetAntdProps:{showQuickJumper:!0},numTotal:e.length,onChange:e=>p(e-1),pageSize:1,style:{marginBottom:w.spacing.sm,paddingLeft:w.spacing.sm,paddingRight:w.spacing.sm}}),(0,l.Y)("div",{css:f,children:(0,l.Y)(t.a,{modelTrace:g,initialActiveView:"detail"})})]}):(0,l.Y)("div",{css:(0,o.AH)({paddingTop:w.spacing.md,width:"calc(100% - 2px)"},""),children:(0,l.Y)(i.Empty,{image:(0,l.Y)(s.l,{}),description:(0,l.FD)(l.FK,{children:[(0,l.Y)(s.T.Paragraph,{children:(0,l.Y)(c.sA,{id:"UD4Z+e",defaultMessage:"An error occurred while attempting to fetch trace data (ID: {traceId}). Please ensure that the MLflow tracking server is running, and that the trace data exists. Error details:",values:{traceId:e[n]}})}),y&&(0,l.Y)(s.T.Paragraph,{children:y})]}),title:(0,l.Y)(c.sA,{id:"md81Lo",defaultMessage:"Error"})})})};var g=n(46932),h=n(17297),m=n(48563),v=n(75060)},91130:function(e,r,n){n(31014)},94026:function(e,r,n){n.d(r,{wY:function(){return o}});var t=n(31014);n(18930);function o({ref:e,debounceTimeMs:r}){const n=(0,t.useRef)({width:-1,height:-1}),o=(0,t.useRef)(),[a,s]=(0,t.useState)(null),i=(0,t.useCallback)((e=>{if(0===e.length)return;const t=e[0].contentRect;if(-1===n.current.width)return n.current={width:t.width,height:t.height},void s(n.current);if(t.width!==n.current.width||t.height!==n.current.height){if(n.current.width=t.width,n.current.height=t.height,!r)return void s({...n.current});clearTimeout(o.current),o.current=setTimeout((()=>{s({...n.current})}),r)}}),[r]),c=(0,t.useRef)();return c.current||(c.current=new ResizeObserver(i)),(0,t.useEffect)((()=>{const r="function"===typeof e?e():e.current;if(r){const e=c.current;return e.observe(r),()=>e.unobserve(r)}})),a}n(91130)}}]);
//# sourceMappingURL=1130.59d524d2.chunk.js.map