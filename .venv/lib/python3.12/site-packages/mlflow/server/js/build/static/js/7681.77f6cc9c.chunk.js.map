{"version":3,"file":"static/js/7681.77f6cc9c.chunk.js","mappings":"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","sources":["common/static/icon-visible-fill.svg","experiment-tracking/components/experiment-page/utils/persistSearchFacets.serializers.ts","experiment-tracking/components/experiment-page/hooks/useExperimentPageSearchFacets.tsx","experiment-tracking/components/runs-charts/utils/findChartStepsByTimestamp.ts","experiment-tracking/components/runs-charts/components/cards/RunsChartsLineChartCard.tsx","experiment-tracking/components/runs-charts/hooks/useCompareRunChartSelectedRange.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsScatterChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsContourChartCard.tsx","common/static/parallel-chart-placeholder.svg","experiment-tracking/components/runs-charts/components/cards/RunsChartsParallelChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsDifferenceChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsImageChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsCard.tsx","common/static/chart-contour.svg","experiment-tracking/components/runs-charts/components/hooks/useLineChartGlobalConfig.tsx","experiment-tracking/components/experiment-page/utils/experimentPage.fetch-utils.ts","experiment-tracking/components/runs-charts/components/cards/ChartCard.common.tsx","experiment-tracking/components/runs-charts/components/RunsScatterPlot.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegend.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigure.common.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureMetricWithDatasetSelect.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.tsx","experiment-tracking/components/runs-charts/components/RunsChartsYAxisMetricAndExpressionSelector.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureDifferenceChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChartWithDatasets.tsx","experiment-tracking/components/runs-charts/components/RunsChartsConfigureModal.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.preview.tsx","experiment-tracking/components/runs-charts/utils/runsCharts.const.ts","experiment-tracking/components/runs-charts/components/charts/LazyParallelCoordinatesPlot.tsx","experiment-tracking/components/experiment-page/contexts/ExperimentPageUIStateContext.tsx","experiment-tracking/components/experiment-page/hooks/useToggleRowVisibilityCallback.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegendWrapper.tsx","experiment-tracking/components/runs-charts/hooks/useSampledMetricHistoryGraphQL.tsx","experiment-tracking/components/runs-charts/hooks/useSampledMetricHistory.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentIds.ts","experiment-tracking/components/runs-charts/hooks/useRunsChartTraceHighlight.ts","experiment-tracking/components/runs-charts/hooks/useRunsHighlightTableRow.tsx","experiment-tracking/components/experiment-page/components/runs/cells/ColumnHeaderCell.tsx","experiment-tracking/components/experiment-page/components/runs/cells/DateCellRenderer.tsx","common/components/TrimmedText.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RunDescriptionCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/ExperimentNameCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/ModelsCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/ModelsHeaderCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/VersionCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RunVisibilityControlButton.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableHeaderContext.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RowActionsCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RowActionsHeaderCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/GroupParentCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RunNameCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/LoadMoreRowRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/DatasetsCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/AggregateMetricValueCell.tsx","experiment-tracking/components/experiment-page/utils/experimentPage.column-utils.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsEmptyTable.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableAddColumnCTA.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableStatusBar.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentTableSelectRowHandler.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTable.tsx","experiment-tracking/components/runs-charts/utils/differenceView.ts","experiment-tracking/components/runs-charts/components/charts/difference-view-plot/DifferencePlotDataCell.tsx","experiment-tracking/components/runs-charts/components/charts/difference-view-plot/DifferencePlotRunHeaderCell.tsx","experiment-tracking/components/runs-charts/components/charts/DifferenceViewPlot.tsx","common/static/chart-difference.svg","experiment-tracking/components/runs-charts/components/charts/ImageGridSingleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridMultipleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.tsx","common/components/PreviewSidebar.tsx","experiment-tracking/components/MetricChartsAccordion.tsx","experiment-tracking/components/runs-charts/components/RunsChartsAddChartMenu.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionHeader.tsx","experiment-tracking/components/runs-charts/hooks/useIsInViewport.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggableCard.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggablePreview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggableCardsGridSection.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSection.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionAccordion.tsx","common/static/chart-parallel.svg","experiment-tracking/components/runs-charts/hooks/useChartExpressionParser.tsx","experiment-tracking/components/runs-charts/hooks/useChartImageDownloadHandler.tsx","common/components/ag-grid/AgGridLoader.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsBarChartCard.tsx","experiment-tracking/components/runs-charts/components/RunsMultipleTracesTooltipBody.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsUIConfiguration.tsx","experiment-tracking/hooks/logged-models/useSearchLoggedModelsQuery.tsx","experiment-tracking/components/runs-charts/components/RunsChartsFullScreenModal.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsBarPlot.tsx","experiment-tracking/components/runs-charts/components/RunsContourPlot.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggableCardsGridContext.tsx","experiment-tracking/components/runs-charts/components/RunsChartsTooltipBody.tsx","common/static/chart-line.svg","experiment-tracking/components/runs-charts/hooks/useRunsChartsMultipleTracesTooltip.tsx","experiment-tracking/components/runs-charts/utils/expressionCharts.utils.ts","experiment-tracking/components/runs-charts/components/RunsMetricsLinePlot.tsx","common/static/chart-scatter.svg","experiment-tracking/components/runs-charts/components/RunsChartsNoDataFoundIndicator.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsTooltip.tsx","experiment-tracking/components/RunStatusIcon.tsx","common/static/chart-bar.svg","experiment-tracking/components/runs-compare/hooks/useGroupedChartRunData.tsx","experiment-tracking/components/experiment-page/models/ExperimentPageSearchFacetsState.tsx","common/hooks/useDragAndDropElement.tsx","experiment-tracking/components/runs-charts/hooks/useMutableHoverCallback.tsx","experiment-tracking/components/runs-charts/hooks/useImageSliderStepMarks.tsx","common/static/chart-image.svg"],"sourcesContent":["var _path, _circle;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgIconVisibleFill({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8 3C3.45 3 1.4375 6.33333 1 8C1.4375 9.66667 3.45 13 8 13C12.55 13 14.5625 9.66667 15 8C14.5625 6.33333 12.55 3 8 3Z\",\n    fill: \"currentColor\",\n    stroke: \"currentColor\"\n  })), _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 8,\n    cy: 8,\n    r: 2.25,\n    fill: \"currentColor\",\n    stroke: \"white\",\n    strokeWidth: 1.5\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgIconVisibleFill);\nexport default __webpack_public_path__ + \"static/media/icon-visible-fill.8d34cd35303828fdfc15154f5536e63b.svg\";\nexport { ForwardRef as ReactComponent };","import { isArray } from 'lodash';\nimport { atobUtf8, btoaUtf8 } from '../../../../common/utils/StringUtils';\nimport { ExperimentPageSearchFacetsState } from '../models/ExperimentPageSearchFacetsState';\nimport { ExperimentPageUIState } from '../models/ExperimentPageUIState';\n\ntype PersistSearchSerializeFunctions<Serialized = any, Unserialized = any> = {\n  serializeLocalStorage?(input: Unserialized): Serialized;\n  serializeQueryString?(input: Unserialized): Serialized;\n  deserializeLocalStorage?(input: Serialized): Unserialized;\n  deserializeQueryString?(input: Serialized): Unserialized;\n};\n\n/**\n * \"Flattens\" the strings array, i.e. merges it into a single value\n */\nconst flattenString = (input: string | string[]) => (isArray(input) ? input.join() : input);\n\n/**\n * All known field serialization and deserialization mechanisms used in search facets state persisting mechanism.\n */\nconst persistSearchStateFieldSerializers: Record<string, PersistSearchSerializeFunctions> = {\n  /**\n   * In rare cases, search filter might contain commas that interfere with `querystring` library\n   * parsing causing it to return array instead of string. Since it's difficult to selectively\n   * change `querystring`'s parsing action, we are making sure that the parsed values are always strings.\n   */\n  searchFilter: {\n    deserializeLocalStorage: flattenString,\n    deserializeQueryString: flattenString,\n  },\n  orderByAsc: {\n    serializeQueryString(input: boolean) {\n      return input.toString();\n    },\n    deserializeQueryString(input: string) {\n      return input === 'true';\n    },\n  },\n  datasetsFilter: {\n    serializeQueryString(inputs: ExperimentPageSearchFacetsState['datasetsFilter']) {\n      const inputsWithoutExperimentId = inputs.map(({ name, digest, context }) => ({\n        name,\n        digest,\n        context,\n      }));\n      return btoaUtf8(JSON.stringify(inputsWithoutExperimentId));\n    },\n    deserializeQueryString(input: string): ExperimentPageSearchFacetsState['datasetsFilter'] {\n      try {\n        // Process the URL defensively against intended and unintended malformation\n        const parsedResult = JSON.parse(atobUtf8(input));\n        if (!Array.isArray(parsedResult)) {\n          return [];\n        }\n        return parsedResult;\n      } catch {\n        return [];\n      }\n    },\n  },\n  /**\n   * Array of visible configured charts are serialized into base64-encoded JSON when put into query string\n   */\n  compareRunCharts: {\n    serializeQueryString(input: ExperimentPageUIState['compareRunCharts']) {\n      return btoaUtf8(JSON.stringify(input));\n    },\n    deserializeQueryString(input: string): ExperimentPageUIState['compareRunCharts'] {\n      try {\n        // Process the URL defensively against intended and unintended malformation\n        const parsedResult = JSON.parse(atobUtf8(input));\n        if (!Array.isArray(parsedResult)) {\n          return undefined;\n        }\n        return parsedResult;\n      } catch {\n        return undefined;\n      }\n    },\n  },\n  /**\n   * For \"compareRunsMode\", we will always save \"undefined\" value to local storage so users will\n   * get back to default view after visiting the view once more.\n   */\n  compareRunsMode: {\n    serializeLocalStorage() {\n      return undefined;\n    },\n  },\n};\n\ntype StateKey = keyof Partial<ExperimentPageSearchFacetsState>;\n\n/**\n * Consumes an object with persistable search facets and transforms relevant fields\n * with the registered serialization functions specific to query string.\n * Example scenario: serializing an array of visible configured charts into base64-encoded JSON.\n */\nexport const serializeFieldsToQueryString = (input: Partial<ExperimentPageSearchFacetsState>) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const serializeFn = persistSearchStateFieldSerializers[field]?.serializeQueryString;\n    if (serializeFn) {\n      resultObject[field] = serializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with search facets extracted from query string and transforms relevant fields\n * with the registered deserialization functions. Example scenario: deserializing an array of\n * visible configured charts from base64-encoded JSON.\n */\nexport const deserializeFieldsFromQueryString = (\n  input: Partial<ExperimentPageSearchFacetsState> | Record<string, any>,\n) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const deserializeFn = persistSearchStateFieldSerializers[field]?.deserializeQueryString;\n    if (deserializeFn) {\n      resultObject[field] = deserializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with persistable search facets and transforms relevant fields\n * with the registered serialization functions specific to local storage.\n * Example scenario: serializing an array of visible configured charts into base64-encoded JSON.\n */\nexport const serializeFieldsToLocalStorage = (input: Partial<ExperimentPageSearchFacetsState>) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const serializeFn = persistSearchStateFieldSerializers[field]?.serializeLocalStorage;\n    if (serializeFn) {\n      resultObject[field] = serializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with search facets extracted from local storage and transforms relevant fields\n * with the registered deserialization functions. Example scenario: deserializing an array of\n * visible configured charts from base64-encoded JSON.\n */\nexport const deserializeFieldsFromLocalStorage = (\n  input: Partial<ExperimentPageSearchFacetsState> | Record<string, any>,\n) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const deserializeFn = persistSearchStateFieldSerializers[field]?.deserializeLocalStorage;\n    if (deserializeFn) {\n      resultObject[field] = deserializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n","import { assign, entries, isNil, keys, omitBy, pick } from 'lodash';\nimport { useMemo } from 'react';\nimport { NavigateOptions, useParams, useSearchParams } from '../../../../common/utils/RoutingUtils';\nimport {\n  ExperimentPageSearchFacetsState,\n  createExperimentPageSearchFacetsState,\n} from '../models/ExperimentPageSearchFacetsState';\nimport {\n  deserializeFieldsFromQueryString,\n  serializeFieldsToQueryString,\n} from '../utils/persistSearchFacets.serializers';\n\nexport const EXPERIMENT_PAGE_QUERY_PARAM_KEYS = [\n  'searchFilter',\n  'orderByKey',\n  'orderByAsc',\n  'startTime',\n  'lifecycleFilter',\n  'modelVersionFilter',\n  'datasetsFilter',\n];\n\nexport const EXPERIMENT_PAGE_QUERY_PARAM_IS_PREVIEW = 'isPreview';\n\nexport type ExperimentPageQueryParams = any;\n\nexport type ExperimentQueryParamsSearchFacets = ExperimentPageSearchFacetsState & {\n  experimentIds?: string[];\n};\n\nconst getComparedExperimentIds = (comparedExperimentIds: string): string[] => {\n  try {\n    return comparedExperimentIds ? JSON.parse(comparedExperimentIds) : [];\n  } catch {\n    return [];\n  }\n};\n\nexport const useExperimentPageSearchFacets = (): [ExperimentQueryParamsSearchFacets | null, string[], boolean] => {\n  const [queryParams] = useSearchParams();\n\n  // Pick only the keys we care about\n  const pickedValues = useMemo(\n    () => pick(Object.fromEntries(queryParams.entries()), EXPERIMENT_PAGE_QUERY_PARAM_KEYS),\n    [queryParams],\n  );\n\n  // Check if the page is in preview mode. If so, it should not be persisted until explicitly changed\n  const isPreview = queryParams.get(EXPERIMENT_PAGE_QUERY_PARAM_IS_PREVIEW) === 'true';\n\n  // Destructure to get raw values\n  const { searchFilter, orderByKey, orderByAsc, startTime, lifecycleFilter, modelVersionFilter, datasetsFilter } =\n    pickedValues;\n\n  const areValuesEmpty = keys(pickedValues).length < 1;\n\n  const { experimentId } = useParams<{ experimentId: string }>();\n  const queryParamsExperimentIds = queryParams.get('experiments');\n\n  // Calculate experiment IDs\n  const experimentIds = useMemo(() => {\n    if (experimentId) {\n      return [experimentId];\n    }\n    if (queryParamsExperimentIds) {\n      return getComparedExperimentIds(queryParamsExperimentIds);\n    }\n    return [];\n  }, [experimentId, queryParamsExperimentIds]);\n\n  // Calculate and memoize search facets\n  const searchFacets = useMemo(() => {\n    if (areValuesEmpty) {\n      return null;\n    }\n    const deserializedFields = deserializeFieldsFromQueryString(\n      omitBy(\n        {\n          searchFilter,\n          orderByKey,\n          orderByAsc,\n          startTime,\n          lifecycleFilter,\n          modelVersionFilter,\n          datasetsFilter,\n        },\n        isNil,\n      ),\n    ) as ExperimentPageSearchFacetsState;\n\n    // If not all fields are provided, fill the gaps with default values\n    return assign(createExperimentPageSearchFacetsState(), deserializedFields);\n  }, [\n    // Use exact values to avoid unnecessary re-renders\n    searchFilter,\n    orderByKey,\n    orderByAsc,\n    startTime,\n    lifecycleFilter,\n    modelVersionFilter,\n    datasetsFilter,\n    areValuesEmpty,\n  ]);\n\n  return [searchFacets, experimentIds, isPreview];\n};\n\nexport const useUpdateExperimentPageSearchFacets = () => {\n  const [, setParams] = useSearchParams();\n\n  return (partialFacets: Partial<ExperimentPageSearchFacetsState>, options?: NavigateOptions) => {\n    const newParams = serializeFieldsToQueryString(partialFacets);\n    setParams((currentParams) => {\n      entries(newParams).forEach(([key, value]) => {\n        currentParams.set(key, value);\n      });\n      currentParams.delete(EXPERIMENT_PAGE_QUERY_PARAM_IS_PREVIEW);\n      return currentParams;\n    }, options);\n  };\n};\n","import { type Dictionary, compact, first, isUndefined, last, max, min, minBy, orderBy, values } from 'lodash';\nimport { MetricEntity, SampledMetricsByRunUuidState } from '../../../types';\nimport { SampledMetricsByRun } from '../hooks/useSampledMetricHistory';\n\n/**\n * This function consumes chart timestamp range and returns\n * corresponding step range for a given metric basing on a history.\n */\nexport const findChartStepsByTimestamp = (\n  // Currently fetched metric history\n  currentMetricHistory: {\n    [rangeKey: string]: {\n      loading?: boolean | undefined;\n      metricsHistory?: MetricEntity[] | undefined;\n    };\n  },\n  // Timestamp range - either textual (\"2022-10-23 10:00:00\") or numeric (milliseconds)\n  range: [string | number, string | number],\n  // If set to true, will return entire boundaries from history if timestamps are not found.\n  // Otherwise, will return undefined.\n  useDefaultIfNotFound = true,\n): [number, number] | undefined => {\n  // First, let's compile a history of all metric values from all ranges,\n  // then sort it by timestamp\n  const flatHistory = orderBy(\n    compact(\n      values(currentMetricHistory)\n        .map(({ metricsHistory }) => metricsHistory)\n        .flat(),\n    ),\n    'timestamp',\n  );\n\n  // If there's no sufficient entries, return nothing\n  if (flatHistory.length < 2) {\n    return undefined;\n  }\n\n  // We consume textual ranges produced by charts so we have\n  // to convert them to timestamps\n  const lowerBound = new Date(range[0]).valueOf();\n  const upperBound = new Date(range[1]).valueOf();\n\n  // First, try to find the lower entry using loop\n  let lowerEntry = useDefaultIfNotFound ? first(flatHistory) : undefined;\n\n  for (let index = 0; index < flatHistory.length; index++) {\n    const entry = flatHistory[index];\n    if (entry.timestamp > lowerBound) {\n      lowerEntry = flatHistory[index - 1] || entry;\n      break;\n    }\n  }\n\n  // Repeat for the upper entry\n  let upperEntry = useDefaultIfNotFound ? last(flatHistory) : undefined;\n\n  for (let index = flatHistory.length - 1; index >= 0; index--) {\n    const entry = flatHistory[index];\n    if (entry.timestamp < upperBound) {\n      upperEntry = flatHistory[index + 1] || entry;\n      break;\n    }\n  }\n\n  // If boundaries are not found, return nothing\n  if (isUndefined(lowerEntry) || isUndefined(upperEntry)) {\n    return undefined;\n  }\n\n  // Return found boundary entries\n  return [lowerEntry.step, upperEntry.step];\n};\n\n/**\n * Finds the chart steps by absolute timestamp for multiple runs.\n *\n * @param sampledMetrics - The sampled metrics by run UUID state.\n * @param runUuids - The array of run UUIDs.\n * @param metricKey - The metric key.\n * @param range - The range of timestamps.\n * @returns The lower and upper bounds of the chart steps, or undefined if not found.\n */\nexport const findChartStepsByTimestampForRuns = (\n  sampledMetrics: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  metricKey: string,\n  range: [string | number, string | number],\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const metricHistoryForRun = sampledMetrics[runUuid]?.[metricKey];\n      return metricHistoryForRun ? findChartStepsByTimestamp(metricHistoryForRun, range, false) : undefined;\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n\n/**\n * This function consumes chart relative time range and returns\n * corresponding step range for a given metric basing on a history.\n *\n * @param currentlyVisibleMetrics currentlyVisibleMetrics is a dictionary of currently rendered metric traces for run\n * @param runUuids a list of run UUIDs to process\n * @param relativeRange a relative time range in seconds\n * @returns a range of steps or undefined if no relevant are found\n */\nexport const findAbsoluteTimestampRangeForRelativeRange = (\n  currentlyVisibleMetrics: Dictionary<SampledMetricsByRun>,\n  runUuids: string[],\n  relativeRange: [number, number],\n  multiplier = 1000,\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const runData = currentlyVisibleMetrics[runUuid];\n\n      if (!runData) {\n        return null;\n      }\n\n      // omit the \"runUuid\" key so we can conveniently access the metrics data\n      const { runUuid: _, ...runMetrics } = runData;\n\n      // concat all the metrics history for the run\n      const visibleMetricHistoryForRun = values(runMetrics).flatMap((metric) => metric.metricsHistory ?? []);\n\n      // Find the timestamp offset for the run. Should be equal to lowest timestamp value for each run.\n      const timestampOffset = minBy(visibleMetricHistoryForRun, 'timestamp')?.timestamp || 0;\n\n      // Convert relative time range to timestamp range. Relative range comes\n      // in seconds so we have to multiply it by 1000 to get milliseconds.\n      return [relativeRange[0] * multiplier + timestampOffset, relativeRange[1] * multiplier + timestampOffset] as [\n        number,\n        number,\n      ];\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n","import { ReactNode, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType, removeOutliersFromMetricHistory } from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport {\n  RunsChartsLineChartYAxisType,\n  type RunsChartsCardConfig,\n  type RunsChartsLineCardConfig,\n} from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardVisibilityProps,\n  RunsChartCardSizeProps,\n  RunsChartCardLoadingPlaceholder,\n} from './ChartCard.common';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, intersection, isEqual, isUndefined, pick, uniq } from 'lodash';\nimport {\n  shouldEnableRelativeTimeDateAxis,\n  shouldEnableChartExpressions,\n} from '../../../../../common/utils/FeatureUtils';\nimport { findAbsoluteTimestampRangeForRelativeRange } from '../../utils/findChartStepsByTimestamp';\nimport { Figure } from 'react-plotly.js';\nimport { ReduxState } from '../../../../../redux-types';\nimport { shallowEqual, useSelector } from 'react-redux';\nimport { useCompareRunChartSelectedRange } from '../../hooks/useCompareRunChartSelectedRange';\nimport { MetricHistoryByName } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\nimport {\n  ExperimentChartImageDownloadFileFormat,\n  useChartImageDownloadHandler,\n} from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartMetricHistoryCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport { useLineChartGlobalConfig } from '../hooks/useLineChartGlobalConfig';\n\nconst getV2ChartTitle = (cardConfig: RunsChartsLineCardConfig): string => {\n  if (shouldEnableChartExpressions() && cardConfig.yAxisKey === RunsChartsLineChartYAxisType.EXPRESSION) {\n    const expressions = cardConfig.yAxisExpressions?.map((exp) => exp.expression) || [];\n    return expressions?.join(' vs ') || '';\n  }\n  if (!cardConfig.selectedMetricKeys || cardConfig.selectedMetricKeys.length === 0) {\n    return cardConfig.metricKey;\n  }\n\n  return cardConfig.selectedMetricKeys.join(' vs ');\n};\n\nexport interface RunsChartsLineChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardSizeProps,\n    RunsChartCardVisibilityProps {\n  config: RunsChartsLineCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  groupBy: RunsGroupByConfig | null;\n\n  onDelete: () => void;\n  onEdit: () => void;\n\n  fullScreen?: boolean;\n\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n\n  setFullScreenChart?: (chart: { config: RunsChartsCardConfig; title: string; subtitle: ReactNode }) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nconst SUPPORTED_DOWNLOAD_FORMATS: (ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full')[] = [\n  'png',\n  'svg',\n  'csv',\n  'csv-full',\n];\n\nexport const RunsChartsLineChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onDownloadFullMetricHistoryCsv,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n  globalLineChartConfig,\n  isInViewport: isInViewportProp,\n  isInViewportDeferred: isInViewportDeferredProp,\n  positionInSection,\n  ...reorderProps\n}: RunsChartsLineChartCardProps) => {\n  const { xAxisKey, selectedXAxisMetricKey, lineSmoothness } = useLineChartGlobalConfig(config, globalLineChartConfig);\n\n  const toggleFullScreenChart = useCallback(() => {\n    setFullScreenChart?.({\n      config,\n      title: getV2ChartTitle(config),\n      subtitle: null,\n    });\n  }, [config, setFullScreenChart]);\n\n  const slicedRuns = useMemo(() => chartRunData.filter(({ hidden }) => !hidden).reverse(), [chartRunData]);\n\n  const isGrouped = useMemo(() => slicedRuns.some((r) => r.groupParentInfo), [slicedRuns]);\n\n  const isEmptyDataset = useMemo(() => {\n    const metricKeys = config.selectedMetricKeys ?? [config.metricKey];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      // First, get all runs inside visible groups\n      const runsInGroups = compact(slicedRuns.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n\n      // Finally, get \"remaining\" runs that are not grouped\n      const ungroupedRuns = compact(\n        slicedRuns.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    // If grouping is disabled, just get all run UUIDs from runInfo\n    return compact(slicedRuns.map((r) => r.runInfo?.runUuid));\n  }, [slicedRuns, isGrouped]);\n\n  const metricKeys = useMemo(() => {\n    const getYAxisKeys = (config: RunsChartsLineCardConfig) => {\n      const fallback = [config.metricKey];\n      if (!shouldEnableChartExpressions() || config.yAxisKey !== RunsChartsLineChartYAxisType.EXPRESSION) {\n        return config.selectedMetricKeys ?? fallback;\n      }\n      const yAxisKeys = config.yAxisExpressions?.reduce((acc, exp) => {\n        exp.variables.forEach((variable) => acc.add(variable));\n        return acc;\n      }, new Set<string>());\n      return yAxisKeys === undefined ? fallback : Array.from(yAxisKeys);\n    };\n    const yAxisKeys = getYAxisKeys(config);\n    const xAxisKeys = !selectedXAxisMetricKey ? [] : [selectedXAxisMetricKey];\n\n    return yAxisKeys.concat(xAxisKeys);\n  }, [config, selectedXAxisMetricKey]);\n\n  const { setTooltip, resetTooltip, destroyTooltip, selectedRunUuid } = useRunsChartsTooltip(\n    config,\n    RunsChartsTooltipMode.MultipleTracesWithScanline,\n  );\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  const isInViewport = fullScreen || isInViewportProp;\n  const isInViewportDeferred = fullScreen || isInViewportDeferredProp;\n\n  const { aggregateFunction } = groupBy || {};\n\n  const sampledMetricsByRunUuid = useSelector(\n    (state: ReduxState) => pick(state.entities.sampledMetricsByRunUuid, runUuidsToFetch),\n    shallowEqual,\n  );\n\n  /**\n   * We set a local state for changes because full screen and non-full screen charts are\n   * different components - this prevents having to sync them.\n   */\n  const [yRangeLocal, setYRangeLocal] = useState<[number, number] | undefined>(() => {\n    if (config.range && !isUndefined(config.range.yMin) && !isUndefined(config.range.yMax)) {\n      return [config.range.yMin, config.range.yMax];\n    }\n    return undefined;\n  });\n\n  const { setOffsetTimestamp, stepRange, xRangeLocal, setXRangeLocal } = useCompareRunChartSelectedRange(\n    config,\n    xAxisKey,\n    config.metricKey,\n    sampledMetricsByRunUuid,\n    runUuidsToFetch,\n    xAxisKey === RunsChartsLineChartXAxisType.STEP ? config.xAxisScaleType : 'linear',\n  );\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys,\n    enabled: isInViewportDeferred,\n    maxResults: 320,\n    range: stepRange,\n    autoRefreshEnabled,\n  });\n\n  const chartLayoutUpdated = ({ layout }: Readonly<Figure>) => {\n    // We only want to update the local state if the chart is not in full screen mode.\n    // If not, this can cause synchronization issues between the full screen and non-full screen charts.\n    if (!fullScreen) {\n      let yAxisMin = yRangeLocal?.[0];\n      let yAxisMax = yRangeLocal?.[1];\n      let xAxisMin = xRangeLocal?.[0];\n      let xAxisMax = xRangeLocal?.[1];\n\n      const { autorange: yAxisAutorange, range: newYRange } = layout.yaxis || {};\n      const yRangeChanged = !isEqual(yAxisAutorange ? [undefined, undefined] : newYRange, [yAxisMin, yAxisMax]);\n\n      if (yRangeChanged) {\n        // When user zoomed in/out or changed the Y range manually, hide the tooltip\n        destroyTooltip();\n      }\n\n      if (yAxisAutorange) {\n        yAxisMin = undefined;\n        yAxisMax = undefined;\n      } else if (newYRange) {\n        yAxisMin = newYRange[0];\n        yAxisMax = newYRange[1];\n      }\n\n      const { autorange: xAxisAutorange, range: newXRange } = layout.xaxis || {};\n      if (xAxisAutorange) {\n        // Remove saved range if chart is back to default viewport\n        xAxisMin = undefined;\n        xAxisMax = undefined;\n      } else if (newXRange) {\n        const ungroupedRunUuids = compact(slicedRuns.map(({ runInfo }) => runInfo?.runUuid));\n        const groupedRunUuids = slicedRuns.flatMap(({ groupParentInfo }) => groupParentInfo?.runUuids ?? []);\n\n        if (!shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n          const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n            resultsByRunUuid,\n            [...ungroupedRunUuids, ...groupedRunUuids],\n            newXRange as [number, number],\n          );\n          setOffsetTimestamp([...(timestampRange as [number, number])]);\n        } else if (xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n          const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n            resultsByRunUuid,\n            [...ungroupedRunUuids, ...groupedRunUuids],\n            newXRange as [number, number],\n            1000 * 60 * 60, // Convert hours to milliseconds\n          );\n          setOffsetTimestamp([...(timestampRange as [number, number])]);\n        } else {\n          setOffsetTimestamp(undefined);\n        }\n        xAxisMin = newXRange[0];\n        xAxisMax = newXRange[1];\n      }\n\n      if (\n        !isEqual(\n          { xMin: xRangeLocal?.[0], xMax: xRangeLocal?.[1], yMin: yRangeLocal?.[0], yMax: yRangeLocal?.[1] },\n          { xMin: xAxisMin, xMax: xAxisMax, yMin: yAxisMin, yMax: yAxisMax },\n        )\n      ) {\n        setXRangeLocal(isUndefined(xAxisMin) || isUndefined(xAxisMax) ? undefined : [xAxisMin, xAxisMax]);\n        setYRangeLocal(isUndefined(yAxisMin) || isUndefined(yAxisMax) ? undefined : [yAxisMin, yAxisMax]);\n      }\n    }\n  };\n\n  useEffect(() => {\n    destroyTooltip();\n  }, [destroyTooltip, isLoading]);\n\n  const sampledData: RunsChartsRunData[] = useMemo(\n    () =>\n      slicedRuns.map((run) => {\n        const metricsHistory = metricKeys.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = config.ignoreOutliers ? removeOutliersFromMetricHistory(history) : history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeys, resultsByRunUuid, slicedRuns, config.ignoreOutliers],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey: xAxisKey === RunsChartsLineChartXAxisType.METRIC ? selectedXAxisMetricKey : undefined,\n    ignoreOutliers: config.ignoreOutliers ?? false,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  // If the component is not in the viewport, we don't want to render the chart\n  const renderChartBody = isInViewport;\n\n  // If the data is loading or chart has just entered the viewport, show a skeleton\n  const renderSkeleton = isLoading || !isInViewportDeferred;\n\n  const chartBody = (\n    <div\n      css={[\n        styles.lineChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n    >\n      {!renderChartBody ? null : renderSkeleton ? (\n        <RunsChartCardLoadingPlaceholder />\n      ) : (\n        <RunsMetricsLinePlot\n          runsData={chartData}\n          metricKey={config.metricKey}\n          selectedMetricKeys={config.selectedMetricKeys}\n          scaleType={config.scaleType}\n          xAxisKey={xAxisKey}\n          xAxisScaleType={config.xAxisScaleType}\n          yAxisKey={config.yAxisKey}\n          yAxisExpressions={config.yAxisExpressions}\n          selectedXAxisMetricKey={selectedXAxisMetricKey}\n          lineSmoothness={lineSmoothness}\n          useDefaultHoverBox={false}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onUpdate={chartLayoutUpdated}\n          xRange={xRangeLocal}\n          yRange={yRangeLocal}\n          fullScreen={fullScreen}\n          displayPoints={config.displayPoints}\n          onSetDownloadHandler={setImageDownloadHandler}\n          positionInSection={positionInSection ?? 0}\n        />\n      )}\n    </div>\n  );\n\n  const onClickDownload = useCallback(\n    (format) => {\n      const savedChartTitle = config.selectedMetricKeys?.join('-') ?? config.metricKey;\n      if (format === 'csv-full') {\n        const singleRunUuids = compact(chartData.map((d) => d.runInfo?.runUuid));\n        const runUuidsFromGroups = compact(\n          chartData\n            .filter(({ groupParentInfo }) => groupParentInfo)\n            .flatMap((group) => group.groupParentInfo?.runUuids),\n        );\n        const runUuids = [...singleRunUuids, ...runUuidsFromGroups];\n        onDownloadFullMetricHistoryCsv?.(runUuids, config.selectedMetricKeys || [config.metricKey]);\n        return;\n      }\n      if (format === 'csv') {\n        downloadChartMetricHistoryCsv(chartData, config.selectedMetricKeys || [config.metricKey], savedChartTitle);\n        return;\n      }\n      imageDownloadHandler?.(format, savedChartTitle);\n    },\n    [chartData, config, imageDownloadHandler, onDownloadFullMetricHistoryCsv],\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={getV2ChartTitle(config)}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      supportedDownloadFormats={SUPPORTED_DOWNLOAD_FORMATS}\n      onClickDownload={onClickDownload}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      isRefreshing={isRefreshing}\n      isHidden={!isInViewport}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  lineChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo, useState } from 'react';\nimport { findChartStepsByTimestampForRuns } from '../utils/findChartStepsByTimestamp';\nimport { SampledMetricsByRunUuidState } from '../../../types';\nimport { isNumber, isString, isUndefined } from 'lodash';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\nimport { RunsChartsLineCardConfig } from '../runs-charts.types';\n\n/**\n * Hook used in compare run charts. It's responsible for converting selected range\n * (which can be either step or timestamp) to step range, based on chart axis type.\n * @param config Line chart configuration\n * @param xAxisKey Can be 'step', 'time' or 'time-relative'\n * @param metricKey\n * @param sampledMetricsByRunUuid Recorded history for metrics for runs in compare chart\n * @param runUuids List of run UUIDs in compare chart\n * @param scaleType Scale type for the chart\n */\nexport const useCompareRunChartSelectedRange = (\n  config: RunsChartsLineCardConfig,\n  xAxisKey: RunsChartsLineChartXAxisType,\n  metricKey: string,\n  sampledMetricsByRunUuid: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  scaleType: 'linear' | 'log' = 'linear',\n) => {\n  const [xRangeLocal, setXRangeLocal] = useState<[number | string, number | string] | undefined>(() => {\n    if (config.range && !isUndefined(config.range.xMin) && !isUndefined(config.range.xMax)) {\n      return [config.range.xMin, config.range.xMax];\n    }\n    return undefined;\n  });\n  const [offsetTimestamp, setOffsetTimestamp] = useState<[number, number] | undefined>(undefined);\n  const stepRange = useMemo<[number, number] | undefined>(() => {\n    if (!xRangeLocal) {\n      return undefined;\n    }\n    if (xAxisKey === RunsChartsLineChartXAxisType.TIME && isString(xRangeLocal[0]) && isString(xRangeLocal[1])) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        xRangeLocal as [string, string],\n      );\n      return bounds;\n    }\n\n    if (\n      xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE &&\n      offsetTimestamp &&\n      isNumber(xRangeLocal[0]) &&\n      isNumber(xRangeLocal[1])\n    ) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        offsetTimestamp as [number, number],\n      );\n      return bounds;\n    }\n\n    if (xAxisKey === RunsChartsLineChartXAxisType.STEP && isNumber(xRangeLocal[0]) && isNumber(xRangeLocal[1])) {\n      // If we're dealing with step-based chart axis, use those steps but incremented/decremented\n      const lowerBound = Math.floor(scaleType === 'log' ? 10 ** xRangeLocal[0] : xRangeLocal[0]);\n      const upperBound = Math.ceil(scaleType === 'log' ? 10 ** xRangeLocal[1] : xRangeLocal[1]);\n      return lowerBound && upperBound ? [lowerBound - 1, upperBound + 1] : undefined;\n    }\n\n    // return undefined for xAxisKey === 'metric' because there isn't\n    // necessarily a mapping between value range and step range\n    return undefined;\n  }, [xAxisKey, metricKey, xRangeLocal, sampledMetricsByRunUuid, runUuids, offsetTimestamp, scaleType]);\n\n  return {\n    /**\n     * If there's an offset timestamp calculated from relative runs, set it using this function\n     */\n    setOffsetTimestamp,\n    /**\n     * Resulting step range\n     */\n    stepRange,\n    /**\n     * Local range selected by user\n     */\n    xRangeLocal,\n    /**\n     * Set selected range\n     */\n    setXRangeLocal,\n  };\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardVisibilityProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { intersection, uniq } from 'lodash';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\nimport { Tag, Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nexport interface RunsChartsScatterChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardVisibilityProps,\n    RunsChartCardFullScreenProps {\n  config: RunsChartsScatterCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsScatterChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  isInViewport: isInViewportProp,\n  ...reorderProps\n}: RunsChartsScatterChartCardProps) => {\n  const { theme } = useDesignSystemTheme();\n  const title = (() => {\n    if (config.xaxis.datasetName || config.yaxis.datasetName) {\n      return (\n        <div css={{ flex: 1, display: 'flex', alignItems: 'center', overflow: 'hidden', gap: theme.spacing.xs }}>\n          <Typography.Text title={config.xaxis.key} ellipsis bold>\n            {config.xaxis.datasetName && (\n              <>\n                <Tag componentId=\"mlflow.charts.scatter_card_title.dataset_tag\" css={{ marginRight: 0 }}>\n                  {config.xaxis.datasetName}\n                </Tag>{' '}\n              </>\n            )}\n            {config.xaxis.key}\n          </Typography.Text>\n          <Typography.Text>vs</Typography.Text>\n          <Typography.Text title={config.xaxis.key} ellipsis bold>\n            {config.yaxis.datasetName && (\n              <>\n                <Tag componentId=\"mlflow.charts.scatter_card_title.dataset_tag\" css={{ marginRight: 0 }}>\n                  {config.yaxis.datasetName}\n                </Tag>{' '}\n              </>\n            )}\n            {config.yaxis.key}\n          </Typography.Text>\n        </div>\n      );\n    }\n    return `${config.xaxis.key} vs. ${config.yaxis.key}`;\n  })();\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: null,\n    });\n  };\n\n  const slicedRuns = useMemo(() => chartRunData.filter(({ hidden }) => !hidden), [chartRunData]);\n\n  const isEmptyDataset = useMemo(() => {\n    const metricKeys = [config.xaxis.dataAccessKey ?? config.xaxis.key, config.yaxis.dataAccessKey ?? config.yaxis.key];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  const isInViewport = fullScreen || isInViewportProp;\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.scatterChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n    >\n      {isInViewport ? (\n        <RunsScatterPlot\n          runsData={slicedRuns}\n          xAxis={config.xaxis}\n          yAxis={config.yaxis}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          useDefaultHoverBox={false}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  scatterChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { intersection, uniq } from 'lodash';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsContourChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsContourCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsContourChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsContourChartCardProps) => {\n  const title = `${config.xaxis.key} vs. ${config.yaxis.key} vs. ${config.zaxis.key}`;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: null,\n    });\n  };\n\n  const slicedRuns = useMemo(() => chartRunData.filter(({ hidden }) => !hidden), [chartRunData]);\n\n  const isEmptyDataset = useMemo(() => {\n    const metricKeys = [config.xaxis.key, config.yaxis.key, config.zaxis.key];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.contourChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n    >\n      <RunsContourPlot\n        runsData={slicedRuns}\n        xAxis={config.xaxis}\n        yAxis={config.yaxis}\n        zAxis={config.zaxis}\n        useDefaultHoverBox={false}\n        onHover={setTooltip}\n        onUnhover={resetTooltip}\n        selectedRunUuid={selectedRunUuid}\n        onSetDownloadHandler={setImageDownloadHandler}\n      />\n    </div>\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key, config.zaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const, 'zaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  contourChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","var _path, _path2, _g, _defs;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgParallelChartPlaceholder({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 80,\n    height: 42,\n    viewBox: \"0 0 80 42\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 2.34094L39.4998 17.0908L76.3746 7.87216\",\n    stroke: \"#CF797B\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.95459 20.443L40.1702 25.1361L77.045 21.1134M1.95459 36.5338L40.1702 35.1929L77.045 25.1361\",\n    stroke: \"#A88E6F\",\n    strokeLinecap: \"round\"\n  })), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    opacity: 0.8\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 1V40.3341\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M40.6189 2.07251V39.9763\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M77.7156 2.07251V39.9763\",\n    stroke: \"url(#paint0_linear_2781_406689)\",\n    strokeWidth: 4,\n    strokeLinecap: \"square\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    id: \"paint0_linear_2781_406689\",\n    x1: 78.2156,\n    y1: 2.07251,\n    x2: 78.2156,\n    y2: 39.9763,\n    gradientUnits: \"userSpaceOnUse\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#D04F5E\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 1,\n    stopColor: \"#4D9734\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgParallelChartPlaceholder);\nexport default __webpack_public_path__ + \"static/media/parallel-chart-placeholder.234ef0c5b220ef2a5a6fa5bafff173f7.svg\";\nexport { ForwardRef as ReactComponent };","import { Button, DropdownMenu, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useCallback, useMemo } from 'react';\nimport { ReactComponent as ParallelChartSvg } from '../../../../../common/static/parallel-chart-placeholder.svg';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot from '../charts/LazyParallelCoordinatesPlot';\nimport { isParallelChartConfigured, processParallelCoordinateData } from '../../utils/parallelCoordinatesPlot.utils';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  RunsChartCardVisibilityProps,\n  RunsChartCardLoadingPlaceholder,\n} from './ChartCard.common';\nimport { FormattedMessage } from 'react-intl';\nimport { useUpdateExperimentViewUIState } from '../../../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsParallelChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardFullScreenProps,\n    RunsChartCardVisibilityProps {\n  config: RunsChartsParallelCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst NotConfiguredParallelCoordsPlaceholder = ({ onEdit }: { onEdit: () => void }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <ParallelChartSvg />\n        <Typography.Title css={{ marginTop: theme.spacing.md }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Compare parameter importance\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > chart not configured warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use the parallel coordinates chart to compare how various parameters in model affect your model metrics.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > chart not configured warning > description\"\n          />\n        </Typography.Text>\n        <Button componentId=\"mlflow.charts.parallel_coords_chart_configure_button\" type=\"primary\" onClick={onEdit}>\n          <FormattedMessage\n            defaultMessage=\"Configure chart\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > configure chart button\"\n          />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst UnsupportedDataPlaceholder = () => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <ParallelChartSvg />\n        <Typography.Title css={{ marginTop: theme.spacing.md, textAlign: 'center' }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Parallel coordinates chart does not support aggregated string values.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use other parameters or disable run grouping to continue.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > description\"\n          />\n        </Typography.Text>\n      </div>\n    </div>\n  );\n};\n\nexport const RunsChartsParallelChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  isInViewport: isInViewportProp,\n  ...reorderProps\n}: RunsChartsParallelChartCardProps) => {\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: 'Parallel Coordinates',\n      subtitle: displaySubtitle ? subtitle : null,\n    });\n  };\n\n  const configuredChartRunData = useMemo(() => {\n    if (config?.showAllRuns) {\n      return chartRunData;\n    }\n    return chartRunData?.filter(({ hidden }) => !hidden);\n  }, [chartRunData, config?.showAllRuns]);\n\n  const containsStringValues = useMemo(\n    () =>\n      config.selectedParams?.some(\n        (paramKey) => configuredChartRunData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [config.selectedParams, configuredChartRunData],\n      ),\n    [config.selectedParams, configuredChartRunData],\n  );\n\n  const updateVisibleOnlySetting = useCallback(\n    (showAllRuns: boolean) => {\n      updateUIState((state) => {\n        const newCompareRunCharts = state.compareRunCharts?.map((existingChartConfig) => {\n          if (existingChartConfig.uuid === config.uuid) {\n            const parallelChartConfig = existingChartConfig as RunsChartsParallelCardConfig;\n            return { ...parallelChartConfig, showAllRuns };\n          }\n          return existingChartConfig;\n        });\n\n        return { ...state, compareRunCharts: newCompareRunCharts };\n      });\n    },\n    [config.uuid, updateUIState],\n  );\n\n  const [isConfigured, parallelCoordsData] = useMemo(() => {\n    const configured = isParallelChartConfigured(config);\n\n    // Prepare the data in the parcoord-es format\n    const data = configured\n      ? processParallelCoordinateData(configuredChartRunData, config.selectedParams, config.selectedMetrics)\n      : [];\n\n    return [configured, data];\n  }, [config, configuredChartRunData]);\n\n  const isEmptyDataset = useMemo(() => {\n    return parallelCoordsData.length === 0;\n  }, [parallelCoordsData]);\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  const isInViewport = fullScreen || isInViewportProp;\n\n  const { setTooltip, resetTooltip, selectedRunUuid, closeContextMenu } = useRunsChartsTooltip(config);\n\n  const containsUnsupportedValues = containsStringValues && groupBy;\n  const displaySubtitle = isConfigured && !containsUnsupportedValues;\n\n  const subtitle = (\n    <>\n      {config.showAllRuns ? (\n        <FormattedMessage\n          defaultMessage=\"Showing all runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for all runs shown\"\n        />\n      ) : (\n        <FormattedMessage\n          defaultMessage=\"Showing only visible runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for only visible runs shown\"\n        />\n      )}\n    </>\n  );\n\n  const chartBody = (\n    <>\n      {!isConfigured ? (\n        <NotConfiguredParallelCoordsPlaceholder onEdit={onEdit} />\n      ) : containsUnsupportedValues ? (\n        <UnsupportedDataPlaceholder />\n      ) : parallelCoordsData.length === 0 ? (\n        <RunsChartsNoDataFoundIndicator />\n      ) : (\n        // Avoid displaying empty set, otherwise parcoord-es goes crazy\n        <div\n          css={[\n            styles.parallelChartCardWrapper,\n            {\n              height: fullScreen ? '100%' : undefined,\n            },\n          ]}\n        >\n          {isInViewport ? (\n            <LazyParallelCoordinatesPlot\n              data={parallelCoordsData}\n              selectedParams={config.selectedParams}\n              selectedMetrics={config.selectedMetrics}\n              onHover={setTooltip}\n              onUnhover={resetTooltip}\n              axesRotateThreshold={8}\n              selectedRunUuid={selectedRunUuid}\n              closeContextMenu={closeContextMenu}\n              fallback={<RunsChartCardLoadingPlaceholder css={{ flex: 1 }} />}\n            />\n          ) : null}\n        </div>\n      )}\n    </>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  const fullScreenEnabled = isConfigured && !containsUnsupportedValues && !isEmptyDataset;\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title=\"Parallel Coordinates\"\n      subtitle={displaySubtitle ? subtitle : null}\n      uuid={config.uuid}\n      tooltip={\n        <FormattedMessage\n          defaultMessage=\"The parallel coordinates chart shows runs with columns that are either numbers or strings. If a column has string entries, the runs corresponding to the 30 most recent unique values will be shown. Only runs with all relevant metrics and/or parameters will be displayed.\"\n          description=\"Experiment page > charts > parallel coordinates chart > tooltip explaining what data is expected to be rendered\"\n        />\n      }\n      dragGroupKey={RunsChartsChartsDragGroup.PARALLEL_CHARTS_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={fullScreenEnabled ? toggleFullScreenChart : undefined}\n      additionalMenuContent={\n        <>\n          <DropdownMenu.Separator />\n          <DropdownMenu.CheckboxItem\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_runschartsparallelchartcard.tsx_293\"\n            checked={!config.showAllRuns}\n            onClick={() => updateVisibleOnlySetting(false)}\n          >\n            <DropdownMenu.ItemIndicator />\n            <FormattedMessage\n              defaultMessage=\"Show only visible\"\n              description=\"Experiment page > compare runs tab > chart header > move down option\"\n            />\n          </DropdownMenu.CheckboxItem>\n          <DropdownMenu.CheckboxItem\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_runschartsparallelchartcard.tsx_300\"\n            checked={config.showAllRuns}\n            onClick={() => updateVisibleOnlySetting(true)}\n          >\n            <DropdownMenu.ItemIndicator />\n            <FormattedMessage\n              defaultMessage=\"Show all runs\"\n              description=\"Experiment page > compare runs tab > chart header > move down option\"\n            />\n          </DropdownMenu.CheckboxItem>\n        </>\n      }\n      supportedDownloadFormats={['csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [...config.selectedMetrics, ...config.selectedParams].join('-');\n\n        if (format === 'csv') {\n          downloadChartDataCsv(configuredChartRunData, config.selectedMetrics, config.selectedParams, savedChartTitle);\n        }\n      }}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  parallelChartCardWrapper: {\n    // Set \"display: flex\" here (and \"flex: 1\" in the child element)\n    // so the chart will grow in width and height\n    display: 'flex',\n    overflow: 'hidden',\n    cursor: 'pointer',\n  },\n};\n","import { Button, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useCallback, useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  type RunsChartsCardConfig,\n  type RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n} from './ChartCard.common';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\n\nexport interface RunsChartsDifferenceChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsDifferenceCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\n/**\n * A placeholder component displayed before runs difference chart is being configured by user\n */\nconst NotConfiguredDifferenceChartPlaceholder = ({ onEdit }: { onEdit: () => void }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <Typography.Title css={{ marginTop: theme.spacing.md }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Compare runs\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > chart not configured warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use the runs difference view to compare model and system metrics, parameters, attributes,\n            and tags across runs.\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > chart not configured warning > description\"\n          />\n        </Typography.Text>\n        <Button componentId=\"mlflow.charts.difference_chart_configure_button\" type=\"primary\" onClick={onEdit}>\n          <FormattedMessage\n            defaultMessage=\"Configure chart\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > configure chart button\"\n          />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport const RunsChartsDifferenceChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsDifferenceChartCardProps) => {\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: config.chartName,\n      subtitle: null,\n    });\n  };\n\n  const [isConfigured, slicedRuns] = useMemo(() => {\n    const configured = Boolean(config.compareGroups?.length);\n    return [configured, chartRunData.filter(({ hidden }) => !hidden).reverse()];\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    return !isConfigured;\n  }, [isConfigured]);\n\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n\n  const setCardConfig = (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => {\n    confirmChartCardConfiguration(setter(config));\n  };\n\n  const showChangeFromBaselineToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showChangeFromBaseline: !config.showChangeFromBaseline,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const showDifferencesOnlyToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showDifferencesOnly: !config.showDifferencesOnly,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const { formatMessage } = useIntl();\n\n  const chartBody = (\n    <>\n      {!isConfigured ? (\n        <NotConfiguredDifferenceChartPlaceholder onEdit={onEdit} />\n      ) : (\n        <DifferenceViewPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={config}\n          setCardConfig={setCardConfig}\n        />\n      )}\n    </>\n  );\n  let showTooltip = undefined;\n  if (groupBy && DISABLED_GROUP_WHEN_GROUPBY.some((group) => config.compareGroups.includes(group))) {\n    showTooltip = formatMessage({\n      defaultMessage: 'Disable grouped runs to compare parameters, tag, or attributes',\n      description:\n        'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > disable group runs tooltip message',\n    });\n  }\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={config.chartName}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      toggleFullScreenChart={toggleFullScreenChart}\n      toggles={[\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show change from baseline',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show change from baseline toggle label',\n          }),\n          currentToggle: config.showChangeFromBaseline,\n          setToggle: showChangeFromBaselineToggle,\n        },\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show differences only',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show differences only toggle label',\n          }),\n          currentToggle: config.showDifferencesOnly,\n          setToggle: showDifferencesOnlyToggle,\n        },\n      ]}\n      tooltip={showTooltip}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n} from './ChartCard.common';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport {\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\nimport { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsImageChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsImageCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\nexport const RunsChartsImageChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  ...reorderProps\n}: RunsChartsImageChartCardProps) => {\n  const { theme } = useDesignSystemTheme();\n  const containerRef = useRef(null);\n  const [containerWidth, setContainerWidth] = useState(0);\n\n  // Optimizations for smoother slider experience. Maintain a local copy of config, and update\n  // the global state only after the user has finished dragging the slider.\n  const [tmpConfig, setTmpConfig] = useState(config);\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n  const updateStep = useCallback(\n    (newStep: number) => {\n      // Skip updating base chart config if step is the same as current step.\n      if (config.step === newStep) {\n        return;\n      }\n      confirmChartCardConfiguration({ ...config, step: newStep } as RunsChartsImageCardConfig);\n    },\n    [config, confirmChartCardConfiguration],\n  );\n  const tmpStepChange = useCallback((newStep: number) => {\n    setTmpConfig((currentConfig) => {\n      // Skip updating temporary config if step is the same as current step.\n      if (currentConfig.step === newStep) {\n        return currentConfig;\n      }\n      return { ...currentConfig, step: newStep };\n    });\n  }, []);\n\n  const chartName = config.imageKeys.length === 1 ? config.imageKeys[0] : DEFAULT_IMAGE_GRID_CHART_NAME;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: chartName,\n      subtitle: null,\n    });\n  };\n\n  const slicedRuns = useMemo(() => chartRunData.filter(({ hidden }) => !hidden).reverse(), [chartRunData]);\n\n  const setCardConfig = useCallback(\n    (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => {\n      confirmChartCardConfiguration(setter(config));\n    },\n    [config, confirmChartCardConfiguration],\n  );\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: slicedRuns,\n    selectedImageKeys: config.imageKeys || [],\n  });\n\n  const stepMarkLength = Object.keys(stepMarks).length;\n\n  useEffect(() => {\n    // If there is only one step mark, set the step to the min mark\n    if (stepMarkLength === 1 && tmpConfig.step !== minMark) {\n      updateStep(minMark);\n      tmpStepChange(minMark);\n    }\n  }, [minMark, stepMarkLength, tmpConfig.step, updateStep, tmpStepChange]);\n\n  const shouldDisplayImageLimitIndicator =\n    slicedRuns.filter((run) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    }).length > NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE;\n\n  const chartBody = (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        height: fullScreen ? '100%' : undefined,\n        width: '100%',\n        overflow: 'hidden',\n        marginTop: theme.spacing.sm,\n        gap: theme.spacing.md,\n      }}\n    >\n      <div\n        ref={containerRef}\n        css={{\n          flex: 1,\n          overflow: 'auto',\n        }}\n      >\n        <ImageGridPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={tmpConfig}\n          setCardConfig={setCardConfig}\n        />\n      </div>\n      <div\n        css={{\n          justifyContent: 'center',\n          alignItems: 'center',\n          display: 'inline-flex',\n          gap: theme.spacing.md,\n        }}\n      >\n        <div css={{ flex: 1 }}>\n          <LineSmoothSlider\n            value={tmpConfig.step}\n            onChange={tmpStepChange}\n            max={maxMark}\n            min={minMark}\n            marks={stepMarks}\n            disabled={Object.keys(stepMarks).length <= 1}\n            onAfterChange={updateStep}\n            css={{\n              '&[data-orientation=\"horizontal\"]': { width: 'auto' },\n            }}\n          />\n        </div>\n      </div>\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  const cardBodyToRender = chartBody;\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={chartName}\n      subtitle={\n        shouldDisplayImageLimitIndicator && `Displaying images from first ${NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE} runs`\n      }\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      toggleFullScreenChart={toggleFullScreenChart}\n      {...reorderProps}\n    >\n      {cardBodyToRender}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useMemo, memo } from 'react';\nimport { RunsChartType } from '../../runs-charts.types';\nimport type {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsScatterCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsChartsBarChartCard } from './RunsChartsBarChartCard';\nimport { RunsChartsLineChartCard } from './RunsChartsLineChartCard';\nimport { RunsChartsScatterChartCard } from './RunsChartsScatterChartCard';\nimport { RunsChartsContourChartCard } from './RunsChartsContourChartCard';\nimport { RunsChartsParallelChartCard } from './RunsChartsParallelChartCard';\nimport type {\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardSizeProps,\n  RunsChartCardVisibilityProps,\n} from './ChartCard.common';\nimport { RunsChartsDifferenceChartCard } from './RunsChartsDifferenceChartCard';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsImageChartCard } from './RunsChartsImageChartCard';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\n\nexport interface RunsChartsCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardFullScreenProps,\n    RunsChartCardVisibilityProps,\n    RunsChartCardSizeProps {\n  cardConfig: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n  index: number;\n  sectionIndex?: number;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  groupBy: RunsGroupByConfig | null;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nconst RunsChartsCardRaw = ({\n  cardConfig,\n  chartRunData,\n  index,\n  sectionIndex,\n  onStartEditChart,\n  onRemoveChart,\n  setFullScreenChart,\n  groupBy,\n  fullScreen,\n  canMoveDown,\n  canMoveUp,\n  previousChartUuid,\n  nextChartUuid,\n  onReorderWith,\n  autoRefreshEnabled,\n  onDownloadFullMetricHistoryCsv,\n  hideEmptyCharts,\n  globalLineChartConfig,\n  height,\n  isInViewport,\n  isInViewportDeferred,\n}: RunsChartsCardProps) => {\n  const reorderProps = useMemo(\n    () => ({\n      onReorderWith,\n      canMoveDown,\n      canMoveUp,\n      previousChartUuid,\n      nextChartUuid,\n    }),\n    [onReorderWith, canMoveDown, canMoveUp, previousChartUuid, nextChartUuid],\n  );\n\n  const editProps = useMemo(\n    () => ({\n      onEdit: () => onStartEditChart(cardConfig),\n      onDelete: () => onRemoveChart(cardConfig),\n      setFullScreenChart,\n    }),\n    [onStartEditChart, onRemoveChart, setFullScreenChart, cardConfig],\n  );\n\n  const commonChartProps = useMemo(\n    () => ({\n      fullScreen,\n      autoRefreshEnabled,\n      groupBy,\n      hideEmptyCharts,\n      height,\n      isInViewport,\n      isInViewportDeferred,\n      ...editProps,\n      ...reorderProps,\n    }),\n    [\n      fullScreen,\n      autoRefreshEnabled,\n      groupBy,\n      editProps,\n      reorderProps,\n      hideEmptyCharts,\n      height,\n      isInViewport,\n      isInViewportDeferred,\n    ],\n  );\n\n  const slicedRuns = useMemo(() => chartRunData.filter(({ hidden }) => !hidden).reverse(), [chartRunData]);\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return (\n      <RunsChartsParallelChartCard\n        config={cardConfig as RunsChartsParallelCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (cardConfig.type === RunsChartType.DIFFERENCE) {\n    return (\n      <RunsChartsDifferenceChartCard\n        config={cardConfig as RunsChartsDifferenceCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (cardConfig.type === RunsChartType.IMAGE) {\n    return (\n      <RunsChartsImageChartCard\n        config={cardConfig as RunsChartsImageCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (cardConfig.type === RunsChartType.BAR) {\n    return (\n      <RunsChartsBarChartCard\n        config={cardConfig as RunsChartsBarCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.LINE) {\n    return (\n      <RunsChartsLineChartCard\n        config={cardConfig as RunsChartsLineCardConfig}\n        chartRunData={slicedRuns}\n        onDownloadFullMetricHistoryCsv={onDownloadFullMetricHistoryCsv}\n        globalLineChartConfig={globalLineChartConfig}\n        positionInSection={index}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.SCATTER) {\n    return (\n      <RunsChartsScatterChartCard\n        config={cardConfig as RunsChartsScatterCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.CONTOUR) {\n    return (\n      <RunsChartsContourChartCard\n        config={cardConfig as RunsChartsContourCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  }\n  return null;\n};\n\nexport const RunsChartsCard = memo(RunsChartsCardRaw);\n","var _path, _path2, _path3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartContour({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.9749 4.94148C12.9188 4.71702 12.221 4.73284 12.0618 4.71515C11.1779 4.61693 10.2817 4.66052 9.39271 4.66052C8.11919 4.66052 7.15648 4.97961 6.24753 5.90922C5.86197 6.30355 5.5235 6.77684 5.23295 7.24378C4.99434 7.62726 4.65544 7.93479 4.40569 8.31299C3.93777 9.02154 3.56281 9.80723 3.56281 10.6699C3.56281 11.1806 3.37479 11.598 3.76962 12.0669C4.19449 12.5714 4.6863 12.9507 5.27978 13.2649C5.88594 13.5858 6.42202 13.8619 7.13723 13.8619C7.74338 13.8619 8.34952 13.8619 8.95567 13.8619C9.45735 13.8619 9.96042 13.8731 10.4619 13.8619C11.1412 13.8468 11.9484 13.1895 12.413 12.7381C13.581 11.6035 14.2393 9.88016 14.2393 8.24665C14.2393 7.69923 14.3797 7.17063 14.3797 6.62723C14.3797 6.40084 14.4779 5.87696 14.2744 5.71411C13.9268 5.43606 13.5785 5.13789 13.1857 4.94148\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.9213 6.83789C11.2761 6.83789 10.6309 6.83789 9.98577 6.83789C9.19776 6.83789 8.80182 7.44144 8.2844 7.97734C7.58163 8.70521 7.28544 9.67306 7.28544 10.666C7.28544 10.9641 7.22004 11.177 7.46104 11.3645C7.6831 11.5372 8.10719 11.6142 8.37806 11.6142C9.07316 11.6142 9.91042 11.5583 10.4462 11.0523C10.9277 10.5975 11.473 10.3701 11.8159 9.75284C12.045 9.34042 12.2022 8.86324 12.2022 8.38317C12.2022 8.14903 12.2022 7.9149 12.2022 7.68077C12.2022 7.4241 12.0208 7.38817 11.9213 7.18909\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartContour);\nexport default __webpack_public_path__ + \"static/media/chart-contour.0d4b306f2669f3ad25375568935e3ce3.svg\";\nexport { ForwardRef as ReactComponent };","import { isUndefined, pick } from 'lodash';\nimport type { RunsChartsLineCardConfig } from '../../runs-charts.types';\nimport type { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport { useMemo } from 'react';\nimport { RunsChartsLineChartXAxisType } from '../RunsCharts.common';\n\n/**\n * A utility hook that selects if certain line chart settings should be\n * taken from global configuration or from local chard card settings.\n */\nexport const useLineChartGlobalConfig = (\n  originalCardConfig: RunsChartsLineCardConfig,\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig,\n) =>\n  useMemo(() => {\n    const result = pick(originalCardConfig, ['xAxisKey', 'selectedXAxisMetricKey', 'lineSmoothness']);\n\n    if (!globalLineChartConfig) {\n      return result;\n    }\n\n    const globalXAxisKey = globalLineChartConfig.xAxisKey;\n\n    if (originalCardConfig.useGlobalLineSmoothing && !isUndefined(globalLineChartConfig.lineSmoothness)) {\n      result.lineSmoothness = globalLineChartConfig.lineSmoothness;\n    }\n\n    if (!isUndefined(globalXAxisKey) && originalCardConfig.useGlobalXaxisKey) {\n      result.xAxisKey = globalXAxisKey;\n      const globalSelectedXAxisMetricKey = globalLineChartConfig?.selectedXAxisMetricKey;\n      if (globalXAxisKey === RunsChartsLineChartXAxisType.METRIC && globalSelectedXAxisMetricKey) {\n        result.selectedXAxisMetricKey = globalSelectedXAxisMetricKey;\n      }\n    }\n\n    return result;\n  }, [originalCardConfig, globalLineChartConfig]);\n","import { chunk, isEqual } from 'lodash';\nimport { AnyAction } from 'redux';\nimport { searchModelVersionsApi } from '../../../../model-registry/actions';\nimport { MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER } from '../../../../model-registry/constants';\nimport {\n  ATTRIBUTE_COLUMN_SORT_KEY,\n  DEFAULT_LIFECYCLE_FILTER,\n  DEFAULT_MODEL_VERSION_FILTER,\n  DEFAULT_START_TIME,\n} from '../../../constants';\nimport { ViewType } from '../../../sdk/MlflowEnums';\nimport { LIFECYCLE_FILTER } from '../../../types';\nimport { KeyValueEntity } from '../../../../common/types';\nimport { EXPERIMENT_LOG_MODEL_HISTORY_TAG } from './experimentPage.common-utils';\nimport { ThunkDispatch } from '../../../../redux-types';\nimport type { ExperimentPageSearchFacetsState } from '../models/ExperimentPageSearchFacetsState';\nimport { RUNS_SEARCH_MAX_RESULTS } from '../../../actions';\nimport { getUUID } from '../../../../common/utils/ActionUtils';\nimport { shouldUseRegexpBasedAutoRunsSearchFilter } from '../../../../common/utils/FeatureUtils';\n\nconst START_TIME_COLUMN_OFFSET = {\n  ALL: null,\n  LAST_HOUR: 1 * 60 * 60 * 1000,\n  LAST_24_HOURS: 24 * 60 * 60 * 1000,\n  LAST_7_DAYS: 7 * 24 * 60 * 60 * 1000,\n  LAST_30_DAYS: 30 * 24 * 60 * 60 * 1000,\n  LAST_YEAR: 12 * 30 * 24 * 60 * 60 * 1000,\n};\n\nconst VALID_TABLE_ALIASES = [\n  'attribute',\n  'attributes',\n  'attr',\n  'run',\n  'metric',\n  'metrics',\n  'param',\n  'params',\n  'parameter',\n  'tag',\n  'tags',\n  'dataset',\n  'datasets',\n  'model',\n  'models',\n];\nconst SQL_SYNTAX_PATTERN = new RegExp(\n  `(${VALID_TABLE_ALIASES.join('|')})\\\\.\\\\S+\\\\s*(>|<|>=|<=|=|!=| like| ilike| rlike| in)`,\n  'i',\n);\n\nexport const RUNS_AUTO_REFRESH_INTERVAL = 30000;\n\n/**\n * Creates \"order by\" SQL expression\n */\nconst createOrderByExpression = ({ orderByKey, orderByAsc }: ExperimentPageSearchFacetsState) => {\n  if (orderByKey) {\n    return orderByAsc ? [orderByKey + ' ASC'] : [orderByKey + ' DESC'];\n  }\n  return [];\n};\n\n/**\n * Creates SQL expression for filtering by run start time\n */\nconst createStartTimeExpression = ({ startTime }: ExperimentPageSearchFacetsState, referenceTime: number) => {\n  const offset = START_TIME_COLUMN_OFFSET[startTime as keyof typeof START_TIME_COLUMN_OFFSET];\n  if (!startTime || !offset || startTime === 'ALL') {\n    return null;\n  }\n  const startTimeOffset = referenceTime - offset;\n\n  return `attributes.start_time >= ${startTimeOffset}`;\n};\n\n/**\n * Creates SQL expression for filtering by selected datasets\n */\nconst createDatasetsFilterExpression = ({ datasetsFilter }: ExperimentPageSearchFacetsState) => {\n  if (datasetsFilter.length === 0) {\n    return null;\n  }\n  const datasetNames = datasetsFilter.map((dataset) => `'${dataset.name}'`).join(',');\n  const datasetDigests = datasetsFilter.map((dataset) => `'${dataset.digest}'`).join(',');\n\n  return `dataset.name IN (${datasetNames}) AND dataset.digest IN (${datasetDigests})`;\n};\n\nexport const detectSqlSyntaxInSearchQuery = (searchFilter: string) => {\n  return SQL_SYNTAX_PATTERN.test(searchFilter);\n};\n\nexport const createQuickRegexpSearchFilter = (searchFilter: string) =>\n  `attributes.run_name RLIKE '${searchFilter.replace(/'/g, \"\\\\'\")}'`;\n\n/**\n * Combines search filter and start time SQL expressions\n */\nconst createFilterExpression = (\n  { searchFilter }: ExperimentPageSearchFacetsState,\n  startTimeExpression: string | null,\n  datasetsFilterExpression: string | null,\n) => {\n  if (\n    shouldUseRegexpBasedAutoRunsSearchFilter() &&\n    searchFilter.length > 0 &&\n    !detectSqlSyntaxInSearchQuery(searchFilter)\n  ) {\n    return createQuickRegexpSearchFilter(searchFilter);\n  }\n\n  const activeFilters = [];\n  if (searchFilter) activeFilters.push(searchFilter);\n  if (startTimeExpression) activeFilters.push(startTimeExpression);\n  if (datasetsFilterExpression) activeFilters.push(datasetsFilterExpression);\n\n  if (activeFilters.length === 0) return undefined;\n  return activeFilters.join(' and ');\n};\n\n/**\n * If this function returns true, the ExperimentView should nest children underneath their parents\n * and fetch all root level parents of visible runs. If this function returns false, the views will\n * not nest children or fetch any additional parents. Will always return true if the orderByKey is\n * 'attributes.start_time'\n */\nconst shouldNestChildrenAndFetchParents = ({ orderByKey, searchFilter }: ExperimentPageSearchFacetsState) =>\n  (!orderByKey && !searchFilter) || orderByKey === ATTRIBUTE_COLUMN_SORT_KEY.DATE;\n\n/**\n *\n * Function creates API-compatible query object basing on the given criteria.\n * @param experimentIds IDs of experiments to be queries for runs\n * @param searchFacetsState the sort/filter model to use\n * @param referenceTime reference time to calculate startTime filter\n * @param pageToken next page token if fetching the next page\n */\nexport const createSearchRunsParams = (\n  experimentIds: string[],\n  searchFacetsState: ExperimentPageSearchFacetsState & { runsPinned: string[] },\n  referenceTime: number,\n  pageToken?: string,\n  maxResults?: number,\n) => {\n  const runViewType =\n    searchFacetsState.lifecycleFilter === LIFECYCLE_FILTER.ACTIVE ? ViewType.ACTIVE_ONLY : ViewType.DELETED_ONLY;\n\n  const { runsPinned = undefined } = searchFacetsState;\n\n  const orderBy = createOrderByExpression(searchFacetsState);\n  const startTimeExpression = createStartTimeExpression(searchFacetsState, referenceTime);\n  const datasetsFilterExpression = createDatasetsFilterExpression(searchFacetsState);\n  const filter = createFilterExpression(searchFacetsState, startTimeExpression, datasetsFilterExpression);\n  const shouldFetchParents = shouldNestChildrenAndFetchParents(searchFacetsState);\n\n  return {\n    // Experiment IDs\n    experimentIds,\n\n    // Filters and sort options\n    filter,\n    runViewType,\n    orderBy,\n    shouldFetchParents,\n\n    // Next page token for loading more runs\n    pageToken,\n    runsPinned,\n\n    maxResults: maxResults || RUNS_SEARCH_MAX_RESULTS,\n  };\n};\n/**\n * Function checks if given runs set contain info about log model history and if true,\n * fetches model versions for them\n *\n * @param runsPayload runs payload returned from the searchRuns API\n * @param actionCreator redux-thunk action creator that for search model versions action\n * @param dispatch redux-compatible dispatch function\n */\nexport const fetchModelVersionsForRuns = (\n  runsPayload: {\n    info: {\n      run_id: string;\n    };\n    data: {\n      tags: KeyValueEntity[];\n    };\n  }[],\n  actionCreator: typeof searchModelVersionsApi,\n  dispatch: ThunkDispatch,\n) => {\n  const runsWithLogModelHistory = runsPayload.filter((run) =>\n    run.data.tags.some((t) => t.key === EXPERIMENT_LOG_MODEL_HISTORY_TAG),\n  );\n\n  const promises = chunk(runsWithLogModelHistory, MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER).map((runsChunk) => {\n    // eslint-disable-next-line prefer-const\n    let maxResults = undefined;\n    const action = actionCreator(\n      {\n        run_id: runsChunk.map((run) => run.info.run_id),\n      },\n      getUUID(),\n      maxResults,\n    );\n    return dispatch(action);\n  });\n\n  return Promise.all(promises);\n};\n\n/**\n * Function consumes a search state facets object and returns `true`\n * if at least one filter-related facet is not-default meaning that runs\n * are currently filtered.\n */\nexport const isSearchFacetsFilterUsed = (currentSearchFacetsState: ExperimentPageSearchFacetsState) => {\n  const { lifecycleFilter, modelVersionFilter, datasetsFilter, searchFilter, startTime } = currentSearchFacetsState;\n  return Boolean(\n    lifecycleFilter !== DEFAULT_LIFECYCLE_FILTER ||\n      modelVersionFilter !== DEFAULT_MODEL_VERSION_FILTER ||\n      datasetsFilter.length !== 0 ||\n      searchFilter ||\n      startTime !== DEFAULT_START_TIME,\n  );\n};\n","import {\n  Button,\n  DragIcon,\n  DropdownMenu,\n  OverflowIcon,\n  Typography,\n  useDesignSystemTheme,\n  LegacyInfoTooltip,\n  FullscreenIcon,\n  Switch,\n  Spinner,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { PropsWithChildren, ReactNode, memo, useCallback, forwardRef } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsCardConfig } from '../../runs-charts.types';\nimport type { ExperimentChartImageDownloadFileFormat } from '../../hooks/useChartImageDownloadHandler';\nimport { noop } from 'lodash';\n\nexport const DRAGGABLE_CARD_HANDLE_CLASS = 'mlflow-charts-drag-handle';\nexport const DRAGGABLE_CARD_TRANSITION_NAME = '--drag-transform';\nexport const DRAGGABLE_CARD_TRANSITION_VAR = `var(${DRAGGABLE_CARD_TRANSITION_NAME})`;\n\nexport enum RunsChartsChartsDragGroup {\n  PARALLEL_CHARTS_AREA = 'PARALLEL_CHARTS_AREA',\n  GENERAL_AREA = 'GENERAL_AREA',\n}\n\nexport interface RunsChartCardReorderProps {\n  onReorderWith: (draggedKey: string, targetDropKey: string) => void;\n  canMoveUp: boolean;\n  canMoveDown: boolean;\n  previousChartUuid?: string;\n  nextChartUuid?: string;\n}\n\nexport interface RunsChartCardSizeProps {\n  height?: number;\n  positionInSection?: number;\n}\n\nexport interface RunsChartCardVisibilityProps {\n  isInViewport?: boolean;\n  isInViewportDeferred?: boolean;\n}\n\nexport type RunsChartCardSetFullscreenFn = (chart: {\n  config: RunsChartsCardConfig;\n  title: string | ReactNode;\n  subtitle: ReactNode;\n}) => void;\n\nexport interface RunsChartCardFullScreenProps {\n  fullScreen?: boolean;\n  setFullScreenChart?: RunsChartCardSetFullscreenFn;\n}\n\nexport interface ChartCardToggleProps {\n  toggleLabel: string;\n  currentToggle: boolean;\n  setToggle: () => void;\n}\n\nexport interface ChartCardWrapperProps extends RunsChartCardReorderProps, RunsChartCardSizeProps {\n  title: React.ReactNode;\n  subtitle?: React.ReactNode;\n  onEdit: () => void;\n  onDelete: () => void;\n  tooltip?: React.ReactNode;\n  uuid?: string;\n  dragGroupKey: RunsChartsChartsDragGroup;\n  additionalMenuContent?: React.ReactNode;\n  toggleFullScreenChart?: () => void;\n  toggles?: ChartCardToggleProps[];\n  isRefreshing?: boolean;\n  onClickDownload?: (format: ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full') => void;\n  supportedDownloadFormats?: (ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full')[];\n  isHidden?: boolean;\n}\n\n/**\n * Wrapper components for all chart cards. Provides styles and adds\n * a dropdown menu with actions for configure and delete.\n */\nconst RunsChartCardWrapperRaw = ({\n  title,\n  subtitle,\n  onDelete,\n  onEdit,\n  children,\n  uuid,\n  dragGroupKey,\n  tooltip = '',\n  onReorderWith = noop,\n  canMoveDown,\n  canMoveUp,\n  previousChartUuid,\n  nextChartUuid,\n  additionalMenuContent,\n  toggleFullScreenChart,\n  toggles,\n  supportedDownloadFormats = [],\n  onClickDownload,\n  isHidden,\n  height,\n  isRefreshing = false,\n}: PropsWithChildren<ChartCardWrapperProps>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const onMoveUp = useCallback(\n    () => onReorderWith(uuid || '', previousChartUuid || ''),\n    [onReorderWith, uuid, previousChartUuid],\n  );\n  const onMoveDown = useCallback(\n    () => onReorderWith(uuid || '', nextChartUuid || ''),\n    [onReorderWith, uuid, nextChartUuid],\n  );\n\n  const usingCustomTitle = React.isValidElement(title);\n\n  return (\n    <div\n      css={{\n        // Either use provided height or default to 360\n        height: height ?? 360,\n        overflow: 'hidden',\n        display: 'grid',\n        gridTemplateRows: 'auto 1fr',\n        backgroundColor: theme.colors.backgroundPrimary,\n        padding: 12,\n        // have a slightly smaller padding when the enableDeepLearningUI\n        // flag is on to accomodate the legend in the charts\n        paddingBottom: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.general.borderRadiusBase,\n        transition: 'opacity 0.12s',\n        position: 'relative',\n      }}\n      data-testid=\"experiment-view-compare-runs-card\"\n    >\n      <div\n        css={{\n          display: 'flex',\n          overflow: 'hidden',\n        }}\n      >\n        <div\n          data-testid=\"experiment-view-compare-runs-card-drag-handle\"\n          css={{\n            marginTop: usingCustomTitle ? theme.spacing.sm : theme.spacing.xs,\n            marginRight: theme.spacing.sm,\n            cursor: 'grab',\n          }}\n          className={DRAGGABLE_CARD_HANDLE_CLASS}\n        >\n          <DragIcon />\n        </div>\n        {usingCustomTitle ? (\n          title\n        ) : (\n          <div css={{ overflow: 'hidden', flex: 1, flexShrink: 1 }}>\n            <Typography.Title\n              title={String(title)}\n              level={4}\n              withoutMargins\n              css={{\n                overflow: 'hidden',\n                whiteSpace: 'nowrap',\n                textOverflow: 'ellipsis',\n              }}\n            >\n              {title}\n            </Typography.Title>\n            {subtitle && <span css={styles.subtitle(theme)}>{subtitle}</span>}\n            {tooltip && <LegacyInfoTooltip css={{ verticalAlign: 'middle' }} title={tooltip} />}\n          </div>\n        )}\n        {isRefreshing && (\n          <div\n            css={{\n              width: theme.general.heightSm,\n              height: theme.general.heightSm,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n          >\n            <Spinner />\n          </div>\n        )}\n        {toggles && (\n          <div\n            css={{\n              display: 'flex',\n              padding: `0px ${theme.spacing.lg}px`,\n              gap: theme.spacing.md,\n              alignItems: 'flex-start',\n            }}\n          >\n            {toggles.map((toggle) => {\n              return (\n                <Switch\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_262\"\n                  key={toggle.toggleLabel}\n                  checked={toggle.currentToggle}\n                  onChange={toggle.setToggle}\n                  label={toggle.toggleLabel}\n                />\n              );\n            })}\n          </div>\n        )}\n        <Button\n          componentId=\"fullscreen_button_chartcard\"\n          icon={<FullscreenIcon />}\n          onClick={toggleFullScreenChart}\n          disabled={!toggleFullScreenChart}\n        />\n        <DropdownMenu.Root modal={false}>\n          <DropdownMenu.Trigger asChild>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_cards_chartcard.common.tsx_158\"\n              type=\"tertiary\"\n              icon={<OverflowIcon />}\n              data-testid=\"experiment-view-compare-runs-card-menu\"\n            />\n          </DropdownMenu.Trigger>\n          <DropdownMenu.Content align=\"end\" minWidth={100}>\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_288\"\n              onClick={onEdit}\n              data-testid=\"experiment-view-compare-runs-card-edit\"\n            >\n              Configure\n            </DropdownMenu.Item>\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_291\"\n              onClick={onDelete}\n              data-testid=\"experiment-view-compare-runs-card-delete\"\n            >\n              Delete\n            </DropdownMenu.Item>\n            {supportedDownloadFormats.length > 0 && onClickDownload && (\n              <>\n                <DropdownMenu.Separator />\n                {supportedDownloadFormats.includes('csv') && (\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_298\"\n                    onClick={() => onClickDownload('csv')}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Export as CSV\"\n                      description=\"Experiment page > compare runs tab > chart header > export CSV data option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('svg') && (\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_316\"\n                    onClick={() => onClickDownload('svg')}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Download as SVG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as SVG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('png') && (\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_324\"\n                    onClick={() => onClickDownload('png')}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Download as PNG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as PNG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n              </>\n            )}\n            <DropdownMenu.Separator />\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_334\"\n              disabled={!canMoveUp}\n              onClick={onMoveUp}\n              data-testid=\"experiment-view-compare-runs-move-up\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move up\"\n                description=\"Experiment page > compare runs tab > chart header > move up option\"\n              />\n            </DropdownMenu.Item>\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_344\"\n              disabled={!canMoveDown}\n              onClick={onMoveDown}\n              data-testid=\"experiment-view-compare-runs-move-down\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move down\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.Item>\n            {additionalMenuContent}\n          </DropdownMenu.Content>\n        </DropdownMenu.Root>\n      </div>\n      {children}\n    </div>\n  );\n};\n\nconst styles = {\n  chartEntry: (theme: Theme) => ({\n    height: 360,\n    overflow: 'hidden',\n    display: 'grid',\n    gridTemplateRows: 'auto 1fr',\n    backgroundColor: theme.colors.backgroundPrimary,\n    padding: theme.spacing.md,\n    border: `1px solid ${theme.colors.border}`,\n    borderRadius: theme.general.borderRadiusBase,\n  }),\n  chartComponentWrapper: () => ({\n    overflow: 'hidden',\n  }),\n  subtitle: (theme: Theme) => ({\n    color: theme.colors.textSecondary,\n    fontSize: 11,\n    marginRight: 4,\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const RunsChartCardWrapper = memo(RunsChartCardWrapperRaw);\n\nexport const RunsChartCardLoadingPlaceholder = forwardRef<\n  HTMLDivElement,\n  {\n    className?: string;\n    style?: React.CSSProperties;\n  }\n>(({ className, style }, ref) => (\n  <div\n    css={{ display: 'flex', height: '100%', justifyContent: 'center', alignItems: 'center' }}\n    className={className}\n    style={style}\n    ref={ref}\n  >\n    <Spinner />\n  </div>\n));\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { isNil } from 'lodash';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport { RunsChartCardLoadingPlaceholder } from './cards/ChartCard.common';\n\nexport interface RunsScatterPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nconst createTooltipTemplate = () =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * scatter plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsScatterPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    markerSize = 10,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsScatterPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { runInfo, metrics, params, color, uuid, displayName } = runData;\n        const { runUuid, runName } = runInfo || {};\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.dataAccessKey ?? xAxis.key]?.value;\n        const y = yAxisData?.[yAxis.dataAccessKey ?? yAxis.key]?.value;\n\n        if (!isNil(x) && !isNil(y)) {\n          xValues.push(x);\n          yValues.push(y);\n          colors.push(color || theme.colors.primary);\n          if (runUuid) {\n            tooltipData.push([runUuid, runName || runUuid] as any);\n          } else {\n            tooltipData.push([uuid, displayName] as any);\n          }\n        }\n      }\n\n      return [\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate() : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n          },\n        } as Data,\n      ];\n    }, [runsData, xAxis, yAxis, theme, markerSize, useDefaultHoverBox]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: { title: yAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = yAxis.key;\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (points[0] as any)?.customdata?.[0];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid, undefined, {});\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onUpdate={onUpdate}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n          fallback={<RunsChartCardLoadingPlaceholder />}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport React from 'react';\nimport { Dash } from 'plotly.js';\n\nconst STROKE_WIDTH = 3;\n\n/**\n * Replicating plotly.js's dasharrays for each dash type, with smaller spaces\n * https://github.com/plotly/plotly.js/blob/master/src/components/drawing/index.js#L162\n */\nconst getDashArray = (dashType: Dash) => {\n  switch (dashType) {\n    case 'dot':\n      return `${STROKE_WIDTH}`;\n    case 'dash':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdash':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'dashdot':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdashdot':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    default:\n      return '';\n  }\n};\n\nexport type LegendLabelData = {\n  label: string;\n  color: string;\n  dashStyle?: Dash;\n  uuid?: string;\n  metricKey?: string;\n};\n\nconst TraceLabel: React.FC<LegendLabelData> = ({ label, color, dashStyle }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'center',\n        textOverflow: 'ellipsis',\n        flexShrink: 0,\n        marginRight: theme.spacing.md,\n        maxWidth: '100%',\n      }}\n    >\n      <TraceLabelColorIndicator color={color} dashStyle={dashStyle} />\n      <Typography.Text\n        color=\"secondary\"\n        size=\"sm\"\n        css={{ whiteSpace: 'nowrap', textOverflow: 'ellipsis', overflow: 'hidden' }}\n      >\n        {label}\n      </Typography.Text>\n    </div>\n  );\n};\n\nexport const TraceLabelColorIndicator: React.FC<Pick<LegendLabelData, 'color' | 'dashStyle'>> = ({\n  color,\n  dashStyle,\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const strokeDasharray = dashStyle ? getDashArray(dashStyle) : undefined;\n  const pathYOffset = theme.typography.fontSizeSm / 2;\n\n  return (\n    <svg\n      css={{\n        height: theme.typography.fontSizeSm,\n        width: STROKE_WIDTH * 8,\n        marginRight: theme.spacing.xs,\n        flexShrink: 0,\n      }}\n    >\n      <path\n        d={`M0,${pathYOffset}h${STROKE_WIDTH * 8}`}\n        style={{\n          strokeWidth: STROKE_WIDTH,\n          stroke: color,\n          strokeDasharray,\n        }}\n      />\n    </svg>\n  );\n};\ntype RunsMetricsLegendProps = {\n  labelData: LegendLabelData[];\n  height: number;\n  fullScreen?: boolean;\n};\n\nconst RunsMetricsLegend: React.FC<RunsMetricsLegendProps> = ({ labelData, height, fullScreen }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexWrap: 'wrap',\n        height,\n        alignContent: fullScreen ? 'flex-start' : 'normal',\n        gap: fullScreen ? theme.spacing.sm : 0,\n        overflowY: 'auto',\n        overflowX: 'hidden',\n        marginTop: fullScreen ? theme.spacing.lg : theme.spacing.sm,\n      }}\n    >\n      {labelData.map((labelDatum) => (\n        <TraceLabel key={labelDatum.uuid ?? labelDatum.label} {...labelDatum} />\n      ))}\n    </div>\n  );\n};\n\nexport default RunsMetricsLegend;\n","import {\n  LegacySelect,\n  SimpleSelect,\n  SimpleSelectOption,\n  SimpleSelectOptionGroup,\n  Tag,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport React, { ComponentProps, PropsWithChildren, useMemo } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { makeCanonicalSortKey } from '../../../experiment-page/utils/experimentPage.common-utils';\n\n/**\n * Represents a field in the compare run charts configuration modal.\n * Displays a title and content with proper margins.\n */\nexport const RunsChartsConfigureField = ({\n  title,\n  compact = false,\n  children,\n}: PropsWithChildren<{\n  title: React.ReactNode;\n  compact?: boolean;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{ marginBottom: compact ? theme.spacing.sm : theme.spacing.md * 2 }}\n      data-testid=\"experiment-view-compare-runs-config-field\"\n    >\n      <Typography.Title level={4}>{title}</Typography.Title>\n      {children}\n    </div>\n  );\n};\n\n/**\n * A searchable select for selecting metric or param from a categorized list.\n */\nexport const RunsChartsMetricParamSelect = ({\n  value,\n  onChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  value: string;\n  onChange: ComponentProps<typeof LegacySelect>['onChange'];\n  metricKeyList?: string[];\n  paramKeyList?: string[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  const isEmpty = !paramKeyList?.length && !metricKeyList?.length;\n\n  return (\n    <LegacySelect\n      css={styles.selectFull}\n      value={\n        isEmpty\n          ? formatMessage({\n              description:\n                'Message displayed when no metrics or params are available in the compare runs chart configure modal',\n              defaultMessage: 'No metrics or parameters available',\n            })\n          : value\n      }\n      disabled={isEmpty}\n      onChange={onChange}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Metrics',\n            description: \"Label for 'metrics' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('METRIC', metric)}\n              value={makeCanonicalSortKey('METRIC', metric)}\n            >\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n      {paramKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Params',\n            description: \"Label for 'params' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('PARAM', param)}\n              value={makeCanonicalSortKey('PARAM', param)}\n            >\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n    </LegacySelect>\n  );\n};\n\nexport const RunsChartsMetricParamSelectV2 = ({\n  value,\n  id,\n  onChange,\n  metricOptions = [],\n  paramOptions = [],\n}: {\n  value: string;\n  id: string;\n  onChange: (value: string) => void;\n  metricOptions: {\n    key: string;\n    datasetName: string | undefined;\n    metricKey: string;\n  }[];\n  paramOptions: {\n    key: string;\n    paramKey: string;\n  }[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  const isEmpty = !paramOptions.length && !metricOptions.length;\n\n  return (\n    <SimpleSelect\n      componentId=\"mlflow.charts.chart_configure.metric_with_dataset_select\"\n      id={id}\n      css={styles.selectFull}\n      value={\n        isEmpty\n          ? formatMessage({\n              description:\n                'Message displayed when no metrics or params are available in the compare runs chart configure modal',\n              defaultMessage: 'No metrics or parameters available',\n            })\n          : value\n      }\n      disabled={isEmpty}\n      onChange={({ target }) => {\n        onChange(target.value);\n      }}\n      contentProps={{\n        matchTriggerWidth: true,\n        maxHeight: 500,\n      }}\n    >\n      {metricOptions?.length ? (\n        <SimpleSelectOptionGroup\n          label={formatMessage({\n            defaultMessage: 'Metrics',\n            description: \"Label for 'metrics' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {metricOptions.map(({ datasetName, key, metricKey }) => (\n            <SimpleSelectOption key={key} value={key}>\n              {datasetName && (\n                <Tag componentId=\"mlflow.charts.chart_configure.metric_with_dataset_select.tag\">{datasetName}</Tag>\n              )}{' '}\n              {metricKey}\n            </SimpleSelectOption>\n          ))}\n        </SimpleSelectOptionGroup>\n      ) : null}\n      {paramOptions?.length ? (\n        <SimpleSelectOptionGroup\n          label={formatMessage({\n            defaultMessage: 'Params',\n            description: \"Label for 'params' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {paramOptions.map(({ key, paramKey }) => (\n            <SimpleSelectOption key={key} value={key}>\n              {paramKey}\n            </SimpleSelectOption>\n          ))}\n        </SimpleSelectOptionGroup>\n      ) : null}\n    </SimpleSelect>\n  );\n};\n\nexport const runsChartsRunCountDefaultOptions: { value: number; label: React.ReactNode }[] = [\n  // We're not using any procedural generation so react-intl extractor can parse it\n  {\n    value: 5,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"5\"\n        description=\"Label for 5 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 10,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"10\"\n        description=\"Label for 10 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 20,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"20\"\n        description=\"Label for 20 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n];\n\nconst styles = { selectFull: { width: '100%' } };\n","import { SimpleSelect, SimpleSelectOption, Tag } from '@databricks/design-system';\nimport { RunsChartsMetricByDatasetEntry } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureMetricWithDatasetSelect = ({\n  metricKeysByDataset,\n  value,\n  onChange,\n}: {\n  metricKeysByDataset?: RunsChartsMetricByDatasetEntry[];\n  value?: string;\n  onChange: (metricByDatasetEntry: RunsChartsMetricByDatasetEntry) => void;\n}) => {\n  return (\n    <SimpleSelect\n      css={{ width: '100%' }}\n      componentId=\"mlflow.charts.chart_configure.metric_with_dataset_select\"\n      id=\"mlflow.charts.chart_configure.metric_with_dataset_select\"\n      value={value}\n      onChange={({ target }) => {\n        const entry = metricKeysByDataset?.find(({ dataAccessKey }) => dataAccessKey === target.value);\n        if (entry) {\n          onChange(entry);\n        }\n      }}\n      contentProps={{\n        matchTriggerWidth: true,\n        maxHeight: 400,\n      }}\n    >\n      {metricKeysByDataset?.map(({ datasetName, metricKey, dataAccessKey }) => (\n        <SimpleSelectOption key={dataAccessKey} value={dataAccessKey}>\n          {datasetName && (\n            <Tag componentId=\"mlflow.charts.chart_configure.metric_with_dataset_select.tag\">{datasetName}</Tag>\n          )}{' '}\n          {metricKey}\n        </SimpleSelectOption>\n      ))}\n    </SimpleSelect>\n  );\n};\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback, useEffect } from 'react';\nimport type {\n  RunsChartsCardConfig,\n  RunsChartsBarCardConfig,\n  RunsChartsMetricByDatasetEntry,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField, runsChartsRunCountDefaultOptions } from './RunsChartsConfigure.common';\nimport { isEmpty } from 'lodash';\nimport { RunsChartsConfigureMetricWithDatasetSelect } from './RunsChartsConfigureMetricWithDatasetSelect';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureBarChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  metricKeysByDataset,\n}: {\n  metricKeyList: string[];\n  metricKeysByDataset?: RunsChartsMetricByDatasetEntry[];\n  state: Partial<RunsChartsBarCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsBarCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string, datasetName?: string, dataAccessKey?: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsBarCardConfig), metricKey, datasetName, dataAccessKey }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsBarCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeysByDataset?.[0]) {\n      updateMetric(\n        metricKeysByDataset[0].metricKey,\n        metricKeysByDataset[0].datasetName,\n        metricKeysByDataset[0].dataAccessKey,\n      );\n      return;\n    }\n\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList, metricKeysByDataset]);\n\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Metric\">\n        {!isEmpty(metricKeysByDataset) ? (\n          <RunsChartsConfigureMetricWithDatasetSelect\n            metricKeysByDataset={metricKeysByDataset}\n            onChange={({ metricKey, datasetName, dataAccessKey }) =>\n              updateMetric(metricKey, datasetName, dataAccessKey)\n            }\n            value={state.dataAccessKey ?? state.metricKey}\n          />\n        ) : (\n          <LegacySelect\n            css={styles.selectFull}\n            value={emptyMetricsList ? 'No metrics available' : state.metricKey}\n            onChange={(metricKey) => updateMetric(metricKey)}\n            disabled={emptyMetricsList}\n            dangerouslySetAntdProps={{ showSearch: true }}\n          >\n            {metricKeyList.map((metric) => (\n              <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n                {metric}\n              </LegacySelect.Option>\n            ))}\n          </LegacySelect>\n        )}\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n\nconst styles = { selectFull: { width: '100%' } };\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureParallelChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsParallelCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsParallelCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating selected metrics and params\n   */\n\n  const updateSelectedParams = useCallback(\n    (selectedParams: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedParams,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (selectedMetrics: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedMetrics,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const emptyMetricsList = metricKeyList.length === 0;\n  const emptyParamsList = paramKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Params\">\n        <LegacySelect\n          mode={emptyParamsList ? undefined : 'multiple'}\n          onChange={updateSelectedParams}\n          style={{\n            width: 275,\n          }}\n          value={emptyParamsList ? ('No parameters available' as any) : state.selectedParams}\n          disabled={emptyParamsList}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option value={param} key={param}>\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Metrics\">\n        <LegacySelect\n          mode={emptyMetricsList ? undefined : 'multiple'}\n          onChange={updateSelectedMetrics}\n          style={{\n            width: 275,\n          }}\n          value={emptyMetricsList ? ('No metrics available' as any) : state.selectedMetrics}\n          disabled={emptyMetricsList}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option value={metric} key={metric}>\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import {\n  Button,\n  CloseIcon,\n  Input,\n  LegacySelect,\n  PlusIcon,\n  Radio,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport {\n  RunsChartsCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsLineChartExpression,\n  RunsChartsLineChartYAxisType,\n} from '../runs-charts.types';\nimport { RunsChartsConfigureField } from './config/RunsChartsConfigure.common';\nimport { FormattedMessage } from 'react-intl';\nimport { shouldEnableChartExpressions } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useChartExpressionParser } from '../hooks/useChartExpressionParser';\nimport { RunsChartsLineChartXAxisType } from './RunsCharts.common';\n\nconst renderMetricSelectorV1 = ({\n  metricKeyList,\n  metricKey,\n  updateMetric,\n}: {\n  metricKeyList: string[];\n  metricKey?: string;\n  updateMetric: (metricKey: string) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      css={{ width: '100%' }}\n      value={emptyMetricsList ? 'No metrics available' : metricKey}\n      onChange={updateMetric}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nconst renderMetricSelectorV2 = ({\n  metricKeyList,\n  selectedMetricKeys,\n  updateSelectedMetrics,\n}: {\n  metricKeyList: string[];\n  selectedMetricKeys?: string[];\n  updateSelectedMetrics: (metricKeys: string[]) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      mode=\"multiple\"\n      placeholder={\n        emptyMetricsList ? (\n          <FormattedMessage\n            defaultMessage=\"No metrics available\"\n            description=\"Text shown in a disabled multi-selector when there are no selectable metrics.\"\n          />\n        ) : (\n          <FormattedMessage\n            defaultMessage=\"Select metrics\"\n            description=\"Placeholder text for a metric multi-selector when configuring a line chart\"\n          />\n        )\n      }\n      css={{ width: '100%' }}\n      value={emptyMetricsList ? [] : selectedMetricKeys}\n      onChange={updateSelectedMetrics}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nconst ExpressionInput = ({\n  chartExpression,\n  index,\n  updateYAxisExpression,\n  removeYAxisExpression,\n  metricKeyList,\n}: {\n  chartExpression: RunsChartsLineChartExpression;\n  index: number;\n  updateYAxisExpression: (expression: RunsChartsLineChartExpression, index: number) => void;\n  removeYAxisExpression: (index: number) => void;\n  metricKeyList: string[];\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const { compileExpression } = useChartExpressionParser();\n  const [isValidExpression, setIsValidExpression] = useState(true);\n  const validateAndUpdate = (expression: string) => {\n    const compiledExpression = compileExpression(expression, metricKeyList);\n    if (compiledExpression === undefined) {\n      setIsValidExpression(false);\n      updateYAxisExpression({ rpn: [], variables: [], expression }, index);\n    } else {\n      setIsValidExpression(true);\n      updateYAxisExpression(compiledExpression, index);\n    }\n  };\n\n  return (\n    <span css={{ display: 'flex', width: '100%', gap: theme.spacing.sm }}>\n      <Input\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsyaxismetricandexpressionselector.tsx_122\"\n        value={chartExpression.expression}\n        onChange={(e) => validateAndUpdate(e.target.value)}\n        validationState={isValidExpression ? undefined : 'error'}\n      />\n      <Button\n        componentId=\"mlflow.charts.line-chart-expressions-remove\"\n        icon={<CloseIcon />}\n        onClick={() => removeYAxisExpression(index)}\n      />\n    </span>\n  );\n};\n\nexport const RunsChartsYAxisMetricAndExpressionSelector = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  updateSelectedMetrics,\n}: {\n  state: Partial<RunsChartsLineCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsLineCardConfig) => void;\n  metricKeyList: string[];\n  updateSelectedMetrics: (metricKeys: string[]) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const usingChartExpressions =\n    shouldEnableChartExpressions() && state.xAxisKey !== RunsChartsLineChartXAxisType.METRIC;\n\n  const DEBOUNCE_DELAY = 300; // in ms\n\n  const [temporaryChartExpressions, setTemporaryChartExpressions] = useState<RunsChartsLineChartExpression[]>(\n    state.yAxisExpressions || [],\n  );\n\n  const updateYAxisExpressionTemporary = (expression: RunsChartsLineChartExpression, index: number) => {\n    setTemporaryChartExpressions((current) => {\n      const newExpressions = [...current];\n      newExpressions[index] = expression;\n      return newExpressions;\n    });\n  };\n\n  const addNewYAxisExpressionTemporary = () => {\n    setTemporaryChartExpressions((current) => {\n      return [...current, { rpn: [], variables: [], expression: '' } as RunsChartsLineChartExpression];\n    });\n  };\n\n  const removeYAxisExpressionTemporary = (index: number) => {\n    setTemporaryChartExpressions((current) => {\n      const newExpressions = [...current];\n      newExpressions.splice(index, 1);\n      return newExpressions;\n    });\n  };\n\n  useEffect(() => {\n    const updateYAxisExpression = (yAxisExpressions: RunsChartsLineChartExpression[]) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          yAxisExpressions,\n        };\n      });\n    };\n    const handler = setTimeout(() => {\n      updateYAxisExpression(temporaryChartExpressions);\n    }, DEBOUNCE_DELAY);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [temporaryChartExpressions, onStateChange]);\n\n  const updateYAxisKey = useCallback(\n    (yAxisKey: RunsChartsLineCardConfig['yAxisKey']) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          yAxisKey,\n          range: {\n            ...config.range,\n            yMin: undefined,\n            yMax: undefined,\n          },\n        };\n      });\n    },\n    [onStateChange],\n  );\n\n  return (\n    <>\n      {usingChartExpressions && (\n        <RunsChartsConfigureField title=\"Metric type\" compact>\n          <Radio.Group\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsyaxismetricandexpressionselector.tsx_221\"\n            name=\"runs-charts-field-group-metric-type-y-axis\"\n            value={state.yAxisKey || RunsChartsLineChartYAxisType.METRIC}\n            onChange={({ target: { value } }) => updateYAxisKey(value)}\n          >\n            <Radio value={RunsChartsLineChartYAxisType.METRIC} key={RunsChartsLineChartYAxisType.METRIC}>\n              <FormattedMessage\n                defaultMessage=\"Logged metrics\"\n                description=\"Experiment tracking > runs charts > line chart configuration > logged metrics label\"\n              />\n            </Radio>\n            <Radio value={RunsChartsLineChartYAxisType.EXPRESSION} key={RunsChartsLineChartYAxisType.EXPRESSION}>\n              <FormattedMessage\n                defaultMessage=\"Custom expression\"\n                description=\"Experiment tracking > runs charts > line chart configuration > custom expression label\"\n              />\n            </Radio>\n          </Radio.Group>\n        </RunsChartsConfigureField>\n      )}\n      {usingChartExpressions && state.yAxisKey === RunsChartsLineChartYAxisType.EXPRESSION ? (\n        <RunsChartsConfigureField title=\"Expression\" compact>\n          <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-start', gap: theme.spacing.sm }}>\n            {temporaryChartExpressions.map((chartExpression, index) => {\n              return (\n                <ExpressionInput\n                  key={index}\n                  chartExpression={chartExpression}\n                  index={index}\n                  updateYAxisExpression={updateYAxisExpressionTemporary}\n                  removeYAxisExpression={removeYAxisExpressionTemporary}\n                  metricKeyList={metricKeyList}\n                />\n              );\n            })}\n            <Button\n              componentId=\"mlflow.charts.line-chart-expressions-add-new\"\n              icon={<PlusIcon />}\n              onClick={addNewYAxisExpressionTemporary}\n            >\n              Add new\n            </Button>\n          </div>\n        </RunsChartsConfigureField>\n      ) : (\n        <RunsChartsConfigureField title=\"Metric\" compact>\n          {renderMetricSelectorV2({\n            metricKeyList,\n            selectedMetricKeys: state.selectedMetricKeys,\n            updateSelectedMetrics,\n          })}\n        </RunsChartsConfigureField>\n      )}\n    </>\n  );\n};\n","import {\n  Radio,\n  LegacySelect,\n  Switch,\n  LegacyTooltip,\n  QuestionMarkIcon,\n  useDesignSystemTheme,\n  ThemeType,\n  SegmentedControlGroup,\n  SegmentedControlButton,\n  InfoSmallIcon,\n  Input,\n  FormUI,\n  Typography,\n  SimpleSelect,\n  SimpleSelectOption,\n  SimpleSelectOptionGroup,\n  Tooltip,\n  PlusIcon,\n  Button,\n  Spacer,\n  CloseIcon,\n} from '@databricks/design-system';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useCallback, useEffect, useState } from 'react';\nimport {\n  RunsChartsLineChartYAxisType,\n  type ChartRange,\n  type RunsChartsCardConfig,\n  type RunsChartsLineCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { shouldEnableChartExpressions } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { RunsChartsLineChartXAxisType } from '@mlflow/mlflow/src/experiment-tracking/components/runs-charts/components/RunsCharts.common';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\nimport { isUndefined } from 'lodash';\nimport { RunsChartsYAxisMetricAndExpressionSelector } from '../RunsChartsYAxisMetricAndExpressionSelector';\n\nconst USE_GLOBAL_SETTING_KEY = '_GLOBAL';\n\nconst renderXAxisMetricSelector = ({\n  theme,\n  metricKeyList,\n  selectedXAxisMetricKey,\n  updateSelectedXAxisMetricKey,\n  disabled = false,\n}: {\n  theme: ThemeType;\n  metricKeyList: string[];\n  selectedXAxisMetricKey?: string;\n  updateSelectedXAxisMetricKey: (metricKey: string) => void;\n  disabled?: boolean;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <Radio value={RunsChartsLineChartXAxisType.METRIC} disabled={disabled}>\n      <FormattedMessage\n        defaultMessage=\"Metric\"\n        description=\"Label for a radio button that configures the x-axis on a line chart. This option makes the X-axis a custom metric that the user selects.\"\n      />\n      <LegacySelect\n        css={{\n          marginTop: theme.spacing.xs,\n          width: '100%',\n        }}\n        value={selectedXAxisMetricKey || undefined}\n        placeholder={\n          emptyMetricsList ? (\n            <FormattedMessage\n              defaultMessage=\"No metrics available\"\n              description=\"Text shown in a disabled metric selector when there are no selectable metrics.\"\n            />\n          ) : (\n            <FormattedMessage\n              defaultMessage=\"Select metric\"\n              description=\"Placeholder text for a metric selector when configuring a line chart\"\n            />\n          )\n        }\n        onClick={(e: React.MouseEvent<HTMLElement>) => {\n          // this is to prevent the radio button\n          // from automatically closing the selector\n          e.preventDefault();\n          e.stopPropagation();\n        }}\n        onChange={updateSelectedXAxisMetricKey}\n        disabled={emptyMetricsList || disabled}\n        dangerouslySetAntdProps={{ showSearch: true }}\n      >\n        {metricKeyList.map((metric) => (\n          <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n            {metric}\n          </LegacySelect.Option>\n        ))}\n      </LegacySelect>\n    </Radio>\n  );\n};\n\nconst safeLog = (x: number | undefined) => {\n  if (isUndefined(x)) {\n    return x;\n  }\n  if (x <= 0) {\n    return undefined;\n  }\n  return Math.log10(x);\n};\n\nconst safePow = (x: number | undefined) => {\n  if (isUndefined(x)) {\n    return x;\n  }\n  return Math.pow(10, x);\n};\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureLineChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n}: {\n  metricKeyList: string[];\n  state: Partial<RunsChartsLineCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsLineCardConfig) => void;\n}) => {\n  const usingChartExpressions = shouldEnableChartExpressions();\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  const [localAxisRange, setLocalAxisRange] = useState<ChartRange>({\n    xMin: state.xAxisScaleType === 'log' ? safePow(state.range?.xMin) : state.range?.xMin,\n    xMax: state.xAxisScaleType === 'log' ? safePow(state.range?.xMax) : state.range?.xMax,\n    yMin: state.scaleType === 'log' ? safePow(state.range?.yMin) : state.range?.yMin,\n    yMax: state.scaleType === 'log' ? safePow(state.range?.yMax) : state.range?.yMax,\n  });\n\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsLineCardConfig), metricKey }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (metricKeys: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        metricKey: metricKeys[0],\n        selectedMetricKeys: metricKeys,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateXAxisKey = useCallback(\n    (xAxisKey: RunsChartsLineCardConfig['xAxisKey'], useGlobal = false) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          xAxisKey,\n          selectedXAxisMetricKey: '',\n          range: {\n            ...config.range,\n            xMin: undefined,\n            xMax: undefined,\n          },\n          useGlobalXaxisKey: useGlobal ?? config.useGlobalXaxisKey,\n          selectedYAxisMetricKey: RunsChartsLineChartYAxisType.METRIC,\n        };\n      });\n    },\n    [onStateChange],\n  );\n\n  const isInvalidLogValue = (value: number | undefined) => !isUndefined(value) && value <= 0;\n\n  const updateXAxisScaleType = useCallback(\n    (isLogType: boolean) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n\n        let newXMin = isLogType ? safeLog(localAxisRange.xMin) : localAxisRange.xMin;\n        let newXMax = isLogType ? safeLog(localAxisRange.xMax) : localAxisRange.xMax;\n        if (isLogType && isInvalidLogValue(localAxisRange.xMin) && localAxisRange.xMax && localAxisRange.xMax > 1) {\n          // when switching to log type, if only xMin is invalid, set xMin to 1.\n          setLocalAxisRange((prev) => ({\n            ...prev,\n            xMin: 1,\n          }));\n          newXMin = 0;\n        } else if (isLogType && (isInvalidLogValue(localAxisRange.xMin) || isInvalidLogValue(localAxisRange.xMax))) {\n          setLocalAxisRange((prev) => ({\n            ...prev,\n            xMin: undefined,\n            xMax: undefined,\n          }));\n          newXMin = undefined;\n          newXMax = undefined;\n        }\n        return {\n          ...config,\n          xAxisScaleType: isLogType ? 'log' : 'linear',\n          range: {\n            ...config.range,\n            xMin: newXMin,\n            xMax: newXMax,\n          },\n        };\n      });\n    },\n    [onStateChange, localAxisRange.xMin, localAxisRange.xMax],\n  );\n\n  const updateSelectedXAxisMetricKey = useCallback(\n    (selectedXAxisMetricKey: string) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        selectedXAxisMetricKey,\n        xAxisKey: RunsChartsLineChartXAxisType.METRIC,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateYAxisType = useCallback(\n    (isLogType: boolean) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n\n        let newYMin = isLogType ? safeLog(localAxisRange.yMin) : localAxisRange.yMin;\n        let newYMax = isLogType ? safeLog(localAxisRange.yMax) : localAxisRange.yMax;\n        if (isLogType && isInvalidLogValue(localAxisRange.yMin) && localAxisRange.yMax && localAxisRange.yMax > 1) {\n          // when switching to log type, if only yMin is invalid, set yMin to 1.\n          setLocalAxisRange((prev) => ({\n            ...prev,\n            yMin: 1,\n          }));\n          newYMin = 0; // This is the logged value of 1.\n        } else if (isLogType && (isInvalidLogValue(localAxisRange.yMin) || isInvalidLogValue(localAxisRange.yMax))) {\n          setLocalAxisRange((prev) => ({\n            ...prev,\n            yMin: undefined,\n            yMax: undefined,\n          }));\n          newYMin = undefined;\n          newYMax = undefined;\n        }\n        return {\n          ...config,\n          scaleType: isLogType ? 'log' : 'linear',\n          range: {\n            ...config.range,\n            yMin: newYMin,\n            yMax: newYMax,\n          },\n        };\n      });\n    },\n    [onStateChange, localAxisRange.yMin, localAxisRange.yMax],\n  );\n\n  const updateIgnoreOutliers = useCallback(\n    (ignoreOutliers: boolean) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        ignoreOutliers,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSmoothing = useCallback(\n    (lineSmoothness: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        lineSmoothness: lineSmoothness,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList]);\n\n  // for backwards compatibility, if selectedMetricKeys\n  // is not present, set it using metricKey.\n  useEffect(() => {\n    if (isUndefined(state.selectedMetricKeys) && !isUndefined(state.metricKey) && state.metricKey !== '') {\n      updateSelectedMetrics([state.metricKey]);\n    }\n  }, [state.selectedMetricKeys, state.metricKey, updateSelectedMetrics]);\n\n  const updateXAxisWhenConfirmed = (xMin: number | undefined, xMax: number | undefined) => {\n    if (inTransitionState(xMin, xMax)) {\n      return;\n    }\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      return {\n        ...config,\n        range: {\n          ...config.range,\n          xMin: config.xAxisScaleType === 'log' ? safeLog(xMin) : xMin,\n          xMax: config.xAxisScaleType === 'log' ? safeLog(xMax) : xMax,\n        },\n      };\n    });\n  };\n\n  const updateYAxisWhenConfirmed = (yMin: number | undefined, yMax: number | undefined) => {\n    if (inTransitionState(yMin, yMax)) {\n      return;\n    }\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      return {\n        ...config,\n        range: {\n          ...config.range,\n          yMin: config.scaleType === 'log' ? safeLog(yMin) : yMin,\n          yMax: config.scaleType === 'log' ? safeLog(yMax) : yMax,\n        },\n      };\n    });\n  };\n\n  const updateXAxisScaleMin = (xMin: string) => {\n    const newXMin = xMin ? Number(xMin) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, xMin: newXMin }));\n    updateXAxisWhenConfirmed(newXMin, localAxisRange.xMax);\n  };\n  const updateXAxisScaleMax = (xMax: string) => {\n    const newXMax = xMax ? Number(xMax) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, xMax: newXMax }));\n    updateXAxisWhenConfirmed(localAxisRange.xMin, newXMax);\n  };\n  const updateYAxisScaleMin = (yMin: string) => {\n    const newYMin = yMin ? Number(yMin) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, yMin: newYMin }));\n    updateYAxisWhenConfirmed(newYMin, localAxisRange.yMax);\n  };\n  const updateYAxisScaleMax = (yMax: string) => {\n    const newYMax = yMax ? Number(yMax) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, yMax: newYMax }));\n    updateYAxisWhenConfirmed(localAxisRange.yMin, newYMax);\n  };\n\n  const inTransitionState = (a: number | undefined, b: number | undefined) => {\n    if (isUndefined(a) && isUndefined(b)) {\n      return false;\n    } else if (!isUndefined(a) && !isUndefined(b)) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  const invalidMessage = (scaleType: 'log' | 'linear' | undefined, value: number | undefined) => {\n    if (scaleType === 'log' && isInvalidLogValue(value)) {\n      return (\n        <FormUI.Message\n          message={\n            <FormattedMessage\n              defaultMessage=\"Invalid log value\"\n              description=\"Experiment tracking > runs charts > line chart configuration > invalid log value message\"\n            />\n          }\n          type=\"warning\"\n        />\n      );\n    }\n    return null;\n  };\n\n  const METRIC_AXIS_PREFIX = 'metric-';\n  return (\n    <>\n      <Typography.Title level={4} color=\"secondary\">\n        X-axis\n      </Typography.Title>\n      <RunsChartsConfigureField title=\"Type\" compact>\n        {usingChartExpressions ? (\n          <SimpleSelect\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_436\"\n            id=\"x-axis-type\"\n            width=\"100%\"\n            value={state.useGlobalXaxisKey ? USE_GLOBAL_SETTING_KEY : state.xAxisKey}\n            contentProps={{ matchTriggerWidth: true, textOverflowMode: 'ellipsis' }}\n            onChange={({ target: { value } }) => {\n              if (value.startsWith(METRIC_AXIS_PREFIX)) {\n                updateSelectedXAxisMetricKey(value.slice(METRIC_AXIS_PREFIX.length));\n              } else if (value === RunsChartsLineChartXAxisType.STEP) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.STEP);\n              } else if (value === RunsChartsLineChartXAxisType.TIME) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.TIME);\n              } else if (value === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.TIME_RELATIVE);\n              } else if (value === USE_GLOBAL_SETTING_KEY) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.STEP, true);\n              }\n            }}\n          >\n            <SimpleSelectOption value={USE_GLOBAL_SETTING_KEY}>\n              <FormattedMessage\n                defaultMessage=\"Use workspace settings\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for using global workspace settings.\"\n              />\n            </SimpleSelectOption>\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.STEP}>\n              <FormattedMessage\n                defaultMessage=\"Step\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the step number that the metrics were logged.\"\n              />\n            </SimpleSelectOption>\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.TIME}>\n              <FormattedMessage\n                defaultMessage=\"Time (wall)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the absolute time that the metrics were logged.\"\n              />\n              <Tooltip\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_474\"\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Absolute date and time\"\n                    description=\"A tooltip line chart configuration for the step function of wall time\"\n                  />\n                }\n                side=\"right\"\n              >\n                <span>\n                  {' '}\n                  <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n                </span>\n              </Tooltip>\n            </SimpleSelectOption>\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.TIME_RELATIVE}>\n              <FormattedMessage\n                defaultMessage=\"Time (relative)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for relative time since the first metric was logged.\"\n              />\n              <Tooltip\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_494\"\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Amount of time that has passed since the first metric value was logged\"\n                    description=\"A tooltip line chart configuration for the step function of relative time\"\n                  />\n                }\n                side=\"right\"\n              >\n                <span>\n                  {' '}\n                  <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n                </span>\n              </Tooltip>\n            </SimpleSelectOption>\n            {metricKeyList.length > 0 && (\n              <SimpleSelectOptionGroup label=\"Metrics\">\n                {metricKeyList.map((metric) => (\n                  <SimpleSelectOption\n                    key={metric}\n                    value={`${METRIC_AXIS_PREFIX}${metric}`}\n                    data-testid={`${METRIC_AXIS_PREFIX}${metric}`}\n                  >\n                    {metric}\n                  </SimpleSelectOption>\n                ))}\n              </SimpleSelectOptionGroup>\n            )}\n          </SimpleSelect>\n        ) : (\n          <Radio.Group\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_524\"\n            name=\"runs-charts-field-group-x-axis\"\n            value={state.useGlobalXaxisKey ? USE_GLOBAL_SETTING_KEY : state.xAxisKey}\n            onChange={({ target: { value } }) => {\n              if (value === USE_GLOBAL_SETTING_KEY) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.STEP, true);\n              } else {\n                updateXAxisKey(value);\n              }\n            }}\n          >\n            <Radio value={USE_GLOBAL_SETTING_KEY}>\n              <FormattedMessage\n                defaultMessage=\"Use workspace settings\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for using global workspace settings.\"\n              />\n            </Radio>\n\n            <Radio value={RunsChartsLineChartXAxisType.STEP}>\n              <FormattedMessage\n                defaultMessage=\"Step\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the step number that the metrics were logged.\"\n              />\n            </Radio>\n            <Radio value={RunsChartsLineChartXAxisType.TIME}>\n              <FormattedMessage\n                defaultMessage=\"Time (wall)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the absolute time that the metrics were logged.\"\n              />\n              <LegacyTooltip\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Absolute date and time\"\n                    description=\"A tooltip line chart configuration for the step function of wall time\"\n                  />\n                }\n                placement=\"right\"\n              >\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </LegacyTooltip>\n            </Radio>\n            <Radio value={RunsChartsLineChartXAxisType.TIME_RELATIVE}>\n              <FormattedMessage\n                defaultMessage=\"Time (relative)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for relative time since the first metric was logged.\"\n              />\n              <LegacyTooltip\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Amount of time that has passed since the first metric value was logged\"\n                    description=\"A tooltip line chart configuration for the step function of relative time\"\n                  />\n                }\n                placement=\"right\"\n              >\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </LegacyTooltip>\n            </Radio>\n            {renderXAxisMetricSelector({\n              theme,\n              metricKeyList,\n              selectedXAxisMetricKey: state.selectedXAxisMetricKey,\n              updateSelectedXAxisMetricKey,\n            })}\n          </Radio.Group>\n        )}\n      </RunsChartsConfigureField>\n      {state.xAxisKey === RunsChartsLineChartXAxisType.STEP && (\n        <>\n          <RunsChartsConfigureField title=\"X-axis scale\" compact>\n            <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n              <div>\n                <Input\n                  componentId=\"mlflow.charts.line_chart_configure.x_axis_min\"\n                  aria-label=\"x-axis-min\"\n                  name=\"min\"\n                  type=\"number\"\n                  value={localAxisRange.xMin}\n                  onChange={(e) => updateXAxisScaleMin(e.target.value)}\n                  max={localAxisRange.xMax}\n                  placeholder=\"Min\"\n                />\n                {invalidMessage(state.xAxisScaleType, localAxisRange.xMin)}\n              </div>\n              <div>\n                <Input\n                  componentId=\"mlflow.charts.line_chart_configure.x_axis_max\"\n                  aria-label=\"x-axis-max\"\n                  name=\"max\"\n                  type=\"number\"\n                  value={localAxisRange.xMax}\n                  onChange={(e) => updateXAxisScaleMax(e.target.value)}\n                  min={localAxisRange.xMin}\n                  placeholder=\"Max\"\n                />\n                {invalidMessage(state.xAxisScaleType, localAxisRange.xMax)}\n              </div>\n            </div>\n            <div style={{ padding: theme.spacing.xs }} />\n            <Switch\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_628\"\n              aria-label=\"x-axis-log\"\n              checked={state.xAxisScaleType === 'log'}\n              onChange={updateXAxisScaleType}\n              label=\"Log scale\"\n              activeLabel=\"On\"\n              inactiveLabel=\"Off\"\n              disabledLabel=\"Disabled\"\n            />\n          </RunsChartsConfigureField>\n        </>\n      )}\n      <Typography.Title level={4} color=\"secondary\" css={{ paddingTop: theme.spacing.lg }}>\n        Y-axis\n      </Typography.Title>\n      <RunsChartsYAxisMetricAndExpressionSelector\n        state={state}\n        onStateChange={onStateChange}\n        metricKeyList={metricKeyList}\n        updateSelectedMetrics={updateSelectedMetrics}\n      />\n      <RunsChartsConfigureField title=\"Y-axis scale\" compact>\n        <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n          <div>\n            <Input\n              componentId=\"mlflow.charts.line_chart_configure.y_axis_min\"\n              aria-label=\"y-axis-min\"\n              name=\"min\"\n              type=\"number\"\n              value={localAxisRange.yMin}\n              onChange={(e) => updateYAxisScaleMin(e.target.value)}\n              max={localAxisRange.yMax}\n              placeholder=\"Min\"\n            />\n            {invalidMessage(state.scaleType, localAxisRange.yMin)}\n          </div>\n          <div>\n            <Input\n              componentId=\"mlflow.charts.line_chart_configure.y_axis_max\"\n              aria-label=\"y-axis-max\"\n              name=\"max\"\n              type=\"number\"\n              value={localAxisRange.yMax}\n              onChange={(e) => updateYAxisScaleMax(e.target.value)}\n              min={localAxisRange.yMin}\n              placeholder=\"Max\"\n            />\n            {invalidMessage(state.scaleType, localAxisRange.yMax)}\n          </div>\n        </div>\n        <Spacer size=\"xs\" />\n        <Switch\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_682\"\n          aria-label=\"y-axis-log\"\n          checked={state.scaleType === 'log'}\n          onChange={updateYAxisType}\n          label=\"Log scale\"\n          activeLabel=\"On\"\n          inactiveLabel=\"Off\"\n          disabledLabel=\"Disabled\"\n        />\n        <Spacer size=\"xs\" />\n        <div css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n          <div>\n            <Typography.Text bold>\n              <FormattedMessage\n                defaultMessage=\"Ignore outliers\"\n                description=\"Runs charts > line chart > ignore outliers > label\"\n              />\n            </Typography.Text>\n            <Tooltip\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_703\"\n              delayDuration={0}\n              content={\n                <FormattedMessage\n                  defaultMessage=\"Only display data points between the p5 and p95 of the data. This can help with chart readability in cases where outliers significantly affect the Y-axis range\"\n                  description=\"A tooltip describing the 'Ignore Outliers' configuration option for line charts\"\n                />\n              }\n              side=\"right\"\n            >\n              <span>\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </span>\n            </Tooltip>\n          </div>\n          <Switch\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_716\"\n            aria-label=\"y-axis-ignore-outliers\"\n            checked={state.ignoreOutliers}\n            onChange={updateIgnoreOutliers}\n            // Empty label so that the active/inactive labels are actually displayed\n            label=\" \"\n            activeLabel={intl.formatMessage({\n              defaultMessage: 'On',\n              description: 'Runs charts > line chart > ignore outliers > on setting label',\n            })}\n            inactiveLabel={intl.formatMessage({\n              defaultMessage: 'Off',\n              description: 'Runs charts > line chart > ignore outliers > off setting label',\n            })}\n            disabledLabel={intl.formatMessage({\n              defaultMessage: 'Disabled',\n              description: 'Runs charts > line chart > ignore outliers > disabled label',\n            })}\n          />\n        </div>\n      </RunsChartsConfigureField>\n      <Typography.Title level={4} color=\"secondary\" css={{ paddingTop: theme.spacing.lg }}>\n        Advanced\n      </Typography.Title>\n      <RunsChartsConfigureField\n        title={intl.formatMessage({\n          defaultMessage: 'Display points',\n          description: 'Runs charts > line chart > display points > label',\n        })}\n        compact\n      >\n        <SegmentedControlGroup\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_747\"\n          name={intl.formatMessage({\n            defaultMessage: 'Display points',\n            description: 'Runs charts > line chart > display points > label',\n          })}\n          value={state.displayPoints}\n          onChange={({ target }) => {\n            onStateChange((current) => ({\n              ...(current as RunsChartsLineCardConfig),\n              displayPoints: target.value,\n            }));\n          }}\n        >\n          <SegmentedControlButton\n            value={undefined}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Auto',\n                description: 'Runs charts > line chart > display points > auto setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Auto\"\n              description=\"Runs charts > line chart > display points > auto setting label\"\n            />{' '}\n            <LegacyTooltip\n              title={\n                <FormattedMessage\n                  defaultMessage=\"Show points on line charts if there are fewer than 60 data points per trace\"\n                  description=\"Runs charts > line chart > display points > auto tooltip\"\n                />\n              }\n            >\n              <InfoSmallIcon />\n            </LegacyTooltip>\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'On',\n                description: 'Runs charts > line chart > display points > on setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"On\"\n              description=\"Runs charts > line chart > display points > on setting label\"\n            />\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value={false}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Off',\n                description: 'Runs charts > line chart > display points > off setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Off\"\n              description=\"Runs charts > line chart > display points > off setting label\"\n            />\n          </SegmentedControlButton>\n        </SegmentedControlGroup>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={\n          <>\n            <FormattedMessage\n              defaultMessage=\"Line smoothing\"\n              description=\"Runs charts > line chart > configuration > label for line smoothing slider control. The control allows changing data trace line smoothness from 1 to 100, where 1 is the original data trace and 100 is the smoothest trace. Line smoothing helps eliminate noise in the data.\"\n            />\n          </>\n        }\n        compact\n      >\n        <Radio.Group\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_838\"\n          name=\"use-global-line-smoothness\"\n          value={Boolean(state.useGlobalLineSmoothing)}\n          onChange={({ target }) => {\n            onStateChange((current) => ({\n              ...(current as RunsChartsLineCardConfig),\n              useGlobalLineSmoothing: target.value === true,\n            }));\n          }}\n        >\n          <Radio value>Use workspace settings</Radio>\n          <Radio value={false}>Custom</Radio>\n        </Radio.Group>\n\n        <LineSmoothSlider\n          data-testid=\"smoothness-toggle\"\n          min={0}\n          max={100}\n          onChange={updateSmoothing}\n          value={state.lineSmoothness ? state.lineSmoothness : 0}\n          disabled={state.useGlobalLineSmoothing}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n\nconst styles = {\n  selectFull: { width: '100%' },\n  timeStepQuestionMarkIcon: () => ({\n    svg: { width: 12, height: 12 },\n  }),\n};\n","import { useCallback, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState } from '../../../../../redux-types';\nimport { MetricHistoryByName } from '../../../../types';\nimport {\n  RunsChartsLineChartXAxisType,\n  removeOutliersFromMetricHistory,\n  type RunsChartsRunData,\n} from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsLineCardConfig, RunsChartsLineChartYAxisType } from '../../runs-charts.types';\nimport { shouldEnableChartExpressions } from '../../../../../common/utils/FeatureUtils';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, isUndefined, uniq } from 'lodash';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport { useLineChartGlobalConfig } from '../hooks/useLineChartGlobalConfig';\nimport { RunsChartCardLoadingPlaceholder } from '../cards/ChartCard.common';\n\nconst RunsChartsConfigureLineChartPreviewImpl = ({\n  previewData,\n  cardConfig,\n  metricsByRunUuid,\n  groupBy,\n  globalLineChartConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsLineCardConfig;\n  groupBy: RunsGroupByConfig | null;\n\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n\n  metricsByRunUuid: Record<string, MetricHistoryByName>;\n}) => {\n  const { lineSmoothness, selectedXAxisMetricKey, xAxisKey } = useLineChartGlobalConfig(\n    cardConfig,\n    globalLineChartConfig,\n  );\n\n  const isGrouped = useMemo(() => previewData.some((r) => r.groupParentInfo), [previewData]);\n\n  const { aggregateFunction } = groupBy || {};\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      const runsInGroups = compact(previewData.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n      const ungroupedRuns = compact(\n        previewData.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid ?? undefined),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    return compact(previewData.map((r) => r.runInfo)).map((g) => g.runUuid ?? '');\n  }, [previewData, isGrouped]);\n\n  const metricKeysToFetch = useMemo(() => {\n    const getYAxisKeys = (cardConfig: RunsChartsLineCardConfig) => {\n      const fallback = [cardConfig.metricKey];\n      if (!shouldEnableChartExpressions() || cardConfig.yAxisKey !== RunsChartsLineChartYAxisType.EXPRESSION) {\n        return cardConfig.selectedMetricKeys ?? fallback;\n      }\n      const yAxisKeys = cardConfig.yAxisExpressions?.reduce((acc, exp) => {\n        exp.variables.forEach((variable) => acc.add(variable));\n        return acc;\n      }, new Set<string>());\n      return yAxisKeys === undefined ? fallback : Array.from(yAxisKeys);\n    };\n    const yAxisKeys = getYAxisKeys(cardConfig);\n    const xAxisKeys = !selectedXAxisMetricKey ? [] : [selectedXAxisMetricKey];\n    return yAxisKeys.concat(xAxisKeys);\n  }, [cardConfig, selectedXAxisMetricKey]);\n\n  const { resultsByRunUuid, isLoading } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys: metricKeysToFetch,\n    enabled: true,\n    maxResults: 320,\n    autoRefreshEnabled: false,\n  });\n\n  const sampledData = useMemo(\n    () =>\n      previewData.map((run) => {\n        const metricsHistory = metricKeysToFetch.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = cardConfig.ignoreOutliers ? removeOutliersFromMetricHistory(history) : history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeysToFetch, resultsByRunUuid, previewData, cardConfig.ignoreOutliers],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys: metricKeysToFetch,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey: xAxisKey === RunsChartsLineChartXAxisType.METRIC ? selectedXAxisMetricKey : undefined,\n    ignoreOutliers: cardConfig.ignoreOutliers ?? false,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(\n    cardConfig,\n    RunsChartsTooltipMode.MultipleTracesWithScanline,\n  );\n\n  if (isLoading) {\n    return <RunsChartCardLoadingPlaceholder />;\n  }\n\n  const checkValidRange = (\n    rangeMin: number | undefined,\n    rangeMax: number | undefined,\n  ): [number, number] | undefined => {\n    if (isUndefined(rangeMin) || isUndefined(rangeMax)) {\n      return undefined;\n    }\n    return [rangeMin, rangeMax];\n  };\n\n  const xRange = checkValidRange(cardConfig.range?.xMin, cardConfig.range?.xMax);\n  const yRange = checkValidRange(cardConfig.range?.yMin, cardConfig.range?.yMax);\n\n  return (\n    <RunsMetricsLinePlot\n      runsData={chartData}\n      metricKey={cardConfig.metricKey}\n      selectedMetricKeys={cardConfig.selectedMetricKeys}\n      scaleType={cardConfig.scaleType}\n      xAxisScaleType={cardConfig.xAxisScaleType}\n      lineSmoothness={lineSmoothness}\n      xAxisKey={xAxisKey}\n      selectedXAxisMetricKey={selectedXAxisMetricKey}\n      displayPoints={cardConfig.displayPoints}\n      yAxisExpressions={cardConfig.yAxisExpressions}\n      yAxisKey={cardConfig.yAxisKey}\n      useDefaultHoverBox={false}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      xRange={xRange}\n      yRange={yRange}\n    />\n  );\n};\n\nconst mapStateToProps = ({ entities: { metricsByRunUuid } }: ReduxState) => ({\n  metricsByRunUuid,\n});\n\n/**\n * Preview of line chart used in compare runs configuration modal\n */\nexport const RunsChartsConfigureLineChartPreview = connect(mapStateToProps, undefined, undefined, {\n  areStatesEqual: (nextState, prevState) => nextState.entities.metricsByRunUuid === prevState.entities.metricsByRunUuid,\n})(RunsChartsConfigureLineChartPreviewImpl);\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot from '../charts/LazyParallelCoordinatesPlot';\nimport { isParallelChartConfigured, processParallelCoordinateData } from '../../utils/parallelCoordinatesPlot.utils';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { Empty, NoIcon } from '@databricks/design-system';\nimport { RunsChartCardLoadingPlaceholder } from '../cards/ChartCard.common';\n\nexport const RunsChartsConfigureParallelChartPreview = ({\n  previewData,\n  cardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsParallelCardConfig;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  const isConfigured = isParallelChartConfigured(cardConfig);\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(cardConfig);\n\n  const containsStringValues = useMemo(\n    () =>\n      cardConfig.selectedParams?.some(\n        (paramKey) => previewData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [cardConfig.selectedParams, previewData],\n      ),\n    [cardConfig.selectedParams, previewData],\n  );\n\n  if (containsStringValues && groupBy) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center', textAlign: 'center' }}>\n        <FormattedMessage\n          defaultMessage=\"Parallel coordinates chart does not support aggregated string values. Use other parameters or disable run grouping to continue.\"\n          description=\"Experiment page > compare runs > parallel coordinates chart configuration modal > unsupported string values warning\"\n        />\n      </div>\n    );\n  }\n\n  const filteredData = isConfigured\n    ? processParallelCoordinateData(previewData, cardConfig.selectedParams, cardConfig.selectedMetrics)\n    : [];\n\n  if (!isConfigured) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n        Select at least two metrics and params first\n      </div>\n    );\n  }\n\n  return filteredData.length ? (\n    /* Avoid displaying empty set, otherwise parcoord-es crashes */\n    <LazyParallelCoordinatesPlot\n      selectedMetrics={cardConfig.selectedMetrics}\n      selectedParams={cardConfig.selectedParams}\n      data={filteredData}\n      axesRotateThreshold={6}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      fallback={<RunsChartCardLoadingPlaceholder />}\n    />\n  ) : (\n    <Empty\n      description={\n        <FormattedMessage\n          defaultMessage=\"No matching data found for the available runs.\"\n          description=\"Experiment tracking > runs charts > parallel coordinates chart preview > no data found description\"\n        />\n      }\n      image={<NoIcon />}\n    />\n  );\n};\n","import { useCallback, useEffect } from 'react';\nimport { useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport { RunsChartsMetricParamSelect, RunsChartsConfigureField } from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsContourCardConfig, 'xaxis' | 'yaxis' | 'zaxis'>;\n\n/**\n * Form containing configuration controls for Contour runs compare chart.\n */\nexport const RunsChartsConfigureContourChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsContourCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsContourCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n    if (!state.zaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'zaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'zaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, state.zaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Z axis',\n          description: 'Label for Z axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.zaxis.key ? makeCanonicalSortKey(state.zaxis.type, state.zaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'zaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { useCallback, useEffect } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsMetricParamSelect,\n  RunsChartsConfigureField,\n  runsChartsRunCountDefaultOptions,\n} from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsScatterCardConfig, 'xaxis' | 'yaxis'>;\n\nconst scatterPlotDefaultOptions = runsChartsRunCountDefaultOptions;\nscatterPlotDefaultOptions.push(\n  {\n    value: 100,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"100\"\n        description=\"Label for 100 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 250,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"250\"\n        description=\"Label for 250 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 500,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"500\"\n        description=\"Label for 500 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n);\n\n/**\n * Form containing configuration controls for scatter runs compare chart.\n */\nexport const RunsChartsConfigureScatterChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsScatterCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsScatterCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import {\n  Checkbox,\n  Input,\n  Switch,\n  useDesignSystemTheme,\n  LegacyTooltip,\n  InfoSmallIcon,\n  LegacyInfoTooltip,\n} from '@databricks/design-system';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { useCallback } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\n/**\n * Form containing configuration controls for runs compare difference view chart.\n */\nexport const RunsChartsConfigureDifferenceChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n  groupBy,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsDifferenceCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  /**\n   * Callback for updating compare groups\n   */\n  const updateCompareGroups = useCallback(\n    (compareGroup: DifferenceCardConfigCompareGroup) => {\n      onStateChange((current) => {\n        const currentConfig = current as RunsChartsDifferenceCardConfig;\n        const compareGroups = currentConfig.compareGroups;\n        if (compareGroups.includes(compareGroup)) {\n          return {\n            ...(current as RunsChartsDifferenceCardConfig),\n            compareGroups: compareGroups.filter((group) => group !== compareGroup),\n          };\n        } else {\n          return { ...(current as RunsChartsDifferenceCardConfig), compareGroups: [...compareGroups, compareGroup] };\n        }\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateChartName = useCallback(\n    (e) => onStateChange((current) => ({ ...(current as RunsChartsDifferenceCardConfig), chartName: e.target.value })),\n    [onStateChange],\n  );\n\n  const updateShowChangeFromBaseline = useCallback(\n    (showChangeFromBaseline: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showChangeFromBaseline,\n      })),\n    [onStateChange],\n  );\n\n  const updateShowDifferencesOnly = useCallback(\n    (showDifferencesOnly: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showDifferencesOnly,\n      })),\n    [onStateChange],\n  );\n\n  const { theme } = useDesignSystemTheme();\n  const { formatMessage } = useIntl();\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Compare',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Compare config section',\n        })}\n      >\n        <Checkbox.Group id=\"checkbox-group\" defaultValue={state.compareGroups}>\n          {Object.values(DifferenceCardConfigCompareGroup).map((group) => {\n            const groupedCondition = groupBy ? DISABLED_GROUP_WHEN_GROUPBY.includes(group) : false;\n            return (\n              <div css={{ display: 'inline-flex', alignItems: 'center' }} key={group}>\n                <Checkbox\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_98\"\n                  key={group}\n                  value={group}\n                  isChecked={state.compareGroups?.includes(group)}\n                  onChange={() => updateCompareGroups(group)}\n                  disabled={groupedCondition}\n                >\n                  {group}\n                </Checkbox>\n                {groupedCondition && (\n                  <LegacyInfoTooltip\n                    title={\n                      <FormattedMessage\n                        defaultMessage=\"Disable grouped runs to compare\"\n                        description=\"Experiment tracking > components > runs-charts > RunsChartsConfigureDifferenceCharts > disable grouped runs info message\"\n                      />\n                    }\n                  />\n                )}\n              </div>\n            );\n          })}\n        </Checkbox.Group>\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            padding: `${theme.spacing.md}px 0px`,\n            gap: theme.spacing.sm,\n          }}\n        >\n          <Switch\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_129\"\n            checked={state.showChangeFromBaseline}\n            onChange={updateShowChangeFromBaseline}\n            label={formatMessage({\n              defaultMessage: 'Show change from baseline',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show change from baseline toggle',\n            })}\n          />\n          <Switch\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_138\"\n            checked={state.showDifferencesOnly}\n            onChange={updateShowDifferencesOnly}\n            label={formatMessage({\n              defaultMessage: 'Show differences only',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show differences only toggle',\n            })}\n          />\n        </div>\n      </RunsChartsConfigureField>\n\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Chart name',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Chart name config section',\n        })}\n      >\n        <Input\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_157\"\n          value={state.chartName}\n          onChange={updateChartName}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { useCallback } from 'react';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { Input } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { DialogCombobox } from '@databricks/design-system';\nimport { DialogComboboxContent } from '@databricks/design-system';\nimport { DialogComboboxTrigger } from '@databricks/design-system';\nimport { DialogComboboxOptionListCheckboxItem } from '@databricks/design-system';\nimport { DialogComboboxOptionList } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\n\nexport const RunsChartsConfigureImageChart = ({\n  previewData,\n  state,\n  onStateChange,\n  imageKeyList,\n}: {\n  previewData: RunsChartsRunData[];\n  imageKeyList: string[];\n  state: Partial<RunsChartsImageCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n}) => {\n  const IMAGE_CONFIG_WIDTH = 275;\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: previewData,\n    selectedImageKeys: state.imageKeys || [],\n  });\n\n  const updateImageKeys = useCallback(\n    (imageKeys: string[]) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), imageKeys };\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateStep = useCallback(\n    (step: number) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), step };\n      });\n    },\n    [onStateChange],\n  );\n\n  const { formatMessage } = useIntl();\n\n  const handleUpdate = (imageKey: string) => {\n    onStateChange((current) => {\n      const currentConfig = current as RunsChartsImageCardConfig;\n      if (currentConfig.imageKeys?.includes(imageKey)) {\n        return {\n          ...currentConfig,\n          imageKeys: currentConfig.imageKeys?.filter((key) => key !== imageKey),\n        };\n      } else {\n        return { ...currentConfig, imageKeys: [...(currentConfig.imageKeys || []), imageKey] };\n      }\n    });\n  };\n\n  const handleClear = () => {\n    onStateChange((current) => {\n      return { ...(current as RunsChartsImageCardConfig), imageKeys: [] };\n    });\n  };\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Images',\n          description: 'Runs charts > components > config > RunsChartsConfigureImageGrid > Images section',\n        })}\n      >\n        <DialogCombobox\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigureimagechart.tsx_84\"\n          value={state.imageKeys}\n          label=\"Images\"\n          multiSelect\n        >\n          <DialogComboboxTrigger onClear={handleClear} minWidth={IMAGE_CONFIG_WIDTH} />\n          <DialogComboboxContent matchTriggerWidth>\n            <DialogComboboxOptionList>\n              {imageKeyList.map((imageKey) => {\n                return (\n                  <DialogComboboxOptionListCheckboxItem\n                    key={imageKey}\n                    value={imageKey}\n                    onChange={handleUpdate}\n                    checked={state.imageKeys?.includes(imageKey)}\n                  />\n                );\n              })}\n            </DialogComboboxOptionList>\n          </DialogComboboxContent>\n        </DialogCombobox>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Step\">\n        <LineSmoothSlider\n          max={maxMark}\n          min={minMark}\n          marks={stepMarks}\n          value={state.step}\n          disabled={Object.keys(stepMarks).length <= 1}\n          onChange={updateStep}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { LOG_IMAGE_TAG_INDICATOR } from '../../../../constants';\n\nexport const RunsChartsConfigureImageChartPreview = ({\n  previewData,\n  cardConfig,\n  setCardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  setCardConfig: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  const containsLoggedImages = previewData.some((run: RunsChartsRunData) => Boolean(run.tags[LOG_IMAGE_TAG_INDICATOR]));\n\n  if (containsLoggedImages && cardConfig?.imageKeys?.length === 0) {\n    return (\n      <Empty\n        title={\n          <FormattedMessage\n            defaultMessage=\"No images configured for preview\"\n            description=\"Title for the empty state when user did not configure any images for preview yet\"\n          />\n        }\n        description={\n          <FormattedMessage\n            defaultMessage=\"Please use controls on the left to select images to be compared\"\n            description=\"Description for the empty state when user did not configure any images for preview yet\"\n          />\n        }\n      />\n    );\n  }\n\n  const chartBody = (\n    <ImageGridPlot previewData={previewData} cardConfig={cardConfig} setCardConfig={setCardConfig} groupBy={groupBy} />\n  );\n\n  const cardBodyToRender = chartBody;\n\n  return <div css={{ width: '100%', overflow: 'auto hidden' }}>{cardBodyToRender}</div>;\n};\n","import { useCallback, useEffect, useMemo } from 'react';\nimport { useIntl } from 'react-intl';\nimport type {\n  RunsChartsCardConfig,\n  RunsChartsMetricByDatasetEntry,\n  RunsChartsScatterCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField, RunsChartsMetricParamSelectV2 } from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsScatterCardConfig, 'xaxis' | 'yaxis'>;\n\n/**\n * Form containing configuration controls for scatter runs compare chart.\n */\nexport const RunsChartsConfigureScatterChartWithDatasets = ({\n  state,\n  onStateChange,\n  paramKeyList,\n  metricKeysByDataset,\n}: {\n  paramKeyList: string[];\n  metricKeysByDataset: RunsChartsMetricByDatasetEntry[] | undefined;\n  state: RunsChartsScatterCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsScatterCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n\n  const metricOptions = useMemo(\n    () =>\n      metricKeysByDataset?.map(({ dataAccessKey, metricKey, datasetName }) => ({\n        key: JSON.stringify(['METRIC', dataAccessKey]),\n        dataAccessKey,\n        datasetName,\n        metricKey,\n      })) ?? [],\n    [metricKeysByDataset],\n  );\n\n  const paramOptions = useMemo(\n    () =>\n      paramKeyList?.map((paramKey) => ({\n        key: JSON.stringify(['PARAM', paramKey]),\n        paramKey,\n      })) ?? [],\n    [paramKeyList],\n  );\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const handleChange = useCallback(\n    (axis: ValidAxis) => (value: string) => {\n      const foundMetric = metricOptions.find(({ key }) => key === value);\n      if (foundMetric) {\n        const { dataAccessKey, datasetName, metricKey } = foundMetric;\n        onStateChange((current) => ({\n          ...(current as RunsChartsScatterCardConfig),\n          [axis]: { key: metricKey, type: 'METRIC', datasetName, dataAccessKey },\n        }));\n      }\n      const foundParam = paramOptions.find(({ key }) => key === value);\n      if (foundParam) {\n        onStateChange((current) => ({\n          ...(current as RunsChartsScatterCardConfig),\n          [axis]: { key: foundParam.paramKey, type: 'PARAM' },\n        }));\n      }\n    },\n    [onStateChange, metricOptions, paramOptions],\n  );\n\n  useEffect(() => {\n    // For each axis: if there is no selected value, select the first available option\n    for (const axis of ['xaxis', 'yaxis'] as const) {\n      if (!state[axis]?.key) {\n        if (metricOptions?.[0]) {\n          handleChange(axis)(metricOptions[0].key);\n        } else if (paramOptions?.[0]) {\n          handleChange(axis)(paramOptions[0].key);\n        }\n      }\n    }\n  }, [state, metricOptions, paramOptions, handleChange]);\n\n  const getSelectedValue = useCallback(\n    (axis: ValidAxis) => {\n      if (state[axis].type === 'METRIC') {\n        const foundMetricOption = metricOptions.find(\n          ({ dataAccessKey }) => dataAccessKey === state[axis].dataAccessKey,\n        );\n        if (foundMetricOption) {\n          return foundMetricOption.key;\n        }\n      }\n      if (state[axis].type === 'PARAM') {\n        const foundParamOption = paramOptions.find(({ paramKey }) => paramKey === state[axis].key);\n        if (foundParamOption) {\n          return foundParamOption.key;\n        }\n      }\n      return '';\n    },\n    [state, metricOptions, paramOptions],\n  );\n\n  const selectedXValue = useMemo(() => getSelectedValue('xaxis'), [getSelectedValue]);\n  const selectedYValue = useMemo(() => getSelectedValue('yaxis'), [getSelectedValue]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelectV2\n          value={selectedXValue}\n          onChange={handleChange('xaxis')}\n          metricOptions={metricOptions}\n          paramOptions={paramOptions}\n          id=\"mlflow.charts.chart_configure.scatter.x_axis\"\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelectV2\n          value={selectedYValue}\n          onChange={handleChange('yaxis')}\n          metricOptions={metricOptions}\n          paramOptions={paramOptions}\n          id=\"mlflow.charts.chart_configure.scatter.y_axis\"\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","/**\n * TODO: implement actual UI for this modal, it's a crude placeholder with minimal logic for now\n */\nimport { Modal, useDesignSystemTheme, SimpleSelect, SimpleSelectOption } from '@databricks/design-system';\nimport { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n  type RunsChartsMetricByDatasetEntry,\n} from '../runs-charts.types';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartsConfigureBarChart } from './config/RunsChartsConfigureBarChart';\nimport { RunsChartsConfigureParallelChart } from './config/RunsChartsConfigureParallelChart';\nimport type { RunsChartsRunData } from './RunsCharts.common';\nimport { RunsChartsConfigureField } from './config/RunsChartsConfigure.common';\nimport { RunsChartsConfigureLineChart } from './config/RunsChartsConfigureLineChart';\nimport { RunsChartsConfigureLineChartPreview } from './config/RunsChartsConfigureLineChart.preview';\nimport { RunsChartsConfigureBarChartPreview } from './config/RunsChartsConfigureBarChart.preview';\nimport { RunsChartsConfigureContourChartPreview } from './config/RunsChartsConfigureContourChart.preview';\nimport { RunsChartsConfigureScatterChartPreview } from './config/RunsChartsConfigureScatterChart.preview';\nimport { RunsChartsConfigureParallelChartPreview } from './config/RunsChartsConfigureParallelChart.preview';\nimport { RunsChartsConfigureContourChart } from './config/RunsChartsConfigureContourChart';\nimport { RunsChartsConfigureScatterChart } from './config/RunsChartsConfigureScatterChart';\nimport { RunsChartsTooltipBody } from './RunsChartsTooltipBody';\nimport { RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport { RunsChartsConfigureDifferenceChart } from './config/RunsChartsConfigureDifferenceChart';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsConfigureImageChart } from './config/RunsChartsConfigureImageChart';\nimport { RunsChartsConfigureImageChartPreview } from './config/RunsChartsConfigureImageChart.preview';\nimport type { RunsChartsGlobalLineChartConfig } from '../../experiment-page/models/ExperimentPageUIState';\nimport { isEmpty } from 'lodash';\nimport { RunsChartsConfigureScatterChartWithDatasets } from './config/RunsChartsConfigureScatterChartWithDatasets';\nimport { DifferenceViewPlot } from './charts/DifferenceViewPlot';\n\nconst previewComponentsMap: Record<\n  RunsChartType,\n  React.FC<{\n    previewData: RunsChartsRunData[];\n    cardConfig: any;\n    groupBy: RunsGroupByConfig | null;\n    globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n    setCardConfig: (\n      setter: (\n        current: RunsChartsCardConfig,\n      ) => RunsChartsDifferenceCardConfig | RunsChartsImageCardConfig | RunsChartsLineCardConfig,\n    ) => void;\n  }>\n> = {\n  [RunsChartType.BAR]: RunsChartsConfigureBarChartPreview,\n  [RunsChartType.CONTOUR]: RunsChartsConfigureContourChartPreview,\n  [RunsChartType.LINE]: RunsChartsConfigureLineChartPreview,\n  [RunsChartType.PARALLEL]: RunsChartsConfigureParallelChartPreview,\n  [RunsChartType.SCATTER]: RunsChartsConfigureScatterChartPreview,\n  [RunsChartType.DIFFERENCE]: DifferenceViewPlot,\n  [RunsChartType.IMAGE]: RunsChartsConfigureImageChartPreview,\n};\n\nexport const RunsChartsConfigureModal = ({\n  onCancel,\n  onSubmit,\n  config,\n  chartRunData,\n  metricKeyList,\n  metricKeysByDataset,\n  paramKeyList,\n  groupBy,\n  supportedChartTypes,\n  globalLineChartConfig,\n}: {\n  metricKeyList: string[];\n  metricKeysByDataset?: RunsChartsMetricByDatasetEntry[];\n  paramKeyList: string[];\n  config: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onCancel: () => void;\n  groupBy: RunsGroupByConfig | null;\n  onSubmit: (formData: Partial<RunsChartsCardConfig>) => void;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  const { theme } = useDesignSystemTheme();\n  const borderStyle = `1px solid ${theme.colors.actionDefaultBorderDefault}`;\n  const [currentFormState, setCurrentFormState] = useState<RunsChartsCardConfig>(config);\n\n  const isEditing = Boolean(currentFormState.uuid);\n\n  const updateChartType = useCallback((type?: RunsChartType) => {\n    if (!type) {\n      return;\n    }\n    const emptyChartCard = RunsChartsCardConfig.getEmptyChartCardByType(type, true);\n    if (emptyChartCard) {\n      setCurrentFormState(emptyChartCard);\n    }\n  }, []);\n\n  const previewData = useMemo(() => chartRunData.filter(({ hidden }) => !hidden).reverse(), [chartRunData]);\n\n  const imageKeyList = useMemo(() => {\n    const imageKeys = new Set<string>();\n    previewData.forEach((run) => {\n      Object.keys(run.images).forEach((imageKey) => {\n        imageKeys.add(imageKey);\n      });\n    });\n    return Array.from(imageKeys).sort();\n  }, [previewData]);\n\n  const renderConfigOptionsforChartType = (type?: RunsChartType) => {\n    if (type === RunsChartType.BAR) {\n      return (\n        <RunsChartsConfigureBarChart\n          metricKeyList={metricKeyList}\n          metricKeysByDataset={metricKeysByDataset}\n          state={currentFormState as RunsChartsBarCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.CONTOUR) {\n      return (\n        <RunsChartsConfigureContourChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsContourCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.LINE) {\n      return (\n        <RunsChartsConfigureLineChart\n          metricKeyList={metricKeyList}\n          state={currentFormState as RunsChartsLineCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.PARALLEL) {\n      return (\n        <RunsChartsConfigureParallelChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsParallelCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.SCATTER) {\n      if (!isEmpty(metricKeysByDataset)) {\n        return (\n          <RunsChartsConfigureScatterChartWithDatasets\n            paramKeyList={paramKeyList}\n            metricKeysByDataset={metricKeysByDataset}\n            state={currentFormState as RunsChartsScatterCardConfig}\n            onStateChange={setCurrentFormState}\n          />\n        );\n      }\n      return (\n        <RunsChartsConfigureScatterChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsScatterCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.DIFFERENCE) {\n      return (\n        <RunsChartsConfigureDifferenceChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsDifferenceCardConfig}\n          onStateChange={setCurrentFormState}\n          groupBy={groupBy}\n        />\n      );\n    }\n    if (type === RunsChartType.IMAGE) {\n      return (\n        <RunsChartsConfigureImageChart\n          previewData={previewData}\n          imageKeyList={imageKeyList}\n          state={currentFormState as RunsChartsImageCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    return null;\n  };\n\n  const renderPreviewChartType = (type?: RunsChartType) => {\n    if (!type) {\n      return null;\n    }\n    const PreviewComponent = previewComponentsMap[type];\n    if (!PreviewComponent) {\n      return null;\n    }\n    return (\n      <PreviewComponent\n        previewData={previewData}\n        cardConfig={currentFormState}\n        groupBy={groupBy}\n        setCardConfig={setCurrentFormState}\n        globalLineChartConfig={globalLineChartConfig}\n      />\n    );\n  };\n\n  const { formatMessage } = useIntl();\n\n  let disableSaveButton = false;\n  if (currentFormState.type === RunsChartType.LINE) {\n    const lineCardConfig = currentFormState as RunsChartsLineCardConfig;\n    disableSaveButton = (lineCardConfig.selectedMetricKeys ?? []).length === 0;\n  }\n\n  return (\n    <Modal\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsconfiguremodal.tsx_232\"\n      visible\n      onCancel={onCancel}\n      onOk={() => onSubmit(currentFormState)}\n      title={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Edit chart',\n              description: 'Title of the modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add new chart',\n              description: 'Title of the modal when adding a new runs comparison chart',\n            })\n      }\n      okButtonProps={{\n        'data-testid': 'experiment-view-compare-runs-chart-modal-confirm',\n        disabled: disableSaveButton,\n      }}\n      cancelText={formatMessage({\n        defaultMessage: 'Cancel',\n        description: 'Cancel button label within a modal for adding/editing a new runs comparison chart',\n      })}\n      okText={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Save changes',\n              description: 'Confirm button label within a modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add chart',\n              description: 'Confirm button label within a modal when adding a new runs comparison chart',\n            })\n      }\n      size=\"wide\"\n      css={{ width: 1280 }}\n      dangerouslySetAntdProps={{\n        bodyStyle: {\n          overflowY: 'hidden',\n          display: 'flex',\n        },\n      }}\n    >\n      <div\n        css={{\n          // TODO: wait for modal dimensions decision\n          display: 'flex',\n          width: '100%',\n          gridTemplateColumns: '300px 1fr',\n          gap: theme.spacing.md,\n          borderTop: borderStyle,\n          borderBottom: borderStyle,\n        }}\n      >\n        <div\n          css={{\n            overflowY: 'auto',\n            borderRight: borderStyle,\n            padding: `${theme.spacing.md}px ${theme.spacing.md}px ${theme.spacing.md}px 0px`,\n            width: '300px',\n          }}\n        >\n          {!isEditing && (\n            <RunsChartsConfigureField title=\"Chart type\">\n              <SimpleSelect\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsconfiguremodal.tsx_296\"\n                id=\"chart-type-select\"\n                css={{ width: '100%' }}\n                value={currentFormState.type}\n                onChange={({ target }) => {\n                  const chartType = target.value as RunsChartType;\n                  Object.values(RunsChartType).includes(chartType) && updateChartType(chartType);\n                }}\n              >\n                {isChartTypeSupported(RunsChartType.BAR) && (\n                  <SimpleSelectOption value={RunsChartType.BAR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartBarIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Bar chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.SCATTER) && (\n                  <SimpleSelectOption value={RunsChartType.SCATTER}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartScatterIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Scatter chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.LINE) && (\n                  <SimpleSelectOption value={RunsChartType.LINE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartLineIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Line chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.PARALLEL) && (\n                  <SimpleSelectOption value={RunsChartType.PARALLEL}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartParallelIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Parallel coordinates\"\n                        description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.CONTOUR) && (\n                  <SimpleSelectOption value={RunsChartType.CONTOUR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartContourIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Contour chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n                  <SimpleSelectOption value={RunsChartType.DIFFERENCE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartDifferenceIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Difference view\"\n                        description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.IMAGE) && (\n                  <SimpleSelectOption value={RunsChartType.IMAGE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartImageIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Image grid\"\n                        description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n              </SimpleSelect>\n            </RunsChartsConfigureField>\n          )}\n          {renderConfigOptionsforChartType(currentFormState.type)}\n        </div>\n        <div css={{ overflow: 'auto', flexGrow: 1 }}>\n          <RunsChartsTooltipWrapper contextData={{ runs: chartRunData }} component={RunsChartsTooltipBody} hoverOnly>\n            <div\n              css={{\n                minHeight: 500,\n                height: '100%',\n                width: 500,\n                padding: '32px 0px',\n              }}\n            >\n              {renderPreviewChartType(currentFormState.type)}\n            </div>\n          </RunsChartsTooltipWrapper>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nconst styles = {\n  chartTypeOption: (theme: Theme) =>\n    ({\n      display: 'grid',\n      gridTemplateColumns: `${theme.general.iconSize + theme.spacing.xs}px 1fr`,\n      gap: theme.spacing.xs,\n      alignItems: 'center',\n    } as Interpolation<Theme>),\n  field: {\n    // TODO: wait for modal dimensions decision\n    display: 'grid',\n    gridTemplateColumns: '80px 1fr',\n    marginBottom: 16,\n  } as Interpolation<Theme>,\n};\n","import { barChartCardDefaultMargin } from '../cards/RunsChartsBarChartCard';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsBarCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureBarChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsBarCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  const dataKey = cardConfig.dataAccessKey ?? cardConfig.metricKey;\n\n  return (\n    <RunsMetricsBarPlot\n      useDefaultHoverBox={false}\n      displayRunNames={false}\n      displayMetricKey={false}\n      metricKey={dataKey}\n      runsData={previewData}\n      margin={barChartCardDefaultMargin}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  );\n};\n","import { useMemo } from 'react';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsContourCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureContourChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsContourCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  // We need to re-render the chart when any axis config changes.\n  // Plotly tries to determine axis format based on values and is not capable\n  // of dynamic switching between different axis types, so we need to make sure\n  // that we re-mount the chart when config changes.\n  const key = useMemo(() => {\n    const { xaxis, yaxis, zaxis } = cardConfig;\n    return JSON.stringify({ xaxis, yaxis, zaxis });\n  }, [cardConfig]);\n\n  return (\n    <RunsContourPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      zAxis={cardConfig.zaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n      key={key}\n    />\n  );\n};\n","import { useMemo } from 'react';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsScatterCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureScatterChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsScatterCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  // We need to re-render the chart when the x or y axis changes.\n  // Plotly tries to determine axis format based on values and is not capable\n  // of dynamic switching between different axis types, so we need to make sure\n  // that we re-mount the chart when config changes.\n  const key = useMemo(() => {\n    const { xaxis, yaxis } = cardConfig;\n    return JSON.stringify({ xaxis, yaxis });\n  }, [cardConfig]);\n\n  return (\n    <RunsScatterPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n      key={key}\n    />\n  );\n};\n","export const RUNS_CHARTS_UI_Z_INDEX = {\n  CARD_PREVIEW: 1,\n  CARD_DRAGGED: 2,\n  TOOLTIP_CONTAINER: 3,\n  SEARCH_BAR: 3,\n  TOOLTIP: 4,\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport React, { Suspense } from 'react';\n\nconst ParallelCoordinatesPlot = React.lazy(() => import('./ParallelCoordinatesPlot'));\n\nconst LazyParallelCoordinatesPlot = ({ fallback, ...props }: any) => {\n  return (\n    <Suspense fallback={fallback ?? <LegacySkeleton />}>\n      <ParallelCoordinatesPlot {...props} />\n    </Suspense>\n  );\n};\n\nexport default LazyParallelCoordinatesPlot;\n","import React, { ReactNode, useMemo } from 'react';\nimport { ExperimentPageUIState, createExperimentPageUIState } from '../models/ExperimentPageUIState';\n\nconst ExperimentPageUISetStateContext = React.createContext<\n  React.Dispatch<React.SetStateAction<ExperimentPageUIState>>\n>((state) => state);\n\n// Creates contexts for setting current UI state\nexport const ExperimentPageUIStateContextProvider = ({\n  children,\n  setUIState,\n}: {\n  children: ReactNode;\n  setUIState: React.Dispatch<React.SetStateAction<ExperimentPageUIState>>;\n}) => (\n  <ExperimentPageUISetStateContext.Provider value={setUIState}>{children}</ExperimentPageUISetStateContext.Provider>\n);\n\nexport const useUpdateExperimentViewUIState = () => React.useContext(ExperimentPageUISetStateContext);\n","import { useCallback, useRef } from 'react';\nimport { useUpdateExperimentViewUIState } from '../contexts/ExperimentPageUIStateContext';\nimport { RUNS_VISIBILITY_MODE } from '../models/ExperimentPageUIState';\nimport type { RunRowType } from '../utils/experimentPage.row-types';\nimport {\n  shouldEnableToggleIndividualRunsInGroups,\n  shouldUseRunRowsVisibilityMap,\n} from '../../../../common/utils/FeatureUtils';\n\nexport const useToggleRowVisibilityCallback = (tableRows: RunRowType[], useGroupedValuesInCharts = true) => {\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  // We're going to use current state of the table rows to determine which rows are hidden.\n  // Since we're interested only in the latest data, we avoid using state here to avoid unnecessary re-renders.\n  const immediateTableRows = useRef(tableRows);\n  immediateTableRows.current = tableRows;\n\n  const toggleRowUsingVisibilityMap = useCallback(\n    (mode: RUNS_VISIBILITY_MODE, groupOrRunUuid?: string, isCurrentlyVisible?: boolean) => {\n      updateUIState((currentUIState) => {\n        // If user has toggled a run or a group manually, we need to update the visibility map\n        if (mode === RUNS_VISIBILITY_MODE.CUSTOM && groupOrRunUuid) {\n          const newRunsVisibilityMap = {\n            ...currentUIState.runsVisibilityMap,\n          };\n\n          // Check if the toggles row is a run group\n          const currentToggledGroupInfo = immediateTableRows.current.find(\n            ({ rowUuid, groupParentInfo }) => rowUuid === groupOrRunUuid && groupParentInfo,\n          )?.groupParentInfo;\n\n          // If we're toggling a group and we're not using grouped values in charts,\n          // then toggle all runs in the group\n          if (\n            currentToggledGroupInfo &&\n            shouldEnableToggleIndividualRunsInGroups() &&\n            useGroupedValuesInCharts === false\n          ) {\n            for (const runUuid of currentToggledGroupInfo.runUuids) {\n              newRunsVisibilityMap[runUuid] = !isCurrentlyVisible;\n            }\n          } else {\n            newRunsVisibilityMap[groupOrRunUuid] = !isCurrentlyVisible;\n          }\n\n          return {\n            ...currentUIState,\n            runsVisibilityMap: newRunsVisibilityMap,\n          };\n        }\n        // Otherwise, we're toggling a predefined visibility mode\n        // and clearing the visibility map\n        if (\n          [\n            RUNS_VISIBILITY_MODE.SHOWALL,\n            RUNS_VISIBILITY_MODE.HIDEALL,\n            RUNS_VISIBILITY_MODE.FIRST_10_RUNS,\n            RUNS_VISIBILITY_MODE.FIRST_20_RUNS,\n          ].includes(mode)\n        ) {\n          return {\n            ...currentUIState,\n            runsHiddenMode: mode,\n            runsHidden: [],\n            runsVisibilityMap: {},\n          };\n        }\n\n        return currentUIState;\n      });\n    },\n    [updateUIState, useGroupedValuesInCharts],\n  );\n\n  /**\n   * @deprecated `toggleRowUsingVisibilityMap` replaces this function.\n   * This one should be removed after ramping up `runsVisibility` field.\n   */\n  const toggleRowVisibility = useCallback(\n    (mode: RUNS_VISIBILITY_MODE, groupOrRunUuid?: string) => {\n      updateUIState((currentUIState) => {\n        if (mode === RUNS_VISIBILITY_MODE.SHOWALL) {\n          // Case #1: Showing all runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.SHOWALL,\n            runsHidden: [],\n          };\n        } else if (mode === RUNS_VISIBILITY_MODE.HIDEALL) {\n          // Case #2: Hiding all runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.HIDEALL,\n            runsHidden: [],\n          };\n        } else if (mode === RUNS_VISIBILITY_MODE.FIRST_10_RUNS) {\n          // Case #3: Showing only first 10 runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.FIRST_10_RUNS,\n            runsHidden: [],\n          };\n        } else if (mode === RUNS_VISIBILITY_MODE.FIRST_20_RUNS) {\n          // Case #4: Showing only first 20 runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.FIRST_20_RUNS,\n            runsHidden: [],\n          };\n        }\n\n        // Case #5: Custom visibility mode enabled by manually toggling visibility of a run or a group\n        if (groupOrRunUuid) {\n          // Determine which runs are hidden at the moment\n          const currentlyHiddenRows = immediateTableRows.current\n            .filter(({ hidden }) => hidden)\n            .map(({ groupParentInfo, rowUuid, runUuid }) => (groupParentInfo ? rowUuid : runUuid));\n\n          // Check if the toggles row is a run group\n          const currentToggledGroupInfo = immediateTableRows.current.find(\n            ({ rowUuid, groupParentInfo }) => rowUuid === groupOrRunUuid && groupParentInfo,\n          )?.groupParentInfo;\n\n          // If we're toggling a group and we're not using grouped values in charts,\n          // then toggle all runs in the group\n          if (\n            currentToggledGroupInfo &&\n            shouldEnableToggleIndividualRunsInGroups() &&\n            useGroupedValuesInCharts === false\n          ) {\n            let newHiddenRows: string[] = [];\n\n            // Depending on the current state of the group, we either show all runs or hide all runs\n            if (currentToggledGroupInfo.allRunsHidden) {\n              newHiddenRows = currentlyHiddenRows.filter(\n                (currentGroupOrRunUuid) => !currentToggledGroupInfo.runUuids.includes(currentGroupOrRunUuid),\n              );\n            } else {\n              newHiddenRows = currentlyHiddenRows.concat(\n                currentToggledGroupInfo.runUuids.filter((runUuid) => !currentlyHiddenRows.includes(runUuid)),\n              );\n            }\n            return {\n              ...currentUIState,\n              // Set mode to \"custom\"\n              runsHiddenMode: RUNS_VISIBILITY_MODE.CUSTOM,\n              runsHidden: newHiddenRows,\n            };\n          }\n\n          // Toggle visibility of a run/group by either adding or removing from the array\n          const newHiddenRows = currentlyHiddenRows.includes(groupOrRunUuid)\n            ? currentlyHiddenRows.filter((currentGroupOrRunUuid) => currentGroupOrRunUuid !== groupOrRunUuid)\n            : [...currentlyHiddenRows, groupOrRunUuid];\n\n          return {\n            ...currentUIState,\n            // Set mode to \"custom\"\n            runsHiddenMode: RUNS_VISIBILITY_MODE.CUSTOM,\n            runsHidden: newHiddenRows,\n          };\n        }\n\n        return currentUIState;\n      });\n    },\n    [updateUIState, useGroupedValuesInCharts],\n  );\n\n  return shouldUseRunRowsVisibilityMap() ? toggleRowUsingVisibilityMap : toggleRowVisibility;\n};\n","import React from 'react';\n\nimport RunsMetricsLegend, { LegendLabelData } from './RunsMetricsLegend';\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nconst RunsMetricsLegendWrapper = ({\n  labelData,\n  fullScreen,\n  children,\n}: React.PropsWithChildren<{\n  labelData: LegendLabelData[];\n  fullScreen?: boolean;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const FULL_SCREEN_LEGEND_HEIGHT = 100;\n  const LEGEND_HEIGHT = 32;\n\n  const height = fullScreen ? FULL_SCREEN_LEGEND_HEIGHT : LEGEND_HEIGHT;\n  const heightBuffer = fullScreen ? theme.spacing.lg : theme.spacing.md;\n\n  return (\n    <>\n      <div css={{ height: `calc(100% - ${height + heightBuffer}px)` }}>{children}</div>\n      <RunsMetricsLegend labelData={labelData} height={height} fullScreen={fullScreen} />\n    </>\n  );\n};\n\nexport default RunsMetricsLegendWrapper;\n","import { gql, NetworkStatus } from '@mlflow/mlflow/src/common/utils/graphQLHooks';\nimport { useQuery } from '@mlflow/mlflow/src/common/utils/graphQLHooks';\nimport { EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL } from '../../../utils/MetricsUtils';\nimport { groupBy, keyBy } from 'lodash';\nimport { useEffect, useMemo } from 'react';\nimport type { SampledMetricsByRun } from './useSampledMetricHistory';\nimport { GetMetricHistoryBulkInterval } from '../../../../graphql/__generated__/graphql';\nimport Utils from '../../../../common/utils/Utils';\nimport { useIntl } from 'react-intl';\n\nconst GET_METRIC_HISTORY_BULK_INTERVAL = gql`\n  query GetMetricHistoryBulkInterval($data: MlflowGetMetricHistoryBulkIntervalInput!)\n  @component(name: \"MLflow.ExperimentRunTracking\") {\n    mlflowGetMetricHistoryBulkInterval(input: $data) {\n      __typename\n      metrics {\n        timestamp\n        step\n        runId\n        key\n        value\n      }\n      apiError {\n        code\n        message\n      }\n    }\n  }\n`;\n\nexport const useSampledMetricHistoryGraphQL = ({\n  metricKey,\n  runUuids,\n  autoRefreshEnabled,\n  enabled,\n  maxResults = 320,\n  range,\n}: {\n  runUuids: string[];\n  metricKey: string;\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const intl = useIntl();\n  const { data, refetch, startPolling, stopPolling, networkStatus, error } = useQuery<GetMetricHistoryBulkInterval>(\n    GET_METRIC_HISTORY_BULK_INTERVAL,\n    {\n      skip: !enabled,\n      notifyOnNetworkStatusChange: true,\n      pollInterval: autoRefreshEnabled ? EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL : undefined,\n      onCompleted(data) {\n        if (data.mlflowGetMetricHistoryBulkInterval?.apiError?.code === 'RESOURCE_DOES_NOT_EXIST') {\n          Utils.displayGlobalErrorNotification(\n            intl.formatMessage({\n              defaultMessage: 'Requested resource does not exist',\n              description:\n                'Error message displayed when a requested run does not exist while fetching sampled metric data',\n            }),\n          );\n        } else if (data.mlflowGetMetricHistoryBulkInterval?.apiError?.message) {\n          Utils.logErrorAndNotifyUser(new Error(data.mlflowGetMetricHistoryBulkInterval.apiError.message));\n        }\n      },\n      variables: {\n        data: {\n          runIds: runUuids,\n          metricKey,\n          startStep: range?.[0] ?? null,\n          endStep: range?.[1] ?? null,\n          maxResults,\n        },\n      },\n    },\n  );\n\n  useEffect(() => {\n    if (autoRefreshEnabled) {\n      startPolling(EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL);\n    } else {\n      stopPolling();\n    }\n  }, [autoRefreshEnabled, startPolling, stopPolling]);\n\n  const resultsByRunUuid = useMemo<Record<string, SampledMetricsByRun>>(() => {\n    if (data) {\n      const metrics = data?.mlflowGetMetricHistoryBulkInterval?.metrics;\n      const metricsByRunId = groupBy(metrics, 'runId');\n\n      // Transform the data into the already existing format\n      return keyBy(\n        runUuids.map(\n          (runId) =>\n            ({\n              runUuid: runId,\n              [metricKey]: {\n                metricsHistory: metricsByRunId[runId]?.map(({ key, step, timestamp, value }) => ({\n                  key: key ?? undefined,\n                  step: Number(step),\n                  timestamp: Number(timestamp),\n                  value: value ?? undefined,\n                })),\n              },\n            } as SampledMetricsByRun),\n        ),\n        'runUuid',\n      );\n    }\n\n    return {};\n  }, [data, metricKey, runUuids]);\n\n  const isLoading = networkStatus === NetworkStatus.loading || networkStatus === NetworkStatus.setVariables;\n  const isRefreshing = networkStatus === NetworkStatus.poll;\n  return {\n    resultsByRunUuid,\n    isLoading,\n    isRefreshing,\n    refresh: refetch,\n    error,\n    apiError: data?.mlflowGetMetricHistoryBulkInterval?.apiError,\n  };\n};\n","import { chunk, isEqual, keyBy } from 'lodash';\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { createChartAxisRangeKey } from '../components/RunsCharts.common';\nimport { getSampledMetricHistoryBulkAction } from '../../../sdk/SampledMetricHistoryService';\nimport type { SampledMetricsByRunUuidState } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL } from '../../../utils/MetricsUtils';\nimport Utils from '../../../../common/utils/Utils';\nimport { shouldEnableGraphQLSampledMetrics } from '../../../../common/utils/FeatureUtils';\nimport { useSampledMetricHistoryGraphQL } from './useSampledMetricHistoryGraphQL';\n\ntype SampledMetricData = SampledMetricsByRunUuidState[string][string][string];\n\nexport type SampledMetricsByRun = {\n  runUuid: string;\n} & {\n  [metricKey: string]: SampledMetricData;\n};\n\nconst SAMPLED_METRIC_HISTORY_API_RUN_LIMIT = 100;\n\n/**\n * Automatically fetches sampled metric history for runs, used in run runs charts.\n * After updating list of metrics or runs, optimizes the request and fetches\n * only the missing entries.\n *\n * REST-based implementation.\n */\nconst useSampledMetricHistoryREST = (params: {\n  runUuids: string[];\n  metricKeys: string[];\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const { metricKeys, runUuids, enabled, maxResults, range, autoRefreshEnabled } = params;\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSelector(\n    (store: ReduxState) => {\n      const rangeKey = createChartAxisRangeKey(range);\n\n      let anyRunRefreshing = false;\n      let anyRunLoading = false;\n\n      const returnValues: SampledMetricsByRun[] = runUuids.map((runUuid) => {\n        const metricsByMetricKey = metricKeys.reduce(\n          (dataByMetricKey: { [key: string]: SampledMetricData }, metricKey: string) => {\n            const runMetricData = store.entities.sampledMetricsByRunUuid[runUuid]?.[metricKey]?.[rangeKey];\n\n            if (!runMetricData) {\n              return dataByMetricKey;\n            }\n\n            anyRunLoading = anyRunLoading || Boolean(runMetricData.loading);\n            anyRunRefreshing = anyRunRefreshing || Boolean(runMetricData.refreshing);\n\n            dataByMetricKey[metricKey] = runMetricData;\n            return dataByMetricKey;\n          },\n          {},\n        );\n\n        return {\n          runUuid,\n          ...metricsByMetricKey,\n        };\n      });\n\n      return {\n        isLoading: anyRunLoading,\n        isRefreshing: anyRunRefreshing,\n        resultsByRunUuid: keyBy(returnValues, 'runUuid'),\n      };\n    },\n    (left, right) =>\n      isEqual(left.resultsByRunUuid, right.resultsByRunUuid) &&\n      left.isLoading === right.isLoading &&\n      left.isRefreshing === right.isRefreshing,\n  );\n\n  const refreshFn = useCallback(() => {\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range, 'all');\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range]);\n\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n  const autoRefreshEnabledRef = useRef(autoRefreshEnabled && params.enabled);\n  autoRefreshEnabledRef.current = autoRefreshEnabled && params.enabled;\n\n  // Serialize runUuids to a string to use as a dependency in the effect,\n  // directly used runUuids can cause unnecessary re-fetches\n  const runUuidsSerialized = useMemo(() => runUuids.join(','), [runUuids]);\n\n  // Regular single fetch effect with no auto-refresh capabilities. Used if auto-refresh is disabled.\n  useEffect(() => {\n    if (!enabled || autoRefreshEnabled) {\n      return;\n    }\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range);\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  // A fetch effect with auto-refresh capabilities. Used only if auto-refresh is enabled.\n  useEffect(() => {\n    let hookUnmounted = false;\n    if (!enabled || !autoRefreshEnabled) {\n      return;\n    }\n\n    // Base fetching function, used for both initial call and subsequent auto-refresh calls\n    const fetchMetricsFn = async (isAutoRefreshing = false) => {\n      const runUuids = runUuidsSerialized.split(',').filter((runUuid: string) => runUuid !== '');\n      await Promise.all(\n        metricKeys.map(async (metricKey) =>\n          Promise.all(\n            chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).map(async (runUuidsChunk) =>\n              dispatch(\n                getSampledMetricHistoryBulkAction(\n                  runUuidsChunk,\n                  metricKey,\n                  maxResults,\n                  range,\n                  isAutoRefreshing ? 'auto' : undefined,\n                ),\n              ),\n            ),\n          ),\n        ),\n      );\n    };\n\n    const scheduleRefresh = async () => {\n      // Initial check to confirm that auto-refresh is still enabled and the hook is still mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n      try {\n        await fetchMetricsFn(true);\n      } catch (e) {\n        // In case of error during auto-refresh, log the error but do break the auto-refresh loop\n        Utils.logErrorAndNotifyUser(e);\n      }\n      clearTimeout(refreshTimeoutRef.current);\n\n      // After loading the data, schedule the next refresh if the hook is still enabled and mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL);\n    };\n\n    fetchMetricsFn().then(scheduleRefresh);\n\n    return () => {\n      // Mark the hook as unmounted to prevent scheduling new auto-refreshes with current data\n      hookUnmounted = true;\n\n      // Clear the timeout\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [dispatch, maxResults, runUuidsSerialized, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  return { isLoading, isRefreshing, resultsByRunUuid, refresh: refreshFn };\n};\n\n/**\n * A switcher hook that selects between the REST and GraphQL implementations of the\n * `useSampledMetricHistory` hook based on flags and parameter context.\n */\nexport const useSampledMetricHistory = (params: {\n  runUuids: string[];\n  metricKeys: string[];\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const { metricKeys, enabled, autoRefreshEnabled, runUuids } = params;\n\n  // We should use the apollo hook if there is only one metric key and the number of runUuids is less than 100.\n  // To be improved after endpoint will start supporting multiple metric keys.\n  const shouldUseGraphql = shouldEnableGraphQLSampledMetrics() && metricKeys.length === 1 && runUuids.length <= 100;\n\n  const legacyResult = useSampledMetricHistoryREST({\n    ...params,\n    enabled: enabled && !shouldUseGraphql,\n    autoRefreshEnabled: autoRefreshEnabled && !shouldUseGraphql,\n  });\n\n  const graphQlResult = useSampledMetricHistoryGraphQL({\n    ...params,\n    metricKey: metricKeys[0],\n    enabled: enabled && shouldUseGraphql,\n    autoRefreshEnabled: autoRefreshEnabled && shouldUseGraphql,\n  });\n\n  return shouldUseGraphql ? graphQlResult : legacyResult;\n};\n","import qs from 'qs';\nimport { useMemo } from 'react';\nimport { useParams, useLocation } from '../../../../common/utils/RoutingUtils';\nimport Utils from '../../../../common/utils/Utils';\n\nexport type UseExperimentIdsResult = string[];\n\n/**\n * Hook that returns requested experiment IDs basing on the URL.\n * It extracts ids basing on either route match (in case of a single experiment)\n * or query params (in case of comparing experiments.).\n *\n * @returns array of strings with experiment IDs\n */\n\nexport const useExperimentIds = (): UseExperimentIdsResult => {\n  const params = useParams<{ experimentId?: string }>();\n  const location = useLocation();\n\n  const normalizedLocationSearch = useMemo(() => decodeURIComponent(location.search), [location.search]);\n\n  /**\n   * Memoized string containing experiment IDs for comparison (\"?experiments=...\")\n   */\n  const compareExperimentIdsQueryParam = useMemo(() => {\n    const queryParams = qs.parse(normalizedLocationSearch.substring(1));\n    if (queryParams['experiments']) {\n      const experimentIdsRaw = queryParams['experiments'];\n      return experimentIdsRaw?.toString() || '';\n    }\n\n    return '';\n  }, [normalizedLocationSearch]);\n\n  return useMemo(() => {\n    // Case #1: single experiment\n    if (params?.experimentId) {\n      return [params?.experimentId];\n    }\n\n    // Case #2: multiple (compare) experiments\n    if (compareExperimentIdsQueryParam) {\n      try {\n        return JSON.parse(compareExperimentIdsQueryParam);\n      } catch {\n        // Apparently URL is malformed\n        Utils.logErrorAndNotifyUser(`Could not parse experiment query parameter ${compareExperimentIdsQueryParam}`);\n        return '';\n      }\n    }\n\n    return [];\n  }, [compareExperimentIdsQueryParam, params?.experimentId]);\n};\n","import { isUndefined, noop } from 'lodash';\nimport {\n  type PropsWithChildren,\n  createContext,\n  createElement,\n  useContext,\n  useMemo,\n  useRef,\n  useEffect,\n  useState,\n  useCallback,\n} from 'react';\nimport { shouldEnableUnifiedChartDataTraceHighlight } from '../../../../common/utils/FeatureUtils';\n\n/**\n * Function used to highlight particular trace in the experiment runs chart,\n * for both hover and select scenarios.\n * Since implementation varies across chart types, the function is curryable where\n * two first-level parameters determine the target SVG selector paths to the trace within\n * target chart type.\n *\n * @param traceSelector selector path to the trace for a particular chart type\n * @param parentSelector selector path to the traces container for a particular chart type\n */\nconst highlightChartTracesFn =\n  (traceSelector: string, parentSelector: string) =>\n  /**\n   * @param parent a HTML element containing the chart\n   * @param hoverIndex index of a trace that should be hover-higlighted, set -1 to remove highlight\n   * @param selectIndex index of a trace that should be select-higlighted, set -1 to remove highlight\n   */\n  (parent: HTMLElement, hoverIndex: number, selectIndex: number, numberOfBands = 0) => {\n    const deselected = hoverIndex === -1 && selectIndex === -1;\n\n    parent.querySelector('.is-hover-highlight')?.classList.remove('is-hover-highlight');\n    if (hoverIndex > -1) {\n      parent.querySelectorAll(traceSelector)[hoverIndex]?.classList.add('is-hover-highlight');\n    }\n\n    parent.querySelector('.is-selection-highlight')?.classList.remove('is-selection-highlight');\n    if (selectIndex > -1) {\n      parent.querySelectorAll(traceSelector)[selectIndex]?.classList.add('is-selection-highlight');\n    }\n\n    if (numberOfBands > 0) {\n      const bandTraceIndex =\n        selectIndex > -1 ? selectIndex - numberOfBands : hoverIndex > -1 ? hoverIndex - numberOfBands : -1;\n      parent.querySelectorAll(traceSelector).forEach((e, index) => {\n        e.classList.toggle('is-band', index >= 0 && index < numberOfBands);\n        e.classList.toggle('is-band-highlighted', index === bandTraceIndex);\n      });\n    } else {\n      parent.querySelectorAll(traceSelector).forEach((e) => e.classList.remove('is-band'));\n    }\n\n    if (deselected) {\n      parent.querySelector(parentSelector)?.classList.remove('is-highlight');\n    } else {\n      parent.querySelector(parentSelector)?.classList.add('is-highlight');\n    }\n  };\n\n/**\n * Type-specific implementation of highlightChartTracesFn for bar charts\n */\nexport const highlightBarTraces = highlightChartTracesFn('svg .trace.bars g.point', '.trace.bars');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for line charts\n */\nexport const highlightLineTraces = highlightChartTracesFn('svg .scatterlayer g.trace', '.scatterlayer');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for scatter and contour charts\n */\nexport const highlightScatterTraces = highlightChartTracesFn('svg .scatterlayer path.point', '.trace.scatter');\n\n/**\n * This hook provides mechanisms necessary for highlighting SVG trace paths\n * in experiment runs charts.\n *\n * @param containerDiv HTML element containing the chart\n * @param selectedRunUuid currently selected run UUID (set to -1 if none)\n * @param runsData array containing run informations, should be the same order as provided to the chart\n * @param highlightFn a styling function that will be called when the trace should be (un)highlighted, please refer to `highlightCallbackFn()`\n */\nexport const useRenderRunsChartTraceHighlight = (\n  containerDiv: HTMLElement | null,\n  selectedRunUuid: string | null | undefined,\n  runsData: { uuid?: string }[],\n  highlightFn: ReturnType<typeof highlightChartTracesFn>,\n  numberOfBands = 0,\n) => {\n  // Save the last runs data to be available immediately on non-stateful callbacks\n  const lastRunsData = useRef(runsData);\n  lastRunsData.current = runsData;\n\n  const selectedTraceIndex = useMemo(() => {\n    if (!containerDiv || !selectedRunUuid) {\n      return -1;\n    }\n    return runsData.findIndex(({ uuid }) => uuid === selectedRunUuid);\n  }, [runsData, containerDiv, selectedRunUuid]);\n\n  const [hoveredPointIndex, setHoveredPointIndex] = useState(-1);\n  const { onHighlightChange } = useRunsChartTraceHighlight();\n\n  useEffect(() => {\n    // Disable this hook variant if new highlight model is enabled\n    if (shouldEnableUnifiedChartDataTraceHighlight()) {\n      return;\n    }\n    if (!containerDiv) {\n      return;\n    }\n    highlightFn(containerDiv, hoveredPointIndex, selectedTraceIndex, numberOfBands);\n  }, [highlightFn, containerDiv, selectedTraceIndex, hoveredPointIndex, numberOfBands]);\n\n  useEffect(() => {\n    // Use this hook variant only if new highlight model is enabled\n    if (!shouldEnableUnifiedChartDataTraceHighlight()) {\n      return;\n    }\n    if (!containerDiv) {\n      return;\n    }\n    // Here, we don't report stateful hovered run UUID since it's handled by the new highlight model\n    highlightFn(containerDiv, -1, selectedTraceIndex, numberOfBands);\n  }, [highlightFn, containerDiv, selectedTraceIndex, numberOfBands]);\n\n  // Save the last selected trace index to be available immediately on non-stateful callbacks\n  const lastSelectedTraceIndex = useRef(selectedTraceIndex);\n  lastSelectedTraceIndex.current = selectedTraceIndex;\n\n  const highlightChangeListener = useCallback(\n    (newExtern: string | null) => {\n      if (!containerDiv) {\n        return;\n      }\n\n      const externallyHighlightedRunIndex = lastRunsData.current.findIndex(({ uuid }) => uuid === newExtern);\n      highlightFn(containerDiv, externallyHighlightedRunIndex, lastSelectedTraceIndex.current, numberOfBands);\n    },\n    [highlightFn, containerDiv, numberOfBands],\n  );\n\n  // Listen to the highlight change event\n  useEffect(() => onHighlightChange(highlightChangeListener), [onHighlightChange, highlightChangeListener]);\n\n  return {\n    selectedTraceIndex,\n    hoveredPointIndex,\n    // With the unified chart data trace highlight, we don't need to do costly state updates anymore\n    setHoveredPointIndex: shouldEnableUnifiedChartDataTraceHighlight() ? noop : setHoveredPointIndex,\n  };\n};\n\nexport enum ChartsTraceHighlightSource {\n  NONE,\n  CHART,\n  TABLE,\n}\n\ninterface RunsChartsSetHighlightContextType {\n  highlightDataTrace: (\n    traceUuid: string | null,\n    options?: { source?: ChartsTraceHighlightSource; shouldBlock?: boolean },\n  ) => void;\n  onHighlightChange: (fn: (traceUuid: string | null, source?: ChartsTraceHighlightSource) => void) => () => void;\n}\n\nconst RunsChartsSetHighlightContext = createContext<RunsChartsSetHighlightContextType>({\n  highlightDataTrace: () => {},\n  onHighlightChange: () => () => {},\n});\n\nexport const RunsChartsSetHighlightContextProvider = ({ children }: PropsWithChildren<unknown>) => {\n  const highlightListenerFns = useRef<((traceUuid: string | null, source?: ChartsTraceHighlightSource) => void)[]>([]);\n  const block = useRef(false);\n\n  // Stable and memoized context value\n  const contextValue = useMemo<RunsChartsSetHighlightContextType>(() => {\n    // If new highlight model is disabled, disable entire feature by providint empty logic to the context\n    if (!shouldEnableUnifiedChartDataTraceHighlight()) {\n      return {\n        highlightDataTrace: () => {},\n        onHighlightChange: () => () => {},\n      };\n    }\n\n    const notifyListeners = (traceUuid: string | null, source?: ChartsTraceHighlightSource) => {\n      for (const fn of highlightListenerFns.current) {\n        fn(traceUuid, source);\n      }\n    };\n\n    const highlightDataTrace = (\n      traceUuid: string | null,\n      { shouldBlock, source }: { source?: ChartsTraceHighlightSource; shouldBlock?: boolean } = {},\n    ) => {\n      if (!isUndefined(shouldBlock)) {\n        block.current = shouldBlock;\n      } else if (block.current) {\n        return;\n      }\n      notifyListeners(traceUuid, source);\n    };\n\n    const onHighlightChange = (listener: (traceUuid: string | null, source?: ChartsTraceHighlightSource) => void) => {\n      highlightListenerFns.current.push(listener);\n      return () => {\n        highlightListenerFns.current = highlightListenerFns.current.filter((fn) => fn !== listener);\n      };\n    };\n\n    return {\n      highlightDataTrace,\n      onHighlightChange,\n    };\n  }, []);\n\n  return createElement(RunsChartsSetHighlightContext.Provider, { value: contextValue }, children);\n};\n\nexport const useRunsChartTraceHighlight = () => useContext(RunsChartsSetHighlightContext);\n","import { type RefObject, useCallback, useEffect } from 'react';\nimport { ChartsTraceHighlightSource, useRunsChartTraceHighlight } from './useRunsChartTraceHighlight';\nimport { CellMouseOverEvent } from '@ag-grid-community/core';\n\nconst DEFAULT_HIGH_LIGHT_CLASS_NAME = 'is-highlighted';\n\n/**\n * Helper hook adding support for useRunsChartTraceSetHighlight() logic to a ag-grid table rows\n */\nexport const useRunsHighlightTableRow = (\n  /**\n   * Reference to the container element of the table.\n   */\n  containerElementRef: RefObject<HTMLDivElement>,\n  /**\n   * Class name to be added to the highlighted row.\n   */\n  highlightedClassName = DEFAULT_HIGH_LIGHT_CLASS_NAME,\n  /**\n   * Additional selector prefix to be used to find the row element.\n   */\n  findInFlexColumns = false,\n  /**\n   * Optional function to extract the row UUID from the table data, used in row hover callback.\n   */\n  getRowUuid?: (data: any) => string | undefined,\n) => {\n  const { onHighlightChange, highlightDataTrace } = useRunsChartTraceHighlight();\n  /**\n   * Listener function that highlights a row in the table by adding a class to it.\n   */\n  const highlightFn = useCallback(\n    (rowUuid: string | null, source?: ChartsTraceHighlightSource) => {\n      // First, quickly remove the highlight class from the previous highlighted row\n      const existingHighlightedRowElement = containerElementRef.current?.querySelector(`.${highlightedClassName}`);\n\n      const additionalSelectorPrefix = findInFlexColumns ? '.ag-center-cols-viewport' : '';\n\n      // Find the new row element and add the highlight class to it\n      const rowElement = containerElementRef.current?.querySelector(\n        `${additionalSelectorPrefix} .ag-row[row-id=\"${rowUuid}\"]`,\n      );\n      if (existingHighlightedRowElement && existingHighlightedRowElement !== rowElement) {\n        existingHighlightedRowElement.classList.remove(highlightedClassName);\n      }\n\n      // Do not highlight the row if the source of highlight event is the table itself\n      if (source === ChartsTraceHighlightSource.TABLE) {\n        return;\n      }\n\n      rowElement && rowElement.classList.add(highlightedClassName);\n    },\n    [containerElementRef, highlightedClassName, findInFlexColumns],\n  );\n\n  // Subscribe to the highlight change event\n  useEffect(() => onHighlightChange(highlightFn), [highlightFn, onHighlightChange]);\n\n  // Create event handlers for table cell mouse over and out events\n  const cellMouseOverHandler = useCallback(\n    ({ data }: CellMouseOverEvent) => {\n      const isGroupRow = typeof data === 'object' && 'groupParentInfo' in data;\n      // Extract the trace UUID from the data\n      // Use runUuid for non-group rows and rowUuid for group rows\n      const dataTraceUuid = getRowUuid ? getRowUuid({ data }) : isGroupRow ? data.rowUuid : data.runUuid;\n\n      highlightDataTrace(dataTraceUuid, {\n        source: ChartsTraceHighlightSource.TABLE,\n      });\n    },\n    [highlightDataTrace, getRowUuid],\n  );\n\n  const cellMouseOutHandler = useCallback(() => highlightDataTrace(null), [highlightDataTrace]);\n\n  return { cellMouseOverHandler, cellMouseOutHandler };\n};\n","import { SortAscendingIcon, SortDescendingIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { useUpdateExperimentPageSearchFacets } from '../../../hooks/useExperimentPageSearchFacets';\n\nexport interface ColumnHeaderCellProps {\n  enableSorting: boolean;\n  displayName: string;\n  canonicalSortKey: string;\n  context: {\n    orderByKey: string;\n    orderByAsc: boolean;\n  };\n}\n\nexport const ColumnHeaderCell = ({\n  enableSorting,\n  canonicalSortKey,\n  displayName,\n  context: tableContext,\n}: ColumnHeaderCellProps) => {\n  const { orderByKey, orderByAsc } = tableContext || {};\n  const updateSearchFacets = useUpdateExperimentPageSearchFacets();\n  const selectedCanonicalSortKey = canonicalSortKey;\n\n  const handleSortBy = () => {\n    let newOrderByAsc = !orderByAsc;\n\n    // If the new sortKey is not equal to the previous sortKey, reset the orderByAsc\n    if (selectedCanonicalSortKey !== orderByKey) {\n      newOrderByAsc = false;\n    }\n    updateSearchFacets({ orderByKey: selectedCanonicalSortKey, orderByAsc: newOrderByAsc });\n  };\n\n  const { theme } = useDesignSystemTheme();\n  const isOrderedByClassName = 'is-ordered-by';\n\n  return (\n    <div\n      role=\"columnheader\"\n      css={{\n        height: '100%',\n        width: '100%',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n      }}\n    >\n      <div\n        css={{\n          height: '100%',\n          width: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          overflow: 'hidden',\n          paddingLeft: theme.spacing.xs + theme.spacing.sm,\n          paddingRight: theme.spacing.xs + theme.spacing.sm,\n          gap: theme.spacing.sm,\n          svg: {\n            color: theme.colors.textSecondary,\n          },\n          '&:hover': {\n            color: enableSorting ? theme.colors.actionTertiaryTextHover : 'unset',\n            svg: {\n              color: theme.colors.actionTertiaryTextHover,\n            },\n          },\n        }}\n        className={selectedCanonicalSortKey === orderByKey ? isOrderedByClassName : ''}\n        onClick={enableSorting ? handleSortBy : undefined}\n      >\n        <span data-testid={`sort-header-${displayName}`}>{displayName}</span>\n        {enableSorting && selectedCanonicalSortKey === orderByKey ? (\n          orderByAsc ? (\n            <SortAscendingIcon />\n          ) : (\n            <SortDescendingIcon />\n          )\n        ) : null}\n      </div>\n    </div>\n  );\n};\n","import { Theme } from '@emotion/react';\nimport React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowDateAndNestInfo } from '../../../utils/experimentPage.row-types';\nimport { RunStatusIcon } from '../../../../RunStatusIcon';\nimport { useIntl } from 'react-intl';\n\nexport interface DateCellRendererProps {\n  value: RunRowDateAndNestInfo;\n}\n\nexport const DateCellRenderer = React.memo(({ value }: DateCellRendererProps) => {\n  const { startTime, referenceTime, runStatus } = value || {};\n  const intl = useIntl();\n  if (!startTime) {\n    return <>-</>;\n  }\n\n  return (\n    <span css={styles.cellWrapper} title={Utils.formatTimestamp(startTime, intl)}>\n      <RunStatusIcon status={runStatus} />\n      {Utils.timeSinceStr(startTime, referenceTime)}\n    </span>\n  );\n});\n\nconst styles = {\n  cellWrapper: (theme: Theme) => ({\n    display: 'flex',\n    alignItems: 'center',\n    gap: theme.spacing.sm,\n  }),\n};\n","import React, { useState } from 'react';\nimport { Button } from '@databricks/design-system';\n\ntype Props = {\n  text: string;\n  maxSize: number;\n  className?: string;\n  allowShowMore?: boolean;\n  dataTestId?: string;\n};\n\nexport const TrimmedText = ({ text, maxSize, className, allowShowMore = false, dataTestId }: Props) => {\n  if (text.length <= maxSize) {\n    return (\n      <span className={className} data-testid={dataTestId}>\n        {text}\n      </span>\n    );\n  }\n  const trimmedText = `${text.substr(0, maxSize)}...`;\n  // Reported during ESLint upgrade\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const [showMore, setShowMore] = useState(false);\n  return (\n    <span className={className} data-testid={dataTestId}>\n      {showMore ? text : trimmedText}\n      {allowShowMore && (\n        <Button\n          componentId=\"codegen_mlflow_app_src_common_components_trimmedtext.tsx_30\"\n          type=\"link\"\n          onClick={() => setShowMore(!showMore)}\n          size=\"small\"\n          css={styles.expandButton}\n          data-testid=\"trimmed-text-button\"\n        >\n          {showMore ? 'collapse' : 'expand'}\n        </Button>\n      )}\n    </span>\n  );\n};\n\nconst styles = {\n  expandButton: {\n    display: 'inline-block',\n  },\n};\n","import React from 'react';\nimport { LegacyTooltip } from '@databricks/design-system';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { TrimmedText } from '../../../../../../common/components/TrimmedText';\n\nexport const RunDescriptionCellRenderer = React.memo(({ value }: { value: RunRowType['tags'] }) => {\n  const description = Utils.getRunDescriptionFromTags(value) || '-';\n  return (\n    <>\n      <LegacyTooltip title={description}>\n        <span>\n          <TrimmedText text={description} maxSize={50} />\n        </span>\n      </LegacyTooltip>\n    </>\n  );\n});\n","import React from 'react';\nimport { Link } from '../../../../../../common/utils/RoutingUtils';\nimport Routes from '../../../../../routes';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport interface ExperimentNameCellRendererProps {\n  value: {\n    name: string;\n    basename: string;\n  };\n  data: RunRowType;\n}\n\nexport const ExperimentNameCellRenderer = React.memo(({ data, value }: ExperimentNameCellRendererProps) =>\n  !data.experimentId ? null : (\n    <Link to={Routes.getExperimentPageRoute(data.experimentId)} title={value.name}>\n      {value.basename}\n    </Link>\n  ),\n);\n","import React, { useMemo } from 'react';\nimport { ModelsIcon, Overflow, Tag, LegacyTooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { ModelRegistryRoutes } from '../../../../../../model-registry/routes';\nimport Routes from '../../../../../routes';\nimport { RunRowModelsInfo } from '../../../utils/experimentPage.row-types';\nimport { Link } from '../../../../../../common/utils/RoutingUtils';\nimport { ReactComponent as RegisteredModelOkIcon } from '../../../../../../common/static/registered-model-grey-ok.svg';\nimport type { LoggedModelProto } from '../../../../../types';\nimport { FormattedMessage } from 'react-intl';\nimport { useExperimentLoggedModelRegisteredVersions } from '../../../../experiment-logged-models/hooks/useExperimentLoggedModelRegisteredVersions';\nimport { isEmpty, uniqBy, values } from 'lodash';\nimport { isUCModelName } from '../../../../../utils/IsUCModelName';\nimport {\n  shouldUnifyLoggedModelsAndRegisteredModels,\n  shouldUseGetLoggedModelsBatchAPI,\n} from '../../../../../../common/utils/FeatureUtils';\n\nconst EMPTY_CELL_PLACEHOLDER = '-';\n\nexport interface ModelsCellRendererProps {\n  value: RunRowModelsInfo;\n}\n\n/**\n * Backfill Typescript type for the value returned from Utils.mergeLoggedAndRegisteredModels\n */\ninterface CombinedModelType {\n  registeredModelName?: string;\n  isUc?: boolean;\n  registeredModelVersion?: string;\n  artifactPath?: string;\n  flavors?: string[];\n  originalLoggedModel?: LoggedModelProto;\n}\n\n/**\n * Icon, label and link for a single model\n */\nconst ModelLink = ({\n  model: { isUc, registeredModelName, registeredModelVersion, flavors, artifactPath, originalLoggedModel } = {},\n  experimentId,\n  runUuid,\n}: {\n  model?: CombinedModelType;\n  experimentId: string;\n  runUuid: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  // Renders a model name based on whether it's a registered model or not\n  const renderModelName = () => {\n    let tooltipBody: React.ReactNode = `${registeredModelName} v${registeredModelVersion}`;\n\n    // If the model is a registered model coming from V3 logged model, we need to show the original logged model name\n    if (\n      registeredModelName &&\n      registeredModelVersion &&\n      originalLoggedModel &&\n      shouldUnifyLoggedModelsAndRegisteredModels()\n    ) {\n      const loggedModelExperimentId = originalLoggedModel.info?.experiment_id;\n      const loggedModelId = originalLoggedModel.info?.model_id;\n      if (loggedModelExperimentId && loggedModelId) {\n        tooltipBody = (\n          <FormattedMessage\n            defaultMessage=\"Original logged model: {originalModelLink}\"\n            description=\"Tooltip text with link to the original logged model\"\n            values={{\n              originalModelLink: (\n                <Link\n                  to={Routes.getExperimentLoggedModelDetailsPage(loggedModelExperimentId, loggedModelId)}\n                  css={{ color: 'inherit', textDecoration: 'underline' }}\n                >\n                  {originalLoggedModel.info?.name}\n                </Link>\n              ),\n            }}\n          />\n        );\n      }\n    }\n    if (registeredModelName) {\n      return (\n        <LegacyTooltip title={tooltipBody} placement=\"topLeft\">\n          <span css={{ verticalAlign: 'middle' }}>{registeredModelName}</span>{' '}\n          <Tag\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_modelscellrenderer.tsx_49\"\n            css={{ marginRight: 0, verticalAlign: 'middle' }}\n          >\n            v{registeredModelVersion}\n          </Tag>\n        </LegacyTooltip>\n      );\n    }\n\n    const firstFlavorName = flavors?.[0];\n\n    return (\n      firstFlavorName || (\n        <FormattedMessage\n          defaultMessage=\"Model\"\n          description=\"Experiment page > runs table > models column > default label for no specific model\"\n        />\n      )\n    );\n  };\n\n  // Renders a link to either the model registry or the run artifacts page\n  const renderModelLink = () => {\n    if (registeredModelName && registeredModelVersion) {\n      return ModelRegistryRoutes.getModelVersionPageRoute(registeredModelName, registeredModelVersion);\n    }\n    return Routes.getRunPageRoute(experimentId, runUuid, artifactPath);\n  };\n\n  // Renders an icon based on whether it's a registered model or not\n  const renderModelIcon = () => {\n    if (registeredModelName) {\n      return <RegisteredModelOkIcon css={{ color: theme.colors.actionPrimaryBackgroundDefault }} />;\n    }\n    return <ModelsIcon css={{ color: theme.colors.actionPrimaryBackgroundDefault }} />;\n  };\n\n  return (\n    <div css={{ display: 'flex', alignItems: 'center', gap: theme.spacing.xs, overflow: 'hidden' }}>\n      <div css={{ width: 20, display: 'flex', alignItems: 'center', justifyContent: 'flex-start', flexShrink: 0 }}>\n        {renderModelIcon()}\n      </div>\n      <Link\n        to={renderModelLink()}\n        target=\"_blank\"\n        css={{ textOverflow: 'ellipsis', overflow: 'hidden', cursor: 'pointer' }}\n      >\n        {renderModelName()}\n      </Link>\n    </div>\n  );\n};\n\nconst LoggedModelV3Link = ({ model }: { model: LoggedModelProto }) => {\n  const { theme } = useDesignSystemTheme();\n\n  if (!model.info?.model_id || !model.info?.experiment_id) {\n    return null;\n  }\n  return (\n    <div css={{ display: 'flex', alignItems: 'center', gap: theme.spacing.xs, overflow: 'hidden' }}>\n      <div css={{ width: 20, display: 'flex', alignItems: 'center', justifyContent: 'flex-start', flexShrink: 0 }}>\n        <ModelsIcon css={{ color: theme.colors.actionPrimaryBackgroundDefault }} />\n      </div>\n      <Link\n        to={Routes.getExperimentLoggedModelDetailsPage(model.info.experiment_id, model.info.model_id)}\n        target=\"_blank\"\n        css={{ textOverflow: 'ellipsis', overflow: 'hidden', cursor: 'pointer' }}\n      >\n        {model.info.name}\n      </Link>\n    </div>\n  );\n};\n\n/**\n * This component renders combined set of models, based on provided models payload.\n * The models are sourced from:\n * - `registeredModels` containing WMR and UC model versions associated with the run, populated by API call\n * - `loggedModels` containing legacy (pre-V3) logged models associated with the run, listed in run's tag\n * - `loggedModelsV3` containing V3 logged models associated with the runs inputs and outputs, populated by API call\n * In the component, we also resolve registered model versions for V3 logged models based on loged model's tags\n */\nexport const ModelsCellRenderer = React.memo((props: ModelsCellRendererProps) => {\n  const { registeredModels = [], loggedModels = [], loggedModelsV3, experimentId, runUuid } = props.value || {};\n\n  // First, we merge legacy logged models and registered models.\n  const modelsLegacy: CombinedModelType[] = Utils.mergeLoggedAndRegisteredModels(\n    loggedModels,\n    registeredModels,\n  ) as any[];\n\n  // Next, registered model versions are resolved from V3 logged models' tags\n  const { modelVersions: registeredModelVersions } = useExperimentLoggedModelRegisteredVersions({\n    loggedModels: loggedModelsV3 || [],\n  });\n\n  // We create a map of registered model versions by their source logged model.\n  // This allows to unfurl logged model to registered model versions while hiding the original logged model.\n  const registeredModelVersionsByLoggedModel = useMemo(() => {\n    if (!shouldUseGetLoggedModelsBatchAPI()) {\n      return {};\n    }\n    const map: Record<string, CombinedModelType[]> = {};\n    registeredModelVersions.forEach((modelVersion) => {\n      const loggedModelId = modelVersion.sourceLoggedModel?.info?.model_id;\n      if (loggedModelId) {\n        const registeredModels = map[loggedModelId] || [];\n        const name = modelVersion.displayedName ?? undefined;\n        registeredModels.push({\n          registeredModelName: name,\n          registeredModelVersion: modelVersion.version ?? undefined,\n          isUc: isUCModelName(name ?? ''),\n          artifactPath: modelVersion.sourceLoggedModel?.info?.artifact_uri ?? '',\n          flavors: [],\n          originalLoggedModel: modelVersion.sourceLoggedModel,\n        });\n        map[loggedModelId] = registeredModels;\n      }\n    });\n    return map;\n  }, [registeredModelVersions]);\n\n  // Merge legacy models with registered model versions from V3 logged models.\n  const registeredModelsToDisplay = useMemo(() => {\n    const allModels = [...modelsLegacy, ...Array.from(values(registeredModelVersionsByLoggedModel)).flat()];\n    // Remove duplicates (it's not impossible to reference the same model version twice in a single logged model)\n    return uniqBy(allModels, (model) =>\n      JSON.stringify(\n        model.registeredModelName && model.registeredModelVersion\n          ? [model.registeredModelName, model.registeredModelVersion?.toString()]\n          : [model.artifactPath],\n      ),\n    );\n  }, [modelsLegacy, registeredModelVersionsByLoggedModel]);\n\n  const containsModels = !isEmpty(registeredModelsToDisplay) || !isEmpty(loggedModelsV3);\n\n  if (!props.value) {\n    return <>{EMPTY_CELL_PLACEHOLDER}</>;\n  }\n\n  if (containsModels) {\n    return (\n      // <Overflow /> component does not ideally fit within ag-grid cell so we need to override its styles a bit\n      <div css={{ width: '100%', '&>div': { maxWidth: '100%', display: 'flex' } }}>\n        <Overflow>\n          {registeredModelsToDisplay.map((model, index) => (\n            <ModelLink model={model} key={model.artifactPath || index} experimentId={experimentId} runUuid={runUuid} />\n          ))}\n          {loggedModelsV3?.map((model, index) => {\n            // Display logged model only if it does not have registered model versions associated with it.\n            const modelId = model.info?.model_id;\n            const loggedModelRegisteredVersions = modelId ? registeredModelVersionsByLoggedModel[modelId] : [];\n            if (!isEmpty(loggedModelRegisteredVersions)) {\n              return null;\n            }\n\n            return <LoggedModelV3Link key={model.info?.model_id ?? index} model={model} />;\n          })}\n        </Overflow>\n      </div>\n    );\n  }\n  return <>{EMPTY_CELL_PLACEHOLDER}</>;\n});\n","import React from 'react';\nimport {\n  SortAscendingIcon,\n  SortDescendingIcon,\n  LegacyTooltip,\n  useDesignSystemTheme,\n  InfoTooltip,\n} from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { ATTRIBUTE_COLUMN_LABELS } from '../../../../../constants';\nimport {\n  shouldUnifyLoggedModelsAndRegisteredModels,\n  shouldUseGetLoggedModelsBatchAPI,\n} from '../../../../../../common/utils/FeatureUtils';\n\nexport const ModelsHeaderCellRenderer = React.memo(() => {\n  const { theme } = useDesignSystemTheme();\n\n  // Check if we are using:\n  // - unified (registered and logged) models\n  // - models based on run's inputs and outputs\n  // We'll use it to display better tooltip\n  const isUsingUnifiedModels = shouldUnifyLoggedModelsAndRegisteredModels() && shouldUseGetLoggedModelsBatchAPI();\n\n  return (\n    <div\n      role=\"columnheader\"\n      css={{\n        height: '100%',\n        width: '100%',\n        display: 'flex',\n        alignItems: 'center',\n        padding: '0 12px',\n        gap: theme.spacing.xs,\n      }}\n    >\n      {isUsingUnifiedModels ? (\n        <>\n          {ATTRIBUTE_COLUMN_LABELS.MODELS}\n          <InfoTooltip\n            componentId=\"mlflow.experiment_view_runs_table.column_header.models.tooltip\"\n            content={\n              <FormattedMessage\n                defaultMessage=\"This column contains all models logged or evaluated by the run. Click into an individual run to see more detailed information about all models associated with it.\"\n                description='A descriptive tooltip for the \"Models\" column header in the runs table on the MLflow experiment detail page'\n              />\n            }\n          />\n        </>\n      ) : (\n        <LegacyTooltip\n          title={\n            <FormattedMessage\n              defaultMessage=\"Click into an individual run to see all models associated with it\"\n              description='MLflow experiment detail page > runs table > tooltip on ML \"Models\" column header'\n            />\n          }\n        >\n          {ATTRIBUTE_COLUMN_LABELS.MODELS}\n        </LegacyTooltip>\n      )}\n    </div>\n  );\n});\n","import React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowVersionInfo } from '../../../utils/experimentPage.row-types';\n\nexport const VersionCellRenderer = React.memo(({ value }: { value?: RunRowVersionInfo }) => {\n  if (!value) {\n    return <>-</>;\n  }\n  const {\n    // Run row version object parameters\n    version,\n    name,\n    type,\n  } = value;\n\n  return (\n    Utils.renderSourceVersion(\n      // Using function from utils to render the source link\n      version,\n      name,\n      type,\n    ) || <>-</>\n  );\n});\n","import { Icon, LegacyTooltip, VisibleOffIcon, useDesignSystemTheme, visuallyHidden } from '@databricks/design-system';\nimport { RUNS_VISIBILITY_MODE } from '../../../models/ExperimentPageUIState';\nimport { ReactComponent as VisibleFillIcon } from '../../../../../../common/static/icon-visible-fill.svg';\nimport { Theme } from '@emotion/react';\n\nconst VisibleIcon = () => <Icon component={VisibleFillIcon} />;\n\ninterface RunVisibilityControlButtonProps {\n  className?: string;\n  runUuid: string;\n  rowHidden: boolean;\n  buttonHidden: boolean;\n  disabled: boolean;\n  onClick: (runUuidOrToggle: string | RUNS_VISIBILITY_MODE, runUuid?: string, isRowVisible?: boolean) => void;\n  label: React.ReactNode;\n}\n\n// Mouse enter/leave delays passed to tooltips are set to 0 so swift toggling/pinning runs is not hampered\nconst MOUSE_DELAYS = { mouseEnterDelay: 0, mouseLeaveDelay: 0 };\n\nexport const RunVisibilityControlButton = ({\n  runUuid,\n  className,\n  rowHidden,\n  buttonHidden,\n  disabled,\n  onClick,\n  label,\n}: RunVisibilityControlButtonProps) => {\n  const { theme } = useDesignSystemTheme();\n  if (buttonHidden) {\n    return <div className={className} css={[styles.button(theme)]} />;\n  }\n  if (disabled) {\n    return (\n      <VisibleOffIcon\n        className={className}\n        css={[\n          styles.button(theme),\n          {\n            opacity: 0.25,\n            color: theme.colors.grey400,\n          },\n        ]}\n      />\n    );\n  }\n  return (\n    <LegacyTooltip dangerouslySetAntdProps={MOUSE_DELAYS} placement=\"right\" title={label}>\n      <label className={className} css={styles.button(theme)}>\n        <span css={visuallyHidden}>{label}</span>\n        <input\n          type=\"checkbox\"\n          className=\"is-visibility-toggle-checkbox\"\n          checked={!rowHidden}\n          onChange={() => {\n            if (runUuid) {\n              const isRowVisible = !rowHidden;\n              onClick(RUNS_VISIBILITY_MODE.CUSTOM, runUuid, isRowVisible);\n            }\n          }}\n        />\n        {!rowHidden ? <VisibleIcon /> : <VisibleOffIcon />}\n      </label>\n    </LegacyTooltip>\n  );\n};\n\nconst styles = {\n  button: (theme: Theme) => ({\n    width: theme.general.iconFontSize,\n    color: theme.colors.grey400,\n    '.ag-row:hover &': {\n      color: theme.colors.grey500,\n    },\n  }),\n};\n","import React, { useMemo } from 'react';\nimport { RUNS_VISIBILITY_MODE } from '../../models/ExperimentPageUIState';\n\nconst ExperimentViewRunsTableHeaderContext = React.createContext({\n  runsHiddenMode: RUNS_VISIBILITY_MODE.FIRST_10_RUNS,\n  useGroupedValuesInCharts: true,\n  usingCustomVisibility: false,\n  allRunsHidden: false,\n});\n\n/**\n * A tiny context that passes the current runs hidden mode to the header cell renderer.\n *\n * This is needed because ag-grid context is unreliable and does not always update when the\n * runs hidden mode changes. The solution below is way more performant than recreating column definitions\n * based on a new value.\n */\nexport const ExperimentViewRunsTableHeaderContextProvider = ({\n  children,\n  runsHiddenMode,\n  useGroupedValuesInCharts,\n  usingCustomVisibility,\n  allRunsHidden,\n}: {\n  children: React.ReactNode;\n  runsHiddenMode: RUNS_VISIBILITY_MODE;\n  useGroupedValuesInCharts?: boolean;\n  /**\n   * Whether the user is using custom visibility settings (at least one row is configured manually)\n   */\n  usingCustomVisibility?: boolean;\n  /**\n   * Whether all runs are hidden\n   */\n  allRunsHidden?: boolean;\n}) => {\n  const contextValue = useMemo(\n    () => ({\n      runsHiddenMode,\n      useGroupedValuesInCharts: useGroupedValuesInCharts ?? true,\n      usingCustomVisibility: usingCustomVisibility ?? false,\n      allRunsHidden: allRunsHidden ?? false,\n    }),\n    [runsHiddenMode, useGroupedValuesInCharts, usingCustomVisibility, allRunsHidden],\n  );\n  return (\n    <ExperimentViewRunsTableHeaderContext.Provider value={contextValue}>\n      {children}\n    </ExperimentViewRunsTableHeaderContext.Provider>\n  );\n};\n\nexport const useExperimentViewRunsTableHeaderContext = () => React.useContext(ExperimentViewRunsTableHeaderContext);\n","import {\n  PinIcon,\n  PinFillIcon,\n  LegacyTooltip,\n  VisibleIcon as VisibleHollowIcon,\n  VisibleOffIcon,\n  useDesignSystemTheme,\n  Icon,\n  visuallyHidden,\n} from '@databricks/design-system';\nimport type { SuppressKeyboardEventParams } from '@ag-grid-community/core';\n\n// TODO: Import this icon from design system when added\nimport { ReactComponent as VisibleFillIcon } from '../../../../../../common/static/icon-visible-fill.svg';\nimport { Theme } from '@emotion/react';\nimport React, { useMemo } from 'react';\nimport { FormattedMessage, defineMessages } from 'react-intl';\nimport { RunRowType, RunRowVisibilityControl } from '../../../utils/experimentPage.row-types';\nimport { shouldEnableToggleIndividualRunsInGroups } from '../../../../../../common/utils/FeatureUtils';\nimport { useUpdateExperimentViewUIState } from '../../../contexts/ExperimentPageUIStateContext';\nimport { RUNS_VISIBILITY_MODE } from '../../../models/ExperimentPageUIState';\nimport { isRemainingRunsGroup } from '../../../utils/experimentPage.group-row-utils';\nimport { RunVisibilityControlButton } from './RunVisibilityControlButton';\nimport { useExperimentViewRunsTableHeaderContext } from '../ExperimentViewRunsTableHeaderContext';\n\nconst labels = {\n  visibility: {\n    groups: defineMessages({\n      unhide: {\n        defaultMessage: 'Unhide group',\n        description: 'A tooltip for the visibility icon button in the runs table next to the hidden run group',\n      },\n      hide: {\n        defaultMessage: 'Hide group',\n        description: 'A tooltip for the visibility icon button in the runs table next to the visible run group',\n      },\n    }),\n    runs: defineMessages({\n      unhide: {\n        defaultMessage: 'Unhide run',\n        description: 'A tooltip for the visibility icon button in the runs table next to the hidden run',\n      },\n      hide: {\n        defaultMessage: 'Hide run',\n        description: 'A tooltip for the visibility icon button in the runs table next to the visible run',\n      },\n    }),\n  },\n  pinning: {\n    groups: defineMessages({\n      unpin: {\n        defaultMessage: 'Unpin group',\n        description: 'A tooltip for the pin icon button in the runs table next to the pinned run group',\n      },\n      pin: {\n        defaultMessage: 'Pin group',\n        description: 'A tooltip for the pin icon button in the runs table next to the not pinned run group',\n      },\n    }),\n    runs: defineMessages({\n      unpin: {\n        defaultMessage: 'Unpin run',\n        description: 'A tooltip for the pin icon button in the runs table next to the pinned run',\n      },\n      pin: {\n        defaultMessage: 'Pin run',\n        description: 'A tooltip for the pin icon button in the runs table next to the not pinned run',\n      },\n    }),\n  },\n};\n\n// Mouse enter/leave delays passed to tooltips are set to 0 so swift toggling/pinning runs is not hampered\nconst MOUSE_DELAYS = { mouseEnterDelay: 0, mouseLeaveDelay: 0 };\n\nexport const RowActionsCellRenderer = React.memo(\n  (props: {\n    data: RunRowType;\n    value: { pinned: boolean; hidden: boolean };\n    onTogglePin: (runUuid: string) => void;\n    onToggleVisibility: (runUuidOrToggle: string | RUNS_VISIBILITY_MODE, runUuid?: string) => void;\n  }) => {\n    const updateUIState = useUpdateExperimentViewUIState();\n    const { theme } = useDesignSystemTheme();\n    const { useGroupedValuesInCharts } = useExperimentViewRunsTableHeaderContext();\n\n    const { groupParentInfo, runDateAndNestInfo, visibilityControl } = props.data;\n    const { belongsToGroup } = runDateAndNestInfo || {};\n    const isGroupRow = Boolean(groupParentInfo);\n    const isVisibilityButtonDisabled =\n      shouldEnableToggleIndividualRunsInGroups() && visibilityControl === RunRowVisibilityControl.Disabled;\n    const { pinned, hidden } = props.value;\n    const { runUuid, rowUuid } = props.data;\n\n    // If a row is a run group, we use its rowUuid for setting visibility.\n    // If this is a run, use runUuid.\n    const runUuidToToggle = groupParentInfo ? rowUuid : runUuid;\n\n    const isRowHidden = (() => {\n      // If \"Use grouping from the runs table in charts\" option is off and we're displaying a group,\n      // we should check if all runs in the group are hidden in order to determine visibility toggle.\n      if (shouldEnableToggleIndividualRunsInGroups() && useGroupedValuesInCharts === false && groupParentInfo) {\n        return Boolean(groupParentInfo.allRunsHidden);\n      }\n\n      // Otherwise, we should use the hidden flag from the row itself.\n      return hidden;\n    })();\n\n    const visibilityMessageDescriptor = isGroupRow\n      ? isRowHidden\n        ? labels.visibility.groups.unhide\n        : labels.visibility.groups.hide\n      : isRowHidden\n      ? labels.visibility.runs.unhide\n      : labels.visibility.runs.hide;\n\n    const pinningMessageDescriptor = isGroupRow\n      ? pinned\n        ? labels.pinning.groups.unpin\n        : labels.pinning.groups.pin\n      : pinned\n      ? labels.pinning.runs.unpin\n      : labels.pinning.runs.pin;\n\n    const isVisibilityButtonHidden = useMemo(() => {\n      if (shouldEnableToggleIndividualRunsInGroups()) {\n        return visibilityControl === RunRowVisibilityControl.Hidden;\n      }\n      return !((groupParentInfo && !isRemainingRunsGroup(groupParentInfo)) || (Boolean(runUuid) && !belongsToGroup));\n    }, [groupParentInfo, belongsToGroup, runUuid, visibilityControl]);\n\n    return (\n      <div css={styles.actionsContainer}>\n        <RunVisibilityControlButton\n          rowHidden={isRowHidden}\n          buttonHidden={isVisibilityButtonHidden}\n          disabled={isVisibilityButtonDisabled}\n          label={<FormattedMessage {...visibilityMessageDescriptor} />}\n          onClick={props.onToggleVisibility}\n          runUuid={runUuidToToggle}\n          css={[\n            styles.actionCheckbox(theme),\n            // We show this button only in the runs compare mode\n            styles.showOnlyInCompareMode,\n          ]}\n        />\n        {((props.data.pinnable && runUuid) || groupParentInfo) && (\n          <LegacyTooltip\n            dangerouslySetAntdProps={MOUSE_DELAYS}\n            placement=\"right\"\n            // We have to force remount of the tooltip with every rerender, otherwise it will jump\n            // around when the row order changes.\n            key={Math.random()}\n            title={<FormattedMessage {...pinningMessageDescriptor} />}\n          >\n            <label css={styles.actionCheckbox(theme)} className=\"is-pin-toggle\" data-testid=\"column-pin-toggle\">\n              <span css={visuallyHidden}>\n                <FormattedMessage {...pinningMessageDescriptor} />\n              </span>\n              <input\n                type=\"checkbox\"\n                checked={pinned}\n                onChange={() => {\n                  const uuidToPin = groupParentInfo ? props.data.rowUuid : runUuid;\n                  updateUIState((existingState) => {\n                    if (uuidToPin) {\n                      return {\n                        ...existingState,\n                        runsPinned: !existingState.runsPinned.includes(uuidToPin)\n                          ? [...existingState.runsPinned, uuidToPin]\n                          : existingState.runsPinned.filter((r) => r !== uuidToPin),\n                      };\n                    }\n                    return existingState;\n                  });\n                }}\n              />\n              {pinned ? <PinFillIcon /> : <PinIcon />}\n            </label>\n          </LegacyTooltip>\n        )}\n      </div>\n    );\n  },\n  (prevProps, nextProps) =>\n    prevProps.value.hidden === nextProps.value.hidden &&\n    prevProps.value.pinned === nextProps.value.pinned &&\n    prevProps.data.visibilityControl === nextProps.data.visibilityControl &&\n    prevProps.data.groupParentInfo?.allRunsHidden === nextProps.data.groupParentInfo?.allRunsHidden,\n);\n\n/**\n * A utility function that enables custom keyboard navigation for the row actions cell renderer by providing\n * conditional suppression of default events.\n */\nexport const RowActionsCellRendererSuppressKeyboardEvents = ({ event }: SuppressKeyboardEventParams) => {\n  if (\n    event.key === 'Tab' &&\n    event.target instanceof HTMLElement &&\n    // Let's suppress the default action if the focus is on cell or on visibility toggle checkbox, allowing\n    // tab to move to the next focusable element.\n    (event.target.classList.contains('ag-cell') || event.target.classList.contains('is-visibility-toggle-checkbox'))\n  ) {\n    return true;\n  }\n  return false;\n};\n\nconst styles = {\n  actionsContainer: {\n    display: 'flex',\n    gap: 18, // In design there's 20 px of gutter, it's minus 2 px due to pin icon's internal padding\n  },\n  showOnlyInCompareMode: {\n    display: 'none',\n    '.is-table-comparing-runs-mode &': {\n      display: 'flex',\n    },\n  },\n  actionCheckbox: (theme: Theme) => ({\n    input: { width: 0, appearance: 'none' as const },\n    cursor: 'pointer',\n    display: 'flex',\n    svg: {\n      width: theme.general.iconFontSize,\n      height: theme.general.iconFontSize,\n      cursor: 'pointer',\n    },\n    // Styling for the pin button - it's transparent when unpinned and not hovered\n    '&.is-pin-toggle svg': {\n      color: 'transparent',\n      '.ag-row:hover &': {\n        color: theme.colors.grey500,\n      },\n    },\n    '& input:checked + span svg': {\n      color: theme.colors.grey500,\n    },\n    '& input:focus-visible + span svg': {\n      color: theme.colors.grey500,\n    },\n  }),\n};\n","import { DashIcon, DropdownMenu, Icon, VisibleOffIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useEffect } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { RUNS_VISIBILITY_MODE } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/models/ExperimentPageUIState';\n// TODO: Import this icon from design system when added\nimport { ReactComponent as VisibleFillIcon } from '../../../../../../common/static/icon-visible-fill.svg';\nimport { useExperimentViewRunsTableHeaderContext } from '../ExperimentViewRunsTableHeaderContext';\n\nconst VisibleIcon = () => <Icon component={VisibleFillIcon} />;\n\nconst RowActionsHeaderCellRendererV2 = React.memo(\n  ({\n    onToggleVisibility,\n  }: {\n    onToggleVisibility: (mode: RUNS_VISIBILITY_MODE | string, runOrGroupUuid?: string) => void;\n  }) => {\n    const { theme } = useDesignSystemTheme();\n    const intl = useIntl();\n    const { runsHiddenMode, usingCustomVisibility, allRunsHidden } = useExperimentViewRunsTableHeaderContext();\n\n    return (\n      <DropdownMenu.Root modal={false}>\n        <DropdownMenu.Trigger asChild>\n          <button\n            css={[\n              styles.actionButton(theme),\n              // We show this button only in the runs compare mode\n              styles.showOnlyInCompareMode,\n            ]}\n            data-testid=\"experiment-view-runs-visibility-column-header\"\n            aria-label={intl.formatMessage({\n              defaultMessage: 'Toggle visibility of runs',\n              description: 'Experiment page > runs table > toggle visibility of runs > accessible label',\n            })}\n          >\n            {runsHiddenMode === RUNS_VISIBILITY_MODE.HIDEALL || allRunsHidden ? <VisibleOffIcon /> : <VisibleIcon />}\n          </button>\n        </DropdownMenu.Trigger>\n\n        <DropdownMenu.Content>\n          <DropdownMenu.RadioGroup\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_rowactionsheadercellrenderer.tsx_52\"\n            value={runsHiddenMode}\n            onValueChange={(e) => onToggleVisibility(e)}\n          >\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.FIRST_10_RUNS}>\n              {/* Dropdown menu does not support indeterminate state, so we're doing it manually */}\n              <DropdownMenu.ItemIndicator>{usingCustomVisibility ? <DashIcon /> : null}</DropdownMenu.ItemIndicator>\n              <FormattedMessage\n                defaultMessage=\"Show first 10\"\n                description=\"Menu option for showing only 10 first runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.FIRST_20_RUNS}>\n              <DropdownMenu.ItemIndicator>{usingCustomVisibility ? <DashIcon /> : null}</DropdownMenu.ItemIndicator>\n              <FormattedMessage\n                defaultMessage=\"Show first 20\"\n                description=\"Menu option for showing only 10 first runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.SHOWALL}>\n              <DropdownMenu.ItemIndicator>{usingCustomVisibility ? <DashIcon /> : null}</DropdownMenu.ItemIndicator>\n              <FormattedMessage\n                defaultMessage=\"Show all runs\"\n                description=\"Menu option for revealing all hidden runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.HIDEALL}>\n              <DropdownMenu.ItemIndicator>{usingCustomVisibility ? <DashIcon /> : null}</DropdownMenu.ItemIndicator>\n              <FormattedMessage\n                defaultMessage=\"Hide all runs\"\n                description=\"Menu option for revealing all hidden runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n          </DropdownMenu.RadioGroup>\n        </DropdownMenu.Content>\n      </DropdownMenu.Root>\n    );\n  },\n);\n\n/**\n * A component used to render \"eye\" icon in the table header used to hide/show all runs\n */\nexport const RowActionsHeaderCellRenderer = React.memo(\n  (props: {\n    allRunsHidden?: boolean;\n    usingCustomVisibility?: boolean;\n    onToggleVisibility: (runUuidOrToggle: string) => void;\n    eGridHeader?: HTMLElement;\n  }) => {\n    const intl = useIntl();\n\n    // Since ag-grid does not add accessible labels to its checkboxes, we do it manually.\n    // This is executed once per table lifetime.\n    useEffect(() => {\n      // Find a checkbox in the header\n      const selectAllCheckbox = props.eGridHeader?.querySelector('input');\n\n      // If found, assign aria-label attribute\n      if (selectAllCheckbox) {\n        selectAllCheckbox.ariaLabel = intl.formatMessage({\n          defaultMessage: 'Select all runs',\n          description: 'Experiment page > runs table > select all rows > accessible label',\n        });\n      }\n    }, [props.eGridHeader, intl]);\n\n    return <RowActionsHeaderCellRendererV2 {...props} />;\n  },\n);\n\nconst styles = {\n  actionButton: (theme: Theme) => ({\n    background: 'transparent',\n    border: 'none',\n    cursor: 'pointer',\n    padding: '8px',\n    // When visibility icon is next to the ag-grid checkbox, remove the bonus padding\n    '.ag-checkbox:not(.ag-hidden) + &': { padding: '0 1px' },\n    svg: {\n      width: theme.general.iconFontSize,\n      height: theme.general.iconFontSize,\n      cursor: 'pointer',\n      color: theme.colors.grey500,\n    },\n  }),\n  showOnlyInCompareMode: {\n    display: 'none',\n    '.is-table-comparing-runs-mode &': {\n      display: 'flex',\n    },\n  },\n};\n","import { ICellRendererParams } from '@ag-grid-community/core';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport {\n  Button,\n  ChevronDownIcon,\n  ChevronRightIcon,\n  NewWindowIcon,\n  Tag,\n  Tooltip,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport {\n  createSearchFilterFromRunGroupInfo,\n  getRunGroupDisplayName,\n  isRemainingRunsGroup,\n} from '../../../utils/experimentPage.group-row-utils';\nimport { useUpdateExperimentViewUIState } from '../../../contexts/ExperimentPageUIStateContext';\nimport { useCallback, useMemo } from 'react';\nimport { RunColorPill } from '../../RunColorPill';\nimport invariant from 'invariant';\nimport { FormattedMessage } from 'react-intl';\nimport { useGetExperimentRunColor, useSaveExperimentRunColor } from '../../../hooks/useExperimentRunColor';\nimport { useExperimentViewRunsTableHeaderContext } from '../ExperimentViewRunsTableHeaderContext';\nimport { shouldEnableToggleIndividualRunsInGroups } from '../../../../../../common/utils/FeatureUtils';\nimport { Link, To, useLocation } from '../../../../../../common/utils/RoutingUtils';\nimport { EXPERIMENT_PAGE_QUERY_PARAM_IS_PREVIEW } from '../../../hooks/useExperimentPageSearchFacets';\n\nexport interface GroupParentCellRendererProps extends ICellRendererParams {\n  data: RunRowType;\n  isComparingRuns?: boolean;\n}\n\nexport const GroupParentCellRenderer = ({ data, isComparingRuns }: GroupParentCellRendererProps) => {\n  const groupParentInfo = data.groupParentInfo;\n  const hidden = data.hidden;\n  invariant(groupParentInfo, 'groupParentInfo should be defined');\n  const { theme } = useDesignSystemTheme();\n  const location = useLocation();\n\n  const { useGroupedValuesInCharts } = useExperimentViewRunsTableHeaderContext();\n  const getRunColor = useGetExperimentRunColor();\n  const saveRunColor = useSaveExperimentRunColor();\n  const updateUIState = useUpdateExperimentViewUIState();\n  const onExpandToggle = useCallback(\n    (groupId: string, doOpen: boolean) => {\n      updateUIState((current) => {\n        const { groupsExpanded } = current;\n        return {\n          ...current,\n          groupsExpanded: { ...groupsExpanded, [groupId]: doOpen },\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  const groupName = getRunGroupDisplayName(groupParentInfo);\n  const groupIsDisplayedInCharts = useMemo(() => {\n    if (shouldEnableToggleIndividualRunsInGroups()) {\n      return useGroupedValuesInCharts && !isRemainingRunsGroup(groupParentInfo);\n    }\n\n    return !isRemainingRunsGroup(groupParentInfo);\n  }, [groupParentInfo, useGroupedValuesInCharts]);\n\n  const urlToRunUuidsFilter = useMemo(() => {\n    const filter = createSearchFilterFromRunGroupInfo(groupParentInfo);\n\n    const searchParams = new URLSearchParams(location.search);\n    searchParams.set('searchFilter', filter);\n    searchParams.set(EXPERIMENT_PAGE_QUERY_PARAM_IS_PREVIEW, 'true');\n    const destination: To = {\n      ...location,\n      search: searchParams.toString(),\n    };\n\n    return destination;\n  }, [groupParentInfo, location]);\n\n  return (\n    <div css={{ display: 'flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n      {groupParentInfo.expanderOpen ? (\n        <ChevronDownIcon\n          role=\"button\"\n          onClick={() => {\n            onExpandToggle(groupParentInfo.groupId, false);\n          }}\n        />\n      ) : (\n        <ChevronRightIcon\n          role=\"button\"\n          onClick={() => {\n            onExpandToggle(groupParentInfo.groupId, true);\n          }}\n        />\n      )}\n      {/* Display color pill only when it's displayed in chart area */}\n      {groupIsDisplayedInCharts && (\n        <RunColorPill\n          color={getRunColor(groupParentInfo.groupId)}\n          hidden={isComparingRuns && hidden}\n          onChangeColor={(colorValue) => {\n            saveRunColor({ groupUuid: groupParentInfo.groupId, colorValue });\n          }}\n        />\n      )}\n      <div\n        css={{\n          display: 'inline-flex',\n          gap: theme.spacing.sm,\n          alignItems: 'center',\n          overflow: 'hidden',\n          textOverflow: 'ellipsis',\n        }}\n      >\n        {isRemainingRunsGroup(groupParentInfo) ? (\n          <FormattedMessage\n            defaultMessage=\"Additional runs\"\n            description=\"Experiment page > grouped runs table > label for group with additional, ungrouped runs\"\n          />\n        ) : (\n          <span title={groupName} css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>\n            <FormattedMessage\n              defaultMessage=\"Group: {groupName}\"\n              description=\"Experiment page > grouped runs table > run group header label\"\n              values={{ groupName }}\n            />\n          </span>\n        )}\n        <Tag\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_groupparentcellrenderer.tsx_109\"\n          css={{ marginLeft: 0, marginRight: 0 }}\n        >\n          {groupParentInfo.runUuids.length}\n        </Tag>\n        <Tooltip\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_groupparentcellrenderer.tsx_136\"\n          content={\n            <FormattedMessage\n              defaultMessage=\"Open runs in this group in the new tab\"\n              description=\"Experiment page > grouped runs table > tooltip for a button that opens runs in a group in a new tab\"\n            />\n          }\n        >\n          <Link\n            to={urlToRunUuidsFilter}\n            target=\"_blank\"\n            css={{\n              marginLeft: -theme.spacing.xs,\n              display: 'none',\n              '.ag-row-hover &': {\n                display: 'inline-flex',\n              },\n            }}\n          >\n            <Button\n              type=\"link\"\n              componentId=\"mlflow.experiment_page.grouped_runs.open_runs_in_new_tab\"\n              size=\"small\"\n              icon={<NewWindowIcon css={{ svg: { width: 12, height: 12 } }} />}\n            />\n          </Link>\n        </Tooltip>\n      </div>\n    </div>\n  );\n};\n","import { ICellRendererParams } from '@ag-grid-community/core';\nimport { Button, MinusSquareIcon, PlusSquareIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useMemo } from 'react';\nimport { Link } from '../../../../../../common/utils/RoutingUtils';\nimport Routes from '../../../../../routes';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { GroupParentCellRenderer } from './GroupParentCellRenderer';\nimport invariant from 'invariant';\nimport { RunColorPill } from '../../RunColorPill';\nimport { shouldEnableToggleIndividualRunsInGroups } from '../../../../../../common/utils/FeatureUtils';\nimport { useGetExperimentRunColor, useSaveExperimentRunColor } from '../../../hooks/useExperimentRunColor';\nimport { useExperimentViewRunsTableHeaderContext } from '../ExperimentViewRunsTableHeaderContext';\n\nexport interface RunNameCellRendererProps extends ICellRendererParams {\n  data: RunRowType;\n  isComparingRuns?: boolean;\n  onExpand: (runUuid: string, childrenIds?: string[]) => void;\n}\n\nexport const RunNameCellRenderer = React.memo((props: RunNameCellRendererProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const saveRunColor = useSaveExperimentRunColor();\n  const getRunColor = useGetExperimentRunColor();\n  const { useGroupedValuesInCharts } = useExperimentViewRunsTableHeaderContext();\n\n  // If we're rendering a group row, use relevant component\n  if (props.data.groupParentInfo) {\n    return <GroupParentCellRenderer {...props} />;\n  }\n  const { onExpand, data } = props;\n  const { runName, experimentId, runUuid, runDateAndNestInfo, hidden } = data;\n\n  // If we are not rendering a group, assert existence of necessary fields\n  invariant(experimentId, 'experimentId should be set for run rows');\n  invariant(runUuid, 'runUuid should be set for run rows');\n  invariant(runDateAndNestInfo, 'runDateAndNestInfo should be set for run rows');\n\n  const { hasExpander, expanderOpen, childrenIds, level, belongsToGroup } = runDateAndNestInfo;\n\n  const renderingAsParent = !isNaN(level) && hasExpander;\n  const hideRunColorControl = (() => {\n    if (shouldEnableToggleIndividualRunsInGroups()) {\n      return belongsToGroup && useGroupedValuesInCharts;\n    }\n    return belongsToGroup;\n  })();\n\n  return (\n    <div css={styles.cellWrapper}>\n      <div css={styles.expanderWrapper}>\n        <div\n          css={styles.nestLevel(theme)}\n          style={{\n            width: (level + 1) * theme.spacing.lg,\n          }}\n        >\n          {renderingAsParent && (\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_runnamecellrenderer.tsx_46\"\n              css={styles.expanderButton}\n              size=\"small\"\n              onClick={() => {\n                onExpand(runUuid, childrenIds);\n              }}\n              key={'Expander-' + runUuid}\n              type=\"link\"\n              icon={expanderOpen ? <MinusSquareIcon /> : <PlusSquareIcon />}\n            />\n          )}\n        </div>\n      </div>\n      <div css={styles.runLink}>\n        {hideRunColorControl ? (\n          // Render empty color pills for grouped runs\n          <div css={{ width: 12, height: 12, flexShrink: 0 }} />\n        ) : (\n          <RunColorPill\n            color={getRunColor(runUuid)}\n            hidden={props.isComparingRuns && hidden}\n            data-testid=\"experiment-view-table-run-color\"\n            onChangeColor={(colorValue) => saveRunColor({ runUuid, colorValue })}\n          />\n        )}\n        <Link to={Routes.getRunPageRoute(experimentId, runUuid)} css={styles.runLink} tabIndex={0}>\n          <span css={styles.runName}>{runName}</span>\n        </Link>\n      </div>\n    </div>\n  );\n});\n\nconst styles = {\n  link: (theme: Theme) => ({\n    display: 'inline-block',\n    minWidth: theme.typography.fontSizeBase,\n    minHeight: theme.typography.fontSizeBase,\n  }),\n  cellWrapper: {\n    display: 'flex',\n  },\n  expanderButton: {\n    svg: {\n      width: 12,\n      height: 12,\n    },\n  },\n  runLink: {\n    overflow: 'hidden',\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n    '&:focus-visible': {\n      textDecoration: 'underline',\n    },\n  },\n  runName: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  expanderWrapper: {\n    display: 'none',\n    '.ag-grid-expanders-visible &': {\n      display: 'block',\n    },\n  },\n  nestLevel: (theme: Theme) => ({\n    display: 'flex',\n    justifyContent: 'flex-end',\n    height: theme.spacing.lg,\n  }),\n};\n","import type { ICellRendererParams } from '@ag-grid-community/core';\nimport { Button } from '@databricks/design-system';\nimport { uniqueId } from 'lodash';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport const createLoadMoreRow = () => ({\n  runUuid: '',\n  rowUuid: uniqueId('load_more'),\n  isLoadMoreRow: true,\n});\n\n/**\n * A cell renderer for special type of full width rows housing \"Load more\"\n * button displayed at the bottom of the grid\n */\nexport const LoadMoreRowRenderer = React.memo(\n  ({ loadMoreRunsFunc }: ICellRendererParams & { loadMoreRunsFunc: () => void }) => (\n    <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: 32 }}>\n      <Button\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_loadmorerowrenderer.tsx_20\"\n        type=\"primary\"\n        onClick={loadMoreRunsFunc}\n        size=\"small\"\n      >\n        <FormattedMessage defaultMessage=\"Load more\" description=\"Load more button text to load more experiment runs\" />\n      </Button>\n    </div>\n  ),\n);\n","import { throttle } from 'lodash';\nimport { Button, Popover, TableIcon, Tag, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useRef, useEffect, useState, useMemo } from 'react';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../../constants';\nimport type { RunDatasetWithTags } from '../../../../../types';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { EXPERIMENT_RUNS_TABLE_ROW_HEIGHT } from '../../../utils/experimentPage.common-utils';\nimport type { SuppressKeyboardEventParams } from '@ag-grid-community/core';\nconst MAX_DATASETS_VISIBLE = 3;\n\n/**\n * Local component, used to render a single dataset within a cell\n * or a context menu\n */\nconst SingleDataset = ({\n  datasetWithTags,\n  onDatasetSelected,\n  appendComma = false,\n  inPopover = false,\n}: {\n  datasetWithTags: RunDatasetWithTags;\n  onDatasetSelected: () => void;\n  appendComma?: boolean;\n  inPopover?: boolean;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const { dataset, tags } = datasetWithTags;\n  if (!dataset) {\n    return null;\n  }\n  const contextTag = tags?.find(({ key }) => key === MLFLOW_RUN_DATASET_CONTEXT_TAG);\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexShrink: 0,\n        alignItems: 'center',\n        overflow: 'hidden',\n        marginRight: theme.spacing.xs,\n      }}\n    >\n      <TableIcon css={{ color: theme.colors.textSecondary, marginRight: theme.spacing.xs }} />{' '}\n      <span\n        css={{ minWidth: 32, marginRight: theme.spacing.xs, flexShrink: 0 }}\n        title={`${dataset.name} (${dataset.digest})`}\n      >\n        {inPopover ? (\n          <Popover.Close asChild>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_49\"\n              type=\"link\"\n              onClick={onDatasetSelected}\n              tabIndex={0}\n            >\n              <span css={{ fontSize: 12 }}>\n                {dataset.name} ({dataset.digest})\n              </span>\n            </Button>\n          </Popover.Close>\n        ) : (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_56\"\n            type=\"link\"\n            onClick={onDatasetSelected}\n            data-testid=\"open-dataset-drawer\"\n            tabIndex={0}\n          >\n            <span>\n              {dataset.name} ({dataset.digest})\n            </span>\n          </Button>\n        )}\n      </span>\n      {contextTag && (\n        <Tag\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_75\"\n          css={{ textTransform: 'capitalize', marginRight: theme.spacing.xs }}\n        >\n          <span css={{ fontSize: 12 }}>{contextTag.value}</span>\n        </Tag>\n      )}\n      {appendComma && <>,</>}\n    </div>\n  );\n};\n\nexport interface DatasetsCellRendererProps {\n  value: RunDatasetWithTags[];\n  data: RunRowType;\n  onDatasetSelected: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  expandRows: boolean;\n}\n\nexport const DatasetsCellRenderer = React.memo(\n  ({ value: datasets, data, onDatasetSelected, expandRows }: DatasetsCellRendererProps) => {\n    const containerElement = useRef<HTMLDivElement>(null);\n    const [datasetsVisible, setDatasetsVisible] = useState(0);\n    const [ellipsisVisible, setEllipsisVisible] = useState(false);\n    const clampedDatasets = useMemo(() => (datasets || []).slice(0, MAX_DATASETS_VISIBLE), [datasets]);\n    const { theme } = useDesignSystemTheme();\n\n    const datasetsLength = (datasets || []).length;\n\n    useEffect(() => {\n      if (!containerElement.current) {\n        return () => {};\n      }\n      const callback: ResizeObserverCallback = throttle(([entry]) => {\n        if (expandRows) {\n          const availableHeight = entry.contentRect.height;\n          let elementsFit = 0;\n          let stackedHeight = 0;\n          for (let i = 0; i < entry.target.children.length; i++) {\n            const item = entry.target.children.item(i) as Element;\n            if (stackedHeight + item.clientHeight > availableHeight) {\n              break;\n            }\n            stackedHeight += item.clientHeight;\n            elementsFit++;\n          }\n          setDatasetsVisible(elementsFit);\n          setEllipsisVisible(elementsFit < datasetsLength);\n        } else {\n          const availableWidth = entry.contentRect.width;\n          if (availableWidth === 0 && datasetsLength) {\n            setDatasetsVisible(0);\n            setEllipsisVisible(true);\n            return;\n          }\n          let elementsFit = 0;\n          let stackedWidth = 0;\n          for (let i = 0; i < entry.target.children.length; i++) {\n            const item = entry.target.children.item(i) as Element;\n            if (stackedWidth + item.clientWidth >= availableWidth) {\n              break;\n            }\n            stackedWidth += item.clientWidth;\n            elementsFit++;\n          }\n          const partiallyVisibleDatasets = Math.min(datasetsLength, elementsFit + 1);\n          setDatasetsVisible(partiallyVisibleDatasets);\n          setEllipsisVisible(elementsFit < datasetsLength);\n        }\n      }, 100);\n\n      const resizeObserver = new ResizeObserver(callback);\n\n      resizeObserver.observe(containerElement.current);\n      return () => resizeObserver.disconnect();\n    }, [expandRows, datasetsLength]);\n\n    const moreItemsToShow = datasetsLength - datasetsVisible;\n    if (!datasets || datasetsLength < 1) {\n      return <>-</>;\n    }\n\n    const datasetsToShow = expandRows ? clampedDatasets : datasets;\n\n    return (\n      <div css={{ display: 'flex' }}>\n        <div\n          css={{\n            overflow: 'hidden',\n            display: 'flex',\n            flexDirection: expandRows ? 'column' : 'row',\n          }}\n          ref={containerElement}\n        >\n          {datasetsToShow.map((datasetWithTags, index) => (\n            <SingleDataset\n              appendComma={expandRows ? false : index < datasetsToShow.length - 1}\n              key={`${datasetWithTags.dataset.name}-${datasetWithTags.dataset.digest}`}\n              datasetWithTags={datasetWithTags}\n              onDatasetSelected={() => onDatasetSelected?.(datasetWithTags, data)}\n            />\n          ))}\n        </div>\n        {(moreItemsToShow > 0 || ellipsisVisible) && (\n          <div css={{ display: 'flex', alignItems: 'flex-end' }}>\n            {!expandRows && ellipsisVisible && (\n              <span css={{ paddingLeft: 0, paddingRight: theme.spacing.xs }}>&hellip;</span>\n            )}\n            {moreItemsToShow > 0 && (\n              <Popover.Root\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_184\"\n                modal={false}\n              >\n                <Popover.Trigger asChild>\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_172\"\n                    size=\"small\"\n                    style={{ borderRadius: '8px', width: '40px' }}\n                    tabIndex={0}\n                  >\n                    <Typography.Text color=\"secondary\">+{moreItemsToShow}</Typography.Text>\n                  </Button>\n                </Popover.Trigger>\n                <Popover.Content align=\"start\" css={{ maxHeight: '400px', overflow: 'auto' }}>\n                  {datasets.slice(datasetsLength - moreItemsToShow).map((datasetWithTags) => (\n                    <div\n                      css={{\n                        height: theme.general.heightSm,\n                        display: 'flex',\n                        alignItems: 'center',\n                      }}\n                      key={`${datasetWithTags.dataset.name}-${datasetWithTags.dataset.digest}`}\n                    >\n                      <SingleDataset\n                        datasetWithTags={datasetWithTags}\n                        onDatasetSelected={() => onDatasetSelected?.(datasetWithTags, data)}\n                        inPopover\n                      />\n                    </div>\n                  ))}\n                </Popover.Content>\n              </Popover.Root>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  },\n);\n\nexport const getDatasetsCellHeight = (datasetColumnShown: boolean, row: { data: RunRowType }) => {\n  if (datasetColumnShown) {\n    const { data } = row;\n\n    // Display at least 1, but at most 5 text lines in the cell.\n    const datasetsCount = Math.min(data.datasets?.length || 1, MAX_DATASETS_VISIBLE);\n    return EXPERIMENT_RUNS_TABLE_ROW_HEIGHT * datasetsCount;\n  }\n  return EXPERIMENT_RUNS_TABLE_ROW_HEIGHT;\n};\n\n/**\n * A utility function that enables custom keyboard navigation for the datasets cell renderer by providing\n * conditional suppression of default events.\n *\n * This cell needs specific handling since it's the only one that displays multiple buttons simultaneously.\n */\nexport const DatasetsCellRendererSuppressKeyboardEvents = ({ event }: SuppressKeyboardEventParams) => {\n  return (\n    event.key === 'Tab' &&\n    event.target instanceof HTMLElement &&\n    // Let's suppress the default action if the focus is on cell or on the dataset button, allowing\n    // tab to move to the next focusable element.\n    (event.target.classList.contains('ag-cell') || event.target instanceof HTMLButtonElement)\n  );\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport const AggregateMetricValueCell = ({\n  value,\n  data,\n  valueFormatted,\n}: {\n  value: string;\n  valueFormatted: null | string;\n  data: RunRowType;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  if (data.groupParentInfo?.aggregateFunction) {\n    return (\n      <Typography.Text>\n        {valueFormatted ?? value}{' '}\n        <span css={{ color: theme.colors.textSecondary }}>({data.groupParentInfo.aggregateFunction})</span>\n      </Typography.Text>\n    );\n  }\n  return value;\n};\n","import type {\n  CellClassParams,\n  ColDef,\n  ColGroupDef,\n  ColumnApi,\n  IsFullWidthRowParams,\n  SuppressKeyboardEventParams,\n} from '@ag-grid-community/core';\nimport { Spinner, SpinnerProps, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useEffect, useMemo, useRef } from 'react';\nimport { isEqual } from 'lodash';\nimport Utils from '../../../../common/utils/Utils';\nimport { ATTRIBUTE_COLUMN_LABELS, ATTRIBUTE_COLUMN_SORT_KEY, COLUMN_TYPES } from '../../../constants';\nimport { ColumnHeaderCell } from '../components/runs/cells/ColumnHeaderCell';\nimport { DateCellRenderer } from '../components/runs/cells/DateCellRenderer';\nimport { RunDescriptionCellRenderer } from '../components/runs/cells/RunDescriptionCellRenderer';\nimport { ExperimentNameCellRenderer } from '../components/runs/cells/ExperimentNameCellRenderer';\nimport { ModelsCellRenderer } from '../components/runs/cells/ModelsCellRenderer';\nimport { ModelsHeaderCellRenderer } from '../components/runs/cells/ModelsHeaderCellRenderer';\nimport { SourceCellRenderer } from '../components/runs/cells/SourceCellRenderer';\nimport { VersionCellRenderer } from '../components/runs/cells/VersionCellRenderer';\nimport {\n  EXPERIMENT_FIELD_PREFIX_METRIC,\n  EXPERIMENT_FIELD_PREFIX_PARAM,\n  EXPERIMENT_FIELD_PREFIX_TAG,\n  getQualifiedEntityName,\n  makeCanonicalSortKey,\n} from './experimentPage.common-utils';\nimport { RunRowType } from './experimentPage.row-types';\nimport {\n  RowActionsCellRenderer,\n  RowActionsCellRendererSuppressKeyboardEvents,\n} from '../components/runs/cells/RowActionsCellRenderer';\nimport { RowActionsHeaderCellRenderer } from '../components/runs/cells/RowActionsHeaderCellRenderer';\nimport { RunNameCellRenderer } from '../components/runs/cells/RunNameCellRenderer';\nimport { LoadMoreRowRenderer } from '../components/runs/cells/LoadMoreRowRenderer';\nimport {\n  DatasetsCellRenderer,\n  DatasetsCellRendererSuppressKeyboardEvents,\n} from '../components/runs/cells/DatasetsCellRenderer';\nimport { RunDatasetWithTags } from '../../../types';\nimport { AggregateMetricValueCell } from '../components/runs/cells/AggregateMetricValueCell';\nimport { type RUNS_VISIBILITY_MODE } from '../models/ExperimentPageUIState';\nimport { useMediaQuery } from '@databricks/web-shared/hooks';\nimport { customMetricBehaviorDefs } from './customMetricBehaviorUtils';\n\nconst cellClassIsOrderedBy = ({ colDef, context }: CellClassParams) => {\n  return context.orderByKey === colDef.headerComponentParams?.canonicalSortKey;\n};\n\n/**\n * Width for \"run name\" column.\n */\nconst RUN_NAME_COLUMN_WIDTH = 190;\n\n/**\n * Width for \"run actions\" column.\n */\nconst BASE_RUN_ACTIONS_COLUMN_WIDTH = 105;\nconst VISIBILITY_TOGGLE_WIDTH = 32;\n\n/**\n * Calculates width for \"actions\" column. \"compactMode\" should be set to true\n * for compare runs mode when checkboxes are hidden.\n */\nconst getActionsColumnWidth = (isComparingRuns?: boolean) => {\n  return isComparingRuns ? BASE_RUN_ACTIONS_COLUMN_WIDTH : BASE_RUN_ACTIONS_COLUMN_WIDTH - VISIBILITY_TOGGLE_WIDTH;\n};\n\n/*\n * Functions used to generate grid field names for params, metrics and prefixes\n */\nexport const createParamFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_PARAM}-${key}`;\nconst createMetricFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_METRIC}-${key}`;\nconst createTagFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_TAG}-${key}`;\n\nconst UntrackedSpinner: React.FC<SpinnerProps> = ({ loading, ...props }) => {\n  return Spinner({ loading: false, ...props });\n};\n\n/**\n * A default listener that suppresses default agGrid keyboard events on the row actions cell renderer.\n * If the focus is on a cell, the tab key should be allowed to navigate to the next focusable element instead of a next cell.\n */\nconst defaultKeyboardNavigationSuppressor = ({ event }: SuppressKeyboardEventParams) =>\n  event.key === 'Tab' && event.target instanceof HTMLElement && event.target.classList.contains('ag-cell');\n\n/**\n * Functions returns all framework components to be used by agGrid\n */\nexport const getFrameworkComponents = () => ({\n  agColumnHeader: ColumnHeaderCell,\n\n  // A workaround for https://github.com/ag-grid/ag-grid/issues/7028.\n  // The page will add an interaction hold directly instead of relying on DuBois' Spinner\n  // to do it.\n  loadingOverlayComponent: UntrackedSpinner,\n\n  /**\n   * We're saving cell renderer component references, otherwise\n   * agGrid will unnecessarily flash cells' content (e.g. when changing sort order)\n   */\n  LoadMoreRowRenderer,\n  SourceCellRenderer,\n  ModelsCellRenderer,\n  ModelsHeaderCellRenderer,\n  VersionCellRenderer,\n  DateCellRenderer,\n  ExperimentNameCellRenderer,\n  RunDescriptionCellRenderer,\n  RowActionsCellRenderer,\n  RowActionsHeaderCellRenderer,\n  RunNameCellRenderer,\n  DatasetsCellRenderer,\n  AggregateMetricValueCell,\n});\n\n/**\n * Certain columns are described as run attributes (opposed to metrics, params etc.), however\n * they actually source their data from the run tags. This objects maps tag names to column identifiers.\n */\nconst TAGS_TO_COLUMNS_MAP = {\n  [ATTRIBUTE_COLUMN_SORT_KEY.USER]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'User'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Run Name'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.SOURCE]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Source'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.VERSION]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Version'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.DESCRIPTION]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Description'),\n};\n\n/**\n * Function returns unique row ID to be used in runs table\n */\nexport const getRowId = ({ data }: { data: RunRowType }) => data.rowUuid;\n\n/**\n * Determines if a data row houses \"load more\" button\n */\nexport const getRowIsLoadMore = ({ rowNode }: IsFullWidthRowParams) => rowNode.data.isLoadMoreRow;\n\n/**\n * Parameters used by `useRunsColumnDefinitions()` hook\n */\nexport interface UseRunsColumnDefinitionsParams {\n  selectedColumns: string[];\n  onExpand: (parentUuid: string, childrenIds: string[]) => void;\n  onTogglePin: (runUuid: string) => void;\n  onToggleVisibility:\n    | ((runUuidOrToggle: string) => void)\n    | ((mode: RUNS_VISIBILITY_MODE, runOrGroupUuid: string) => void);\n  compareExperiments: boolean;\n  metricKeyList: string[];\n  paramKeyList: string[];\n  tagKeyList: string[];\n  columnApi?: ColumnApi;\n  isComparingRuns?: boolean;\n  onDatasetSelected?: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  expandRows?: boolean;\n  allRunsHidden?: boolean;\n  usingCustomVisibility?: boolean;\n  runsHiddenMode?: RUNS_VISIBILITY_MODE;\n}\n\n/**\n * List of all attribute columns that can be shown/hidden by user\n * - when displaying a single experiment (ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT)\n * - when comparing experiments (ADJUSTABLE_ATTRIBUTE_COLUMNS)\n */\n\nexport const getAdjustableAttributeColumns = (isComparingExperiments = false) => {\n  const result = [\n    ATTRIBUTE_COLUMN_LABELS.USER,\n    ATTRIBUTE_COLUMN_LABELS.SOURCE,\n    ATTRIBUTE_COLUMN_LABELS.VERSION,\n    ATTRIBUTE_COLUMN_LABELS.MODELS,\n    ATTRIBUTE_COLUMN_LABELS.DATASET,\n    ATTRIBUTE_COLUMN_LABELS.DESCRIPTION,\n  ];\n\n  if (isComparingExperiments) {\n    result.push(ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME);\n  }\n  return result;\n};\n\n/**\n * This internal hook passes through the list of all metric/param/tag keys.\n * The lists are memoized internally so if somehow a particular param/metric/tag key is not present\n * in the new runs set (e.g. due to reverse sorting), the relevant column will be still displayed.\n * This prevents weirdly disappearing columns on exotic run sets.\n */\nconst useCumulativeColumnKeys = ({\n  paramKeyList,\n  metricKeyList,\n  tagKeyList,\n}: Pick<UseRunsColumnDefinitionsParams, 'tagKeyList' | 'metricKeyList' | 'paramKeyList'>) => {\n  const cachedMetricKeys = useRef<Set<string>>(new Set());\n  const cachedParamKeys = useRef<Set<string>>(new Set());\n  const cachedTagKeys = useRef<Set<string>>(new Set());\n\n  const paramKeys = useMemo(() => {\n    paramKeyList.forEach((key) => cachedParamKeys.current.add(key));\n    return Array.from(cachedParamKeys.current);\n  }, [paramKeyList]);\n\n  const metricKeys = useMemo(() => {\n    metricKeyList.forEach((key) => cachedMetricKeys.current.add(key));\n    return Array.from(cachedMetricKeys.current);\n  }, [metricKeyList]);\n\n  const tagKeys = useMemo(() => {\n    tagKeyList.forEach((key) => cachedTagKeys.current.add(key));\n    return Array.from(cachedTagKeys.current);\n  }, [tagKeyList]);\n\n  const cumulativeColumns = useMemo(\n    () => ({\n      paramKeys,\n      metricKeys,\n      tagKeys,\n    }),\n    [metricKeys, paramKeys, tagKeys],\n  );\n\n  return cumulativeColumns;\n};\n\n/**\n * This hook creates a agGrid-compatible column set definition basing on currently\n * used sort-filter model and provided list of metrics, params and tags.\n *\n * Internally, it reacts to changes to `selectedColumns` and hides/shows relevant columns\n * if necessary.\n *\n * @param params see UseRunsColumnDefinitionsParams\n */\nexport const useRunsColumnDefinitions = ({\n  selectedColumns,\n  compareExperiments,\n  onTogglePin,\n  onToggleVisibility,\n  onExpand,\n  paramKeyList,\n  metricKeyList,\n  tagKeyList,\n  columnApi,\n  onDatasetSelected,\n  isComparingRuns,\n  expandRows,\n  runsHiddenMode,\n}: UseRunsColumnDefinitionsParams) => {\n  const { theme } = useDesignSystemTheme();\n\n  const cumulativeColumns = useCumulativeColumnKeys({\n    metricKeyList,\n    tagKeyList,\n    paramKeyList,\n  });\n\n  // Generate columns differently on super small viewport sizes\n  const usingCompactViewport = useMediaQuery(`(max-width: ${theme.responsive.breakpoints.sm}px)`);\n\n  const columnSet = useMemo(() => {\n    const columns: (ColDef | ColGroupDef)[] = [];\n\n    // Checkbox selection column\n    columns.push({\n      valueGetter: ({ data: { pinned, hidden } }) => ({ pinned, hidden }),\n      checkboxSelection: true,\n      headerComponent: 'RowActionsHeaderCellRenderer',\n      headerComponentParams: { onToggleVisibility },\n      headerCheckboxSelection: true,\n      headerName: '',\n      cellClass: 'is-checkbox-cell',\n      cellRenderer: 'RowActionsCellRenderer',\n      cellRendererParams: { onTogglePin, onToggleVisibility },\n      pinned: usingCompactViewport ? undefined : 'left',\n      minWidth: getActionsColumnWidth(isComparingRuns),\n      width: getActionsColumnWidth(isComparingRuns),\n      maxWidth: getActionsColumnWidth(isComparingRuns),\n      resizable: false,\n      suppressKeyboardEvent: RowActionsCellRendererSuppressKeyboardEvents,\n    });\n\n    const isRunColumnDynamicSized = isComparingRuns;\n\n    // Run name column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.RUN_NAME,\n      colId: isRunColumnDynamicSized ? undefined : TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME],\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME,\n      pinned: usingCompactViewport ? undefined : 'left',\n      sortable: true,\n      cellRenderer: 'RunNameCellRenderer',\n      cellRendererParams: { onExpand, isComparingRuns },\n      equals: (runA: RunRowType, runB: RunRowType) =>\n        runA?.rowUuid === runB?.rowUuid && runA?.groupParentInfo?.expanderOpen === runB?.groupParentInfo?.expanderOpen,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialWidth: isRunColumnDynamicSized ? undefined : RUN_NAME_COLUMN_WIDTH,\n      flex: isRunColumnDynamicSized ? 1 : undefined,\n      resizable: !isComparingRuns,\n      suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n    });\n\n    // If we are only comparing runs, that's it - we cut off the list after the run name column.\n    // This behavior might be revisited and changed later.\n    if (isComparingRuns) {\n      return columns;\n    }\n\n    // Date and expander selection column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DATE,\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n      pinned: usingCompactViewport ? undefined : 'left',\n      sortable: true,\n      field: 'runDateAndNestInfo',\n      cellRenderer: 'DateCellRenderer',\n      cellRendererParams: { onExpand },\n      equals: (dateInfo1, dateInfo2) => isEqual(dateInfo1, dateInfo2),\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialWidth: 150,\n    });\n\n    // Datasets column - guarded by a feature flag\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DATASET,\n      colId: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.DATASET),\n      headerTooltip: ATTRIBUTE_COLUMN_LABELS.DATASET,\n      sortable: false,\n      field: 'datasets',\n      cellRenderer: 'DatasetsCellRenderer',\n      cellRendererParams: { onDatasetSelected, expandRows },\n      cellClass: 'is-multiline-cell',\n      initialWidth: 300,\n      suppressKeyboardEvent: DatasetsCellRendererSuppressKeyboardEvents,\n    });\n\n    // Duration column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DURATION,\n      field: 'duration',\n      initialWidth: 80,\n    });\n\n    // Experiment name column\n    if (compareExperiments) {\n      columns.push({\n        headerName: ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME,\n        colId: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME),\n        field: 'experimentName',\n        cellRenderer: 'ExperimentNameCellRenderer',\n        equals: (experimentName1, experimentName2) => isEqual(experimentName1, experimentName2),\n        initialWidth: 140,\n        initialHide: true,\n        suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n      });\n    }\n\n    // User column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.USER,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.USER],\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.USER,\n      field: 'user',\n      sortable: true,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.USER,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialHide: true,\n    });\n\n    // Source column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.SOURCE,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.SOURCE],\n      field: 'tags',\n      cellRenderer: 'SourceCellRenderer',\n      equals: (tags1 = {}, tags2 = {}) => Utils.getSourceName(tags1) === Utils.getSourceName(tags2),\n      sortable: true,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.SOURCE,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialHide: true,\n      suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n    });\n\n    // Version column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.VERSION,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.VERSION],\n      field: 'version',\n      cellRenderer: 'VersionCellRenderer',\n      equals: (version1 = {}, version2 = {}) => isEqual(version1, version2),\n      sortable: true,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.VERSION,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialHide: true,\n    });\n\n    // Models column\n    columns.push({\n      headerComponent: 'ModelsHeaderCellRenderer',\n      colId: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.MODELS),\n      field: 'models',\n      cellRenderer: 'ModelsCellRenderer',\n      initialWidth: 200,\n      equals: (models1 = {}, models2 = {}) => isEqual(models1, models2),\n      initialHide: true,\n      suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n    });\n\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DESCRIPTION,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.DESCRIPTION],\n      field: 'tags',\n      cellRenderer: 'RunDescriptionCellRenderer',\n      initialWidth: 300,\n      initialHide: true,\n      sortable: true,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.DESCRIPTION,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n    });\n\n    const { metricKeys, paramKeys, tagKeys } = cumulativeColumns;\n\n    // Metrics columns\n    if (metricKeys.length) {\n      columns.push({\n        headerName: 'Metrics',\n        groupId: COLUMN_TYPES.METRICS,\n        children: metricKeys\n          .filter((metricKey) => {\n            // Only create columns for metrics that are selected or if we're comparing runs\n            const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.METRICS, metricKey);\n            return isComparingRuns || selectedColumns.includes(canonicalSortKey);\n          })\n          .map((metricKey) => {\n            const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.METRICS, metricKey);\n            const customMetricColumnDef = customMetricBehaviorDefs[metricKey];\n            const displayName = customMetricColumnDef?.displayName ?? metricKey;\n            const fieldName = createMetricFieldName(metricKey);\n            const tooltip = getQualifiedEntityName(COLUMN_TYPES.METRICS, metricKey);\n            return {\n              headerName: displayName,\n              colId: canonicalSortKey,\n              headerTooltip: tooltip,\n              field: fieldName,\n              tooltipValueGetter: (params) => {\n                return params.data?.[fieldName];\n              },\n              initialWidth: customMetricColumnDef?.initialColumnWidth ?? 100,\n              initialHide: true,\n              sortable: true,\n              headerComponentParams: {\n                canonicalSortKey,\n              },\n              valueFormatter: customMetricColumnDef?.valueFormatter,\n              cellRendererSelector: ({ data: { groupParentInfo } }) =>\n                groupParentInfo ? { component: 'AggregateMetricValueCell' } : undefined,\n              cellClassRules: {\n                'is-previewable-cell': () => true,\n                'is-ordered-by': cellClassIsOrderedBy,\n              },\n            };\n          }),\n      });\n    }\n\n    // Parameter columns\n    if (paramKeys.length) {\n      columns.push({\n        headerName: 'Parameters',\n        groupId: COLUMN_TYPES.PARAMS,\n        children: paramKeys\n          .filter((paramKey) => {\n            // Only create columns for parameters that are selected or if we're comparing runs\n            const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.PARAMS, paramKey);\n            return isComparingRuns || selectedColumns.includes(canonicalSortKey);\n          })\n          .map((paramKey) => {\n            const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.PARAMS, paramKey);\n            return {\n              colId: canonicalSortKey,\n              headerName: paramKey,\n              headerTooltip: getQualifiedEntityName(COLUMN_TYPES.PARAMS, paramKey),\n              field: createParamFieldName(paramKey),\n              tooltipField: createParamFieldName(paramKey),\n              initialHide: true,\n              initialWidth: 100,\n              sortable: true,\n              headerComponentParams: {\n                canonicalSortKey,\n              },\n              cellClassRules: {\n                'is-previewable-cell': () => true,\n                'is-ordered-by': cellClassIsOrderedBy,\n              },\n            };\n          }),\n      });\n    }\n\n    // Tags columns\n    if (tagKeys.length) {\n      columns.push({\n        headerName: 'Tags',\n        colId: COLUMN_TYPES.TAGS,\n        children: tagKeys\n          .filter((tagKey) => {\n            // Only create columns for tags that are selected or if we're comparing runs\n            const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.TAGS, tagKey);\n            return isComparingRuns || selectedColumns.includes(canonicalSortKey);\n          })\n          .map((tagKey) => {\n            const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.TAGS, tagKey);\n            return {\n              colId: canonicalSortKey,\n              headerName: tagKey,\n              initialHide: true,\n              initialWidth: 100,\n              headerTooltip: getQualifiedEntityName(COLUMN_TYPES.TAGS, tagKey),\n              field: createTagFieldName(tagKey),\n              tooltipField: createTagFieldName(tagKey),\n            };\n          }),\n      });\n    }\n\n    return columns;\n  }, [\n    onTogglePin,\n    onToggleVisibility,\n    onExpand,\n    compareExperiments,\n    cumulativeColumns,\n    isComparingRuns,\n    onDatasetSelected,\n    expandRows,\n    usingCompactViewport,\n    selectedColumns,\n  ]);\n\n  const canonicalSortKeys = useMemo(\n    () => [\n      ...getAdjustableAttributeColumns(true).map((key) => makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, key)),\n      ...cumulativeColumns.paramKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.PARAMS, key)),\n      ...cumulativeColumns.metricKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.METRICS, key)),\n      ...cumulativeColumns.tagKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.TAGS, key)),\n    ],\n    [cumulativeColumns],\n  );\n\n  useEffect(() => {\n    if (!columnApi || isComparingRuns) {\n      return;\n    }\n    for (const canonicalKey of canonicalSortKeys) {\n      const visible = selectedColumns.includes(canonicalKey);\n      columnApi.setColumnVisible(canonicalKey, visible);\n    }\n  }, [selectedColumns, columnApi, canonicalSortKeys, isComparingRuns]);\n\n  return columnSet;\n};\n\nexport const EXPERIMENTS_DEFAULT_COLUMN_SETUP = {\n  initialWidth: 100,\n  autoSizePadding: 0,\n  headerComponentParams: { menuIcon: 'fa-bars' },\n  resizable: true,\n  filter: true,\n  suppressMenu: true,\n  suppressMovable: true,\n};\n","import { BeakerIcon, Button, Empty, FilterIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { LoggingRunsDocUrl } from '../../../../../common/constants';\n\n/**\n * This component displays information about no results being displayed in runs tample,\n * either due to no runs recorded in an experiment at all or due to currently used filters.\n */\nexport const ExperimentViewRunsEmptyTable = ({\n  isFiltered,\n  onClearFilters,\n}: {\n  onClearFilters: () => void;\n  isFiltered: boolean;\n}) => {\n  const getLearnMoreLinkUrl = () => LoggingRunsDocUrl;\n\n  return (\n    <div css={styles.noResultsWrapper}>\n      <div css={styles.noResults}>\n        {isFiltered ? (\n          <Empty\n            button={\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsemptytable.tsx_35\"\n                type=\"primary\"\n                onClick={onClearFilters}\n              >\n                <FormattedMessage\n                  defaultMessage=\"Clear filters\"\n                  description=\"Label for a button that clears all filters, visible on a experiment runs page next to a empty state when all runs have been filtered out\"\n                />\n              </Button>\n            }\n            description={\n              <FormattedMessage\n                defaultMessage=\"All runs in this experiment have been filtered. Change or clear filters to view runs.\"\n                description=\"Empty state description text for experiment runs page when all runs have been filtered out\"\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"All runs are filtered\"\n                description=\"Empty state title text for experiment runs page when all runs have been filtered out\"\n              />\n            }\n            image={<FilterIcon />}\n          />\n        ) : (\n          <Empty\n            description={\n              <FormattedMessage\n                defaultMessage=\"No runs have been logged yet. <link>Learn more</link> about how to create ML model training runs in this experiment.\"\n                description=\"Empty state description text for experiment runs page when no runs are logged in the experiment\"\n                values={{\n                  link: (chunks: any) => (\n                    <a target=\"_blank\" href={getLearnMoreLinkUrl()} rel=\"noreferrer\">\n                      {chunks}\n                    </a>\n                  ),\n                }}\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"No runs logged\"\n                description=\"Empty state title text for experiment runs page when no runs are logged in the experiment\"\n              />\n            }\n            image={<BeakerIcon />}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst styles = {\n  noResults: {\n    maxWidth: 360,\n  },\n  noResultsWrapper: (theme: Theme) => ({\n    marginTop: theme.spacing.lg,\n    inset: 0,\n    backgroundColor: theme.colors.backgroundPrimary,\n    position: 'absolute' as const,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  }),\n};\n","import { Button, PlusCircleIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { useCallback, useEffect, useRef } from 'react';\nimport { FormattedMessage } from 'react-intl';\n\n/**\n * Width of the CTA column\n */\nconst COLUMN_CTA_WIDTH = 180;\n\n/**\n * CSS classes used internally\n */\nconst CLASS_OUT_OF_VIEWPORT = 'is-out-of-viewport';\nconst CLASS_IS_HIDDEN = 'is-hidden';\nconst CLASS_IS_MINIMIZED = 'is-minimized';\n\n/**\n * List all necessary agGrid sub-element classes\n */\nconst AG_GRID_CLS = {\n  ROOT: '.ag-root',\n  LEFT_COLS_CONTAINER: '.ag-pinned-left-cols-container',\n  FULL_WIDTH_ROW: '.ag-full-width-row',\n  COLS_CONTAINER: '.ag-center-cols-container',\n  HEADER: '.ag-header',\n  BODY_VIEWPORT: '.ag-body-viewport',\n};\n\ninterface ExperimentViewRunsTableAddColumnCTAProps {\n  onClick: () => void;\n  gridContainerElement: HTMLElement | null;\n  isInitialized: boolean;\n  visible?: boolean;\n  moreRunsAvailable?: boolean;\n  moreAvailableRunsTableColumnCount?: number;\n}\n\n/**\n * Component displaying dynamic table column with \"add metrics and parameters\" CTA.\n *\n * Sample usage:\n *\n * const [gridInitialized, setGridInitialized] = useState(false);\n *\n * return (\n *   <div ref={containerElement}>\n *     <AgGrid onGridReady={() => setGridInitialized(true)} {...} />\n *     <ExperimentViewRunsTableAddColumnCTA\n *       gridContainerElement={containerElement.current}\n *       isInitialized={gridInitialized}\n *       onAddColumnClicked={onAddColumnClicked}\n *       visible={!isLoading}\n *       moreAvailableRunsTableColumnCount={3}\n *     />\n *   </div>\n * );\n */\nexport const ExperimentViewRunsTableAddColumnCTA = ({\n  onClick,\n  gridContainerElement,\n  isInitialized,\n  visible,\n  moreRunsAvailable,\n  moreAvailableRunsTableColumnCount = 0,\n}: ExperimentViewRunsTableAddColumnCTAProps) => {\n  const ctaRef = useRef<HTMLDivElement>(null);\n\n  const savedContainerRef = useRef<HTMLElement>();\n  const immediateMoreRunsAvailable = useRef<boolean>(Boolean(moreRunsAvailable));\n\n  // Save immediate value of \"moreRunsAvailable\" so the fresh version\n  // will be accessible within the resize observer\n  useEffect(() => {\n    immediateMoreRunsAvailable.current = Boolean(moreRunsAvailable);\n  }, [moreRunsAvailable]);\n\n  const initialize = useCallback((containerElement: HTMLElement) => {\n    if (!ctaRef.current || !window.ResizeObserver || !containerElement) {\n      return undefined;\n    }\n\n    const targetElement = ctaRef.current;\n\n    /**\n     * On initialization, first gather all the agGrid sub-elements\n     */\n    const rootElement = containerElement.querySelector(AG_GRID_CLS.ROOT);\n    const refLeftElem = containerElement.querySelector(AG_GRID_CLS.LEFT_COLS_CONTAINER);\n    const refCenterElem = containerElement.querySelector(AG_GRID_CLS.COLS_CONTAINER);\n    const refHeaderElem = containerElement.querySelector(AG_GRID_CLS.HEADER);\n    const refBodyViewport = containerElement.querySelector(AG_GRID_CLS.BODY_VIEWPORT);\n\n    /**\n     * Initialize variables used for position calculation\n     */\n    let gridAreaWidth = 0;\n    let leftColContainerWidth = 0;\n    let leftColContainerHeight = 0;\n    let centerColContainerWidth = 0;\n    let colContainerHeight = 0;\n    let headerHeight = 0;\n\n    /**\n     * Execute only if all elements are in place\n     */\n    if (refLeftElem && refCenterElem && refHeaderElem && rootElement && refBodyViewport) {\n      /**\n       * Hook up an resize observer\n       */\n      const resizeObserver = new ResizeObserver((entries) => {\n        /**\n         * For every changed element, gather the exact dimensions\n         */\n        for (const entry of entries) {\n          if (entry.target === rootElement) {\n            gridAreaWidth = entry.contentRect.width;\n          }\n          if (entry.target === refLeftElem) {\n            leftColContainerWidth = entry.contentRect.width;\n            leftColContainerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refBodyViewport) {\n            colContainerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refHeaderElem) {\n            headerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refCenterElem) {\n            centerColContainerWidth = entry.contentRect.width;\n          }\n        }\n\n        /**\n         * Our \"left\" position will be offset by column container widths\n         */\n        const calculatedLeft = leftColContainerWidth + centerColContainerWidth;\n\n        /**\n         * Our \"top\"  position will be offset by the header height\n         */\n        const calculatedTop = headerHeight;\n\n        /**\n         * If the column is out of viewport (expanding out of the root element),\n         * add proper CSS class to hide it\n         */\n        const isOutOfViewport = calculatedLeft + COLUMN_CTA_WIDTH >= gridAreaWidth;\n        isOutOfViewport\n          ? savedContainerRef.current?.classList.add(CLASS_OUT_OF_VIEWPORT)\n          : savedContainerRef.current?.classList.remove(CLASS_OUT_OF_VIEWPORT);\n\n        // Check if \"load more\" button is visible\n        const loadMoreRowHeight = immediateMoreRunsAvailable.current ? 32 : 0;\n\n        // If the visible row set takes only portion of the table height-wise (leftColContainerHeight < colContainerHeight),\n        // let's contract our CTA a little so \"load more\" button will fit in. If it takes whole area, do not reduce its height.\n        const calculatedHeight =\n          leftColContainerHeight < colContainerHeight ? leftColContainerHeight - loadMoreRowHeight : colContainerHeight;\n\n        /**\n         * If the available height is too low, add a class that indicates\n         * that we should display minimized version\n         */\n        const shouldBeMinimized = calculatedHeight < 100;\n        shouldBeMinimized\n          ? savedContainerRef.current?.classList.add(CLASS_IS_MINIMIZED)\n          : savedContainerRef.current?.classList.remove(CLASS_IS_MINIMIZED);\n\n        /**\n         * Finally, set proper values as CSS transform property. Use 3d transform\n         * to ensure hardware acceleration.\n         */\n        targetElement.style.transform = `translate3d(${calculatedLeft}px, ${calculatedTop}px, 0)`;\n\n        /**\n         * Set target height and add 1px to accomodate the border.\n         */\n        targetElement.style.height = `${calculatedHeight + 1}px`;\n      });\n\n      /**\n       * Setup observer with all the necessary elements.\n       */\n      resizeObserver.observe(refLeftElem);\n      resizeObserver.observe(refCenterElem);\n      resizeObserver.observe(refHeaderElem);\n      resizeObserver.observe(rootElement);\n      resizeObserver.observe(refBodyViewport);\n\n      /**\n       * After cleanup, disconnect the observer.\n       */\n      return () => resizeObserver.disconnect();\n    }\n    return undefined;\n  }, []);\n\n  useEffect(() => {\n    if (isInitialized && gridContainerElement) {\n      savedContainerRef.current = gridContainerElement;\n      initialize(gridContainerElement);\n    }\n  }, [initialize, isInitialized, gridContainerElement]);\n\n  /**\n   * This component works only if ResizeObserver is supported by the browser.\n   * If it's not supported, return nothing.\n   */\n  if (!window.ResizeObserver) {\n    return null;\n  }\n\n  return (\n    <div ref={ctaRef} css={styles.columnContainer} className={visible ? '' : CLASS_IS_HIDDEN}>\n      {visible && (\n        <div css={styles.buttonContainer}>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunstableaddcolumncta.tsx_218\"\n            css={styles.button}\n            type=\"link\"\n            onClick={onClick}\n          >\n            <PlusCircleIcon css={styles.buttonIcon} />\n            <div css={styles.caption}>\n              <FormattedMessage\n                defaultMessage=\"Show more columns\"\n                description=\"Label for a CTA button in experiment runs table which invokes column management dropdown\"\n              />\n            </div>\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst styles = {\n  columnContainer: (theme: Theme) => ({\n    width: COLUMN_CTA_WIDTH,\n    height: 0,\n    position: 'absolute' as const,\n    border: `1px solid ${theme.colors.borderDecorative}`,\n    borderTop: 0,\n    top: 0,\n    left: 0,\n    willChange: 'transform' as const,\n    transform: 'translate3d(0, 0, 0)',\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      display: 'flex',\n      alignItems: 'center' as const,\n    },\n    [`&.${CLASS_IS_HIDDEN}, .${CLASS_OUT_OF_VIEWPORT} &`]: {\n      display: 'none',\n    },\n    pointerEvents: 'none' as const,\n    display: 'flex',\n    alignItems: 'center',\n  }),\n  buttonContainer: (theme: Theme) => ({\n    top: 0,\n    paddingLeft: theme.spacing.lg,\n    paddingRight: theme.spacing.lg,\n    width: '100%',\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      paddingTop: theme.spacing.xs,\n    },\n    pointerEvents: 'all' as const,\n  }),\n  button: { whiteSpace: 'pre-wrap' as const, width: '100%' },\n  buttonIcon: (theme: Theme) => ({ color: theme.colors.textSecondary }),\n  caption: (theme: Theme) => ({\n    color: theme.colors.textSecondary,\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      display: 'none',\n    },\n  }),\n};\n","import { Spinner, Typography } from '@databricks/design-system';\nimport type { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\n\ninterface ExperimentViewRunsTableStatusBarProps {\n  isLoading: boolean;\n  allRunsCount: number;\n}\n\n// Strongifies the i18n string, used in <FormattedMessage> below\nconst strong = (text: string) => <strong>{text}</strong>;\n\nexport const ExperimentViewRunsTableStatusBar = ({\n  isLoading,\n  allRunsCount,\n}: ExperimentViewRunsTableStatusBarProps) => (\n  <div css={styles.statusBar}>\n    <Typography.Text size=\"sm\" color={isLoading ? 'secondary' : undefined}>\n      <FormattedMessage\n        // eslint-disable-next-line max-len\n        defaultMessage=\"<strong>{length}</strong> matching {length, plural, =0 {runs} =1 {run} other {runs}}\"\n        // eslint-disable-next-line max-len\n        description=\"Message for displaying how many runs match search criteria on experiment page\"\n        values={{\n          strong,\n          length: allRunsCount,\n        }}\n      />\n    </Typography.Text>\n    {isLoading && <Spinner size=\"small\" />}\n  </div>\n);\n\nconst styles = {\n  statusBar: (theme: Theme) => ({\n    height: 28,\n    display: 'flex',\n    gap: 8,\n    marginTop: -1,\n    position: 'relative' as const,\n    alignItems: 'center',\n    borderTop: `1px solid ${theme.colors.border}`,\n  }),\n};\n","import { GridApi, RowSelectedEvent, SelectionChangedEvent } from '@ag-grid-community/core';\nimport { useCallback, useRef } from 'react';\nimport { ExperimentPageViewState } from '../models/ExperimentPageViewState';\nimport { RunRowType } from '../utils/experimentPage.row-types';\nimport { uniqBy } from 'lodash';\n\n/**\n * Helper function that select particular run rows in the ag-grid.\n */\nconst agGridSelectRunRows = (runUuids: string[], isSelected: boolean, gridApi: GridApi) => {\n  gridApi.forEachNode((node) => {\n    if (node.data?.isLoadMoreRow) {\n      return;\n    }\n    const { runInfo, runDateAndNestInfo: childRunDateInfo } = node.data as RunRowType;\n\n    if (!runInfo) {\n      return;\n    }\n\n    const childrenRunUuid = runInfo.runUuid;\n    if (runUuids.includes(childrenRunUuid)) {\n      // If we found children being parents, mark their children\n      // to be selected as well.\n      if (childRunDateInfo?.childrenIds) {\n        runUuids.push(...childRunDateInfo.childrenIds);\n      }\n\n      node.setSelected(isSelected, false, true);\n    }\n  });\n};\n\n/**\n * Helper function that select particular group rows in the ag-grid.\n */\nconst agGridSelectGroupRows = (rowData: RunRowType[], gridApi: GridApi) => {\n  gridApi.forEachNode((node) => {\n    const data: RunRowType = node.data;\n    if (!data.groupParentInfo) {\n      return;\n    }\n\n    // If all runs belonging to the group are selected, select the group\n    if (data.groupParentInfo.runUuids.every((runUuid) => rowData.some((row) => row.runUuid === runUuid))) {\n      node.setSelected(true, false, true);\n    }\n\n    // If none of the runs belonging to the group are selected, deselect the group\n    if (!data.groupParentInfo.runUuids.some((runUuid) => rowData.some((row) => row.runUuid === runUuid))) {\n      node.setSelected(false, false, true);\n    }\n  });\n};\n\n/**\n * Returns handlers for row selection in the experiment runs table.\n * Supports groups, nested runs and regular flat hierarchy.\n */\nexport const useExperimentTableSelectRowHandler = (\n  updateViewState: (newPartialViewState: Partial<ExperimentPageViewState>) => void,\n) => {\n  const onSelectionChange = useCallback(\n    ({ api }: SelectionChangedEvent) => {\n      const selectedUUIDs: string[] = api\n        .getSelectedRows()\n        // Filter out \"load more\" and group rows\n        .filter((row) => row.runInfo)\n        .map(({ runInfo }) => runInfo.runUuid);\n      updateViewState({\n        runsSelected: selectedUUIDs.reduce((aggregate, curr) => ({ ...aggregate, [curr]: true }), {}),\n      });\n    },\n    [updateViewState],\n  );\n\n  const handleRowSelected = useCallback((event: RowSelectedEvent) => {\n    // Let's check if the actual number of selected rows have changed\n    // to avoid empty runs\n    const isSelected = Boolean(event.node.isSelected());\n\n    // We will continue only if the selected row has properly set runDateInfo\n    const { runDateAndNestInfo, runInfo, groupParentInfo } = event.data as RunRowType;\n\n    if (groupParentInfo) {\n      agGridSelectRunRows(groupParentInfo.runUuids, isSelected, event.api);\n    }\n\n    if (!runDateAndNestInfo) {\n      return;\n    }\n    const { isParent, expanderOpen, childrenIds } = runDateAndNestInfo;\n\n    // We will continue only if the selected row is a parent containing\n    // children and is actually expanded\n    if (isParent && expanderOpen && childrenIds) {\n      const childrenIdsToSelect = childrenIds;\n      agGridSelectRunRows(childrenIdsToSelect, isSelected, event.api);\n    } else if (runInfo) {\n      // If we are selecting a run row, we need to select other runs with the same UUID\n      agGridSelectRunRows([runInfo.runUuid], isSelected, event.api);\n\n      // Next, we need to (de)select the group row if all runs belonging to the group are (de)selected\n      const selectedRunRows = uniqBy(\n        event.api.getSelectedRows().filter((row) => Boolean(row.runUuid)),\n        'runUuid',\n      );\n      agGridSelectGroupRows(selectedRunRows, event.api);\n    }\n  }, []);\n\n  return { handleRowSelected, onSelectionChange };\n};\n","import type { CellClickedEvent, ColumnApi, GridApi, GridReadyEvent } from '@ag-grid-community/core';\nimport { type CSSObject, Interpolation, Theme } from '@emotion/react';\nimport cx from 'classnames';\nimport React, { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { MLFlowAgGridLoader } from '../../../../../common/components/ag-grid/AgGridLoader';\nimport Utils from '../../../../../common/utils/Utils';\nimport {\n  ExperimentEntity,\n  UpdateExperimentViewStateFn,\n  RunDatasetWithTags,\n  ExperimentViewRunsCompareMode,\n} from '../../../../types';\n\nimport { isSearchFacetsFilterUsed } from '../../utils/experimentPage.fetch-utils';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\nimport {\n  EXPERIMENTS_DEFAULT_COLUMN_SETUP,\n  getFrameworkComponents,\n  getRowIsLoadMore,\n  getRowId,\n  useRunsColumnDefinitions,\n  getAdjustableAttributeColumns,\n} from '../../utils/experimentPage.column-utils';\nimport { makeCanonicalSortKey } from '../../utils/experimentPage.common-utils';\nimport { EXPERIMENT_RUNS_TABLE_ROW_HEIGHT } from '../../utils/experimentPage.common-utils';\nimport { RunRowType } from '../../utils/experimentPage.row-types';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { createLoadMoreRow } from './cells/LoadMoreRowRenderer';\nimport { ExperimentViewRunsEmptyTable } from './ExperimentViewRunsEmptyTable';\nimport { ExperimentViewRunsTableAddColumnCTA } from './ExperimentViewRunsTableAddColumnCTA';\nimport { ExperimentViewRunsTableStatusBar } from './ExperimentViewRunsTableStatusBar';\nimport { shouldUseRunRowsVisibilityMap } from '../../../../../common/utils/FeatureUtils';\nimport { getDatasetsCellHeight } from './cells/DatasetsCellRenderer';\nimport { PreviewSidebar } from '../../../../../common/components/PreviewSidebar';\nimport { ATTRIBUTE_COLUMN_LABELS, COLUMN_TYPES } from '../../../../constants';\nimport { Empty, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\nimport { useUpdateExperimentPageSearchFacets } from '../../hooks/useExperimentPageSearchFacets';\nimport {\n  createExperimentPageSearchFacetsState,\n  ExperimentPageSearchFacetsState,\n} from '../../models/ExperimentPageSearchFacetsState';\nimport { useExperimentTableSelectRowHandler } from '../../hooks/useExperimentTableSelectRowHandler';\nimport { useToggleRowVisibilityCallback } from '../../hooks/useToggleRowVisibilityCallback';\nimport { ExperimentViewRunsTableHeaderContextProvider } from './ExperimentViewRunsTableHeaderContext';\nimport { useRunsHighlightTableRow } from '../../../runs-charts/hooks/useRunsHighlightTableRow';\nimport { isEmpty } from 'lodash';\n\nconst ROW_BUFFER = 101; // How many rows to keep rendered, even ones not visible\n\nexport interface ExperimentViewRunsTableProps {\n  /**\n   * Actual set of prepared row data to be rendered\n   */\n  rowsData: RunRowType[];\n\n  /**\n   * Helper data set with metric, param and tag keys\n   */\n  runsData: ExperimentRunsSelectorResult;\n\n  experiments: ExperimentEntity[];\n  searchFacetsState: ExperimentPageSearchFacetsState;\n  viewState: ExperimentPageViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n  isLoading: boolean;\n  moreRunsAvailable: boolean;\n  onAddColumnClicked: () => void;\n  loadMoreRunsFunc: () => void;\n  onDatasetSelected?: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  expandRows: boolean;\n  uiState: ExperimentPageUIState;\n  compareRunsMode: ExperimentViewRunsCompareMode;\n}\n\nexport const ExperimentViewRunsTable = React.memo(\n  // eslint-disable-next-line complexity\n  ({\n    experiments,\n    searchFacetsState,\n    runsData,\n    isLoading,\n    moreRunsAvailable,\n    updateViewState,\n    onAddColumnClicked,\n    rowsData,\n    loadMoreRunsFunc,\n    onDatasetSelected,\n    expandRows,\n    viewState,\n    uiState,\n    compareRunsMode,\n  }: ExperimentViewRunsTableProps) => {\n    const { theme } = useDesignSystemTheme();\n    const updateUIState = useUpdateExperimentViewUIState();\n    const setUrlSearchFacets = useUpdateExperimentPageSearchFacets();\n\n    const { orderByKey, orderByAsc } = searchFacetsState;\n\n    // If using new view state model, use `uiState` instead of `searchFacetsState`\n    const {\n      // Get relevant column and run info from persisted UI state\n      selectedColumns,\n      runsPinned,\n      runsHidden,\n      runListHidden,\n    } = uiState;\n\n    const isComparingRuns = compareRunsMode !== 'TABLE';\n\n    // Performance optimization: Only extract the keys we actually need based on selectedColumns\n    const { paramKeyList, metricKeyList, tagsList } = useMemo(() => {\n      // If we're comparing runs, we don't need to filter the keys\n      if (isComparingRuns) {\n        return runsData;\n      }\n\n      // Filter metric keys based on selected columns\n      const filteredMetricKeys = runsData.metricKeyList.filter((key) =>\n        selectedColumns.includes(makeCanonicalSortKey(COLUMN_TYPES.METRICS, key)),\n      );\n\n      // Filter param keys based on selected columns\n      const filteredParamKeys = runsData.paramKeyList.filter((key) =>\n        selectedColumns.includes(makeCanonicalSortKey(COLUMN_TYPES.PARAMS, key)),\n      );\n\n      // Filter tag keys based on selected columns\n      const filteredTags = runsData.tagsList.map((tags) =>\n        Object.fromEntries(\n          Object.entries(tags).filter(([key]) =>\n            selectedColumns.includes(makeCanonicalSortKey(COLUMN_TYPES.TAGS, key)),\n          ),\n        ),\n      );\n\n      return {\n        metricKeyList: filteredMetricKeys,\n        paramKeyList: filteredParamKeys,\n        tagsList: filteredTags,\n      };\n    }, [runsData, selectedColumns, isComparingRuns]);\n\n    const [gridApi, setGridApi] = useState<GridApi>();\n    const [columnApi, setColumnApi] = useState<ColumnApi>();\n    const prevSelectRunUuids = useRef<string[]>([]);\n\n    const filteredTagKeys = useMemo(() => Utils.getVisibleTagKeyList(tagsList), [tagsList]);\n\n    const containerElement = useRef<HTMLDivElement>(null);\n    // Flag indicating if there are any rows that can be expanded\n    const expandersVisible = useMemo(() => rowsData.some((row) => row.runDateAndNestInfo?.hasExpander), [rowsData]);\n\n    const toggleRowExpanded = useCallback(\n      (parentId: string) =>\n        updateUIState(({ runsExpanded: currentRunsExpanded, ...state }: ExperimentPageUIState) => ({\n          ...state,\n          runsExpanded: { ...currentRunsExpanded, [parentId]: !currentRunsExpanded[parentId] },\n        })),\n      [updateUIState],\n    );\n\n    const togglePinnedRow = useCallback(\n      (uuid: string) => {\n        updateUIState((existingFacets: ExperimentPageUIState) => ({\n          ...existingFacets,\n          runsPinned: !existingFacets.runsPinned.includes(uuid)\n            ? [...existingFacets.runsPinned, uuid]\n            : existingFacets.runsPinned.filter((r) => r !== uuid),\n        }));\n      },\n      [updateUIState],\n    );\n\n    // A modern version of row visibility toggle function, supports \"show all\", \"show first n runs\" options\n    const toggleRowVisibility = useToggleRowVisibilityCallback(rowsData, uiState.useGroupedValuesInCharts);\n\n    const gridReadyHandler = useCallback((params: GridReadyEvent) => {\n      setGridApi(params.api);\n      setColumnApi(params.columnApi);\n    }, []);\n\n    const { handleRowSelected, onSelectionChange } = useExperimentTableSelectRowHandler(updateViewState);\n\n    const allRunsHidden = useMemo(() => {\n      if (shouldUseRunRowsVisibilityMap()) {\n        return rowsData.every((row) => row.hidden);\n      }\n      return runsData.runInfos.every(({ runUuid }) => runsHidden.includes(runUuid));\n    }, [runsData, rowsData, runsHidden]);\n\n    // Check if at least one run has custom visibility settings\n    const usingCustomVisibility = shouldUseRunRowsVisibilityMap() && !isEmpty(uiState.runsVisibilityMap);\n\n    const columnDefs = useRunsColumnDefinitions({\n      selectedColumns,\n      onExpand: toggleRowExpanded,\n      compareExperiments: experiments.length > 1,\n      onTogglePin: togglePinnedRow,\n      onToggleVisibility: toggleRowVisibility,\n      metricKeyList,\n      paramKeyList,\n      tagKeyList: filteredTagKeys,\n      columnApi,\n      isComparingRuns,\n      onDatasetSelected,\n      expandRows,\n      runsHiddenMode: uiState.runsHiddenMode,\n    });\n\n    const gridSizeHandler = useCallback(\n      (api: GridApi) => {\n        if (api && isComparingRuns) {\n          try {\n            api.sizeColumnsToFit();\n          } catch {\n            // ag-grid occasionally throws an error when trying to size columns while its internal ref is lost\n            // We can't do much about it, so the exception is consumed\n          }\n        }\n      },\n      [isComparingRuns],\n    );\n\n    useEffect(() => {\n      if (!gridApi) {\n        return;\n      }\n\n      if (isLoading) {\n        gridApi.showLoadingOverlay();\n      } else {\n        gridApi.hideOverlay();\n\n        // If there are more runs available in the API, append\n        // additional special row that will display \"Load more\" button\n        if (rowsData.length && moreRunsAvailable) {\n          gridApi.setRowData([...rowsData, createLoadMoreRow()]);\n          gridSizeHandler(gridApi);\n          return;\n        }\n\n        gridApi.setRowData(rowsData);\n        gridSizeHandler(gridApi);\n      }\n    }, [gridApi, rowsData, isLoading, moreRunsAvailable, loadMoreRunsFunc, gridSizeHandler]);\n\n    // Count all columns available for selection\n    const allAvailableColumnsCount = useMemo(() => {\n      const attributeColumnCount = getAdjustableAttributeColumns(experiments.length > 1).length;\n\n      const valuesColumnCount = metricKeyList.length + paramKeyList.length + filteredTagKeys.length;\n\n      return attributeColumnCount + valuesColumnCount;\n    }, [experiments.length, filteredTagKeys.length, metricKeyList.length, paramKeyList.length]);\n\n    const hasSelectedAllColumns = selectedColumns.length >= allAvailableColumnsCount;\n\n    const moreAvailableRunsTableColumnCount = Math.max(0, allAvailableColumnsCount - selectedColumns.length);\n\n    const allRunsCount = useMemo(\n      () =>\n        runsData.runInfos.filter(\n          (r) => runsPinned.includes(r.runUuid) || runsData.runUuidsMatchingFilter.includes(r.runUuid),\n        ).length,\n      [runsData, runsPinned],\n    );\n\n    useLayoutEffect(() => {\n      if (!gridApi) {\n        return;\n      }\n      // Each time we switch to \"compare runs\" mode, we should\n      // maximize columns so \"run name\" column will take up all remaining space\n      if (isComparingRuns) {\n        // Selection feature is not supported in compare runs mode so we should deselect all\n        gridApi.deselectAll();\n        gridApi.sizeColumnsToFit();\n      }\n      gridApi.resetRowHeights();\n    }, [gridApi, isComparingRuns]);\n\n    /**\n     * Function used by ag-grid to calculate each row's height.\n     * In this case, it's based on a datasets cell size.\n     */\n\n    const rowHeightGetterFn = useCallback(\n      // if is comparing runs, use the default row height\n      (row: { data: RunRowType }) => {\n        if (isComparingRuns || !expandRows) {\n          return EXPERIMENT_RUNS_TABLE_ROW_HEIGHT;\n        }\n        const datasetColumnId = makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.DATASET);\n        const datasetColumnShown = selectedColumns.includes(datasetColumnId);\n        // if not comparing runs, use the datasets cell height\n        return getDatasetsCellHeight(datasetColumnShown, row);\n      },\n      [selectedColumns, isComparingRuns, expandRows],\n    );\n\n    useEffect(() => {\n      // Enabling certain columns (datasets) will change our row height calculation,\n      // let's recalculate them\n      gridApi?.resetRowHeights();\n    }, [gridApi, selectedColumns, expandRows]);\n\n    const [sidebarPreviewData, setSidebarPreviewData] = useState<{\n      value: string;\n      header: string;\n    } | null>(null);\n\n    const handleCellClicked = useCallback(\n      ({ column, data, value }: CellClickedEvent) => {\n        const columnGroupId = column.getParent()?.getGroupId();\n        const shouldInvokePreviewSidebar =\n          columnGroupId === COLUMN_TYPES.METRICS || columnGroupId === COLUMN_TYPES.PARAMS;\n\n        if (shouldInvokePreviewSidebar) {\n          setSidebarPreviewData({\n            value,\n            header: `Run name: ${data.runName}, Column name: ${column.getColDef().headerTooltip}`,\n          });\n          updateViewState({ previewPaneVisible: true });\n        }\n      },\n      [updateViewState],\n    );\n\n    const displayAddColumnsCTA = !hasSelectedAllColumns && !isComparingRuns && rowsData.length > 0;\n    const displayPreviewSidebar = !isComparingRuns && viewState.previewPaneVisible;\n    const displayRunsTable = !runListHidden || !isComparingRuns;\n    const displayStatusBar = !runListHidden;\n    const displayEmptyState = rowsData.length < 1 && !isLoading && displayRunsTable;\n\n    const tableContext = useMemo(() => ({ orderByAsc, orderByKey }), [orderByAsc, orderByKey]);\n\n    const { cellMouseOverHandler, cellMouseOutHandler } = useRunsHighlightTableRow(containerElement);\n\n    const gridStyles = useExperimentAgGridTableStyles();\n\n    return (\n      <div\n        css={(theme) => ({\n          display: 'grid',\n          flex: 1,\n          gridTemplateColumns: displayPreviewSidebar ? '1fr auto' : '1fr',\n          borderTop: `1px solid ${theme.colors.border}`,\n        })}\n        className={isComparingRuns ? 'is-table-comparing-runs-mode' : undefined}\n      >\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            position: 'relative',\n          }}\n        >\n          <div\n            ref={containerElement}\n            className={cx('ag-theme-balham ag-grid-sticky', {\n              'ag-grid-expanders-visible': expandersVisible,\n              'is-table-comparing-runs-mode': isComparingRuns,\n            })}\n            css={[gridStyles, { display: displayRunsTable ? 'block' : 'hidden', height: '100%' }]}\n            aria-hidden={!displayRunsTable}\n          >\n            <ExperimentViewRunsTableHeaderContextProvider\n              runsHiddenMode={uiState.runsHiddenMode}\n              usingCustomVisibility={usingCustomVisibility}\n              useGroupedValuesInCharts={Boolean(uiState.groupBy) && uiState.useGroupedValuesInCharts}\n              allRunsHidden={allRunsHidden}\n            >\n              <MLFlowAgGridLoader\n                context={tableContext}\n                defaultColDef={EXPERIMENTS_DEFAULT_COLUMN_SETUP}\n                columnDefs={columnDefs}\n                rowSelection=\"multiple\"\n                onGridReady={gridReadyHandler}\n                onSelectionChanged={onSelectionChange}\n                getRowHeight={rowHeightGetterFn}\n                headerHeight={EXPERIMENT_RUNS_TABLE_ROW_HEIGHT}\n                onRowSelected={handleRowSelected}\n                suppressRowClickSelection\n                suppressColumnMoveAnimation\n                suppressScrollOnNewData\n                isFullWidthRow={getRowIsLoadMore}\n                fullWidthCellRenderer=\"LoadMoreRowRenderer\"\n                fullWidthCellRendererParams={{ loadMoreRunsFunc }}\n                suppressFieldDotNotation\n                enableCellTextSelection\n                components={getFrameworkComponents()}\n                suppressNoRowsOverlay\n                loadingOverlayComponent=\"loadingOverlayComponent\"\n                loadingOverlayComponentParams={{ showImmediately: true }}\n                getRowId={getRowId}\n                rowBuffer={ROW_BUFFER}\n                onCellClicked={handleCellClicked}\n                onGridSizeChanged={({ api }) => gridSizeHandler(api)}\n                onCellMouseOver={cellMouseOverHandler}\n                onCellMouseOut={cellMouseOutHandler}\n                maxBlocksInCache={20} // Increased from 10\n                cacheBlockSize={100}\n                maxConcurrentDatasourceRequests={2} // Increased from 1\n                suppressModelUpdateAfterUpdateTransaction\n                immutableData // Added for better performance\n                getRowNodeId={(data) => data.rowUuid} // Added for better row identification\n                suppressPropertyNamesCheck // Added to reduce overhead\n                suppressAnimationFrame // Added to reduce rendering overhead\n              />\n            </ExperimentViewRunsTableHeaderContextProvider>\n            {displayAddColumnsCTA && (\n              <ExperimentViewRunsTableAddColumnCTA\n                gridContainerElement={containerElement.current}\n                isInitialized={Boolean(gridApi)}\n                onClick={onAddColumnClicked}\n                visible={!isLoading}\n                moreRunsAvailable={moreRunsAvailable}\n                moreAvailableRunsTableColumnCount={moreAvailableRunsTableColumnCount}\n              />\n            )}\n          </div>\n          {displayEmptyState && (\n            <ExperimentViewRunsEmptyTable\n              onClearFilters={() => {\n                setUrlSearchFacets(createExperimentPageSearchFacetsState());\n              }}\n              isFiltered={isSearchFacetsFilterUsed(searchFacetsState)}\n            />\n          )}\n          {displayStatusBar && <ExperimentViewRunsTableStatusBar allRunsCount={allRunsCount} isLoading={isLoading} />}\n        </div>\n        {displayPreviewSidebar && (\n          <PreviewSidebar\n            content={sidebarPreviewData?.value}\n            copyText={sidebarPreviewData?.value}\n            headerText={sidebarPreviewData?.header}\n            onClose={() => updateViewState({ previewPaneVisible: false })}\n            empty={\n              <Empty\n                description={\n                  <FormattedMessage\n                    defaultMessage=\"Select a cell to display preview\"\n                    description=\"Experiment page > table view > preview sidebar > nothing selected\"\n                  />\n                }\n              />\n            }\n          />\n        )}\n      </div>\n    );\n  },\n);\n\n/**\n * Concrete named definitions for colors used in this agGrid\n */\nconst getGridColors = (theme: Theme) => ({\n  rowForeground: theme.colors.textPrimary, // regular row background\n  rowBackground: theme.colors.backgroundPrimary, // regular row background\n  rowBackgroundHover: theme.colors.tableBackgroundUnselectedHover,\n  rowBackgroundSelected: theme.colors.tableBackgroundSelectedDefault,\n  rowBackgroundHoverSelected: theme.colors.tableBackgroundSelectedHover,\n  columnSortedBy: `${theme.colors.blue400}1F`,\n  headerBackground: theme.colors.backgroundSecondary,\n  headerTextColor: theme.colors.textSecondary, // directly from Figma design\n  headerGroupTextColor: theme.colors.textSecondary, // directly from Figma design\n  borderColor: theme.colors.borderDecorative, // border between header and content and scrollable areas\n  headerBorderColor: 'transparent', // borders inside the header\n  checkboxBorderColor: theme.colors.actionDefaultBorderDefault,\n  checkboxBorderColorChecked: theme.colors.backgroundPrimary,\n  checkboxBackgroundColorChecked: theme.colors.actionPrimaryBackgroundDefault,\n  overlayBackground: `${theme.colors.backgroundSecondary}99`, // color for the loading overlay\n});\n\nconst styles = {\n  agGridOverrides: (theme: Theme, usingCustomHeaderComponent = true): CSSObject => {\n    const gridColors = getGridColors(theme);\n    return {\n      height: '100%',\n      position: 'relative',\n      '&.ag-theme-balham': {\n        // Set up internal variable values\n        '--ag-border-color': gridColors.borderColor,\n        '--ag-row-border-color': gridColors.borderColor,\n        '--ag-foreground-color': gridColors.rowForeground,\n        '--ag-background-color': gridColors.rowBackground,\n        '--ag-odd-row-background-color': gridColors.rowBackground,\n        '--ag-row-hover-color': gridColors.rowBackgroundHover,\n        '--ag-selected-row-background-color': gridColors.rowBackgroundSelected,\n        '--ag-header-foreground-color': gridColors.headerTextColor,\n        '--ag-header-background-color': gridColors.headerBackground,\n        '--ag-modal-overlay-background-color': gridColors.overlayBackground,\n\n        // Makes row header sticky\n        '&.ag-grid-sticky .ag-header': {\n          position: 'sticky',\n          top: 0,\n          zIndex: 1,\n        },\n        '&.ag-grid-sticky .ag-root': {\n          overflow: 'visible',\n        },\n        '&.ag-grid-sticky .ag-root-wrapper': {\n          border: '0',\n          borderRadius: '4px',\n          overflow: 'visible',\n        },\n\n        // When scrollbars are forced to be visible in the system, ag-grid will sometimes\n        // display a scrollbar that is not needed. We hide it here on compact mode.\n        '.is-table-comparing-runs-mode & .ag-body-horizontal-scroll.ag-scrollbar-invisible': {\n          display: 'none',\n        },\n\n        // Adds a static line between column group header row and column headers\n        '.ag-header::after': {\n          content: '\"\"',\n          position: 'absolute',\n          top: EXPERIMENT_RUNS_TABLE_ROW_HEIGHT,\n          left: 0,\n          right: 0,\n          height: 1,\n          backgroundColor: gridColors.borderColor,\n        },\n\n        // Line height for cell contents is the row height minus the border\n        '.ag-cell': {\n          // lineHeight: `min(var(--ag-line-height, ${ROW_HEIGHT - 2}px), ${ROW_HEIGHT - 2}px)`,\n          display: 'flex',\n          overflow: 'hidden',\n          '& > .ag-cell-wrapper': {\n            overflow: 'hidden',\n          },\n        },\n\n        // Padding fixes for the header (if custom header component is used)\n        '.ag-header-cell': usingCustomHeaderComponent\n          ? {\n              padding: 0,\n            }\n          : undefined,\n\n        '.ag-header-cell .ag-checkbox': usingCustomHeaderComponent\n          ? {\n              padding: '0 7px',\n              borderLeft: '1px solid transparent', // to match it with the cell sizing\n            }\n          : undefined,\n\n        '.ag-cell.is-ordered-by, .ag-header-cell > .is-ordered-by': {\n          backgroundColor: gridColors.columnSortedBy,\n        },\n        '.ag-header-row': {\n          '--ag-border-color': gridColors.headerBorderColor,\n        },\n        '.ag-header-row.ag-header-row-column-group': {\n          '--ag-header-foreground-color': gridColors.headerGroupTextColor,\n        },\n        '.ag-row.ag-row-selected.ag-row-hover': {\n          backgroundColor: gridColors.rowBackgroundHoverSelected,\n        },\n        '.ag-row.is-highlighted': {\n          backgroundColor: gridColors.rowBackgroundHoverSelected,\n        },\n        // Hides resize guidelines when header is not hovered\n        '.ag-header:not(:hover) .ag-header-cell::after, .ag-header:not(:hover) .ag-header-group-cell::after': {\n          opacity: 0,\n        },\n        '.ag-pinned-left-header': {\n          borderRight: 'none',\n        },\n\n        // Fixed for loading overlay, should be above \"load more\" button\n        '.ag-overlay-loading-wrapper': {\n          paddingTop: theme.spacing.md * 4,\n          alignItems: 'center',\n          zIndex: 2,\n        },\n        '.ag-overlay-loading-wrapper .ag-react-container': {\n          flex: 1,\n        },\n\n        // Adds border after the last column to separate contents from \"Add columns\" CTA\n        '.ag-center-cols-container': {\n          minHeight: 0,\n        },\n\n        '.ag-full-width-row': {\n          borderBottom: 0,\n          backgroundColor: 'transparent',\n          zIndex: 1,\n          '&.ag-row-hover': {\n            backgroundColor: 'transparent',\n          },\n        },\n\n        // Centers vertically and styles the checkbox cell\n        '.is-checkbox-cell': {\n          display: 'flex',\n          alignItems: 'center',\n          paddingLeft: 7, // will end up in 8px due to 1px of transparent border on the left\n          '.is-multiline-cell .ag-cell-value': {\n            height: '100%',\n          },\n        },\n\n        // Change appearance of the previewable cells\n        '.is-previewable-cell': {\n          cursor: 'pointer',\n        },\n\n        // Header checkbox cell will get the same background as header only if it's unchecked\n        '.ag-header-cell .ag-checkbox .ag-input-wrapper:not(.ag-indeterminate):not(.ag-checked)': {\n          '--ag-checkbox-background-color': gridColors.headerBackground,\n        },\n\n        // Distance from the checkbox to other icons (pin, visibility etc.)\n        '.ag-cell-wrapper .ag-selection-checkbox': {\n          marginRight: 20,\n        },\n\n        // Header and cell checkboxes will get same colors from the palette\n        '.is-checkbox-cell, .ag-header-cell .ag-checkbox': {\n          '.ag-checkbox-input-wrapper::after': {\n            color: gridColors.checkboxBorderColor,\n          },\n          '.ag-checkbox-input-wrapper.ag-checked': {\n            '--ag-checkbox-background-color': gridColors.checkboxBackgroundColorChecked,\n            '--ag-checkbox-checked-color': gridColors.checkboxBorderColorChecked,\n            '&::after': {\n              color: gridColors.checkboxBorderColorChecked,\n            },\n          },\n        },\n      },\n    };\n  },\n};\n\n/**\n * Returns common styles to be used in ag-grid powered tables\n */\nexport const useExperimentAgGridTableStyles = ({\n  usingCustomHeaderComponent = true,\n}: { usingCustomHeaderComponent?: boolean } = {}) => {\n  const { theme } = useDesignSystemTheme();\n  return useMemo(() => styles.agGridOverrides(theme, usingCustomHeaderComponent), [theme, usingCustomHeaderComponent]);\n};\n","import { MLFLOW_SYSTEM_METRIC_PREFIX } from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { MetricEntitiesByName } from '../../../types';\nimport { KeyValueEntity } from '../../../../common/types';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\nimport { DifferenceCardAttributes, RunsChartsDifferenceCardConfig } from '../runs-charts.types';\nimport Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nconst DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE = '-';\nconst DIFFERENCE_EPSILON = 1e-6;\nexport const getDifferenceChartDisplayedValue = (val: any, places = 2) => {\n  if (typeof val === 'number') {\n    return val.toFixed(places);\n  } else if (typeof val === 'string') {\n    return val;\n  }\n  try {\n    return JSON.stringify(val);\n  } catch {\n    return DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE;\n  }\n};\n\nexport enum DifferenceChartCellDirection {\n  POSITIVE,\n  NEGATIVE,\n  SAME,\n}\nexport const differenceView = (a: any, b: any) => {\n  if (typeof a !== 'number' || typeof b !== 'number') {\n    return undefined;\n  } else {\n    const diff = a - b;\n    if (diff === 0) {\n      return { label: getDifferenceChartDisplayedValue(diff).toString(), direction: DifferenceChartCellDirection.SAME };\n    } else if (diff > 0) {\n      return { label: `+${getDifferenceChartDisplayedValue(diff)}`, direction: DifferenceChartCellDirection.POSITIVE };\n    } else {\n      return {\n        label: getDifferenceChartDisplayedValue(diff).toString(),\n        direction: DifferenceChartCellDirection.NEGATIVE,\n      };\n    }\n  }\n};\n\nexport const isDifferent = (a: any, b: any) => {\n  if (a === DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE || b === DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE) {\n    return false;\n  }\n  // Check if type a and b are the same\n  if (typeof a !== typeof b) {\n    return true;\n  } else if (typeof a === 'number' && typeof b === 'number') {\n    return Math.abs(a - b) > DIFFERENCE_EPSILON;\n  } else if (typeof a === 'string' && typeof b === 'string') {\n    return a !== b;\n  }\n  return false;\n};\n\nexport const getDifferenceViewDataGroups = (\n  previewData: RunsChartsRunData[],\n  cardConfig: RunsChartsDifferenceCardConfig,\n  headingColumnId: string,\n  groupBy: RunsGroupByConfig | null,\n) => {\n  const getMetrics = (\n    filterCondition: (metric: string) => boolean,\n    runDataKeys: (data: RunsChartsRunData) => string[],\n    runDataAttribute: (\n      data: RunsChartsRunData,\n    ) =>\n      | MetricEntitiesByName\n      | Record<string, KeyValueEntity>\n      | Record<string, { key: string; value: string | number }>,\n  ) => {\n    // Get array of sorted keys\n    const keys = Array.from(new Set(previewData.flatMap((runData) => runDataKeys(runData))))\n      .filter((key) => filterCondition(key))\n      .sort();\n    const values = keys.flatMap((key: string) => {\n      const data: Record<string, string | number> = {};\n      let hasDifference = false;\n\n      previewData.forEach((runData, index) => {\n        // Set the key as runData.uuid and the value as the metric's value or DEFAULT_EMPTY_VALUE\n        data[runData.uuid] = runDataAttribute(runData)[key]\n          ? runDataAttribute(runData)[key].value\n          : DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE;\n        if (index > 0) {\n          const prev = previewData[index - 1];\n          if (isDifferent(data[prev.uuid], data[runData.uuid])) {\n            hasDifference = true;\n          }\n        }\n      });\n      if (cardConfig.showDifferencesOnly && !hasDifference) {\n        return [];\n      }\n      return [\n        {\n          [headingColumnId]: key,\n          ...data,\n        },\n      ];\n    });\n    return values;\n  };\n\n  const modelMetrics = getMetrics(\n    (metric: string) => !metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  const systemMetrics = getMetrics(\n    (metric: string) => metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  if (groupBy) {\n    return { modelMetrics, systemMetrics, parameters: [], tags: [], attributes: [] };\n  }\n\n  const parameters = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Object.keys(runData.params),\n    (runData: RunsChartsRunData) => runData.params,\n  );\n\n  const tags = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Utils.getVisibleTagValues(runData.tags).map(([key]) => key),\n    (runData: RunsChartsRunData) => runData.tags,\n  );\n\n  // Get attributes\n  const attributeGroups = [\n    DifferenceCardAttributes.USER,\n    DifferenceCardAttributes.SOURCE,\n    DifferenceCardAttributes.VERSION,\n    DifferenceCardAttributes.MODELS,\n  ];\n  const attributes = attributeGroups.flatMap((attribute) => {\n    const attributeData: Record<string, string | number> = {};\n    let hasDifference = false;\n    previewData.forEach((runData, index) => {\n      if (attribute === DifferenceCardAttributes.USER) {\n        const user = Utils.getUser(runData.runInfo ?? {}, runData.tags);\n        attributeData[runData.uuid] = user;\n      } else if (attribute === DifferenceCardAttributes.SOURCE) {\n        const source = Utils.getSourceName(runData.tags);\n        attributeData[runData.uuid] = source;\n      } else if (attribute === DifferenceCardAttributes.VERSION) {\n        const version = Utils.getSourceVersion(runData.tags);\n        attributeData[runData.uuid] = version;\n      } else {\n        const models = Utils.getLoggedModelsFromTags(runData.tags);\n        attributeData[runData.uuid] = models.join(',');\n      }\n      if (index > 0) {\n        const prev = previewData[index - 1];\n        if (isDifferent(attributeData[prev.uuid], attributeData[runData.uuid])) {\n          hasDifference = true;\n        }\n      }\n    });\n    if (cardConfig.showDifferencesOnly && !hasDifference) {\n      return [];\n    }\n    return [\n      {\n        [headingColumnId]: attribute,\n        ...attributeData,\n      },\n    ];\n  });\n  return { modelMetrics, systemMetrics, parameters, tags, attributes };\n};\n\nexport const DIFFERENCE_PLOT_EXPAND_COLUMN_ID = 'expand';\nexport const DIFFERENCE_PLOT_HEADING_COLUMN_ID = 'headingColumn';\n\n/**\n * Transforms an array of objects into a format suitable for rendering in a table.\n * Each object in the array represents a row in the table.\n * If all values in a row are JSON objects with the same keys, the row is transformed into a parent row with child rows.\n * Each child row represents a key-value pair from the JSON objects.\n * If a value in a row is not a JSON object or the JSON objects don't have the same keys, the row is not transformed.\n *\n * @param data - An array of objects. Each object represents a row in the table.\n * @returns An array of objects. Each object represents a row or a parent row with child rows in the table.\n */\nexport const getDifferencePlotJSONRows = (data: { [key: string]: string | number }[]) => {\n  const validateParseJSON = (value: string) => {\n    try {\n      const parsed = JSON.parse(value);\n      if (parsed === null || typeof parsed !== 'object' || Array.isArray(parsed) || Object.keys(parsed).length === 0) {\n        return null;\n      }\n      return parsed;\n    } catch (e) {\n      return null;\n    }\n  };\n\n  const extractMaximumCommonSchema = (schema1: Record<any, any> | undefined, schema2: Record<any, any> | undefined) => {\n    if (schema1 !== undefined && Object.keys(schema1).length === 0) {\n      // This may not be a suitable object, return null\n      return null;\n    } else if (schema2 !== undefined && Object.keys(schema2).length === 0) {\n      return null;\n    }\n\n    const schema: Record<string, unknown> = {};\n\n    const collectKeys = (target: Record<any, any>, source: Record<any, any>) => {\n      for (const key in source) {\n        if (!target.hasOwnProperty(key) || target[key]) {\n          if (typeof source[key] === 'object' && source[key] !== null && !Array.isArray(source[key])) {\n            target[key] = target[key] || {};\n            collectKeys(target[key], source[key]);\n          } else if (source[key] === DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE) {\n            target[key] = true;\n          } else {\n            target[key] = false;\n          }\n        }\n      }\n    };\n\n    schema1 !== undefined && collectKeys(schema, schema1);\n    schema2 !== undefined && collectKeys(schema, schema2);\n\n    return schema;\n  };\n\n  const getChildren = (\n    parsedRowWithoutHeadingCol: { [key: string]: Record<any, any> | undefined },\n    schema: Record<any, any>,\n  ): Record<string, any>[] => {\n    return Object.keys(schema).map((key) => {\n      if (typeof schema[key] === 'boolean') {\n        let result = {\n          key: key,\n          [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: key,\n        };\n        Object.keys(parsedRowWithoutHeadingCol).forEach((runUuid) => {\n          const value = parsedRowWithoutHeadingCol[runUuid]?.[key];\n          result = {\n            ...result,\n            [runUuid]: value === undefined ? DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE : value,\n          };\n        });\n        return result;\n      }\n      // Recurse\n      const newParsedRow: { [key: string]: Record<any, any> | undefined } = {};\n      Object.keys(parsedRowWithoutHeadingCol).forEach((runUuid) => {\n        newParsedRow[runUuid] = parsedRowWithoutHeadingCol[runUuid]?.[key];\n      });\n\n      return {\n        key: key,\n        [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: key,\n        children: getChildren(newParsedRow, schema[key]),\n      };\n    });\n  };\n\n  const isAllElementsJSON = (row: { [key: string]: string | number }) => {\n    let jsonSchema: Record<any, any> | undefined = undefined;\n    let isAllJson = true;\n    const parsedRow: Record<string, any> = {};\n\n    Object.keys(row).forEach((runUuid) => {\n      if (runUuid !== DIFFERENCE_PLOT_HEADING_COLUMN_ID) {\n        if (row[runUuid] !== DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE) {\n          const json = validateParseJSON(row[runUuid] as string);\n          parsedRow[runUuid] = json;\n          if (json === null) {\n            isAllJson = false;\n          } else {\n            const commonSchema = extractMaximumCommonSchema(jsonSchema, json);\n            if (commonSchema === null) {\n              isAllJson = false;\n            } else {\n              jsonSchema = commonSchema;\n            }\n          }\n        }\n      }\n    });\n    if (isAllJson && jsonSchema !== undefined) {\n      try {\n        return {\n          [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: row[DIFFERENCE_PLOT_HEADING_COLUMN_ID],\n          children: getChildren(parsedRow, jsonSchema),\n          key: row[DIFFERENCE_PLOT_HEADING_COLUMN_ID],\n        };\n      } catch {\n        return row;\n      }\n    } else {\n      return row;\n    }\n  };\n  return data.map(isAllElementsJSON);\n};\n","import {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  DashIcon,\n  Typography,\n  TypographyColor,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport {\n  DifferenceChartCellDirection,\n  differenceView,\n  getDifferenceChartDisplayedValue,\n} from '../../../utils/differenceView';\nimport { type CellContext } from '@tanstack/react-table';\nimport { DifferencePlotDataColumnDef, type DifferencePlotDataRow } from '../DifferenceViewPlot';\n\nconst CellDifference = ({ label, direction }: { label: string; direction: DifferenceChartCellDirection }) => {\n  const { theme } = useDesignSystemTheme();\n  let paragraphColor: TypographyColor | undefined = undefined;\n  let icon = null;\n  switch (direction) {\n    case DifferenceChartCellDirection.NEGATIVE:\n      paragraphColor = 'error';\n      icon = <ArrowDownIcon color=\"danger\" data-testid=\"negative-cell-direction\" />;\n      break;\n    case DifferenceChartCellDirection.POSITIVE:\n      paragraphColor = 'success';\n      icon = <ArrowUpIcon color=\"success\" data-testid=\"positive-cell-direction\" />;\n      break;\n    case DifferenceChartCellDirection.SAME:\n      paragraphColor = 'info';\n      icon = <DashIcon css={{ color: theme.colors.textSecondary }} data-testid=\"same-cell-direction\" />;\n      break;\n    default:\n      break;\n  }\n\n  return (\n    <div\n      css={{\n        display: 'inline-flex',\n        backgroundColor: theme.colors.actionDisabledBackground,\n        padding: `${theme.spacing.xs / 2}px ${theme.spacing.xs}px`,\n        fontSize: theme.typography.fontSizeSm,\n        borderRadius: theme.borders.borderRadiusSm,\n        userSelect: 'none',\n        gap: theme.spacing.xs,\n        alignItems: 'center',\n        svg: {\n          width: theme.typography.fontSizeSm,\n          height: theme.typography.fontSizeSm,\n        },\n        overflow: 'hidden',\n      }}\n    >\n      <Typography.Text size=\"sm\" color={paragraphColor} css={{ margin: 0 }} ellipsis>\n        {label}\n      </Typography.Text>\n      {icon}\n    </div>\n  );\n};\n\nexport const DifferencePlotDataCell = ({\n  getValue,\n  row: { original },\n  column: { columnDef },\n}: CellContext<DifferencePlotDataRow, DifferencePlotDataRow> & {\n  column: { columnDef: DifferencePlotDataColumnDef };\n  row: { original: Record<string, any> };\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const { isBaseline, baselineColumnUuid, showChangeFromBaseline } = columnDef.meta ?? {};\n\n  const value = getValue();\n\n  if (isBaseline) {\n    return getDifferenceChartDisplayedValue(getValue());\n  }\n  if (value === undefined) {\n    return null;\n  }\n  const rowDifference = baselineColumnUuid ? differenceView(value, original[baselineColumnUuid]) : null;\n  return (\n    <span css={{ display: 'inline-flex', overflow: 'hidden', gap: theme.spacing.sm, alignItems: 'center' }}>\n      <Typography.Text ellipsis>{getDifferenceChartDisplayedValue(value)}</Typography.Text>\n      {rowDifference && showChangeFromBaseline && (\n        <CellDifference label={rowDifference.label} direction={rowDifference.direction} />\n      )}\n    </span>\n  );\n};\n","import { HeaderContext } from '@tanstack/react-table';\nimport { RunColorPill } from '../../../../experiment-page/components/RunColorPill';\nimport { Button, DropdownMenu, OverflowIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { type DifferencePlotDataColumnDef } from '../DifferenceViewPlot';\n\nexport const DifferencePlotRunHeaderCell = ({\n  column: { columnDef },\n}: {\n  column: {\n    columnDef: DifferencePlotDataColumnDef;\n  };\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const traceData = columnDef.meta?.traceData;\n  const updateBaselineColumnUuid = columnDef.meta?.updateBaselineColumnUuid;\n  if (!traceData) {\n    return null;\n  }\n  return (\n    <div\n      css={{\n        flex: 1,\n        display: 'inline-flex',\n        overflow: 'hidden',\n        alignItems: 'center',\n        gap: theme.spacing.xs,\n        fontWeight: 'normal',\n      }}\n    >\n      <RunColorPill color={traceData.color} /> <Typography.Text ellipsis>{traceData?.displayName}</Typography.Text>\n      <div css={{ flex: 1 }} />\n      <DropdownMenu.Root>\n        <DropdownMenu.Trigger asChild>\n          <Button\n            type=\"link\"\n            size=\"small\"\n            componentId=\"mlflow.charts.difference_plot.overflow_menu.trigger\"\n            icon={<OverflowIcon />}\n          />\n        </DropdownMenu.Trigger>\n        <DropdownMenu.Content>\n          <DropdownMenu.Item\n            componentId=\"mlflow.charts.difference_plot.overflow_menu.set_as_baseline\"\n            onClick={() => updateBaselineColumnUuid?.(traceData.uuid)}\n          >\n            <FormattedMessage\n              defaultMessage=\"Set as baseline\"\n              description=\"In the run data difference comparison table, the label for an option to set particular experiment run as a baseline one - meaning other runs will be compared to it.\"\n            />\n          </DropdownMenu.Item>\n        </DropdownMenu.Content>\n      </DropdownMenu.Root>\n    </div>\n  );\n};\n","import {\n  Button,\n  ChevronDownIcon,\n  ChevronRightIcon,\n  Table,\n  TableCell,\n  TableHeader,\n  TableRow,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport {\n  CellContext,\n  ColumnDef,\n  ColumnDefTemplate,\n  flexRender,\n  getCoreRowModel,\n  getExpandedRowModel,\n  Row,\n  useReactTable,\n} from '@tanstack/react-table';\nimport { useVirtualizer } from '@tanstack/react-virtual';\nimport { useCallback, useMemo, useRef, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport {\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport {\n  DIFFERENCE_PLOT_EXPAND_COLUMN_ID,\n  DIFFERENCE_PLOT_HEADING_COLUMN_ID,\n  getDifferencePlotJSONRows,\n  getDifferenceViewDataGroups,\n} from '../../utils/differenceView';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { DifferencePlotDataCell } from './difference-view-plot/DifferencePlotDataCell';\nimport { DifferencePlotRunHeaderCell } from './difference-view-plot/DifferencePlotRunHeaderCell';\n\nexport type DifferencePlotDataColumnDef = ColumnDef<DifferencePlotDataRow> & {\n  meta?: {\n    traceData?: RunsChartsRunData;\n    updateBaselineColumnUuid: (uuid: string) => void;\n    isBaseline: boolean;\n    showChangeFromBaseline: boolean;\n    baselineColumnUuid?: string;\n  };\n};\n\nexport type DifferencePlotDataRow =\n  | Record<string, any>\n  | {\n      children: DifferencePlotDataRow[];\n      key: string;\n      [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: string;\n    };\n\nconst ExpandCell: ColumnDefTemplate<\n  CellContext<DifferencePlotDataRow, unknown> & { toggleExpand?: (row: Row<DifferencePlotDataRow>) => void }\n> = ({ row, toggleExpand }) => {\n  if (row.getCanExpand() && toggleExpand) {\n    return (\n      <Button\n        componentId=\"mlflow.charts.difference_plot.expand_button\"\n        size=\"small\"\n        type=\"link\"\n        onClick={() => toggleExpand(row)}\n        icon={row.getIsExpanded() ? <ChevronDownIcon /> : <ChevronRightIcon />}\n      />\n    );\n  }\n  return null;\n};\n\nexport const DifferenceViewPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsDifferenceCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const { modelMetrics, systemMetrics, parameters, tags, attributes } = useMemo(\n    () => getDifferenceViewDataGroups(previewData, cardConfig, DIFFERENCE_PLOT_HEADING_COLUMN_ID, groupBy),\n    [previewData, cardConfig, groupBy],\n  );\n\n  const { baselineColumn, nonBaselineColumns } = useMemo(() => {\n    const dataTracesReverse = previewData.slice().reverse();\n    // baseline column (can be undefined if no baseline selected)\n    let baselineColumn = dataTracesReverse.find((runData) => runData.uuid === cardConfig.baselineColumnUuid);\n    if (baselineColumn === undefined && dataTracesReverse.length > 0) {\n      // Set the first column as baseline column\n      baselineColumn = dataTracesReverse[0];\n    }\n    // non-baseline columns\n    const nonBaselineColumns = dataTracesReverse.filter(\n      (runData) => baselineColumn === undefined || runData.uuid !== baselineColumn.uuid,\n    );\n    return { baselineColumn, nonBaselineColumns };\n  }, [previewData, cardConfig.baselineColumnUuid]);\n\n  const updateBaselineColumnUuid = useCallback(\n    (baselineColumnUuid: string) => {\n      setCardConfig?.((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        baselineColumnUuid,\n      }));\n    },\n    [setCardConfig],\n  );\n\n  const dataRows = useMemo<DifferencePlotDataRow[]>(\n    () =>\n      cardConfig.compareGroups.reduce((acc: DifferencePlotDataRow[], group: DifferenceCardConfigCompareGroup) => {\n        switch (group) {\n          case DifferenceCardConfigCompareGroup.MODEL_METRICS:\n            acc.push({\n              [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: formatMessage({\n                defaultMessage: `Model Metrics`,\n                description:\n                  'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > model metrics heading',\n              }),\n              children: [...modelMetrics],\n              key: 'modelMetrics',\n            });\n            break;\n          case DifferenceCardConfigCompareGroup.SYSTEM_METRICS:\n            acc.push({\n              [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: formatMessage({\n                defaultMessage: `System Metrics`,\n                description:\n                  'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > system metrics heading',\n              }),\n              children: [...systemMetrics],\n              key: 'systemMetrics',\n            });\n            break;\n          case DifferenceCardConfigCompareGroup.PARAMETERS:\n            acc.push({\n              [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: formatMessage({\n                defaultMessage: `Parameters`,\n                description:\n                  'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > parameters heading',\n              }),\n              children: getDifferencePlotJSONRows(parameters),\n              key: 'parameters',\n            });\n            break;\n          case DifferenceCardConfigCompareGroup.ATTRIBUTES:\n            acc.push({\n              [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: formatMessage({\n                defaultMessage: `Attributes`,\n                description:\n                  'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > attributes heading',\n              }),\n              children: [...attributes],\n              key: 'attributes',\n            });\n            break;\n          case DifferenceCardConfigCompareGroup.TAGS:\n            acc.push({\n              [DIFFERENCE_PLOT_HEADING_COLUMN_ID]: formatMessage({\n                defaultMessage: `Tags`,\n                description: 'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > tags heading',\n              }),\n              children: [...tags],\n              key: 'tags',\n            });\n            break;\n        }\n        return acc;\n      }, []),\n    [modelMetrics, systemMetrics, parameters, tags, attributes, cardConfig.compareGroups, formatMessage],\n  );\n\n  const columns = useMemo(() => {\n    const columns: DifferencePlotDataColumnDef[] = [\n      {\n        id: DIFFERENCE_PLOT_EXPAND_COLUMN_ID,\n        cell: ExpandCell,\n        size: 32,\n        enableResizing: false,\n      },\n      {\n        accessorKey: DIFFERENCE_PLOT_HEADING_COLUMN_ID,\n        size: 150,\n        header: formatMessage({\n          defaultMessage: 'Compare by',\n          description: 'Runs charts > components > charts > DifferenceViewPlot > Compare by column heading',\n        }),\n        id: DIFFERENCE_PLOT_HEADING_COLUMN_ID,\n        enableResizing: true,\n      },\n      ...[baselineColumn, ...nonBaselineColumns].map((traceData, index) => ({\n        accessorKey: traceData?.uuid,\n        size: 200,\n        enableResizing: true,\n        meta: {\n          traceData,\n          updateBaselineColumnUuid,\n          showChangeFromBaseline: cardConfig.showChangeFromBaseline,\n          isBaseline: traceData === baselineColumn,\n          baselineColumnUuid: baselineColumn?.uuid,\n        },\n        id: traceData?.uuid ?? index.toString(),\n        header: DifferencePlotRunHeaderCell as ColumnDefTemplate<DifferencePlotDataRow>,\n        cell: DifferencePlotDataCell as ColumnDefTemplate<DifferencePlotDataRow>,\n      })),\n    ];\n    return columns;\n  }, [formatMessage, baselineColumn, nonBaselineColumns, updateBaselineColumnUuid, cardConfig.showChangeFromBaseline]);\n\n  // Start with all row groups expanded\n  const [expanded, setExpanded] = useState({\n    modelMetrics: true,\n    systemMetrics: true,\n    parameters: true,\n    attributes: true,\n    tags: true,\n  });\n\n  const table = useReactTable({\n    columns,\n    data: dataRows,\n    getCoreRowModel: getCoreRowModel(),\n    getExpandedRowModel: getExpandedRowModel(),\n    columnResizeMode: 'onChange',\n    enableExpanding: true,\n    getSubRows: (row) => row.children,\n    getRowId: (row) => row.key,\n    getRowCanExpand: (row) => Boolean(row.subRows.length),\n    state: {\n      expanded,\n      columnPinning: {\n        left: [DIFFERENCE_PLOT_EXPAND_COLUMN_ID, DIFFERENCE_PLOT_HEADING_COLUMN_ID],\n      },\n    },\n  });\n\n  const tableContainerRef = useRef<HTMLDivElement>(null);\n\n  const toggleExpand = useCallback((row: Row<DifferencePlotDataRow>) => {\n    const key = row.original.key;\n    setExpanded((prev) => ({\n      ...prev,\n      [key]: !row.getIsExpanded(),\n    }));\n  }, []);\n\n  const { getVirtualItems, getTotalSize } = useVirtualizer({\n    count: table.getExpandedRowModel().rows.length,\n    getScrollElement: () => tableContainerRef.current,\n    estimateSize: () => 33, // Default row height\n    paddingStart: 37, // Default header height,\n  });\n\n  const expandedRows = table.getExpandedRowModel().rows;\n\n  return (\n    <div css={{ flex: 1, overflowX: 'scroll', height: '100%' }} ref={tableContainerRef}>\n      <Table css={{ width: table.getTotalSize(), position: 'relative' }}>\n        <TableRow isHeader css={{ position: 'sticky', top: 0, zIndex: 101 }}>\n          {table.getLeafHeaders().map((header, index) => {\n            const isPinned = header.column.getIsPinned();\n\n            return (\n              <TableHeader\n                header={header}\n                column={header.column}\n                setColumnSizing={table.setColumnSizing}\n                componentId=\"mlflow.charts.difference_plot.header\"\n                key={header.id}\n                multiline={false}\n                style={{\n                  left: isPinned === 'left' ? `${header.column.getStart('left')}px` : undefined,\n                  position: isPinned ? 'sticky' : 'relative',\n                  width: header.column.getSize(),\n                  flexBasis: header.column.getSize(),\n                  zIndex: isPinned ? 100 : 0,\n                }}\n                wrapContent={false}\n              >\n                {flexRender(header.column.columnDef.header, header.getContext())}\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n        <div css={{ height: getTotalSize() }}>\n          {getVirtualItems().map(({ index, start, size }) => {\n            const row = expandedRows[index];\n\n            return (\n              <TableRow\n                key={row.id + index}\n                css={{\n                  width: 'auto',\n                  position: 'absolute',\n                  top: 0,\n                }}\n                style={{\n                  transform: `translateY(${start}px)`,\n                  height: size,\n                }}\n              >\n                {row.getVisibleCells().map((cell, index) => {\n                  const isPinned = cell.column.getIsPinned();\n\n                  const isNameColumn = cell.column.columnDef.id === DIFFERENCE_PLOT_HEADING_COLUMN_ID;\n                  return (\n                    <TableCell\n                      key={cell.id}\n                      style={{\n                        left: isPinned === 'left' ? `${cell.column.getStart('left')}px` : undefined,\n                        position: isPinned ? 'sticky' : 'relative',\n                        width: cell.column.getSize(),\n                        zIndex: isPinned ? 100 : 0,\n                        flexBasis: cell.column.getSize(),\n                      }}\n                      css={[\n                        {\n                          backgroundColor: isPinned ? theme.colors.backgroundPrimary : undefined,\n                        },\n                        isNameColumn && { borderRight: `1px solid ${theme.colors.border}` },\n                        isNameColumn && { paddingLeft: row.depth * theme.spacing.lg },\n                      ]}\n                      wrapContent={false}\n                    >\n                      {flexRender(cell.column.columnDef.cell, { ...cell.getContext(), toggleExpand })}\n                    </TableCell>\n                  );\n                })}\n              </TableRow>\n            );\n          })}\n        </div>\n      </Table>\n    </div>\n  );\n};\n","var _rect, _rect2, _rect3, _rect4, _rect5, _rect6, _rect7, _rect8, _rect9, _rect0, _rect1, _rect10, _rect11, _rect12, _rect13, _rect14, _rect15, _rect16;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartDifference({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect5 || (_rect5 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect6 || (_rect6 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect7 || (_rect7 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect8 || (_rect8 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect9 || (_rect9 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect0 || (_rect0 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect1 || (_rect1 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect10 || (_rect10 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect11 || (_rect11 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect12 || (_rect12 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect13 || (_rect13 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect14 || (_rect14 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect15 || (_rect15 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect16 || (_rect16 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartDifference);\nexport default __webpack_public_path__ + \"static/media/chart-difference.16174216d6f3b7c24f40e3541fe0ca2c.svg\";\nexport { ForwardRef as ReactComponent };","import { Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, ImagePlotWithHistory } from './ImageGridPlot.common';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\n\nexport const ImageGridSingleKeyPlot = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => {\n    const imageMetadata = run.images[cardConfig.imageKeys[0]];\n    return imageMetadata && Object.keys(imageMetadata).length > 0;\n  });\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ display: 'flex', justifyContent: 'flex-start', flexWrap: 'wrap', gap: theme.spacing.xs }}>\n      {displayRuns.map((run: RunsChartsRunData) => {\n        // There is exactly one key in this plot\n        const imageMetadataByStep = Object.values(run.images[cardConfig.imageKeys[0]]).reduce(\n          (acc, metadata: ImageEntity) => {\n            if (metadata.step !== undefined) {\n              acc[metadata.step] = metadata;\n            }\n            return acc;\n          },\n          {} as Record<number, ImageEntity>,\n        );\n        return (\n          <div\n            key={run.uuid}\n            css={{\n              border: `1px solid transparent`,\n              borderRadius: theme.borders.borderRadiusSm,\n              padding: theme.spacing.sm,\n              '&:hover': {\n                border: `1px solid ${theme.colors.border}`,\n                backgroundColor: theme.colors.tableBackgroundUnselectedHover,\n              },\n            }}\n          >\n            <Tooltip content={run.displayName} componentId=\"mlflow.charts.image-plot.run-name-tooltip\">\n              <div\n                css={{\n                  height: theme.typography.lineHeightMd,\n                  overflow: 'hidden',\n                  whiteSpace: 'nowrap',\n                  display: 'inline-flex',\n                  alignItems: 'center',\n                  gap: theme.spacing.sm,\n                }}\n              >\n                <RunColorPill color={run.color} />\n                {run.displayName}\n              </div>\n            </Tooltip>\n            <ImagePlotWithHistory\n              key={run.uuid}\n              step={cardConfig.step}\n              metadataByStep={imageMetadataByStep}\n              runUuid={run.uuid}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import { useDesignSystemTheme, TableRow, TableHeader, TableCell, Table, Tooltip } from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { useMemo } from 'react';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, ImagePlotWithHistory, MIN_GRID_IMAGE_SIZE } from './ImageGridPlot.common';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ImageGridMultipleKeyPlot = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => Object.keys(run.images).length !== 0);\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ height: '100%', width: '100%' }}>\n      <Table grid scrollable>\n        <TableRow isHeader>\n          <TableHeader\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_imagegridmultiplekeyplot.tsx_44\"\n            css={{ minWidth: MIN_GRID_IMAGE_SIZE + theme.spacing.md }}\n          >\n            <FormattedMessage\n              defaultMessage=\"images\"\n              description=\"Experiment tracking > runs charts > charts > image grid multiple key > table header text\"\n            />\n          </TableHeader>\n          {displayRuns.map((run: RunsChartsRunData) => {\n            return (\n              <TableHeader\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_imagegridmultiplekeyplot.tsx_52\"\n                key={run.uuid}\n                css={{ minWidth: MIN_GRID_IMAGE_SIZE + theme.spacing.md }}\n              >\n                <Tooltip content={run.displayName} componentId=\"mlflow.charts.image-plot.run-name-tooltip\">\n                  <div\n                    css={{\n                      height: theme.typography.lineHeightMd,\n                      whiteSpace: 'nowrap',\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      margin: 'auto',\n                      gap: theme.spacing.sm,\n                      fontWeight: 'normal',\n                    }}\n                  >\n                    <RunColorPill color={run.color} />\n                    {run.displayName}\n                  </div>\n                </Tooltip>\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n        {cardConfig.imageKeys.map((imageKey) => {\n          return (\n            <TableRow key={imageKey}>\n              <TableCell css={{ minWidth: MIN_GRID_IMAGE_SIZE + theme.spacing.md }}>\n                <div style={{ whiteSpace: 'normal' }}>{imageKey}</div>\n              </TableCell>\n              {displayRuns.map((run: RunsChartsRunData) => {\n                if (run.images[imageKey] && Object.keys(run.images[imageKey]).length > 0) {\n                  const metadataByStep = Object.values(run.images[imageKey]).reduce((acc, metadata) => {\n                    if (metadata.step !== undefined) {\n                      acc[metadata.step] = metadata;\n                    }\n                    return acc;\n                  }, {} as Record<number, ImageEntity>);\n                  return (\n                    <TableCell\n                      key={run.uuid}\n                      css={{\n                        minWidth: MIN_GRID_IMAGE_SIZE + theme.spacing.md,\n                        '&:hover': {\n                          backgroundColor: theme.colors.tableBackgroundUnselectedHover,\n                        },\n                      }}\n                    >\n                      <ImagePlotWithHistory metadataByStep={metadataByStep} step={cardConfig.step} runUuid={run.uuid} />\n                    </TableCell>\n                  );\n                }\n                return <TableCell key={run.uuid} css={{ minWidth: MIN_GRID_IMAGE_SIZE + theme.spacing.md }} />;\n              })}\n            </TableRow>\n          );\n        })}\n      </Table>\n    </div>\n  );\n};\n","import { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ImageGridSingleKeyPlot } from './ImageGridSingleKeyPlot';\nimport { ImageGridMultipleKeyPlot } from './ImageGridMultipleKeyPlot';\nimport {\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\nimport { Empty } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ImageGridPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n}) => {\n  const containsLoggedImages = previewData.some((run: RunsChartsRunData) => Boolean(run.tags[LOG_IMAGE_TAG_INDICATOR]));\n\n  const filteredPreviewData = previewData\n    .filter((run: RunsChartsRunData) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    })\n    .slice(-NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE);\n\n  if (!containsLoggedImages) {\n    return (\n      <div css={{ flex: 1, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n        <Empty\n          title={\n            <FormattedMessage\n              defaultMessage=\"No images found\"\n              description=\"Title for the empty state when no images are found in the currently visible runs\"\n            />\n          }\n          description={\n            <FormattedMessage\n              defaultMessage=\"No logged images found in the currently visible runs\"\n              description=\"Description for the empty state when no images are found in the currently visible runs\"\n            />\n          }\n        />\n      </div>\n    );\n  }\n\n  if (cardConfig.imageKeys.length === 1) {\n    return <ImageGridSingleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} />;\n  } else if (cardConfig.imageKeys.length > 1) {\n    return <ImageGridMultipleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} />;\n  }\n  return null;\n};\n","import React from 'react';\nimport { Button, CloseIcon, CopyIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { CopyButton } from '../../shared/building_blocks/CopyButton';\n\nconst PREVIEW_SIDEBAR_WIDTH = 300;\n\n/**\n * Displays a sidebar helpful in expanding textual data in table components.\n * Will be replaced by DuBois standardized component in the future.\n */\nexport const PreviewSidebar = ({\n  content,\n  copyText,\n  headerText,\n  empty,\n  onClose,\n}: {\n  content?: React.ReactNode;\n  copyText?: string;\n  headerText?: string;\n  empty?: React.ReactNode;\n  onClose?: () => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{\n        width: PREVIEW_SIDEBAR_WIDTH,\n        padding: theme.spacing.sm,\n        paddingRight: 0,\n        borderLeft: `1px solid ${theme.colors.borderDecorative}`,\n        overflow: 'hidden',\n        display: 'flex',\n        flexDirection: 'column',\n        height: '100%',\n      }}\n      data-testid=\"preview-sidebar-content\"\n    >\n      {content ? (\n        <>\n          <div\n            css={{\n              display: 'grid',\n              gridTemplateColumns: '1fr auto auto',\n              rowGap: theme.spacing.sm,\n              alignItems: 'flex-start',\n              flex: '0 0 auto',\n            }}\n          >\n            {headerText && (\n              <Typography.Title\n                level={4}\n                css={{\n                  overflowX: 'hidden',\n                  overflowY: 'auto',\n                  marginTop: theme.spacing.sm,\n                  marginRight: theme.spacing.xs,\n\n                  // Escape hatch if for some reason title is so long it would consume entire sidebar\n                  maxHeight: 200,\n                }}\n              >\n                {headerText}\n              </Typography.Title>\n            )}\n            {copyText && <CopyButton copyText={copyText} showLabel={false} icon={<CopyIcon />} />}\n            {onClose && (\n              <Button\n                componentId=\"codegen_mlflow_app_src_common_components_previewsidebar.tsx_67\"\n                type=\"primary\"\n                icon={<CloseIcon />}\n                onClick={onClose}\n              />\n            )}\n          </div>\n          <div\n            css={{\n              // Preserve original line breaks\n              whiteSpace: 'pre-wrap',\n              overflowY: 'auto',\n              flex: 1,\n            }}\n          >\n            {content}\n          </div>\n        </>\n      ) : (\n        <div css={{ marginTop: theme.spacing.md }}>{empty}</div>\n      )}\n    </div>\n  );\n};\n","import { Accordion, useDesignSystemTheme } from '@databricks/design-system';\nimport { CSSObject, css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nexport const METRIC_CHART_SECTION_HEADER_SIZE = 55;\n\ninterface MetricChartsAccordionProps {\n  activeKey?: string | string[];\n  onActiveKeyChange?: (key: string | string[]) => void;\n  children: React.ReactNode;\n  disableCollapse?: boolean;\n}\n\nconst MetricChartsAccordion = ({\n  activeKey,\n  onActiveKeyChange,\n  children,\n  disableCollapse = false,\n}: MetricChartsAccordionProps) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n  const clsPrefix = getPrefixedClassName('collapse');\n\n  const styles = useMemo(() => {\n    const classItem = `.${clsPrefix}-item`;\n    const classItemActive = `${classItem}-active`;\n    const classHeader = `.${clsPrefix}-header`;\n    const classContent = `.${clsPrefix}-content`;\n    const classContentBox = `.${clsPrefix}-content-box`;\n    const classArrow = `.${clsPrefix}-arrow`;\n\n    const styles: CSSObject = {\n      [classContent]: {\n        padding: '0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [classContentBox]: {\n        padding: '0 0 12px 0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [`& > ${classItem} > ${classHeader} > ${classArrow}`]: {\n        fontSize: theme.general.iconSize,\n        left: 12,\n        // TODO: This is needed currently because the rotated icon isn't centered, remove when accordion is fixed\n        verticalAlign: '-7px',\n        transform: 'rotate(-90deg)',\n        display: disableCollapse ? 'none' : undefined,\n      },\n\n      [`& > ${classItemActive} > ${classHeader} > ${classArrow}`]: {\n        transform: 'rotate(0deg)',\n      },\n\n      [classHeader]: {\n        display: 'flex',\n        color: theme.colors.textPrimary,\n        fontWeight: 600,\n        alignItems: 'center',\n\n        '&:focus-visible': {\n          outlineColor: `${theme.colors.primary} !important`,\n          outlineStyle: 'auto !important',\n        },\n      },\n\n      [`& > ${classItem}`]: {\n        borderBottom: `1px solid ${theme.colors.border}`,\n        borderRadius: 0,\n      },\n\n      [`& > ${classItem} > ${classHeader}`]: {\n        padding: 0,\n        lineHeight: '20px',\n        height: METRIC_CHART_SECTION_HEADER_SIZE,\n      },\n    };\n    return styles;\n  }, [theme, clsPrefix, disableCollapse]);\n\n  return (\n    <Accordion\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_metricchartsaccordion.tsx_82\"\n      {...(activeKey ? { activeKey } : {})}\n      {...(onActiveKeyChange ? { onChange: onActiveKeyChange } : {})}\n      dangerouslyAppendEmotionCSS={css(styles)}\n      dangerouslySetAntdProps={{ expandIconPosition: 'left' }}\n    >\n      {children}\n    </Accordion>\n  );\n};\n\nexport default MetricChartsAccordion;\n","import { Button, DropdownMenu, PlusIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartType } from '../runs-charts.types';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface RunsChartsAddChartMenuProps {\n  onAddChart: (type: RunsChartType) => void;\n  supportedChartTypes?: RunsChartType[];\n}\n\nexport const RunsChartsAddChartMenu = ({ onAddChart, supportedChartTypes }: RunsChartsAddChartMenuProps) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  return (\n    <DropdownMenu.Root modal={false}>\n      <DropdownMenu.Trigger asChild>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscompareaddchartmenu.tsx_19\"\n          css={styles.addChartButton}\n          icon={<PlusIcon />}\n          data-testid=\"experiment-view-compare-runs-add-chart\"\n        >\n          <FormattedMessage\n            defaultMessage=\"Add chart\"\n            description=\"Experiment tracking > runs charts > add chart menu\"\n          />\n        </Button>\n      </DropdownMenu.Trigger>\n      <DropdownMenu.Content align=\"end\">\n        {isChartTypeSupported(RunsChartType.BAR) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_42\"\n            onClick={() => onAddChart(RunsChartType.BAR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-bar\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartBarIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Bar chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.LINE) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_56\"\n            onClick={() => onAddChart(RunsChartType.LINE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-line\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartLineIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Line chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.PARALLEL) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_70\"\n            onClick={() => onAddChart(RunsChartType.PARALLEL)}\n            data-testid=\"experiment-view-compare-runs-chart-type-parallel\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartParallelIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Parallel coordinates\"\n              description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.SCATTER) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_84\"\n            onClick={() => onAddChart(RunsChartType.SCATTER)}\n            data-testid=\"experiment-view-compare-runs-chart-type-scatter\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartScatterIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Scatter chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.CONTOUR) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_98\"\n            onClick={() => onAddChart(RunsChartType.CONTOUR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-contour\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartContourIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Contour chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_112\"\n            onClick={() => onAddChart(RunsChartType.DIFFERENCE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-difference\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartDifferenceIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Difference view\"\n              description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.IMAGE) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_126\"\n            onClick={() => onAddChart(RunsChartType.IMAGE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-image\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartImageIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Image grid\"\n              description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n            />\n          </DropdownMenu.Item>\n        )}\n      </DropdownMenu.Content>\n    </DropdownMenu.Root>\n  );\n};\n\nconst styles = {\n  addChartButton: (theme: Theme) => ({\n    // Overriden while waiting for design decision in DuBois (FEINF-1711)\n    backgroundColor: `${theme.colors.backgroundPrimary} !important`,\n  }),\n  iconWrapper: (theme: Theme) => ({\n    width: theme.general.iconSize + theme.spacing.xs,\n  }),\n};\n","import {\n  Button,\n  DangerModal,\n  DragIcon,\n  DropdownMenu,\n  Input,\n  Modal,\n  OverflowIcon,\n  PencilIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsAddChartMenu } from '../RunsChartsAddChartMenu';\nimport { RunsChartType } from '../../runs-charts.types';\nimport { useEffect, useRef, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useDragAndDropElement } from '@mlflow/mlflow/src/common/hooks/useDragAndDropElement';\nimport { CheckIcon } from '@databricks/design-system';\nimport { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport cx from 'classnames';\n\nexport interface RunsChartsSectionHeaderProps {\n  index: number;\n  section: ChartSectionConfig;\n  sectionChartsLength: number;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  onDeleteSection: (sectionId: string) => void;\n  onAddSection: (sectionId: string, above: boolean) => void;\n  editSection: number;\n  onSetEditSection: React.Dispatch<React.SetStateAction<number>>;\n  onSetSectionName: (sectionId: string, name: string) => void;\n  onSectionReorder: (sourceSectionId: string, targetSectionId: string) => void;\n  isExpanded: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  /**\n   * Set to \"true\" to hide various controls (e.g. edit, add, delete) in the section header.\n   */\n  hideExtraControls: boolean;\n}\n\nexport const RunsChartsSectionHeader = ({\n  index,\n  section,\n  sectionChartsLength,\n  addNewChartCard,\n  onDeleteSection,\n  onAddSection,\n  editSection,\n  onSetEditSection,\n  onSetSectionName,\n  onSectionReorder,\n  isExpanded,\n  hideExtraControls,\n  supportedChartTypes,\n}: RunsChartsSectionHeaderProps) => {\n  const { theme } = useDesignSystemTheme();\n  // Change name locally for better performance\n  const [tmpSectionName, setTmpSectionName] = useState(section.name);\n  // State to check if element is being dragged\n  const [isDraggingHandle, setIsDraggingHandle] = useState(false);\n\n  // Ref and state to measure the width of the section name\n  const sectionNameRef = useRef<HTMLDivElement>(null);\n  const confirmButtonRef = useRef<HTMLButtonElement>(null);\n  const [sectionNameWidth, setSectionNameWidth] = useState(0.0);\n\n  // Delete section modal\n  const [isDeleteSectionModalOpen, setIsDeleteSectionModalOpen] = useState(false);\n\n  const stopPropagation = (e: any) => {\n    e.stopPropagation();\n  };\n\n  const deleteModalConfirm = () => {\n    onDeleteSection(section.uuid);\n  };\n\n  const deleteModalCancel = () => {\n    setIsDeleteSectionModalOpen(false);\n  };\n\n  const deleteSection = () => {\n    setIsDeleteSectionModalOpen(true);\n  };\n\n  const addSectionAbove = () => {\n    onAddSection(section.uuid, true);\n  };\n\n  const addSectionBelow = () => {\n    onAddSection(section.uuid, false);\n  };\n\n  const onEdit = (e: React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    onSetEditSection(index);\n  };\n\n  const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setTmpSectionName(e.target.value);\n  };\n\n  const onSubmit = (e: React.KeyboardEvent<HTMLInputElement> | React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    if (!tmpSectionName.trim()) {\n      e.preventDefault();\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  const onEsc = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Escape') {\n      e.stopPropagation();\n      onSetEditSection(-1);\n      setTmpSectionName(section.name);\n    }\n  };\n\n  const onBlur = (e: React.FocusEvent) => {\n    if (e.relatedTarget === confirmButtonRef.current) {\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  useEffect(() => {\n    if (!sectionNameRef.current) {\n      return;\n    }\n\n    const resizeObserver = new ResizeObserver(([entry]) => {\n      setSectionNameWidth(entry.contentRect.width);\n    });\n\n    resizeObserver.observe(sectionNameRef.current);\n\n    return () => resizeObserver.disconnect();\n  }, []);\n\n  // For explicitness:\n  const EDITABLE_LABEL_PADDING_WIDTH = 6;\n  const EDITABLE_LABEL_BORDER_WIDTH = 1;\n  const EDITABLE_LABEL_OFFSET = EDITABLE_LABEL_PADDING_WIDTH + EDITABLE_LABEL_BORDER_WIDTH;\n\n  const isCurrentlyEdited = editSection === index;\n  const [isCurrentlyHovered, setIsCurrentlyHovered] = useState(false);\n\n  const { dragHandleRef, dragPreviewRef, dropTargetRef, isOver, isDragging } = useDragAndDropElement({\n    dragGroupKey: 'sections',\n    dragKey: section.uuid,\n    onDrop: onSectionReorder,\n  });\n\n  return (\n    <>\n      <div\n        role=\"figure\"\n        css={{\n          display: 'flex',\n          alignItems: 'center',\n          width: '100%',\n          padding: `${theme.spacing.xs}px 0px`,\n          height: `${METRIC_CHART_SECTION_HEADER_SIZE}px`,\n          '.section-element-visibility-on-hover': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? 1 : 0,\n          },\n          '.section-element-visibility-on-hover-and-not-drag': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? (isDraggingHandle ? 0 : 1) : 0,\n          },\n          '.section-element-hidden-on-edit': { display: isCurrentlyEdited ? 'none' : 'inherit' },\n        }}\n        onMouseMove={() => setIsCurrentlyHovered(true)}\n        onMouseLeave={() => setIsCurrentlyHovered(false)}\n        ref={(element) => {\n          // Use this element for both drag preview and drop target\n          dropTargetRef?.(element);\n          dragPreviewRef?.(element);\n        }}\n        data-testid=\"experiment-view-compare-runs-section-header\"\n      >\n        {isOver && (\n          // Visual overlay for target drop element\n          <div\n            css={{\n              position: 'absolute',\n              inset: 0,\n              backgroundColor: theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100,\n              border: `2px dashed ${theme.colors.blue400}`,\n              opacity: 0.75,\n            }}\n          />\n        )}\n        <div\n          style={{\n            maxWidth: '40%',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n        >\n          <div\n            ref={sectionNameRef}\n            style={{\n              position: !isCurrentlyEdited ? 'relative' : 'absolute',\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              textOverflow: isCurrentlyEdited ? undefined : 'ellipsis',\n              maxWidth: '100%',\n              overflow: 'clip',\n              paddingLeft: EDITABLE_LABEL_OFFSET,\n              whiteSpace: 'pre',\n            }}\n          >\n            {tmpSectionName}\n          </div>\n          {editSection === index && (\n            <Input\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_220\"\n              autoFocus\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              onChange={onChange}\n              value={tmpSectionName}\n              css={{\n                color: theme.colors.textPrimary,\n                fontWeight: 600,\n                padding: `1px ${EDITABLE_LABEL_PADDING_WIDTH}px 1px ${EDITABLE_LABEL_PADDING_WIDTH}px`,\n                background: theme.colors.backgroundSecondary,\n                minWidth: '50px',\n                width: sectionNameWidth + 2 * EDITABLE_LABEL_OFFSET,\n                position: 'relative',\n                lineHeight: theme.typography.lineHeightBase,\n                maxWidth: '100%',\n              }}\n              onKeyDown={onEsc}\n              onPressEnter={onSubmit}\n              dangerouslyAppendEmotionCSS={{ '&&': { minHeight: '20px !important' } }}\n              onBlur={onBlur}\n            />\n          )}\n          <div\n            css={{\n              padding: theme.spacing.xs,\n              position: 'relative',\n            }}\n            style={{\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              display: isCurrentlyEdited ? 'none' : 'inherit',\n            }}\n          >\n            {`(${sectionChartsLength})`}\n          </div>\n          {!hideExtraControls && (\n            <div className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\">\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_246\"\n                onClick={onEdit}\n                aria-label=\"Icon label\"\n                icon={<PencilIcon />}\n              />\n            </div>\n          )}\n        </div>\n        {editSection === index && !hideExtraControls && (\n          <div style={{ padding: `0 ${theme.spacing.xs}px` }}>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_251\"\n              onClick={onSubmit}\n              icon={<CheckIcon />}\n              ref={confirmButtonRef}\n            />\n          </div>\n        )}\n        {!hideExtraControls && (\n          <div\n            className=\"section-element-visibility-on-hover section-element-hidden-on-edit\"\n            css={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', cursor: 'grab' }}\n          >\n            <DragIcon\n              rotate={90}\n              style={{ color: theme.colors.textSecondary }}\n              ref={dragHandleRef}\n              onMouseDown={() => setIsDraggingHandle(true)}\n              onMouseLeave={() => {\n                setIsDraggingHandle(false);\n              }}\n              data-testid=\"experiment-view-compare-runs-section-header-drag-handle\"\n            />\n          </div>\n        )}\n        {!hideExtraControls && (\n          <div\n            style={{\n              position: 'absolute',\n              top: '50%',\n              right: '0',\n              transform: 'translate(0, -50%)',\n              display: 'flex',\n              alignItems: 'center',\n            }}\n          >\n            <div\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\"\n            >\n              <DropdownMenu.Root modal={false}>\n                <DropdownMenu.Trigger asChild>\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_288\"\n                    icon={<OverflowIcon />}\n                  />\n                </DropdownMenu.Trigger>\n                <DropdownMenu.Content>\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_321\"\n                    onClick={addSectionAbove}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Add section above\"\n                      description=\"Experiment page > compare runs > chart section > add section above label\"\n                    />\n                  </DropdownMenu.Item>\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_327\"\n                    onClick={addSectionBelow}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Add section below\"\n                      description=\"Experiment page > compare runs > chart section > add section below label\"\n                    />\n                  </DropdownMenu.Item>\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_333\"\n                    onClick={deleteSection}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Delete section\"\n                      description=\"Experiment page > compare runs > chart section > delete section label\"\n                    />\n                  </DropdownMenu.Item>\n                </DropdownMenu.Content>\n              </DropdownMenu.Root>\n              <DangerModal\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_351\"\n                visible={isDeleteSectionModalOpen}\n                onOk={deleteModalConfirm}\n                onCancel={deleteModalCancel}\n                title=\"Delete section\"\n              >\n                <FormattedMessage\n                  defaultMessage=\"Deleting the section will permanently remove it and the charts it contains. This cannot be undone.\"\n                  description=\"Experiment page > compare runs > chart section > delete section warning message\"\n                />\n              </DangerModal>\n            </div>\n\n            <div\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              className={cx(\n                {\n                  'section-element-visibility-on-hover-and-not-drag': !isExpanded,\n                },\n                'section-element-hidden-on-edit',\n              )}\n              css={{\n                alignSelf: 'flex-end',\n                marginLeft: theme.spacing.xs,\n              }}\n            >\n              <RunsChartsAddChartMenu\n                onAddChart={addNewChartCard(section.uuid)}\n                supportedChartTypes={supportedChartTypes}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n","import { useEffect, useRef, useState } from 'react';\n\n// Define a module-global observer and a WeakMap on elements to hold callbacks\nlet sharedObserver: IntersectionObserver | null = null;\nconst entryCallbackMap = new WeakMap();\n\nconst ensureSharedObserverExists = () => {\n  if (!sharedObserver) {\n    sharedObserver = new IntersectionObserver((entries) => {\n      for (const entry of entries) {\n        const entryCallback = entryCallbackMap.get(entry.target);\n        entryCallback?.(entry.isIntersecting);\n      }\n    });\n  }\n};\n\nfunction observeElement(element: Element, callback: (isIntersecting: boolean) => void) {\n  ensureSharedObserverExists();\n  entryCallbackMap.set(element, callback);\n  sharedObserver?.observe(element);\n\n  return () => {\n    if (element) {\n      sharedObserver?.unobserve(element);\n      entryCallbackMap.delete(element);\n    }\n  };\n}\n\n/**\n * Checks if the element is currently visible within the viewport using IntersectionObserver.\n * If \"enabled\" is set to false, the returned value will always be true.\n */\nexport const useIsInViewport = <T extends Element>({ enabled = true }: { enabled?: boolean } = {}) => {\n  const [element, setElementRef] = useState<T | null>(null);\n  const [isInViewport, setIsInViewport] = useState(!enabled);\n\n  useEffect(() => {\n    // If already viewed or element is not available, do nothing\n    if (!element) {\n      return;\n    }\n\n    // If IntersectionObserver is not available, assume that the element is visible\n    if (!window.IntersectionObserver || !enabled) {\n      setIsInViewport(true);\n      return;\n    }\n\n    return observeElement(element, setIsInViewport);\n  }, [enabled, element]);\n\n  // When the flag is disabled, deferred result is the same as the regular one\n  return { isInViewport, setElementRef };\n};\n","import { forwardRef, memo, useCallback, useRef, useState } from 'react';\nimport { RunsChartsCard, type RunsChartsCardProps } from './cards/RunsChartsCard';\nimport { DraggableCore, type DraggableEventHandler } from 'react-draggable';\nimport { Resizable } from 'react-resizable';\nimport { Spinner, useDesignSystemTheme } from '@databricks/design-system';\nimport { useIsInViewport } from '../hooks/useIsInViewport';\nimport { useDebounce } from 'use-debounce';\nimport {\n  DRAGGABLE_CARD_HANDLE_CLASS,\n  DRAGGABLE_CARD_TRANSITION_VAR,\n  RunsChartCardLoadingPlaceholder,\n} from './cards/ChartCard.common';\nimport { useRunsChartsDraggableGridActionsContext } from './RunsChartsDraggableCardsGridContext';\nimport { RUNS_CHARTS_UI_Z_INDEX } from '../utils/runsCharts.const';\n\nconst VIEWPORT_DEBOUNCE_MS = 150;\n\ninterface RunsChartsDraggableCardProps extends RunsChartsCardProps {\n  uuid?: string;\n  translateBy?: { x: number; y: number; overflowing: boolean };\n  onResizeStart: (rect: DOMRect) => void;\n  onResize: (width: number, height: number) => void;\n  onResizeStop: () => void;\n}\n\nexport const RunsChartsDraggableCard = memo((props: RunsChartsDraggableCardProps) => {\n  const { setElementRef, isInViewport } = useIsInViewport<HTMLDivElement>();\n  const { uuid, translateBy, onResizeStart, onResize, onResizeStop, ...cardProps } = props;\n  const { theme } = useDesignSystemTheme();\n\n  const [deferredValue] = useDebounce(isInViewport, VIEWPORT_DEBOUNCE_MS);\n  const isInViewportDeferred = deferredValue;\n\n  const [resizeWidth, setResizeWidth] = useState(0);\n  const [resizeHeight, setResizeHeight] = useState(0);\n  const [isDragging, setIsDragging] = useState(false);\n  const [origin, setOrigin] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const { setDraggedCardUuid, onDropChartCard } = useRunsChartsDraggableGridActionsContext();\n\n  const draggedCardElementRef = useRef<HTMLDivElement | null>(null);\n\n  const onStartDrag = useCallback<DraggableEventHandler>(\n    (_, { x, y }) => {\n      setIsDragging(true);\n      setDraggedCardUuid(uuid ?? null);\n      setOrigin({ x, y });\n    },\n    [setDraggedCardUuid, uuid],\n  );\n\n  const onDrag = useCallback(\n    (_, { x, y }) => {\n      if (draggedCardElementRef.current) {\n        draggedCardElementRef.current.style.transform = `translate3d(${x - origin.x}px, ${y - origin.y}px, 0)`;\n      }\n    },\n    [origin],\n  );\n\n  const onStopDrag = useCallback(() => {\n    onDropChartCard();\n    setDraggedCardUuid(null);\n    if (draggedCardElementRef.current) {\n      draggedCardElementRef.current.style.transform = '';\n    }\n    setIsDragging(false);\n  }, [onDropChartCard, setDraggedCardUuid, draggedCardElementRef]);\n\n  const onResizeStartInternal = useCallback(() => {\n    const rect = draggedCardElementRef.current?.getBoundingClientRect();\n    if (rect) {\n      setResizeWidth(rect?.width ?? 0);\n      setResizeHeight(rect?.height ?? 0);\n      onResizeStart?.(rect);\n    }\n  }, [onResizeStart, draggedCardElementRef]);\n\n  const onResizeInternal = useCallback(\n    (_, { size }) => {\n      setResizeWidth(size.width);\n      setResizeHeight(size.height);\n      onResize(size.width, size.height);\n    },\n    [onResize],\n  );\n\n  if (!isInViewport) {\n    // If the card is not in the viewport, we avoid rendering draggable/resizable components\n    // and render a placeholder element having card's height instead.\n    return (\n      <RunsChartCardLoadingPlaceholder\n        style={{\n          height: props.height,\n        }}\n        css={{\n          backgroundColor: theme.colors.backgroundPrimary,\n          border: `1px solid ${theme.colors.border}`,\n          borderRadius: theme.general.borderRadiusBase,\n        }}\n        ref={setElementRef}\n      />\n    );\n  }\n\n  return (\n    <DraggableCore\n      enableUserSelectHack={false}\n      onStart={onStartDrag}\n      onDrag={onDrag}\n      onStop={onStopDrag}\n      handle={`.${DRAGGABLE_CARD_HANDLE_CLASS}`}\n    >\n      <Resizable\n        width={resizeWidth}\n        height={resizeHeight}\n        axis=\"both\"\n        onResizeStart={onResizeStartInternal}\n        onResizeStop={onResizeStop}\n        onResize={onResizeInternal}\n        handle={<ResizableHandle />}\n      >\n        <div\n          ref={(element) => {\n            draggedCardElementRef.current = element;\n            setElementRef(element);\n          }}\n          style={\n            isDragging\n              ? {\n                  // Make sure the dragged card is on top of all other cards\n                  zIndex: RUNS_CHARTS_UI_Z_INDEX.CARD_DRAGGED,\n                  pointerEvents: 'none',\n                }\n              : {\n                  transition: DRAGGABLE_CARD_TRANSITION_VAR,\n                  transform: `translate3d(${translateBy?.x ?? 0}px,${translateBy?.y ?? 0}px,0)`,\n                  opacity: translateBy?.overflowing ? 0 : 1,\n                }\n          }\n        >\n          <RunsChartsCard {...cardProps} isInViewport={isInViewport} isInViewportDeferred={isInViewportDeferred} />\n        </div>\n      </Resizable>\n    </DraggableCore>\n  );\n});\n\nconst ResizableHandle = forwardRef((props, ref) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      ref={ref as any}\n      {...props}\n      data-testid=\"draggable-card-resize-handle\"\n      css={{\n        position: 'absolute',\n        bottom: 0,\n        right: 0,\n        cursor: 'se-resize',\n        lineHeight: 0,\n        padding: theme.spacing.xs,\n        color: theme.colors.actionDefaultIconDefault,\n      }}\n    >\n      <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\">\n        <path d=\"M6 6V0H8V8H0V6H6Z\" fill=\"currentColor\" />\n      </svg>\n    </div>\n  );\n});\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { RUNS_CHARTS_UI_Z_INDEX } from '../utils/runsCharts.const';\n\nexport const RunsChartsDraggablePreview = ({\n  x,\n  y,\n  width,\n  height,\n}: {\n  x?: number;\n  y?: number;\n  width?: number | string;\n  height?: number | string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <>\n      {/* Cover pointer events */}\n      <div\n        css={{\n          position: 'absolute',\n          inset: 0,\n        }}\n      />\n      <div\n        css={{\n          position: 'absolute',\n          backgroundColor: theme.colors.actionDefaultBackgroundHover,\n          borderStyle: 'dashed',\n          borderColor: theme.colors.actionDefaultBorderDefault,\n          pointerEvents: 'none',\n          borderRadius: theme.general.borderRadiusBase,\n          borderWidth: 2,\n          inset: 0,\n          // Make sure the preview is above other cards\n          zIndex: RUNS_CHARTS_UI_Z_INDEX.CARD_PREVIEW,\n        }}\n        style={{\n          transform: `translate3d(${x}px, ${y}px, 0)`,\n          width: width,\n          height: height,\n        }}\n      />\n    </>\n  );\n};\n","import { Empty, useDesignSystemTheme } from '@databricks/design-system';\nimport { memo, useCallback, useMemo, useRef, useState } from 'react';\nimport { useUpdateRunsChartsUIConfiguration } from '../hooks/useRunsChartsUIConfiguration';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { isEmptyChartCard, RunsChartsRunData } from './RunsCharts.common';\nimport { useMediaQuery } from '@databricks/web-shared/hooks';\nimport { Global } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { ChartSectionConfig } from '../../../types';\nimport { RunsChartsDraggableCard } from './RunsChartsDraggableCard';\nimport {\n  useRunsChartsDraggableGridActionsContext,\n  useRunsChartsDraggableGridStateContext,\n} from './RunsChartsDraggableCardsGridContext';\nimport { RunsChartsDraggablePreview } from './RunsChartsDraggablePreview';\nimport { DRAGGABLE_CARD_TRANSITION_NAME, type RunsChartCardSetFullscreenFn } from './cards/ChartCard.common';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport type { RunsChartsGlobalLineChartConfig } from '../../experiment-page/models/ExperimentPageUIState';\n\nconst rowHeightSuggestions = [300, 330, 360, 400, 500];\n\nconst getColumnSuggestions = (containerWidth: number, gapSize = 8) =>\n  [1, 2, 3, 4, 5].map((n) => ({\n    cols: n,\n    width: (containerWidth - (n - 1) * gapSize) / n,\n  }));\n\nconst PlaceholderSymbol = Symbol('placeholder');\n\ninterface RunsChartsDraggableCardsGridProps {\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  sectionConfig: ChartSectionConfig;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  sectionId: string;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n  chartRunData: RunsChartsRunData[];\n  cardsConfig: RunsChartsCardConfig[];\n}\n\n// Renders draggable cards grid in a single chart section\nexport const RunsChartsDraggableCardsGridSection = memo(\n  ({\n    cardsConfig,\n    sectionConfig,\n    chartRunData,\n    sectionId,\n    hideEmptyCharts,\n    ...cardProps\n  }: RunsChartsDraggableCardsGridProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    // If below medium breakpoint, display only 1 card per row.\n    // Otherwise, use section configuration or fall back to 3 columns.\n    const isCompactMode = useMediaQuery(`(max-width: ${theme.responsive.breakpoints.md}px)`);\n    const columns = isCompactMode ? 1 : sectionConfig.columns ?? 3;\n\n    // Use card height from the section configuration or fall back to 360 pixels.\n    const cardHeight = sectionConfig.cardHeight ?? 360;\n\n    const gridBoxRef = useRef<HTMLDivElement | null>(null);\n\n    const { draggedCardUuid, isDragging } = useRunsChartsDraggableGridStateContext();\n    const { setTargetSection, setTargetPosition, onSwapCards } = useRunsChartsDraggableGridActionsContext();\n\n    const updateUIState = useUpdateRunsChartsUIConfiguration();\n\n    const setColumns = useCallback(\n      (columnCount: number) => {\n        updateUIState((current) => {\n          const section = current.compareRunSections?.find((section) => section.uuid === sectionId);\n          if (!section) {\n            return current;\n          }\n\n          return {\n            ...current,\n            compareRunSections: current.compareRunSections?.map((s) => {\n              if (s.uuid === sectionId) {\n                return {\n                  ...s,\n                  columns: columnCount,\n                };\n              }\n              return s;\n            }),\n          };\n        });\n      },\n      [sectionId, updateUIState],\n    );\n\n    const setCardHeight = useCallback(\n      (height: number) => {\n        updateUIState((current) => {\n          const section = current.compareRunSections?.find((section) => section.uuid === sectionId);\n          if (!section) {\n            return current;\n          }\n\n          return {\n            ...current,\n            compareRunSections: current.compareRunSections?.map((s) => {\n              if (s.uuid === sectionId) {\n                return {\n                  ...s,\n                  cardHeight: height,\n                };\n              }\n              return s;\n            }),\n          };\n        });\n      },\n      [sectionId, updateUIState],\n    );\n\n    const lastElementCount = useRef<number>(0);\n\n    const [positionInSection, setPositionInSection] = useState<number | null>(null);\n    const [resizePreview, setResizePreview] = useState<null | Partial<DOMRect>>(null);\n\n    lastElementCount.current = cardsConfig.length;\n    const position = !draggedCardUuid ? null : positionInSection;\n\n    // Helper function that calculates the x, y coordinates of a card based on its position in the grid\n    const findCoords = useCallback(\n      (position) => {\n        const gap = theme.spacing.sm;\n        const rowCount = Math.ceil(cardsConfig.length / columns);\n\n        const row = Math.floor(position / columns);\n        const col = position % columns;\n\n        const colGapsCount = columns - 1;\n\n        const passedColGaps = col;\n        const passedRowGaps = row;\n        const rect = gridBoxRef.current?.getBoundingClientRect();\n\n        const singleWidth = ((rect?.width ?? 0) - colGapsCount * gap) / columns;\n\n        const overflowing = row >= rowCount;\n\n        return {\n          overflowing,\n          row,\n          col,\n          x: col * singleWidth + passedColGaps * gap,\n          y: row * cardHeight + passedRowGaps * gap,\n        };\n      },\n      [columns, cardHeight, theme, cardsConfig.length],\n    );\n\n    const cardsToRender = useMemo(() => {\n      return cardsConfig.filter((cardConfig) => {\n        if (!hideEmptyCharts) {\n          return true;\n        }\n        return !isEmptyChartCard(chartRunData, cardConfig);\n      });\n    }, [cardsConfig, chartRunData, hideEmptyCharts]);\n\n    // Calculate the transforms for each card based on the dragged card and its position.\n    const cardTransforms = useMemo(() => {\n      if (!draggedCardUuid || position === null) {\n        return {};\n      }\n\n      const result: Record<string, { x: number; y: number; overflowing: boolean }> = {};\n\n      const newArray: (RunsChartsCardConfig | typeof PlaceholderSymbol)[] = cardsToRender.slice();\n      const fromIndex = cardsToRender.findIndex((x) => x.uuid === draggedCardUuid);\n      const toIndex = position;\n\n      if (fromIndex !== -1) {\n        // If the card is dragged within same section, just rearrange the cards\n        newArray.splice(fromIndex, 1);\n        newArray.splice(toIndex, 0, cardsToRender[fromIndex]);\n      } else {\n        // If the card is dragged from another section, insert empty placeholder element\n        newArray.splice(toIndex, 0, PlaceholderSymbol);\n      }\n\n      for (const cardConfig of cardsToRender) {\n        const newIndex = newArray.indexOf(cardConfig);\n        const oldIndex = cardsToRender.indexOf(cardConfig);\n\n        const oldCoords = findCoords(oldIndex);\n        const newCoords = findCoords(newIndex);\n\n        // If the card is not moving, skip it\n        if (newCoords.x === oldCoords.x && newCoords.y === oldCoords.y) {\n          continue;\n        }\n\n        // Calculate the delta between the old and new positions\n        const deltaX = newCoords.x - oldCoords.x;\n        const deltaY = newCoords.y - oldCoords.y;\n\n        if (cardConfig.uuid) {\n          result[cardConfig.uuid] = {\n            x: deltaX,\n            y: deltaY,\n            overflowing: newCoords.overflowing,\n          };\n        }\n      }\n\n      return result;\n    }, [draggedCardUuid, position, cardsToRender, findCoords]);\n\n    // Calculate the preview (placeholder) for the dragged card based on its new position\n    const dragPreview = useMemo(() => {\n      if (position === null) {\n        return null;\n      }\n      if (cardsToRender.length === 0) {\n        return { x: 0, y: 0, width: '100%', height: '100%' };\n      }\n      const { x, y } = findCoords(position);\n      const colGapsCount = columns - 1;\n      const rect = gridBoxRef.current?.getBoundingClientRect();\n\n      const singleWidth = ((rect?.width ?? 0) - colGapsCount * theme.spacing.sm) / columns;\n\n      const height = cardHeight;\n      return { x, y, width: singleWidth, height };\n    }, [position, findCoords, columns, cardHeight, theme, cardsToRender.length]);\n\n    const mouseMove = useCallback(\n      (e: React.MouseEvent) => {\n        if (!isDragging() || !gridBoxRef.current) {\n          return;\n        }\n\n        const rect = gridBoxRef.current.getBoundingClientRect();\n        const rowCount = Math.ceil(lastElementCount.current / columns);\n\n        setTargetSection(sectionId);\n        const pos =\n          Math.floor(((e.clientY - rect.top) / rect.height) * rowCount) * columns +\n          Math.floor(((e.clientX - rect.left) / rect.width) * columns);\n\n        setPositionInSection(pos);\n        setTargetPosition(pos);\n      },\n\n      [columns, isDragging, sectionId, setTargetSection, setTargetPosition],\n    );\n\n    const [columnSuggestions, setColumnSuggestions] = useState<{ cols: number; width: number }[]>([]);\n\n    const immediateColSuggestion = useRef<number | null>(null);\n    const immediateRowSuggestion = useRef<number | null>(null);\n\n    const onResizeStart = useCallback((rect: DOMRect) => {\n      const gridBoxRefSize = gridBoxRef.current?.getBoundingClientRect();\n      if (!gridBoxRefSize) {\n        return;\n      }\n\n      setResizePreview({\n        x: rect.left - gridBoxRefSize.left,\n        y: rect.top - gridBoxRefSize.top,\n        width: rect.width,\n        height: rect.height,\n      });\n\n      setColumnSuggestions(getColumnSuggestions(gridBoxRefSize.width));\n    }, []);\n\n    const onResizeStop = useCallback(() => {\n      setColumns(immediateColSuggestion.current ?? columns);\n      setCardHeight(immediateRowSuggestion.current ?? cardHeight);\n      setResizePreview(null);\n    }, [cardHeight, columns, setCardHeight, setColumns]);\n\n    const onResize = useCallback(\n      (width: number, height: number) => {\n        const columnSuggestion = columnSuggestions.reduce((prev, curr) =>\n          Math.abs(curr.width - width) < Math.abs(prev.width - width) ? curr : prev,\n        );\n\n        const rowHeightSuggestion = rowHeightSuggestions.reduce((prev, curr) =>\n          Math.abs(curr - height) < Math.abs(prev - height) ? curr : prev,\n        );\n\n        immediateColSuggestion.current = columnSuggestion.cols;\n        immediateRowSuggestion.current = rowHeightSuggestion;\n\n        setResizePreview((current) => {\n          if (!current) {\n            return null;\n          }\n          if (current.width !== columnSuggestion.width || current.height !== rowHeightSuggestion) {\n            return { ...current, width: columnSuggestion.width, height: rowHeightSuggestion };\n          }\n          return current;\n        });\n      },\n      [columnSuggestions],\n    );\n\n    return (\n      <div\n        ref={gridBoxRef}\n        css={[\n          { position: 'relative' },\n          cardsToRender.length > 0 && {\n            display: 'grid',\n            gap: theme.spacing.sm,\n          },\n        ]}\n        style={{\n          gridTemplateColumns: 'repeat(' + columns + ', 1fr)',\n          ...(draggedCardUuid && {\n            [DRAGGABLE_CARD_TRANSITION_NAME]: 'transform 0.1s',\n          }),\n        }}\n        data-testid=\"draggable-chart-cards-grid\"\n        onMouseMove={mouseMove}\n        onMouseLeave={() => {\n          setPositionInSection(null);\n        }}\n      >\n        {(draggedCardUuid || resizePreview) && (\n          <Global\n            styles={{\n              'body, :host': {\n                userSelect: 'none',\n              },\n            }}\n          />\n        )}\n        {cardsToRender.length === 0 && (\n          <div css={{ display: 'flex', justifyContent: 'center', minHeight: 160 }}>\n            <Empty\n              title={\n                <FormattedMessage\n                  defaultMessage=\"No charts in this section\"\n                  description=\"Runs compare page > Charts tab > No charts placeholder title\"\n                />\n              }\n              description={\n                <FormattedMessage\n                  defaultMessage=\"Click 'Add chart' or drag and drop to add charts here.\"\n                  description=\"Runs compare page > Charts tab > No charts placeholder description\"\n                />\n              }\n            />\n          </div>\n        )}\n        {cardsToRender.map((cardConfig, index, array) => {\n          return (\n            <RunsChartsDraggableCard\n              key={cardConfig.uuid}\n              uuid={cardConfig.uuid ?? ''}\n              translateBy={cardTransforms[cardConfig.uuid ?? '']}\n              onResizeStart={onResizeStart}\n              onResizeStop={onResizeStop}\n              onResize={onResize}\n              cardConfig={cardConfig}\n              chartRunData={chartRunData}\n              onReorderWith={onSwapCards}\n              index={index}\n              height={cardHeight}\n              canMoveDown={Boolean(array[index + 1])}\n              canMoveUp={Boolean(array[index - 1])}\n              previousChartUuid={array[index - 1]?.uuid}\n              nextChartUuid={array[index + 1]?.uuid}\n              hideEmptyCharts={hideEmptyCharts}\n              {...cardProps}\n            />\n          );\n        })}\n        {dragPreview && <RunsChartsDraggablePreview {...dragPreview} />}\n        {resizePreview && <RunsChartsDraggablePreview {...resizePreview} />}\n      </div>\n    );\n  },\n);\n","import type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport type { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsDraggableCardsGridSection } from '../RunsChartsDraggableCardsGridSection';\n\nexport interface RunsChartsSectionProps {\n  sectionId: string;\n  sectionConfig: ChartSectionConfig;\n  sectionCharts: RunsChartsCardConfig[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  isMetricHistoryLoading: boolean;\n  chartData: RunsChartsRunData[];\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n  sectionIndex: number;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nexport const RunsChartsSection = ({\n  sectionId,\n  sectionCharts,\n  reorderCharts,\n  insertCharts,\n  isMetricHistoryLoading,\n  chartData,\n  startEditChart,\n  removeChart,\n  groupBy,\n  sectionIndex,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n  globalLineChartConfig,\n  sectionConfig,\n}: RunsChartsSectionProps) => {\n  return (\n    <RunsChartsDraggableCardsGridSection\n      sectionConfig={sectionConfig}\n      cardsConfig={sectionCharts}\n      chartRunData={chartData}\n      onStartEditChart={startEditChart}\n      onRemoveChart={removeChart}\n      setFullScreenChart={setFullScreenChart}\n      sectionId={sectionId}\n      groupBy={groupBy}\n      autoRefreshEnabled={autoRefreshEnabled}\n      hideEmptyCharts={hideEmptyCharts}\n      globalLineChartConfig={globalLineChartConfig}\n    />\n  );\n};\n","import { Accordion } from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  SerializedRunsChartsCardConfigCard,\n  RunsChartsParallelCardConfig,\n} from '../../runs-charts.types';\nimport MetricChartsAccordion, { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport { RunsChartsSectionHeader } from './RunsChartsSectionHeader';\nimport { RunsChartsSection } from './RunsChartsSection';\nimport { useCallback, useMemo } from 'react';\nimport { getUUID } from '@mlflow/mlflow/src/common/utils/ActionUtils';\nimport { useState } from 'react';\nimport { Button, PlusIcon } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { Spacer } from '@databricks/design-system';\nimport { useUpdateRunsChartsUIConfiguration } from '../../hooks/useRunsChartsUIConfiguration';\nimport { compact, isArray } from 'lodash';\nimport { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport type { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\n\nconst chartMatchesFilter = (filter: string, config: RunsChartsCardConfig) => {\n  // Use regexp-based filtering if a feature flag is enabled\n  if (config.type === RunsChartType.IMAGE || config.type === RunsChartType.DIFFERENCE) {\n    return true;\n  }\n\n  try {\n    const filterRegex = new RegExp(filter, 'i');\n    return getChartMetricsAndParams(config).some((metricOrParam) => metricOrParam.match(filterRegex));\n  } catch {\n    // If the regex is invalid (e.g. user it still typing it), prevent from filtering\n    return true;\n  }\n};\n\nconst getChartMetricsAndParams = (config: RunsChartsCardConfig): string[] => {\n  if (config.type === RunsChartType.BAR) {\n    const barConfig = config as RunsChartsBarCardConfig;\n    if (barConfig.dataAccessKey) {\n      return [barConfig.metricKey, barConfig.dataAccessKey];\n    }\n    return [barConfig.metricKey];\n  } else if (config.type === RunsChartType.LINE) {\n    const lineConfig = config as RunsChartsLineCardConfig;\n    if (isArray(lineConfig.selectedMetricKeys)) {\n      return lineConfig.selectedMetricKeys;\n    }\n    return [lineConfig.metricKey];\n  } else if (config.type === RunsChartType.SCATTER) {\n    const scatterConfig = config as RunsChartsScatterCardConfig;\n    return [scatterConfig.xaxis.key.toLowerCase(), scatterConfig.yaxis.key.toLowerCase()];\n  } else if (config.type === RunsChartType.PARALLEL) {\n    const parallelConfig = config as RunsChartsParallelCardConfig;\n    return [...parallelConfig.selectedMetrics, ...parallelConfig.selectedParams];\n  } else {\n    const contourConfig = config as RunsChartsContourCardConfig;\n    return [contourConfig.xaxis.key, contourConfig.yaxis.key, contourConfig.zaxis.key];\n  }\n};\n\nexport interface RunsChartsSectionAccordionProps {\n  compareRunSections?: ChartSectionConfig[];\n  compareRunCharts?: SerializedRunsChartsCardConfigCard[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  search: string;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n  noRunsSelectedEmptyState?: React.ReactElement;\n}\n\nexport const RunsChartsSectionAccordion = ({\n  compareRunSections,\n  compareRunCharts,\n  reorderCharts,\n  insertCharts,\n  chartData,\n  isMetricHistoryLoading = false,\n  autoRefreshEnabled = false,\n  startEditChart,\n  removeChart,\n  addNewChartCard,\n  search,\n  groupBy,\n  supportedChartTypes,\n  hideEmptyCharts,\n  setFullScreenChart = () => {},\n  globalLineChartConfig,\n  noRunsSelectedEmptyState,\n}: RunsChartsSectionAccordionProps) => {\n  const updateUIState = useUpdateRunsChartsUIConfiguration();\n  const [editSection, setEditSection] = useState(-1);\n  const { theme } = useDesignSystemTheme();\n\n  /**\n   * Get the active (expanded) panels for the accordion\n   */\n  const activeKey = useMemo(() => {\n    const activeSections = (compareRunSections || []).flatMap((sectionConfig: ChartSectionConfig) => {\n      if (sectionConfig.display) {\n        return [sectionConfig.uuid];\n      } else {\n        return [];\n      }\n    });\n    return activeSections;\n  }, [compareRunSections]);\n\n  /**\n   * Updates the active (expanded) panels for the accordion\n   */\n  const onActivePanelChange = useCallback(\n    (key: string | string[]) => {\n      updateUIState((current) => {\n        const newCompareRunPanels = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n          const sectionId = sectionConfig.uuid;\n          const shouldDisplaySection =\n            (typeof key === 'string' && sectionId === key) || (Array.isArray(key) && key.includes(sectionId));\n          return {\n            ...sectionConfig,\n            display: shouldDisplaySection,\n          };\n        });\n        return {\n          ...current,\n          compareRunSections: newCompareRunPanels,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Deletes a section from the accordion\n   */\n  const deleteSection = useCallback(\n    (sectionId: string) => {\n      updateUIState((current) => {\n        const newCompareRunCharts = (current.compareRunCharts || [])\n          // Keep charts that are generated or not in section\n          .filter((chartConfig: RunsChartsCardConfig) => {\n            return chartConfig.isGenerated || chartConfig.metricSectionId !== sectionId;\n          })\n          // For charts that are generated and in section, set deleted to true\n          .map((chartConfig: RunsChartsCardConfig) => {\n            if (chartConfig.isGenerated && chartConfig.metricSectionId === sectionId) {\n              return { ...chartConfig, deleted: true };\n            } else {\n              return chartConfig;\n            }\n          });\n\n        // Delete section\n        const newCompareRunSections = (current.compareRunSections || [])\n          .slice()\n          .filter((sectionConfig: ChartSectionConfig) => {\n            return sectionConfig.uuid !== sectionId;\n          });\n\n        return {\n          ...current,\n          compareRunCharts: newCompareRunCharts,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Adds a section to the accordion\n   * @param sectionId indicates the section selected to anchor at\n   * @param above is a boolean value indicating whether to add the section above or below the anchor\n   */\n  const addSection = useCallback(\n    (sectionId: string, above: boolean) => {\n      let idx = -1;\n      updateUIState((current) => {\n        // Look for index\n        const newCompareRunSections = [...(current.compareRunSections || [])];\n        idx = newCompareRunSections.findIndex((sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sectionId);\n        const newSection = { name: '', uuid: getUUID(), display: false, isReordered: false };\n        if (idx < 0) {\n          // Index not found, add to end\n          newCompareRunSections.push(newSection);\n        } else if (above) {\n          newCompareRunSections.splice(idx, 0, newSection);\n        } else {\n          idx += 1;\n          newCompareRunSections.splice(idx, 0, newSection);\n        }\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n      return idx;\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Appends a section to the end of the accordion\n   */\n  const appendSection = useCallback(() => {\n    updateUIState((current) => {\n      const newCompareRunSections = [\n        ...(current.compareRunSections || []),\n        { name: '', uuid: getUUID(), display: false, isReordered: false },\n      ];\n      return {\n        ...current,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n    setEditSection(compareRunSections?.length || -1);\n  }, [updateUIState, compareRunSections?.length]);\n\n  /**\n   * Updates the name of a section\n   * @param sectionId the section to update the name of\n   * @param name the new name of the section\n   */\n  const setSectionName = useCallback(\n    (sectionId: string, name: string) => {\n      updateUIState((current) => {\n        const newCompareRunSections = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n          if (sectionConfig.uuid === sectionId) {\n            return { ...sectionConfig, name: name };\n          } else {\n            return sectionConfig;\n          }\n        });\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Reorders the sections in the accordion\n   * @param sourceSectionId the section you are dragging\n   * @param targetSectionId the section to drop\n   */\n  const sectionReorder = useCallback(\n    (sourceSectionId: string, targetSectionId: string) => {\n      updateUIState((current) => {\n        const newCompareRunSections = (current.compareRunSections || []).slice();\n        const sourceSectionIdx = newCompareRunSections.findIndex(\n          (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sourceSectionId,\n        );\n        const targetSectionIdx = newCompareRunSections.findIndex(\n          (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === targetSectionId,\n        );\n        const sourceSection = newCompareRunSections.splice(sourceSectionIdx, 1)[0];\n        // If the source section is above the target section, the target section index will be shifted down by 1\n        newCompareRunSections.splice(targetSectionIdx, 0, sourceSection);\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  const noRunsSelected = useMemo(() => chartData.filter(({ hidden }) => !hidden).length === 0, [chartData]);\n\n  const { sectionsToRender, chartsToRender } = useMemo(() => {\n    if (search === '') {\n      return { sectionsToRender: compareRunSections, chartsToRender: compareRunCharts };\n    }\n\n    const compareRunChartsFiltered = (compareRunCharts || []).filter((config: RunsChartsCardConfig) => {\n      return !config.deleted && chartMatchesFilter(search, config);\n    });\n    // Get the sections that have these charts\n    const sectionsWithCharts = new Set<string>();\n    compareRunChartsFiltered.forEach((config: RunsChartsCardConfig) => {\n      if (config.metricSectionId) {\n        sectionsWithCharts.add(config.metricSectionId);\n      }\n    });\n    // Filter the sections\n    const compareRunSectionsFiltered = (compareRunSections || []).filter((sectionConfig: ChartSectionConfig) => {\n      return sectionsWithCharts.has(sectionConfig.uuid);\n    });\n\n    return { sectionsToRender: compareRunSectionsFiltered, chartsToRender: compareRunChartsFiltered };\n  }, [search, compareRunCharts, compareRunSections]);\n\n  const isSearching = search !== '';\n\n  if (!compareRunSections || !compareRunCharts) {\n    return null;\n  }\n\n  if (noRunsSelected) {\n    return (\n      noRunsSelectedEmptyState ?? (\n        <div css={{ marginTop: theme.spacing.lg }}>\n          <Empty\n            description={\n              <FormattedMessage\n                defaultMessage=\"All runs are hidden. Select at least one run to view charts.\"\n                description=\"Experiment tracking > runs charts > indication displayed when no runs are selected for comparison\"\n              />\n            }\n          />\n        </div>\n      )\n    );\n  }\n\n  if (isSearching && chartsToRender?.length === 0) {\n    // Render empty in the center of the page\n    return (\n      <>\n        <Spacer size=\"lg\" />\n        <Empty\n          title={\n            <FormattedMessage\n              defaultMessage=\"No metric charts\"\n              description=\"Experiment page > compare runs > no metric charts\"\n            />\n          }\n          description={\n            <FormattedMessage\n              defaultMessage=\"All charts are filtered. Clear the search filter to see hidden metric charts.\"\n              description=\"Experiment page > compare runs > no metric charts > description\"\n            />\n          }\n        />\n      </>\n    );\n  }\n\n  return (\n    <div>\n      <MetricChartsAccordion activeKey={activeKey} onActiveKeyChange={onActivePanelChange}>\n        {(sectionsToRender || []).map((sectionConfig: ChartSectionConfig, index: number) => {\n          const sectionCharts = (chartsToRender || []).filter((config: RunsChartsCardConfig) => {\n            const section = (config as RunsChartsBarCardConfig).metricSectionId;\n            return !config.deleted && section === sectionConfig.uuid;\n          });\n\n          return (\n            <Accordion.Panel\n              header={\n                <RunsChartsSectionHeader\n                  index={index}\n                  section={sectionConfig}\n                  onDeleteSection={deleteSection}\n                  onAddSection={addSection}\n                  editSection={editSection}\n                  onSetEditSection={setEditSection}\n                  onSetSectionName={setSectionName}\n                  sectionChartsLength={sectionCharts.length}\n                  addNewChartCard={addNewChartCard}\n                  onSectionReorder={sectionReorder}\n                  isExpanded={activeKey.includes(sectionConfig.uuid)}\n                  supportedChartTypes={supportedChartTypes}\n                  // When searching, hide the section placement controls\n                  hideExtraControls={isSearching}\n                />\n              }\n              key={sectionConfig.uuid}\n              aria-hidden={!activeKey.includes(sectionConfig.uuid)}\n            >\n              <RunsChartsSection\n                sectionId={sectionConfig.uuid}\n                sectionConfig={sectionConfig}\n                sectionCharts={sectionCharts}\n                reorderCharts={reorderCharts}\n                insertCharts={insertCharts}\n                isMetricHistoryLoading={isMetricHistoryLoading}\n                chartData={chartData}\n                startEditChart={startEditChart}\n                removeChart={removeChart}\n                groupBy={groupBy}\n                sectionIndex={index}\n                setFullScreenChart={setFullScreenChart}\n                autoRefreshEnabled={autoRefreshEnabled}\n                hideEmptyCharts={hideEmptyCharts}\n                globalLineChartConfig={globalLineChartConfig}\n              />\n            </Accordion.Panel>\n          );\n        })}\n      </MetricChartsAccordion>\n      {!isSearching && (\n        <div>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionaccordion.tsx_405\"\n            block\n            onClick={appendSection}\n            icon={<PlusIcon />}\n            style={{ border: 'none', marginTop: '6px' }}\n          >\n            <FormattedMessage\n              defaultMessage=\"Add section\"\n              description=\"Experiment page > compare runs > chart section > add section bar\"\n            />\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n","var _path, _path2, _path3, _path4, _path5;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartParallel({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.21875 3.58289C4.55663 3.58289 4.88067 3.68935 5.21469 3.73008C5.6474 3.78285 6.02137 3.96513 6.37191 4.21552C6.76902 4.49917 7.0271 4.74589 7.24101 5.18954C7.44337 5.60925 7.59378 6.06989 7.72958 6.51432C7.86002 6.94121 8.09708 7.33726 8.19153 7.77803C8.25347 8.0671 8.34514 8.32427 8.44678 8.60015C8.58028 8.96252 8.80086 9.27915 8.96667 9.62583C9.15145 10.0122 9.216 10.4461 9.34876 10.8551C9.57831 11.5623 9.91132 12.4763 10.7205 12.6731C11.4284 12.8453 12.1459 12.8845 12.8705 12.8845C13.0981 12.8845 13.3979 12.898 13.5831 12.7499C13.6402 12.7042 13.7451 12.6907 13.8164 12.6591C13.8752 12.6329 14.0919 12.5871 14.1123 12.5463\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.16162 12.9805C4.32512 12.9805 4.4895 12.9859 4.65284 12.9805C4.84076 12.9742 5.0468 12.7952 5.2099 12.707C5.62236 12.4841 5.99426 12.0648 6.24299 11.6739C6.49491 11.2781 6.8776 10.9871 7.0887 10.5649C7.27767 10.187 7.50992 9.80749 7.73691 9.45078C7.93911 9.13304 8.10211 8.77722 8.28637 8.44554C8.43088 8.18544 8.45 7.88672 8.60542 7.62768C8.94898 7.05509 9.16215 6.418 9.45873 5.82484C9.72614 5.29001 9.96898 4.82426 10.4159 4.42207C10.5753 4.27853 10.8984 4.21824 11.0995 4.14861C11.3303 4.06873 11.579 4.02714 11.8136 3.93592C12.0394 3.84807 12.2521 3.84383 12.4795 3.77386C12.6993 3.70623 12.9319 3.63713 13.1632 3.63713C13.5192 3.63713 13.9089 3.59155 14.2798 3.59155\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.79248 2.74207V13.8225\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.873 3.04419V13.7217\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartParallel);\nexport default __webpack_public_path__ + \"static/media/chart-parallel.da7dedf539b2af4b654d377c679173e4.svg\";\nexport { ForwardRef as ReactComponent };","import { last, uniq } from 'lodash';\nimport { RunsChartsLineChartExpression } from '../runs-charts.types';\nimport { useCallback } from 'react';\n\nconst VARIABLE_OPERATOR = '$';\nconst MATCH_VARIABLE_REGEX = /\\$\\{([^}]+)\\}/g;\n\nenum Operator {\n  ADD = '+',\n  SUBTRACT = '-',\n  MULTIPLY = '*',\n  DIVIDE = '/',\n  POWER = '^',\n  // unary operators\n  NEGATIVE_SIGN = '_',\n  POSITIVE_SIGN = '|',\n}\nenum Parenthesis {\n  OPEN = '(',\n  CLOSE = ')',\n}\nenum VariableParenthesis {\n  OPEN = '{',\n  CLOSE = '}',\n}\n// Higher precedence value means higher priority\nconst precedence = {\n  [Operator.ADD]: 1,\n  [Operator.SUBTRACT]: 1,\n  [Operator.MULTIPLY]: 2,\n  [Operator.DIVIDE]: 2,\n  [Operator.POWER]: 3,\n  [Operator.NEGATIVE_SIGN]: 4,\n  [Operator.POSITIVE_SIGN]: 4,\n};\n\nconst isBinaryOperator = (char: string | number | undefined) => {\n  if (typeof char === 'string') {\n    return [Operator.ADD, Operator.SUBTRACT, Operator.MULTIPLY, Operator.DIVIDE, Operator.POWER].includes(\n      char as Operator,\n    );\n  }\n  return false;\n};\n\nconst isUnaryOperator = (char: string | number | undefined) => {\n  if (typeof char === 'string') {\n    return [Operator.NEGATIVE_SIGN, Operator.POSITIVE_SIGN].includes(char as Operator);\n  }\n  return false;\n};\nconst isHigherPrecedence = (op1: Operator, op2: Operator) => precedence[op1] > precedence[op2];\n\nconst indexToVariableString = (name: number) => `${VARIABLE_OPERATOR}{${name}}`;\nconst variableStringToIndex = (variable: string) => variable.slice(2, -1);\n\n// Parses variables from an expression and replace with an index\nexport const parseVariablesAndReplaceWithIndex = (expression: string) => {\n  const matches = expression.match(MATCH_VARIABLE_REGEX);\n  if (!matches) {\n    return { expression, variables: [] };\n  }\n  // De-duplicate matches and map them to their index\n  const dedupMatches = uniq(matches);\n  const matchesMap: Record<string, string> = {};\n  dedupMatches.forEach((match, index) => {\n    matchesMap[match] = indexToVariableString(index);\n  });\n  // Convert each variable into an index number e.g. ${train/loss} => ${0}\n  const replacedExpression = expression.replace(MATCH_VARIABLE_REGEX, (match) => {\n    if (match in matchesMap) {\n      return matchesMap[match];\n    }\n    return match;\n  });\n\n  const variables = dedupMatches.map(variableStringToIndex);\n  return { expression: replacedExpression, variables };\n};\n\n// Pop function that throws an error if the stack is empty\nconst popAndValidate = (stack: (string | number)[], operandCount: number[]): string | number => {\n  const lastElement = stack.pop();\n  if (lastElement === undefined) {\n    throw new Error('Invalid expression: stack is empty');\n  } else if (isBinaryOperator(lastElement)) {\n    if (operandCount[operandCount.length - 1] < 2) {\n      throw new Error('Invalid expression: Stack has binary operator without enough operands');\n    }\n    operandCount[operandCount.length - 1]--;\n  } else if (isUnaryOperator(lastElement)) {\n    if (operandCount[operandCount.length - 1] < 1) {\n      throw new Error('Invalid expression: Stack has unary operator without enough operands');\n    }\n  } else {\n    throw new Error('Invalid expression: Stack has invalid elements');\n  }\n  return lastElement;\n};\n\n// Flushes all the unary operators on a given value\nconst flushUnaryOperators = (stack: (string | number)[], output: (string | number)[], operandCount: number[]) => {\n  while (stack.length > 0 && isUnaryOperator(last(stack))) {\n    output.push(popAndValidate(stack, operandCount));\n  }\n};\n\nconst toRPN = (expression: string) => {\n  const stack: (string | number)[] = [];\n  const output: (string | number)[] = [];\n  const operandCount: number[] = [0];\n\n  const incrementOperand = () => {\n    operandCount[operandCount.length - 1]++;\n  };\n  for (let i = 0; i < expression.length; i++) {\n    let char = expression[i];\n\n    // Convert unary operators to placeholder negative and positive signs\n    const isUnarySign = i === 0 || isBinaryOperator(expression[i - 1]) || expression[i - 1] === Parenthesis.OPEN;\n    if (char === Operator.SUBTRACT && isUnarySign) {\n      char = Operator.NEGATIVE_SIGN;\n    } else if (char === Operator.ADD && isUnarySign) {\n      char = Operator.POSITIVE_SIGN;\n    }\n\n    if (char === VARIABLE_OPERATOR) {\n      let variable = '';\n      if (i + 1 >= expression.length || expression[i + 1] !== VariableParenthesis.OPEN) {\n        throw new Error('Invalid expression: Variable must be followed by {');\n      }\n      i++; // Skip '{'\n      while (i + 1 < expression.length && expression[i + 1] !== VariableParenthesis.CLOSE) {\n        variable += expression[++i];\n      }\n      i++; // Skip '}'\n      output.push(variable);\n      incrementOperand();\n      flushUnaryOperators(stack, output, operandCount);\n    } else if (/\\d/.test(char) || char === '.') {\n      // If the character is part of a number (digit or decimal point)\n      let num = char;\n      // Parse full number\n      while (i + 1 < expression.length && (/\\d/.test(expression[i + 1]) || expression[i + 1] === '.')) {\n        num += expression[++i];\n      }\n      const periodMatches = num.match(/\\./g);\n      if (periodMatches && periodMatches.length > 1) {\n        throw new Error('Invalid expression: Number has multiple decimal points');\n      }\n      const floatNum = parseFloat(num);\n      incrementOperand();\n      output.push(floatNum);\n      flushUnaryOperators(stack, output, operandCount);\n    } else if (isUnaryOperator(char)) {\n      stack.push(char);\n    } else if (isBinaryOperator(char)) {\n      // If its a binary operator, we should have at least on element in the output to operate on\n      if (output.length === 0) {\n        throw new Error('Invalid expression: Binary operator without operands');\n      }\n      while (\n        stack.length > 0 &&\n        isBinaryOperator(last(stack)) &&\n        (isHigherPrecedence(last(stack) as Operator, char as Operator) ||\n          (last(stack) === char && char !== Operator.POWER))\n      ) {\n        output.push(popAndValidate(stack, operandCount));\n      }\n      stack.push(char);\n    } else if (char === Parenthesis.OPEN) {\n      stack.push(char);\n      operandCount.push(0);\n    } else if (char === Parenthesis.CLOSE) {\n      while (stack.length > 0 && last(stack) !== Parenthesis.OPEN) {\n        output.push(popAndValidate(stack, operandCount));\n      }\n      const openParen = stack.pop(); // Remove '(' from the stack\n      if (openParen !== Parenthesis.OPEN) {\n        throw new Error('Invalid expression: Parenthesis mismatch');\n      }\n      if (operandCount[operandCount.length - 1] !== 1) {\n        throw new Error('Invalid expression: Parenthesis does not have exactly one operand');\n      }\n      operandCount.pop();\n      incrementOperand();\n      flushUnaryOperators(stack, output, operandCount);\n    } else {\n      throw new Error('Invalid expression: Unknown character in expression');\n    }\n  }\n  // The stack should only have unary and binary operators at the end\n  while (stack.length > 0) {\n    output.push(popAndValidate(stack, operandCount));\n  }\n  if (operandCount.length !== 1 || operandCount[0] !== 1) {\n    throw new Error('Invalid expression: Invalid number of operands');\n  }\n  return output;\n};\n\nconst fromRPN = (tokens: (string | number)[]) => {\n  const stack: (number | string)[] = [];\n  tokens.forEach((token) => {\n    if (typeof token === 'number') {\n      stack.push(token);\n      return;\n    }\n    if (isUnaryOperator(token)) {\n      const x = stack.pop();\n      if (typeof x !== 'number') {\n        throw new Error('Invalid expression: Unary operator without operand');\n      }\n      switch (token) {\n        case Operator.NEGATIVE_SIGN:\n          stack.push(-x);\n          break;\n        case Operator.POSITIVE_SIGN:\n          stack.push(x);\n          break;\n      }\n    } else if (isBinaryOperator(token)) {\n      const b = stack.pop();\n      const a = stack.pop();\n      if (typeof a !== 'number' || typeof b !== 'number') {\n        throw new Error('Invalid expression: Binary operator without enough operands');\n      }\n      switch (token) {\n        case Operator.ADD:\n          stack.push(a + b);\n          break;\n        case Operator.SUBTRACT:\n          stack.push(a - b);\n          break;\n        case Operator.MULTIPLY:\n          stack.push(a * b);\n          break;\n        case Operator.DIVIDE:\n          stack.push(a / b);\n          break;\n        case Operator.POWER:\n          stack.push(Math.pow(a, b));\n          break;\n      }\n    } else {\n      throw new Error('Invalid expression: Unknown token in expression');\n    }\n  });\n  if (stack.length !== 1 || typeof stack[0] !== 'number') {\n    throw new Error('Invalid expression: Invalid expression result');\n  }\n  return stack[0];\n};\n\nexport const useChartExpressionParser = () => {\n  const compileExpression = useCallback(\n    (expression: string, metricKeyList: string[]): RunsChartsLineChartExpression | undefined => {\n      try {\n        // Validate only contains valid characters\n        const noVariableExpression = expression.replace(MATCH_VARIABLE_REGEX, '');\n        if (!/^[0-9+\\-*/().\\s^]*$/.test(noVariableExpression)) {\n          return undefined;\n        }\n        // Parse variables from expression and remove whitespace elsewhere\n        const { expression: parsedExpression, variables } = parseVariablesAndReplaceWithIndex(expression);\n        // Check if all variables are valid\n        for (const variable of variables) {\n          if (!metricKeyList.includes(variable)) {\n            return undefined;\n          }\n        }\n        const cleanedExpression = parsedExpression.replace(/\\s/g, '');\n        const replacedExpression = cleanedExpression.replace(MATCH_VARIABLE_REGEX, (match) => {\n          const index = parseInt(match.slice(2, -1), 10);\n          return `${VARIABLE_OPERATOR}{${variables[index]}}`;\n        });\n        // Convert expression to RPN\n        const rpn = toRPN(replacedExpression);\n        return {\n          rpn,\n          variables,\n          expression,\n        };\n      } catch (e) {\n        // If not a valid expression, return undefined\n        return undefined;\n      }\n    },\n    [],\n  );\n\n  const evaluateExpression = (\n    chartExpression: RunsChartsLineChartExpression | undefined,\n    variables: Record<string, number>,\n  ): number | undefined => {\n    if (chartExpression === undefined) {\n      return undefined;\n    }\n    try {\n      const parsedRPN = chartExpression.rpn.map((token) => {\n        if (typeof token === 'string' && chartExpression.variables.includes(token)) {\n          return variables[token];\n        }\n        return token;\n      });\n      return fromRPN(parsedRPN);\n    } catch (e) {\n      return undefined;\n    }\n  };\n\n  return {\n    compileExpression,\n    evaluateExpression,\n  };\n};\n","import { useCallback, useRef, useState } from 'react';\nimport { type Data, type Layout, type Config, downloadImage } from 'plotly.js';\n\nexport type ExperimentChartImageDownloadFileFormat = 'svg' | 'png';\nexport type ExperimentChartImageDownloadHandler = (\n  format: ExperimentChartImageDownloadFileFormat,\n  chartTitle: string,\n) => void;\n\nconst experimentChartImageDefaultDownloadLayout: Partial<Layout> = {\n  paper_bgcolor: 'white',\n  plot_bgcolor: 'white',\n};\n\nconst experimentChartImageDefaultDownloadSettings = {\n  width: 1200,\n  height: 600,\n};\n\nconst experimentChartImageDefaultDownloadPlotConfig: Partial<Config> = {\n  displaylogo: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createChartImageDownloadHandler =\n  (data: Data[], layout: Partial<Layout>) => (format: 'svg' | 'png', title: string) =>\n    downloadImage(\n      {\n        data,\n        layout: { ...layout, ...experimentChartImageDefaultDownloadLayout },\n        config: experimentChartImageDefaultDownloadPlotConfig,\n      },\n      { ...experimentChartImageDefaultDownloadSettings, format, filename: title },\n    );\n\n/**\n * Returns a memoized download handler for chart images.\n * Uses ref-based caching to ensure that the download handler is not recreated on every render.\n */\nexport const useChartImageDownloadHandler = () => {\n  const downloadHandlerRef = useRef<ExperimentChartImageDownloadHandler | null>(null);\n  const [downloadHandler, setDownloadHandler] = useState<ExperimentChartImageDownloadHandler | null>(null);\n\n  const setDownloadHandlerCached = useCallback((downloadHandler: ExperimentChartImageDownloadHandler) => {\n    downloadHandlerRef.current = downloadHandler;\n    setDownloadHandler((existingHandler: ExperimentChartImageDownloadHandler | null) => {\n      if (existingHandler) {\n        return existingHandler;\n      }\n\n      return (format: ExperimentChartImageDownloadFileFormat, chartTitle: string) =>\n        downloadHandlerRef.current?.(format, chartTitle);\n    });\n  }, []);\n\n  return [downloadHandler, setDownloadHandlerCached] as const;\n};\n","import type { AgGridReactProps, AgReactUiProps } from '@ag-grid-community/react';\nimport { Spinner } from '@databricks/design-system';\nimport React from 'react';\n\nconst MLFlowAgGridImpl = React.lazy(() => import('./AgGrid'));\n\n/**\n * A simple loader that will lazily load MLflow's ag grid implementation.\n * Extracted to a separate module for testing purposes.\n */\nexport const MLFlowAgGridLoader = (props: AgGridReactProps | AgReactUiProps) => (\n  <React.Suspense\n    fallback={\n      <div\n        css={(cssTheme) => ({\n          display: 'flex',\n          justifyContent: 'center',\n          margin: cssTheme.spacing.md,\n        })}\n      >\n        <Spinner />\n      </div>\n    }\n  >\n    <MLFlowAgGridImpl {...props} />\n  </React.Suspense>\n);\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsBarCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartCardWrapper,\n  type RunsChartCardReorderProps,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  RunsChartCardVisibilityProps,\n} from './ChartCard.common';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { customMetricBehaviorDefs } from '../../../experiment-page/utils/customMetricBehaviorUtils';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\nimport { Tag, Typography } from '@databricks/design-system';\n\nexport interface RunsChartsBarChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardFullScreenProps,\n    RunsChartCardVisibilityProps {\n  config: RunsChartsBarCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const barChartCardDefaultMargin = {\n  t: 24,\n  b: 48,\n  r: 0,\n  l: 4,\n  pad: 0,\n};\n\nexport const RunsChartsBarChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  isInViewport: isInViewportProp,\n  ...reorderProps\n}: RunsChartsBarChartCardProps) => {\n  const dataKey = config.dataAccessKey ?? config.metricKey;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: customMetricBehaviorDefs[config.metricKey]?.displayName ?? config.metricKey,\n      subtitle: null,\n    });\n  };\n\n  const slicedRuns = useMemo(\n    () => chartRunData.filter(({ hidden, metrics }) => !hidden && metrics[dataKey]),\n    [chartRunData, dataKey],\n  );\n\n  const isEmptyDataset = useMemo(() => {\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return !metricsInRuns.includes(dataKey);\n  }, [dataKey, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  const isInViewport = fullScreen || isInViewportProp;\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.barChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n    >\n      {isInViewport ? (\n        <RunsMetricsBarPlot\n          runsData={slicedRuns}\n          metricKey={dataKey}\n          displayRunNames={false}\n          displayMetricKey={false}\n          useDefaultHoverBox={false}\n          margin={barChartCardDefaultMargin}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  const chartTitle = (() => {\n    if (config.datasetName) {\n      return (\n        <div css={{ flex: 1, display: 'flex', alignItems: 'center', overflow: 'hidden' }}>\n          <Typography.Text title={config.metricKey} ellipsis bold>\n            <Tag componentId=\"mlflow.charts.bar_card_title.dataset_tag\" css={{ marginRight: 0 }}>\n              {config.datasetName}\n            </Tag>{' '}\n            {config.metricKey}\n          </Typography.Text>\n        </div>\n      );\n    }\n    return customMetricBehaviorDefs[config.metricKey]?.displayName ?? config.displayName ?? config.metricKey;\n  })();\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={chartTitle}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        if (format === 'csv' || format === 'csv-full') {\n          const runsToExport = [...slicedRuns].reverse();\n          downloadChartDataCsv(runsToExport, [config.metricKey], [], config.metricKey);\n          return;\n        }\n        imageDownloadHandler?.(format, config.metricKey);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  barChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { isUndefined } from 'lodash';\n\nimport { RunsCompareMultipleTracesTooltipData } from './RunsMetricsLinePlot';\nimport React from 'react';\nimport { TraceLabelColorIndicator } from './RunsMetricsLegend';\nimport { FormattedDate, FormattedTime, useIntl } from 'react-intl';\nimport { getChartAxisLabelDescriptor, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { shouldEnableRelativeTimeDateAxis } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTime = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedDate value={value} year=\"numeric\" />-\n    <FormattedDate value={value} month=\"2-digit\" />-\n    <FormattedDate value={value} day=\"2-digit\" /> <FormattedTime value={value} hour=\"numeric\" hourCycle=\"h24\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTimestamp = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedTime value={value} hour=\"2-digit\" hourCycle=\"h23\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n/**\n * Variant of the tooltip body for the line chart that displays multiple traces at once.\n * Used in the compare runs page and run details metrics page.\n */\nexport const RunsMultipleTracesTooltipBody = ({ hoverData }: { hoverData: RunsCompareMultipleTracesTooltipData }) => {\n  const { tooltipLegendItems, hoveredDataPoint: singleTraceHoverData, xValue, xAxisKeyLabel } = hoverData;\n  const { traceUuid: runUuid, metricEntity } = singleTraceHoverData || {};\n\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const hoveredTraceUuid = `${runUuid}.${metricEntity?.key}`;\n  const displayedXValueLabel =\n    hoverData.xAxisKey === RunsChartsLineChartXAxisType.METRIC\n      ? xAxisKeyLabel\n      : intl.formatMessage(getChartAxisLabelDescriptor(hoverData.xAxisKey));\n\n  if (tooltipLegendItems) {\n    return (\n      <div>\n        {!isUndefined(xValue) && (\n          <div css={{ marginBottom: theme.spacing.xs }}>\n            <span css={{ fontWeight: 'bold' }}>{displayedXValueLabel}</span>{' '}\n            {hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME ? (\n              <PlotlyLikeFormattedTime value={xValue} />\n            ) : shouldEnableRelativeTimeDateAxis() &&\n              hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE ? (\n              <PlotlyLikeFormattedTimestamp value={xValue} />\n            ) : (\n              xValue\n            )}\n          </div>\n        )}\n        <div\n          css={{\n            display: 'grid',\n            gridTemplateColumns: `${theme.general.iconSize}px auto auto`,\n            columnGap: theme.spacing.sm,\n            rowGap: theme.spacing.sm / 4,\n            alignItems: 'center',\n          }}\n        >\n          {tooltipLegendItems.map(({ displayName, color, uuid, value, dashStyle }) => (\n            <React.Fragment key={uuid}>\n              <TraceLabelColorIndicator color={color || 'transparent'} dashStyle={dashStyle} />\n\n              <div\n                css={{\n                  marginRight: theme.spacing.md,\n                  fontSize: theme.typography.fontSizeSm,\n                  color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                }}\n              >\n                {displayName}\n              </div>\n              <div>\n                {!isUndefined(value) && (\n                  <span\n                    css={{\n                      fontWeight: hoveredTraceUuid === uuid ? 'bold' : 'normal',\n                      color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                    }}\n                  >\n                    {value}\n                  </span>\n                )}\n              </div>\n            </React.Fragment>\n          ))}\n        </div>\n      </div>\n    );\n  }\n  return null;\n};\n","import React, { useCallback } from 'react';\nimport { ExperimentRunsChartsUIConfiguration } from '../../experiment-page/models/ExperimentPageUIState';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { getUUID } from '../../../../common/utils/ActionUtils';\n\nexport type RunsChartsUIConfigurationSetter = (\n  state: ExperimentRunsChartsUIConfiguration,\n) => ExperimentRunsChartsUIConfiguration;\n\nconst RunsChartsUIConfigurationContext = React.createContext<\n  (stateSetter: RunsChartsUIConfigurationSetter, isSeeding?: boolean) => void\n>(() => {});\n\n/**\n * Creates a localized context to manage the UI state of the runs charts.\n * Accepts a function to update the state object, coming from simple state setter or a reducer.\n */\nexport const RunsChartsUIConfigurationContextProvider = ({\n  children,\n  updateChartsUIState,\n}: {\n  children: React.ReactNode;\n  updateChartsUIState: (stateSetter: RunsChartsUIConfigurationSetter, isSeeding?: boolean) => void;\n}) => (\n  <RunsChartsUIConfigurationContext.Provider value={updateChartsUIState}>\n    {children}\n  </RunsChartsUIConfigurationContext.Provider>\n);\n\n/**\n * Returns a function to update the current overarching UI state of the runs charts.\n */\nexport const useUpdateRunsChartsUIConfiguration = () => React.useContext(RunsChartsUIConfigurationContext);\n\nexport const useReorderRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return useCallback(\n    (sourceChartUuid: string, targetChartUuid: string) => {\n      updateChartsUIState((current) => {\n        const newChartsOrder = current.compareRunCharts?.slice();\n        const newSectionsState = current.compareRunSections?.slice();\n        if (!newChartsOrder || !newSectionsState) {\n          return current;\n        }\n\n        const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n        const indexTarget = newChartsOrder.findIndex((c) => c.uuid === targetChartUuid);\n\n        // If one of the charts is not found, do nothing\n        if (indexSource < 0 || indexTarget < 0) {\n          return current;\n        }\n\n        const sourceChart = newChartsOrder[indexSource];\n        const targetChart = newChartsOrder[indexTarget];\n\n        const isSameMetricSection = targetChart.metricSectionId === sourceChart.metricSectionId;\n\n        // Update the sections to indicate that the charts have been reordered\n        const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n        const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetChart.metricSectionId);\n        newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n        newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n        // Set new chart metric group\n        const newSourceChart = { ...sourceChart };\n        newSourceChart.metricSectionId = targetChart.metricSectionId;\n\n        // Remove the source graph from array\n        newChartsOrder.splice(indexSource, 1);\n        if (!isSameMetricSection) {\n          // Insert the source graph into target\n          newChartsOrder.splice(\n            newChartsOrder.findIndex((c) => c.uuid === targetChartUuid),\n            0,\n            newSourceChart,\n          );\n        } else {\n          // The indexTarget is not neccessarily the target now, but it will work as the insert index\n          newChartsOrder.splice(indexTarget, 0, newSourceChart);\n        }\n\n        return {\n          ...current,\n          compareRunCharts: newChartsOrder,\n          compareRunSections: newSectionsState,\n        };\n      });\n    },\n    [updateChartsUIState],\n  );\n};\n\nexport const useConfirmChartCardConfigurationFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return useCallback(\n    (configuredCard: Partial<RunsChartsCardConfig>) => {\n      const serializedCard = RunsChartsCardConfig.serialize({\n        ...configuredCard,\n        uuid: getUUID(),\n      });\n\n      // Creating new chart\n      if (!configuredCard.uuid) {\n        updateChartsUIState((current) => ({\n          ...current,\n          // This condition ensures that chart collection will remain undefined if not set previously\n          compareRunCharts: current.compareRunCharts && [...current.compareRunCharts, serializedCard],\n        }));\n      } /* Editing existing chart */ else {\n        updateChartsUIState((current) => ({\n          ...current,\n          compareRunCharts: current.compareRunCharts?.map((existingChartCard) => {\n            if (existingChartCard.uuid === configuredCard.uuid) {\n              return { ...serializedCard, uuid: existingChartCard.uuid };\n            }\n            return existingChartCard;\n          }),\n        }));\n      }\n    },\n    [updateChartsUIState],\n  );\n};\n\nexport const useInsertRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return useCallback(\n    (sourceChartUuid: string, targetSectionId: string) => {\n      updateChartsUIState((current) => {\n        const newChartsOrder = current.compareRunCharts?.slice();\n        const newSectionsState = current.compareRunSections?.slice();\n        if (!newChartsOrder || !newSectionsState) {\n          return current;\n        }\n\n        const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n        if (indexSource < 0) {\n          return current;\n        }\n        const sourceChart = newChartsOrder[indexSource];\n        // Set new chart metric group\n        const newSourceChart = { ...sourceChart };\n        newSourceChart.metricSectionId = targetSectionId;\n\n        // Update the sections to indicate that the charts have been reordered\n        const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n        const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetSectionId);\n        newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n        newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n        // Remove the source graph from array and append\n        newChartsOrder.splice(indexSource, 1);\n        newChartsOrder.push(newSourceChart);\n\n        return {\n          ...current,\n          compareRunCharts: newChartsOrder,\n          compareRunSections: newSectionsState,\n        };\n      });\n    },\n    [updateChartsUIState],\n  );\n};\n\nexport const useRemoveRunsChartFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return useCallback(\n    (configToDelete: RunsChartsCardConfig) => {\n      updateChartsUIState((current) => ({\n        ...current,\n        compareRunCharts: configToDelete.isGenerated\n          ? current.compareRunCharts?.map((setup) =>\n              setup.uuid === configToDelete.uuid ? { ...setup, deleted: true } : setup,\n            )\n          : current.compareRunCharts?.filter((setup) => setup.uuid !== configToDelete.uuid),\n      }));\n    },\n    [updateChartsUIState],\n  );\n};\n","import { useInfiniteQuery } from '@mlflow/mlflow/src/common/utils/reactQueryHooks';\nimport { isEmpty, last, uniqBy } from 'lodash';\nimport { LoggedModelMetricDataset, LoggedModelProto } from '../../types';\nimport { loggedModelsDataRequest } from './request.utils';\nimport { getAjaxUrl } from '@mlflow/mlflow/src/common/utils/FetchUtils';\nimport { useMemo } from 'react';\n\ntype UseSearchLoggedModelsQueryResponseType = {\n  models: LoggedModelProto[];\n  next_page_token?: string;\n};\n\nexport const useSearchLoggedModelsQuery = (\n  {\n    experimentIds,\n    orderByAsc,\n    orderByField,\n    searchQuery,\n    selectedFilterDatasets,\n    orderByDatasetName,\n    orderByDatasetDigest,\n  }: {\n    experimentIds?: string[];\n    orderByAsc?: boolean;\n    orderByField?: string;\n    searchQuery?: string;\n    selectedFilterDatasets?: LoggedModelMetricDataset[];\n    orderByDatasetName?: string;\n    orderByDatasetDigest?: string;\n  },\n  {\n    enabled = true,\n  }: {\n    enabled?: boolean;\n  } = {},\n) => {\n  // Uniquely identify the query by the experiment IDs, order by, filter query and datasets, and order by asc\n  const queryKey = [\n    'SEARCH_LOGGED_MODELS',\n    JSON.stringify(experimentIds),\n    orderByField,\n    orderByAsc,\n    searchQuery,\n    JSON.stringify(selectedFilterDatasets),\n    orderByDatasetName,\n    orderByDatasetDigest,\n  ];\n\n  const { data, isLoading, isFetching, fetchNextPage, refetch, error } = useInfiniteQuery<\n    UseSearchLoggedModelsQueryResponseType,\n    Error\n  >({\n    queryKey,\n    queryFn: async ({ pageParam }) => {\n      const requestBody = {\n        experiment_ids: experimentIds,\n        order_by: [\n          {\n            field_name: orderByField ?? 'creation_time',\n            ascending: orderByAsc ?? false,\n            dataset_name: orderByDatasetName,\n            dataset_digest: orderByDatasetDigest,\n          },\n        ],\n\n        page_token: pageParam,\n        filter: searchQuery,\n        datasets: !isEmpty(selectedFilterDatasets) ? selectedFilterDatasets : undefined,\n      };\n\n      return loggedModelsDataRequest(getAjaxUrl('ajax-api/2.0/mlflow/logged-models/search'), 'POST', requestBody);\n    },\n    cacheTime: 0,\n    getNextPageParam: (lastPage) => lastPage.next_page_token,\n    refetchOnWindowFocus: false,\n    retry: false,\n    enabled,\n  });\n\n  // Concatenate all the models from all the result pages\n  const modelsData = useMemo(() => data?.pages.flatMap((page) => page?.models).filter(Boolean), [data]);\n\n  // The current page token is the one from the last page\n  const nextPageToken = last(data?.pages)?.next_page_token;\n\n  return {\n    isLoading,\n    isFetching,\n    data: modelsData,\n    nextPageToken,\n    refetch,\n    error,\n    loadMoreResults: fetchNextPage,\n  } as const;\n};\n","import { ReactNode } from 'react';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { RunsChartsRunData } from './RunsCharts.common';\nimport { Modal, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunsChartsTooltipBodyProps, RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport { RunsChartsCard } from './cards/RunsChartsCard';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport type { RunsChartsGlobalLineChartConfig } from '../../experiment-page/models/ExperimentPageUIState';\n\nexport const RunsChartsFullScreenModal = <TContext,>({\n  chartData,\n  isMetricHistoryLoading = false,\n  groupBy,\n  fullScreenChart,\n  onCancel,\n  tooltipContextValue,\n  tooltipComponent,\n  autoRefreshEnabled,\n  globalLineChartConfig,\n}: {\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  fullScreenChart:\n    | {\n        config: RunsChartsCardConfig;\n        title: string | ReactNode;\n        subtitle: ReactNode;\n      }\n    | undefined;\n  onCancel: () => void;\n  tooltipContextValue: TContext;\n  tooltipComponent: React.ComponentType<RunsChartsTooltipBodyProps<TContext>>;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n\n  const emptyReorderProps = {\n    canMoveDown: false,\n    canMoveUp: false,\n    onMoveDown: () => {},\n    onMoveUp: () => {},\n    onReorderWith: () => {},\n  };\n\n  const emptyConfigureProps = {\n    onRemoveChart: () => {},\n    onReorderCharts: () => {},\n    onStartEditChart: () => {},\n    setFullScreenChart: () => {},\n  };\n\n  if (!fullScreenChart) {\n    return null;\n  }\n\n  return (\n    <Modal\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsfullscreenmodal.tsx_53\"\n      visible\n      onCancel={onCancel}\n      title={\n        <div css={{ display: 'flex', flexDirection: 'column' }}>\n          {fullScreenChart.title}\n          <span\n            css={{\n              color: theme.colors.textSecondary,\n              fontSize: theme.typography.fontSizeSm,\n              marginRight: theme.spacing.xs,\n            }}\n          >\n            {fullScreenChart.subtitle}\n          </span>\n        </div>\n      }\n      footer={null}\n      verticalSizing=\"maxed_out\"\n      dangerouslySetAntdProps={{ width: '95%' }}\n      css={{\n        [`.${getPrefixedClassName('modal-body')}`]: {\n          flex: 1,\n        },\n      }}\n    >\n      <RunsChartsTooltipWrapper contextData={tooltipContextValue} component={tooltipComponent}>\n        <RunsChartsCard\n          cardConfig={fullScreenChart.config}\n          chartRunData={chartData}\n          groupBy={groupBy}\n          index={0}\n          sectionIndex={0}\n          fullScreen\n          autoRefreshEnabled={autoRefreshEnabled}\n          globalLineChartConfig={globalLineChartConfig}\n          {...emptyConfigureProps}\n          {...emptyReorderProps}\n        />\n      </RunsChartsTooltipWrapper>\n    </Modal>\n  );\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Config, Data, Layout } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightBarTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport type { MetricEntity } from '../../../types';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport { customMetricBehaviorDefs } from '../../experiment-page/utils/customMetricBehaviorUtils';\nimport { RunsChartCardLoadingPlaceholder } from './cards/ChartCard.common';\n\n// We're not using params in bar plot\nexport type BarPlotRunData = Omit<RunsChartsRunData, 'params' | 'tags' | 'images'>;\n\nexport interface RunsMetricsBarPlotHoverData {\n  xValue: string;\n  yValue: number;\n  index: number;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsMetricsBarPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   */\n  metricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: BarPlotRunData[];\n\n  /**\n   * Relative width of the plot bar\n   */\n  barWidth?: number;\n\n  /**\n   * Display run names on the Y axis\n   */\n  displayRunNames?: boolean;\n\n  /**\n   * Display metric key on the X axis\n   */\n  displayMetricKey?: boolean;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  scrollZoom: false,\n  doubleClick: 'autosize',\n  showTips: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nconst Y_AXIS_PARAMS = {\n  ticklabelposition: 'inside',\n  tickfont: { size: 11 },\n  fixedrange: true,\n};\n\nconst getFixedPointValue = (val: string | number, places = 2) => (typeof val === 'number' ? val.toFixed(places) : val);\n\n/**\n * Implementation of plotly.js chart displaying\n * bar plot comparing metrics for a given\n * set of experiments runs\n */\nexport const RunsMetricsBarPlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    barWidth = 3 / 4,\n    width,\n    height,\n    displayRunNames = true,\n    useDefaultHoverBox = true,\n    displayMetricKey = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsMetricsBarPlotProps) => {\n    const plotData = useMemo(() => {\n      // Run uuids\n      const ids = runsData.map((d) => d.uuid);\n\n      // Trace names\n      const names = runsData.map(({ displayName }) => displayName);\n\n      // Actual metric values\n      const values = runsData.map((d) => normalizeChartValue(d.metrics[metricKey]?.value));\n\n      // Displayed metric values\n      const textValues = runsData.map((d) => {\n        const customMetricBehaviorDef = customMetricBehaviorDefs[metricKey];\n        if (customMetricBehaviorDef) {\n          return customMetricBehaviorDef.valueFormatter({ value: d.metrics[metricKey]?.value });\n        }\n\n        return getFixedPointValue(d.metrics[metricKey]?.value);\n      });\n\n      // Colors corresponding to each run\n      const colors = runsData.map((d) => d.color);\n\n      return [\n        {\n          y: ids,\n          x: values,\n          names,\n          text: textValues,\n          textposition: values.map((value) => (value === 0 ? 'outside' : 'auto')),\n          textfont: {\n            size: 11,\n          },\n          metrics: runsData.map((d) => d.metrics[metricKey]),\n          // Display run name on hover. \"<extra></extra>\" removes plotly's \"extra\" tooltip that\n          // is unnecessary here.\n          type: 'bar' as any,\n          hovertemplate: useDefaultHoverBox ? '%{label}<extra></extra>' : undefined,\n          hoverinfo: useDefaultHoverBox ? 'y' : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          width: barWidth,\n\n          orientation: 'h',\n          marker: {\n            color: colors,\n          },\n        } as Data & { names: string[] },\n      ];\n    }, [runsData, metricKey, barWidth, useDefaultHoverBox]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n    const { theme } = useDesignSystemTheme();\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      hovermode: 'y',\n      margin,\n      xaxis: {\n        title: displayMetricKey ? metricKey : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        tickformat: customMetricBehaviorDefs[metricKey]?.chartAxisTickFormat ?? undefined,\n      },\n      yaxis: {\n        showticklabels: displayRunNames,\n        title: displayRunNames\n          ? formatMessage({\n              defaultMessage: 'Run name',\n              description: 'Label for Y axis in bar chart when comparing metrics between runs',\n            })\n          : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        fixedrange: true,\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => ({\n        ...current,\n        width: width || layoutWidth,\n        height: height || layoutHeight,\n        margin,\n        xaxis: {\n          ...current.xaxis,\n          title: displayMetricKey ? metricKey : undefined,\n        },\n      }));\n    }, [layoutWidth, layoutHeight, margin, metricKey, width, height, displayMetricKey]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightBarTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points, event }) => {\n        const metricEntity = points[0].data?.metrics[points[0].pointIndex];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        const hoverData: RunsMetricsBarPlotHoverData = {\n          xValue: points[0].x,\n          yValue: points[0].value,\n          // The index of the X datum\n          index: points[0].pointIndex,\n          metricEntity,\n        };\n\n        const runUuid = points[0]?.label;\n        if (runUuid) {\n          onHover?.(runUuid, event, hoverData);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      // Prepare layout and data traces to export\n      const layoutToExport = {\n        ...layout,\n        yaxis: {\n          ...layout.yaxis,\n          showticklabels: true,\n          automargin: true,\n        },\n      };\n\n      const dataToExport = plotData.map((trace) => ({\n        ...trace,\n        // In exported image, use names for Y axes\n        y: trace.names,\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n          fallback={<RunsChartCardLoadingPlaceholder />}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.trace.bars g.point path': {\n      transition: 'var(--trace-transition)',\n    },\n    '.trace.bars.is-highlight g.point path': {\n      opacity: 'var(--trace-opacity-dimmed-high) !important',\n    },\n    '.trace.bars g.point.is-hover-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.trace.bars g.point.is-selection-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n  },\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultContourMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport { RunsChartCardLoadingPlaceholder } from './cards/ChartCard.common';\n\nexport interface RunsContourPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Depth dimension with a metric or a param\n   */\n  zAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n\n  /**\n   * Sets the color scale in [[0.35, 'rgb(40,60,190)'],[0.5, 'rgb(70,100,245)'],...] format.\n   * Leave unset to use the defualt scale.\n   */\n  colorScale?: [number, string][];\n\n  /**\n   * Set to `true` in order to reverse the color scale.\n   */\n  reverseScale?: boolean;\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nconst DEFAULT_COLOR_SCALE: [number, string][] = [\n  [0, 'rgb(5,10,172)'],\n  [0.35, 'rgb(40,60,190)'],\n  [0.5, 'rgb(70,100,245)'],\n  [0.6, 'rgb(90,120,245)'],\n  [0.7, 'rgb(106,137,247)'],\n  [1, 'rgb(220,220,220)'],\n];\n\nconst createTooltipTemplate = (zAxisTitle: string) =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  `<b>${zAxisTitle}:</b> %{customdata[2]:.2f}` +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * contour plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsContourPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    zAxis,\n    markerSize = 10,\n    className,\n    reverseScale,\n    margin = runsChartDefaultContourMargin,\n    colorScale = DEFAULT_COLOR_SCALE,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsContourPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const zValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { metrics, params, color, uuid, displayName } = runData;\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n        const zAxisData = zAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value || undefined;\n        const y = yAxisData?.[yAxis.key]?.value || undefined;\n        const z = zAxisData?.[zAxis.key]?.value || undefined;\n\n        if (x && y && z) {\n          xValues.push(x);\n          yValues.push(y);\n          zValues.push(z);\n          colors.push(color || theme.colors.primary);\n          tooltipData.push([uuid, displayName || uuid, z] as any);\n        }\n      }\n\n      // Let's compile chart layers\n      const layers = [\n        // The top layer with the scatter plot (dots)\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate(zAxis.key) : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n            line: {\n              color: 'black',\n              width: 1,\n            },\n          },\n        },\n      ] as Data[];\n\n      // If there are at least two runs, add a contour chart layer\n      if (runsData.length > 1) {\n        layers.unshift({\n          x: xValues,\n          y: yValues,\n          z: zValues,\n          type: 'contour',\n          connectgaps: true,\n          hoverinfo: 'none',\n          contours: {\n            coloring: 'heatmap',\n          },\n          colorscale: colorScale,\n          reversescale: reverseScale,\n          colorbar: {\n            tickfont: { size: 11, color: theme.colors.textSecondary, family: '' },\n          },\n        } as Data);\n      }\n      return layers;\n    }, [\n      colorScale,\n      reverseScale,\n      markerSize,\n      runsData,\n      xAxis.type,\n      xAxis.key,\n      yAxis.type,\n      yAxis.key,\n      zAxis.type,\n      zAxis.key,\n      theme.colors.primary,\n      theme.colors.textSecondary,\n      useDefaultHoverBox,\n    ]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: {\n        ticks: 'inside',\n        title: { standoff: 32, text: yAxis.key },\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = { standoff: 32, text: yAxis.key };\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find hover event corresponding to the second curve (scatter plot) only\n        const scatterPoints = points.find(({ curveNumber }) => curveNumber === 1);\n\n        setHoveredPointIndex(scatterPoints?.pointIndex ?? -1);\n\n        if (!scatterPoints) {\n          return;\n        }\n\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (scatterPoints as any)?.customdata?.[0];\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n          fallback={<RunsChartCardLoadingPlaceholder />}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport { createContext, useCallback, useContext, useMemo, useRef, useState } from 'react';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { DragAndDropProvider } from '../../../../common/hooks/useDragAndDropElement';\nimport { useUpdateRunsChartsUIConfiguration } from '../hooks/useRunsChartsUIConfiguration';\nimport { indexOf, sortBy } from 'lodash';\n\nconst RunsChartsDraggableGridStateContext = createContext<{\n  draggedCardUuid: string | null;\n  targetSection: string | null;\n  isDragging: () => boolean;\n}>({\n  draggedCardUuid: '',\n  targetSection: '',\n  isDragging: () => false,\n});\n\nconst RunsChartsDraggableGridActionsContext = createContext<{\n  setDraggedCardUuid: (cardUuid: string | null) => void;\n  setTargetSection: (targetSectionUuid: string | null) => void;\n  setTargetPosition: (pos: number) => void;\n  onDropChartCard: () => void;\n  onSwapCards: (sourceUuid: string, targetUuid: string) => void;\n}>({\n  setDraggedCardUuid: () => {},\n  setTargetSection: () => {},\n  setTargetPosition: () => {},\n  onDropChartCard: () => {},\n  onSwapCards: () => {},\n});\n\nexport const useRunsChartsDraggableGridStateContext = () => useContext(RunsChartsDraggableGridStateContext);\nexport const useRunsChartsDraggableGridActionsContext = () => useContext(RunsChartsDraggableGridActionsContext);\n\nexport const RunsChartsDraggableCardsGridContextProvider = ({\n  children,\n  visibleChartCards = [],\n}: {\n  children?: React.ReactNode;\n  visibleChartCards?: RunsChartsCardConfig[];\n}) => {\n  // Stateful values: dragged card ID and target section ID\n  const [draggedCardUuid, setDraggedCardUuid] = useState<string | null>(null);\n  const [targetSectionUuid, setTargetSectionUuid] = useState<string | null>(null);\n\n  // Use refs for direct access to the values\n  const immediateDraggedCardUuid = useRef<string | null>(null);\n  const immediateTargetSectionId = useRef<string | null>(null);\n  immediateDraggedCardUuid.current = draggedCardUuid;\n  immediateTargetSectionId.current = targetSectionUuid;\n\n  // Mutable field: target position (index) in the target section\n  const targetLocalPosition = useRef<number | null>(null);\n\n  const setTargetPosition = useCallback((pos: number) => {\n    targetLocalPosition.current = pos;\n  }, []);\n\n  const isDragging = useCallback(() => immediateDraggedCardUuid.current !== null, []);\n\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  // Callback for simple card swapping (Move up/move down functionality)\n  const onSwapCards = useCallback(\n    (sourceChartUuid: string, targetChartUuid: string) => {\n      updateChartsUIState((current) => {\n        const newChartsOrder = current.compareRunCharts?.slice();\n\n        if (!newChartsOrder) {\n          return current;\n        }\n\n        const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n        const indexTarget = newChartsOrder.findIndex((c) => c.uuid === targetChartUuid);\n\n        // If one of the charts is not found, do nothing\n        if (indexSource < 0 || indexTarget < 0) {\n          return current;\n        }\n\n        const sourceChart = newChartsOrder[indexSource];\n\n        // Remove the chart and insert it at the target position\n        newChartsOrder.splice(indexSource, 1);\n        newChartsOrder.splice(indexTarget, 0, sourceChart);\n\n        return { ...current, compareRunCharts: newChartsOrder };\n      });\n    },\n    [updateChartsUIState],\n  );\n\n  // Callback invoked when a card is dropped\n  const onDropChartCard = useCallback(() => {\n    const draggedChartUuid = immediateDraggedCardUuid.current;\n    const targetSectionId = immediateTargetSectionId.current;\n    const targetPosition = targetLocalPosition.current;\n\n    if (draggedChartUuid === null || targetSectionId === null || targetPosition === null) {\n      return;\n    }\n\n    setDraggedCardUuid(null);\n\n    updateChartsUIState((current) => {\n      // Find the source card and section in the current state\n      const sourceCard = current.compareRunCharts?.find((chart) => chart.uuid === draggedChartUuid);\n      if (!sourceCard) {\n        return current;\n      }\n\n      const sourceSection = current.compareRunSections?.find((section) => section.uuid === sourceCard?.metricSectionId);\n\n      // Find the target section in the current state\n      const targetSection = current.compareRunSections?.find((section) => section.uuid === targetSectionId);\n\n      // Get all the cards in the source section\n      const sourceSectionCards = current.compareRunCharts?.filter(\n        (chartCard) => chartCard.metricSectionId === sourceSection?.uuid,\n      );\n\n      // If we're moving the card within the same section\n      if (sourceSection === targetSection) {\n        // Copy the resulting chart list\n        const resultChartsList = current.compareRunCharts?.slice();\n\n        // Get all the currently visible cards (excluding hidden and deleted cards)\n        const visibleSectionCards = sourceSectionCards?.filter((chartCard) => visibleChartCards.includes(chartCard));\n\n        if (!resultChartsList || !visibleSectionCards) {\n          return current;\n        }\n\n        // Find the original position\n        const originalIndex = resultChartsList.findIndex((chartCard) => chartCard.uuid === draggedChartUuid);\n\n        // Clamp the target position index to the visible section cards\n        const clampedLocalPosition = Math.min(targetPosition, visibleSectionCards.length - 1);\n\n        // Map from the index in the section to a global index\n        const targetIndex = indexOf(resultChartsList, visibleSectionCards?.[clampedLocalPosition]);\n\n        // If we found the original index and the target index\n        if (resultChartsList && originalIndex !== -1 && targetIndex !== -1) {\n          // Remove the card from the original position\n          resultChartsList.splice(originalIndex, 1);\n          // Insert the card at the target position\n          resultChartsList.splice(targetIndex, 0, sourceCard);\n        }\n\n        return {\n          ...current,\n          compareRunCharts: resultChartsList,\n        };\n      } else {\n        // If we're moving card to a new section\n        const targetSectionCards = current.compareRunCharts?.filter(\n          (chart) => chart.metricSectionId === targetSectionId && !chart.deleted,\n        );\n\n        // Calculate the target position in the target section\n        if (targetSectionCards) {\n          targetSectionCards.splice(targetPosition, 0, sourceCard);\n        }\n\n        return {\n          ...current,\n          // Use the target position in the sorting function to determine the new position\n          compareRunCharts: sortBy(current.compareRunCharts, (a) => targetSectionCards?.indexOf(a) ?? -1).map(\n            (chart) => {\n              // Also, update the metricSectionId of the dragged card\n              if (chart.uuid === sourceCard.uuid) {\n                return {\n                  ...chart,\n                  metricSectionId: targetSectionId,\n                };\n              }\n              return chart;\n            },\n          ),\n          compareRunSections: current.compareRunSections?.map((section) => {\n            if (section.uuid === sourceSection?.uuid || section.uuid === targetSection?.uuid) {\n              return { ...section, isReordered: true };\n            }\n            return section;\n          }),\n        };\n      }\n    });\n  }, [updateChartsUIState, visibleChartCards]);\n\n  // For performance purposes, expose two different contexts:\n  // one for state (changing but rarely consumed) and one for actions (static but consumed often)\n  const stateContextValue = useMemo(\n    () => ({\n      draggedCardUuid,\n      targetSection: targetSectionUuid,\n      isDragging,\n    }),\n    [draggedCardUuid, targetSectionUuid, isDragging],\n  );\n\n  const actionsContextValue = useMemo(\n    () => ({\n      setDraggedCardUuid,\n      setTargetSection: setTargetSectionUuid,\n      setTargetPosition,\n      onDropChartCard,\n      onSwapCards,\n    }),\n    [onDropChartCard, onSwapCards, setTargetPosition],\n  );\n\n  return (\n    <DragAndDropProvider>\n      <RunsChartsDraggableGridStateContext.Provider value={stateContextValue}>\n        <RunsChartsDraggableGridActionsContext.Provider value={actionsContextValue}>\n          {children}\n        </RunsChartsDraggableGridActionsContext.Provider>\n      </RunsChartsDraggableGridStateContext.Provider>\n    </DragAndDropProvider>\n  );\n};\n","import { isNil } from 'lodash';\nimport {\n  Button,\n  CloseIcon,\n  PinIcon,\n  PinFillIcon,\n  LegacyTooltip,\n  VisibleIcon,\n  Typography,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from '../../../../common/utils/RoutingUtils';\nimport Routes from '../../../routes';\nimport { useExperimentIds } from '../../experiment-page/hooks/useExperimentIds';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport {\n  RunsChartsTooltipBodyProps,\n  RunsChartsTooltipMode,\n  containsMultipleRunsTooltipData,\n} from '../hooks/useRunsChartsTooltip';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n} from '../runs-charts.types';\nimport {\n  type RunsCompareMultipleTracesTooltipData,\n  type RunsMetricsSingleTraceTooltipData,\n} from './RunsMetricsLinePlot';\nimport { RunsMultipleTracesTooltipBody } from './RunsMultipleTracesTooltipBody';\nimport { shouldEnableRelativeTimeDateAxis } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { customMetricBehaviorDefs } from '../../experiment-page/utils/customMetricBehaviorUtils';\n\ninterface RunsChartsContextMenuContentDataType {\n  runs: RunsChartsRunData[];\n  onTogglePin?: (runUuid: string) => void;\n  onHideRun?: (runUuid: string) => void;\n  getDataTraceLink?: (experimentId: string, traceUuid: string) => string;\n}\n\ntype RunsChartContextMenuHoverDataType = RunsChartsCardConfig;\n\nconst createBarChartValuesBox = (cardConfig: RunsChartsBarCardConfig, activeRun: RunsChartsRunData) => {\n  const { metricKey, dataAccessKey } = cardConfig;\n\n  const dataKey = dataAccessKey ?? metricKey;\n\n  const metric = activeRun?.metrics[dataKey];\n\n  if (!metric) {\n    return null;\n  }\n\n  const customMetricBehaviorDef = customMetricBehaviorDefs[metric.key];\n  const displayName = customMetricBehaviorDef?.displayName ?? metric.key;\n  const displayValue = customMetricBehaviorDef?.valueFormatter({ value: metric.value }) ?? metric.value;\n\n  return (\n    <div css={styles.value}>\n      <strong>{displayName}:</strong> {displayValue}\n    </div>\n  );\n};\n\nconst createScatterChartValuesBox = (cardConfig: RunsChartsScatterCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis } = cardConfig;\n  const xKey = xaxis.dataAccessKey ?? xaxis.key;\n  const yKey = xaxis.dataAccessKey ?? yaxis.key;\n\n  const xLabel = xaxis.key;\n  const yLabel = yaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xLabel}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yLabel}):</strong> {yValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst createContourChartValuesBox = (cardConfig: RunsChartsContourCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis, zaxis } = cardConfig;\n  const xKey = xaxis.key;\n  const yKey = yaxis.key;\n  const zKey = zaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  const zValue = zaxis.type === 'METRIC' ? activeRun.metrics[zKey]?.value : activeRun.params[zKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xKey}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yKey}):</strong> {yValue}\n        </div>\n      )}\n      {zValue && (\n        <div css={styles.value}>\n          <strong>Z ({zKey}):</strong> {zValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst normalizeRelativeTimeChartTooltipValue = (value: string | number) => {\n  if (typeof value === 'number') {\n    return value;\n  }\n  return value.split(' ')[1] || '00:00:00';\n};\n\nconst getTooltipXValue = (\n  hoverData: RunsMetricsSingleTraceTooltipData | undefined,\n  xAxisKey: RunsChartsLineChartXAxisType,\n) => {\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    return hoverData?.xValue ?? '';\n  }\n\n  if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    return normalizeRelativeTimeChartTooltipValue(hoverData?.xValue ?? '');\n  }\n\n  // Default return for other cases\n  return hoverData?.xValue;\n};\n\nconst createLineChartValuesBox = (\n  cardConfig: RunsChartsLineCardConfig,\n  activeRun: RunsChartsRunData,\n  hoverData?: RunsMetricsSingleTraceTooltipData,\n) => {\n  const { metricKey: metricKeyFromConfig, xAxisKey } = cardConfig;\n  const metricKey = hoverData?.metricEntity?.key || metricKeyFromConfig;\n\n  // If there's available value from x axis (step or time), extract entry from\n  // metric history instead of latest metric.\n  const metricValue = hoverData?.yValue ?? activeRun?.metrics[metricKey].value;\n\n  if (isNil(metricValue)) {\n    return null;\n  }\n\n  const xValue = getTooltipXValue(hoverData, xAxisKey);\n  return (\n    <>\n      {hoverData && (\n        <div css={styles.value}>\n          <strong>{hoverData.label}:</strong> {xValue}\n        </div>\n      )}\n      <div css={styles.value}>\n        <strong>{metricKey}:</strong> {metricValue}\n      </div>\n    </>\n  );\n};\n\nconst createParallelChartValuesBox = (\n  cardConfig: RunsChartsParallelCardConfig,\n  activeRun: RunsChartsRunData,\n  isHovering?: boolean,\n) => {\n  const { selectedParams, selectedMetrics } = cardConfig as RunsChartsParallelCardConfig;\n  const paramsList = selectedParams.map((paramKey) => {\n    const param = activeRun?.params[paramKey];\n    if (param) {\n      return (\n        <div key={paramKey}>\n          <strong>{param.key}:</strong> {param.value}\n        </div>\n      );\n    }\n    return true;\n  });\n  const metricsList = selectedMetrics.map((metricKey) => {\n    const metric = activeRun?.metrics[metricKey];\n    if (metric) {\n      return (\n        <div key={metricKey}>\n          <strong>{metric.key}:</strong> {metric.value}\n        </div>\n      );\n    }\n    return true;\n  });\n\n  // show only first 3 params and primary metric if hovering, else show all\n  if (isHovering) {\n    return (\n      <>\n        {paramsList.slice(0, 3)}\n        {(paramsList.length > 3 || metricsList.length > 1) && <div>...</div>}\n        {metricsList[metricsList.length - 1]}\n      </>\n    );\n  } else {\n    return (\n      <>\n        {paramsList}\n        {metricsList}\n      </>\n    );\n  }\n};\n\n/**\n * Internal component that displays metrics/params - its final design\n * is a subject to change\n */\nconst ValuesBox = ({\n  activeRun,\n  cardConfig,\n  isHovering,\n  hoverData,\n}: {\n  activeRun: RunsChartsRunData;\n  cardConfig: RunsChartsCardConfig;\n  isHovering?: boolean;\n  hoverData?: RunsMetricsSingleTraceTooltipData;\n}) => {\n  if (cardConfig.type === RunsChartType.BAR) {\n    return createBarChartValuesBox(cardConfig as RunsChartsBarCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.SCATTER) {\n    return createScatterChartValuesBox(cardConfig as RunsChartsScatterCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.CONTOUR) {\n    return createContourChartValuesBox(cardConfig as RunsChartsContourCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.LINE) {\n    return createLineChartValuesBox(cardConfig as RunsChartsLineCardConfig, activeRun, hoverData);\n  }\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return createParallelChartValuesBox(cardConfig as RunsChartsParallelCardConfig, activeRun, isHovering);\n  }\n\n  return null;\n};\n\nexport const RunsChartsTooltipBody = ({\n  closeContextMenu,\n  contextData,\n  hoverData,\n  chartData,\n  runUuid,\n  isHovering,\n  mode,\n}: RunsChartsTooltipBodyProps<\n  RunsChartsContextMenuContentDataType,\n  RunsChartContextMenuHoverDataType,\n  RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData\n>) => {\n  const { runs, onTogglePin, onHideRun, getDataTraceLink } = contextData;\n  const [experimentId] = useExperimentIds();\n  const activeRun = runs?.find((run) => run.uuid === runUuid);\n\n  if (\n    containsMultipleRunsTooltipData(hoverData) &&\n    mode === RunsChartsTooltipMode.MultipleTracesWithScanline &&\n    isHovering\n  ) {\n    return <RunsMultipleTracesTooltipBody hoverData={hoverData} />;\n  }\n\n  const singleTraceHoverData = containsMultipleRunsTooltipData(hoverData) ? hoverData.hoveredDataPoint : hoverData;\n\n  if (!activeRun) {\n    return null;\n  }\n\n  const runName = activeRun.displayName || activeRun.uuid;\n  const metricSuffix = singleTraceHoverData?.metricEntity ? ` (${singleTraceHoverData.metricEntity.key})` : '';\n\n  return (\n    <div>\n      <div css={styles.contentWrapper}>\n        <div css={styles.header}>\n          <div css={styles.colorPill} style={{ backgroundColor: activeRun.color }} />\n          {activeRun.groupParentInfo ? (\n            <Typography.Text>{runName + metricSuffix}</Typography.Text>\n          ) : (\n            <Link\n              to={getDataTraceLink?.(experimentId, runUuid) ?? Routes.getRunPageRoute(experimentId, runUuid)}\n              target=\"_blank\"\n              css={styles.runLink}\n              onClick={closeContextMenu}\n            >\n              {runName + metricSuffix}\n            </Link>\n          )}\n        </div>\n        {!isHovering && (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_259\"\n            size=\"small\"\n            onClick={closeContextMenu}\n            icon={<CloseIcon />}\n          />\n        )}\n      </div>\n\n      <ValuesBox\n        isHovering={isHovering}\n        activeRun={activeRun}\n        cardConfig={chartData}\n        hoverData={singleTraceHoverData}\n      />\n\n      <div css={styles.actionsWrapper}>\n        {activeRun.pinnable && onTogglePin && (\n          <LegacyTooltip\n            title={\n              activeRun.pinned ? (\n                <FormattedMessage\n                  defaultMessage=\"Unpin run\"\n                  description=\"A tooltip for the pin icon button in the runs table next to the pinned run\"\n                />\n              ) : (\n                <FormattedMessage\n                  defaultMessage=\"Click to pin the run\"\n                  description=\"A tooltip for the pin icon button in the runs chart tooltip next to the not pinned run\"\n                />\n              )\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_282\"\n              size=\"small\"\n              onClick={() => {\n                onTogglePin(runUuid);\n                closeContextMenu();\n              }}\n              icon={activeRun.pinned ? <PinFillIcon /> : <PinIcon />}\n            />\n          </LegacyTooltip>\n        )}\n        {onHideRun && (\n          <LegacyTooltip\n            title={\n              <FormattedMessage\n                defaultMessage=\"Click to hide the run\"\n                description='A tooltip for the \"hide\" icon button in the runs chart tooltip'\n              />\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_302\"\n              data-testid=\"experiment-view-compare-runs-tooltip-visibility-button\"\n              size=\"small\"\n              onClick={() => {\n                onHideRun(runUuid);\n                closeContextMenu();\n              }}\n              icon={<VisibleIcon />}\n            />\n          </LegacyTooltip>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst styles = {\n  runLink: (theme: Theme) => ({\n    color: theme.colors.primary,\n    '&:hover': {},\n  }),\n  actionsWrapper: {\n    marginTop: 8,\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  header: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  value: {\n    whiteSpace: 'nowrap' as const,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  contentWrapper: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n    marginBottom: 12,\n    justifyContent: 'space-between',\n    height: 24,\n  },\n  colorPill: { width: 12, height: 12, borderRadius: '100%' },\n};\n","var _path, _path2;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartLine({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 22,\n    height: 22,\n    viewBox: \"0 0 22 22\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.38977 15.717L8.79655 10.8113L12.5254 14.9622L19.644 7.03772\",\n    stroke: \"#338ECC\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V21H21\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartLine);\nexport default __webpack_public_path__ + \"static/media/chart-line.0adaa2036bb4eb5956db6d0c7e925a3d.svg\";\nexport { ForwardRef as ReactComponent };","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { Figure } from 'react-plotly.js';\nimport type {\n  LineChartTraceData,\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsLinePlotProps,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { compact, isNumber, isString, isUndefined, orderBy, throttle, uniq } from 'lodash';\nimport type { LegendLabelData } from '../components/RunsMetricsLegend';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\n\n// Plotly-specific selectors for finding particular elements of interest in the plot DOM structure\nconst PLOTLY_SVG_SELECTOR = '.main-svg';\nconst PLOTLY_DRAGLAYER_SELECTOR = '.main-svg .draglayer .nsewdrag';\n\n// Interval for throttling the tooltip data update handler\nconst TOOLTIP_DATA_UPDATE_INTERVAL = 50;\n\n/**\n * Utility function, parses the microseconds from the plotly's axis boundary string\n * which are not supported by JavaScript's Date object and have to be added manually.\n *\n * E.g. transforms 2024-02-02 14:35:37.5747 into 0.7\n */\nconst parseMicroseconds = (plotlyAxisBoundary: string) => {\n  const microsecondsString =\n    isString(plotlyAxisBoundary) && plotlyAxisBoundary.match(/[0-9]{2}:[0-9]{2}:[0-9]{2}\\.([0-9]+)/)?.[1];\n  if (!microsecondsString) {\n    return 0;\n  }\n\n  // We turn the microseconds into a fraction of a millisecond, e.g. 0.5743 -> 574.3 -> 0.3\n  return (Number(`0.${microsecondsString}`) * 1000) % 1;\n};\n\nexport const useRunsMultipleTracesTooltipData = ({\n  onUnhover,\n  onHover,\n  runsData,\n  plotData,\n  legendLabelData,\n  containsMultipleMetricKeys,\n  xAxisKeyLabel,\n  xAxisKey,\n  disabled = false,\n  setHoveredPointIndex,\n  xAxisScaleType = 'linear',\n  positionInSection = 0,\n}: Pick<RunsMetricsLinePlotProps, 'runsData' | 'onHover' | 'onUnhover'> & {\n  plotData: LineChartTraceData[];\n  legendLabelData: LegendLabelData[];\n  containsMultipleMetricKeys?: boolean;\n  xAxisKeyLabel: string;\n  disabled?: boolean;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  setHoveredPointIndex: (value: number) => void;\n  xAxisScaleType?: 'linear' | 'log';\n  positionInSection?: number;\n}) => {\n  // Save current boundaries/dimensions of the plot in the mutable ref object\n  const chartBoundaries = useRef<{\n    containerLeftPixels: number;\n    plotWidthPixels: number;\n    plotOffsetPixels: number;\n    lowerBoundValue: number;\n    valueRange: number;\n    mainContainer: SVGElement | null;\n    dragLayer: SVGElement | null;\n    initialized: boolean;\n  }>({\n    containerLeftPixels: 0,\n    plotWidthPixels: 0,\n    plotOffsetPixels: 0,\n    lowerBoundValue: 0,\n    valueRange: 0,\n    mainContainer: null,\n    dragLayer: null,\n    initialized: false,\n  });\n\n  // Keep the reference to the scanline element\n  const scanlineElementRef = useRef<HTMLDivElement>(null);\n\n  // Keep the reference to the current hovered trace data\n  const currentHoveredDataPoint = useRef<RunsMetricsSingleTraceTooltipData | undefined>(undefined);\n\n  // Calculate all visible X values each time the plot data changes\n  const visibleXValues = useMemo(() => uniq(plotData.map(({ x }) => x).flat()) as number[], [plotData]);\n\n  // Store the reference to the initialized plotly's figure object, helps keep track when the plot is initialized\n  const [initializedFigure, setInitializedFigure] = useState<{\n    figure: Readonly<Figure>;\n    graphDiv: Readonly<HTMLElement>;\n  } | null>(null);\n\n  // We are calculating the tooltip data outside of React to avoid unnecessary re-renders,\n  // so we're copying all the input data to the mutable ref objects\n  const immediateHoverData = useRef<RunsCompareMultipleTracesTooltipData | undefined>(undefined);\n  const immediateLegendLabelData = useRef(legendLabelData);\n  const immediateRunsData = useRef(runsData);\n  const immediatePlotData = useRef(plotData);\n  const immediateXValuesData = useRef(visibleXValues);\n  const immediateFigure = useRef(initializedFigure);\n\n  // Update the mutable ref objects when the input data changes\n  immediateLegendLabelData.current = legendLabelData;\n  immediateRunsData.current = runsData;\n  immediatePlotData.current = plotData;\n  immediateXValuesData.current = visibleXValues;\n  immediateFigure.current = initializedFigure;\n\n  // Setup the boundaries of the plot\n  const setupBoundaries = useCallback((figure: Readonly<Figure>) => {\n    const lowerAxisValue = figure.layout.xaxis?.range?.[0];\n    const upperAxisValue = figure.layout.xaxis?.range?.[1];\n\n    // If the axis values are numbers, use them as is, otherwise convert them to timestamps\n    let lowerBoundary = isNumber(lowerAxisValue) ? lowerAxisValue : new Date(lowerAxisValue ?? 0).getTime();\n    let upperBoundary = isNumber(upperAxisValue) ? upperAxisValue : new Date(upperAxisValue ?? 0).getTime();\n\n    lowerBoundary += parseMicroseconds(lowerAxisValue);\n    upperBoundary += parseMicroseconds(upperAxisValue);\n\n    // Save the boundaries to the mutable ref object\n    chartBoundaries.current.lowerBoundValue = lowerBoundary ?? 0;\n    chartBoundaries.current.valueRange = (upperBoundary ?? 0) - chartBoundaries.current.lowerBoundValue;\n  }, []);\n\n  const updateContainerPosition = useCallback(() => {\n    const { mainContainer, dragLayer } = chartBoundaries.current;\n\n    if (mainContainer && dragLayer) {\n      const containerRect = mainContainer.getBoundingClientRect();\n      const dragLayerRect = dragLayer.getBoundingClientRect();\n\n      // Save the boundaries to the mutable ref object\n      chartBoundaries.current.containerLeftPixels = containerRect.x;\n      chartBoundaries.current.plotWidthPixels = dragLayerRect.width;\n      chartBoundaries.current.plotOffsetPixels = dragLayerRect.x - containerRect.x;\n      chartBoundaries.current.initialized = dragLayerRect.width > 0;\n    }\n  }, []);\n\n  // This is a handler of plotly's onUpdate callback.\n  // It is called when the plot is initialized and when the plot is updated.\n  const onUpdatePlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setupBoundaries(figure);\n\n      const mainContainer: SVGElement | null = graphDiv.querySelector(PLOTLY_SVG_SELECTOR);\n      const dragLayer: SVGElement | null = graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n      chartBoundaries.current.mainContainer = mainContainer;\n      chartBoundaries.current.dragLayer = dragLayer;\n      updateContainerPosition();\n    },\n    [setupBoundaries, updateContainerPosition],\n  );\n\n  // This is a handler of plotly's onInit callback.\n  const onInitPlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setInitializedFigure({ figure, graphDiv });\n      onUpdatePlotHandler(figure, graphDiv);\n    },\n    [onUpdatePlotHandler],\n  );\n\n  useEffect(() => {\n    // Recalculate positions after chart has been moved\n    requestAnimationFrame(() => {\n      if (!immediateFigure.current) {\n        return;\n      }\n      onUpdatePlotHandler(immediateFigure.current.figure, immediateFigure.current.graphDiv);\n    });\n  }, [positionInSection, onUpdatePlotHandler]);\n\n  // Hides the scanline when the mouse leaves the plot\n  const pointerLeavePlotCallback = useCallback(\n    (e: PointerEvent) => {\n      // Noop if the mouse is moving to plotly's dragcover element\n      if (e.relatedTarget instanceof Element && e.relatedTarget.classList.contains('dragcover')) {\n        return;\n      }\n      onUnhover?.();\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'none';\n      }\n    },\n    [onUnhover],\n  );\n\n  // This is a handler of plotly's onHover callback.\n  const onPointHoverCallback = useCallback(\n    ({ points }) => {\n      const hoveredPoint = points[0];\n      const hoveredPointData = hoveredPoint?.data;\n\n      setHoveredPointIndex(hoveredPoint?.curveNumber ?? -1);\n\n      if (!hoveredPointData) {\n        return;\n      }\n\n      // Extract metric entity\n      const metricEntity = hoveredPointData.metricHistory?.[hoveredPoint.pointIndex];\n\n      const singleTraceData: RunsMetricsSingleTraceTooltipData = {\n        // Value of the \"x\" axis (time, step)\n        xValue: hoveredPoint.x,\n        // Value of the \"y\" axis\n        yValue: hoveredPoint.y,\n        // Metric entity value\n        metricEntity,\n        // The index of the X datum\n        index: hoveredPoint.pointIndex,\n        // Current label (\"Step\", \"Time\" etc.)\n        label: xAxisKeyLabel,\n        // Run/group UUID\n        traceUuid: hoveredPointData.uuid,\n      };\n\n      // Save the hovered point/trace data to the mutable ref object\n      currentHoveredDataPoint.current = singleTraceData;\n    },\n    [xAxisKeyLabel, setHoveredPointIndex],\n  );\n\n  // This is a handler of plotly's onUnhover callback.\n  const onPointUnhoverCallback = useCallback(() => {\n    currentHoveredDataPoint.current = undefined;\n    setHoveredPointIndex(-1);\n  }, [setHoveredPointIndex]);\n\n  const getClosestXValue = useCallback(\n    (pointerClientX: number) => {\n      const boundaries = chartBoundaries.current;\n      // Calculate the X value of the hovered point\n      const resultX =\n        (pointerClientX - boundaries.plotOffsetPixels - boundaries.containerLeftPixels) / boundaries.plotWidthPixels;\n\n      // Calculate the current step based on the X value and precalculated boundaries\n      let currentStep = boundaries.lowerBoundValue + boundaries.valueRange * resultX;\n      if (xAxisScaleType === 'log') {\n        currentStep = 10 ** currentStep;\n      }\n      // Find the closest existing X value to the currently hovered value\n      const closestXValue = immediateXValuesData.current.reduce((acc, x) => {\n        if (Math.abs(x - currentStep) < Math.abs(acc - currentStep)) {\n          return x;\n        }\n        return acc;\n      }, immediateXValuesData.current[0]);\n      return closestXValue;\n    },\n    [xAxisScaleType],\n  );\n\n  useEffect(() => {\n    // Return early if this tooltip is disabled\n    if (disabled) {\n      return;\n    }\n    // Return early if the figure is not initialized yet\n    if (!initializedFigure) {\n      return;\n    }\n\n    // Setup the boundaries of the plot at the beginning\n    setupBoundaries(initializedFigure.figure);\n\n    // Get the drag layer element - this is the event-sensitive layer of rendered plotly chart\n    const dragLayer: SVGElement | null = initializedFigure.graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n    // This is a throttled handler of the pointermove event, it contains some heavier logic so it's throttled for 50ms\n    const tooltipDataUpdateHandler = throttle(\n      (e: PointerEvent) => {\n        // If for some reason the chart sizing is not initialized yet, do it now\n        if (!chartBoundaries.current.initialized) {\n          updateContainerPosition();\n        }\n        const closestXValue = getClosestXValue(e.clientX);\n\n        // Calculate the tooltip data - based on existing legend, plot and runs data\n        const data = immediateLegendLabelData.current.map((legendEntry) => {\n          // First, find the corresponding data entry (from chart components's input data) and trace (from data prepared for plotly)\n          const correspondingDataEntry = immediateRunsData.current.find(({ uuid }) => uuid === legendEntry.uuid);\n          const correspondingDataTrace = immediatePlotData.current.find(\n            ({ uuid, metricKey }) => uuid === legendEntry.uuid && legendEntry.metricKey === metricKey,\n          );\n\n          if (!correspondingDataTrace) {\n            return undefined;\n          }\n\n          // Determine the display name of the metric - if there are multiple metrics, use the legend label,\n          // otherwise use the display name of the corresponding data entry.\n          const displayName = containsMultipleMetricKeys ? legendEntry.label : correspondingDataEntry?.displayName;\n\n          // Find the value of the corresponding data trace at the closest X value\n          const xIndex = correspondingDataTrace.x?.indexOf(closestXValue);\n          if (isUndefined(xIndex) || xIndex === -1) {\n            return undefined;\n          }\n          const value = correspondingDataTrace.y?.[xIndex];\n\n          // Construct the tooltip legend entry\n          return {\n            displayName: displayName || '',\n            value: isNumber(value) ? value : undefined,\n            color: legendEntry?.color,\n            dashStyle: legendEntry?.dashStyle,\n            uuid: `${legendEntry.uuid}.${legendEntry.metricKey}`,\n          };\n        });\n\n        // Save the tooltip data to the mutable ref object\n        immediateHoverData.current = {\n          tooltipLegendItems: orderBy(compact(data), 'value', 'desc'),\n          hoveredDataPoint: currentHoveredDataPoint?.current,\n          xValue: closestXValue,\n          xAxisKey,\n          xAxisKeyLabel,\n        };\n      },\n      TOOLTIP_DATA_UPDATE_INTERVAL,\n      { leading: true },\n    );\n\n    const windowResizeHandler = throttle(updateContainerPosition, TOOLTIP_DATA_UPDATE_INTERVAL);\n\n    // This is a handler of the pointermove event.\n    // It's not throttled: it just updates the scanline and tooltip position and pass precalculated tooltip data\n    const hoverHandler = (e: PointerEvent) => {\n      if (!immediateHoverData.current) {\n        return;\n      }\n\n      const boundaries = chartBoundaries.current;\n      const closestXValue = getClosestXValue(e.clientX);\n      const closestXValueLeftX =\n        ((xAxisScaleType === 'log' ? Math.log10(closestXValue) : closestXValue) - boundaries.lowerBoundValue) /\n        boundaries.valueRange;\n      const closestXValueLeftInPixels = closestXValueLeftX * boundaries.plotWidthPixels;\n\n      // Enable and reposition the scanline\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'block';\n        scanlineElementRef.current.style.left = `${boundaries.plotOffsetPixels + closestXValueLeftInPixels}px`;\n      }\n\n      onHover?.(\n        immediateHoverData.current?.hoveredDataPoint?.traceUuid || '',\n        {\n          x: boundaries.containerLeftPixels + boundaries.plotOffsetPixels + closestXValueLeftInPixels,\n          y: e.clientY,\n          originalEvent: e,\n        },\n        immediateHoverData.current,\n      );\n    };\n\n    if (dragLayer) {\n      // Assign two separate handlers for move: one for updating the tooltip data, one for updating the scanline and tooltip position\n      dragLayer.addEventListener('pointermove', tooltipDataUpdateHandler);\n      dragLayer.addEventListener('pointermove', hoverHandler);\n      window.addEventListener('resize', windowResizeHandler);\n\n      // Assign a handler that hides the scanline and tooltip\n      dragLayer.addEventListener('pointerleave', pointerLeavePlotCallback);\n      return () => {\n        dragLayer.removeEventListener('pointermove', tooltipDataUpdateHandler);\n        dragLayer.removeEventListener('pointermove', hoverHandler);\n        dragLayer.removeEventListener('pointerleave', pointerLeavePlotCallback);\n        window.removeEventListener('resize', windowResizeHandler);\n      };\n    }\n\n    return () => {};\n  }, [\n    pointerLeavePlotCallback,\n    initializedFigure,\n    setupBoundaries,\n    onHover,\n    containsMultipleMetricKeys,\n    currentHoveredDataPoint,\n    disabled,\n    xAxisKey,\n    xAxisKeyLabel,\n    xAxisScaleType,\n    getClosestXValue,\n    updateContainerPosition,\n  ]);\n\n  const scanlineElement = disabled ? null : (\n    <div\n      css={{\n        top: 0,\n        width: 0,\n        borderLeft: `1px dashed rgba(0,0,0,0.5)`,\n        height: '100%',\n        position: 'absolute',\n        pointerEvents: 'none',\n      }}\n      ref={scanlineElementRef}\n      style={{ display: 'none' }}\n    />\n  );\n\n  return {\n    updateHandler: onUpdatePlotHandler,\n    initHandler: onInitPlotHandler,\n    scanlineElement,\n    onPointHover: onPointHoverCallback,\n    onPointUnhover: onPointUnhoverCallback,\n  };\n};\n","import { intersection } from 'lodash';\nimport { MetricEntity } from '../../../types';\nimport { RunsChartsLineChartXAxisType, RunsChartsRunData } from '../components/RunsCharts.common';\nimport { RunsMetricsLinePlotProps } from '../components/RunsMetricsLinePlot';\nimport { RunsChartsLineChartExpression } from '../runs-charts.types';\n\nconst getCompareValue = (element: MetricEntity, xAxisKey: RunsMetricsLinePlotProps['xAxisKey']) => {\n  if (xAxisKey === RunsChartsLineChartXAxisType.STEP) {\n    // If xAxisKey is steps, we match along step\n    return element.step;\n  } else if (\n    xAxisKey === RunsChartsLineChartXAxisType.TIME ||\n    xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE\n  ) {\n    // If xAxisKey is time, we match along timestamp\n    return element.timestamp;\n  }\n  return null;\n};\n\nexport const getExpressionChartsSortedMetricHistory = ({\n  expression,\n  runEntry,\n  evaluateExpression,\n  xAxisKey,\n}: {\n  expression: RunsChartsLineChartExpression;\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  evaluateExpression: (\n    expression: RunsChartsLineChartExpression,\n    variables: Record<string, number>,\n  ) => number | undefined;\n  xAxisKey: RunsMetricsLinePlotProps['xAxisKey'];\n}) => {\n  const xDataPointsPerVariable = expression.variables.map((variable) => {\n    const elements = runEntry.metricsHistory?.[variable];\n    if (elements !== undefined) {\n      return elements.flatMap((element) => {\n        const compareValue = getCompareValue(element, xAxisKey);\n        if (compareValue !== null) {\n          return [compareValue];\n        }\n        return [];\n      });\n    }\n    return [];\n  });\n  const xDataPoints = intersection(...xDataPointsPerVariable);\n  xDataPoints.sort((a, b) => a - b); // ascending\n\n  // For each xDataPoint, extract variables and evaluate expression\n  return xDataPoints.flatMap((xDataPoint) => {\n    const variables = expression.variables.reduce((obj, variable) => {\n      const elements = runEntry.metricsHistory?.[variable];\n      const value = elements?.find((element) => getCompareValue(element, xAxisKey) === xDataPoint)?.value;\n      if (value !== undefined) {\n        obj[variable] = value;\n      }\n      return obj;\n    }, {} as Record<string, number>);\n\n    const expressionValue = evaluateExpression(expression, variables);\n    if (expressionValue !== undefined) {\n      return [\n        {\n          value: expressionValue,\n          key: expression.expression,\n          ...(xAxisKey === RunsChartsLineChartXAxisType.STEP || xAxisKey === RunsChartsLineChartXAxisType.METRIC\n            ? { step: xDataPoint, timestamp: 0 }\n            : { timestamp: xDataPoint, step: 0 }),\n        },\n      ];\n    }\n    return [];\n  });\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { isEmpty, isEqual, isNumber, maxBy, minBy } from 'lodash';\nimport type { Config, Dash, Data as PlotlyData, Layout, LayoutAxis } from 'plotly.js';\nimport { type Figure } from 'react-plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { MetricEntity } from '../../../types';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightLineTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLineChartLegendData,\n  lineDashStyles,\n  containsDuplicateXValues,\n  createFadedTraceColor,\n  getChartAxisLabelDescriptor,\n  RunsChartsLineChartXAxisType,\n} from './RunsCharts.common';\nimport { EMA } from '../../MetricsPlotView';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport {\n  shouldEnableRelativeTimeDateAxis,\n  shouldEnableChartExpressions,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { useRunsMultipleTracesTooltipData } from '../hooks/useRunsChartsMultipleTracesTooltip';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport {\n  EPOCH_RELATIVE_TIME,\n  HOUR_IN_MILLISECONDS,\n  LINE_CHART_RELATIVE_TIME_THRESHOLD,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { type RunsChartsLineChartExpression, RunsChartsLineChartYAxisType } from '../runs-charts.types';\nimport { useChartExpressionParser } from '../hooks/useChartExpressionParser';\nimport { getExpressionChartsSortedMetricHistory } from '../utils/expressionCharts.utils';\nimport { RunsChartCardLoadingPlaceholder } from './cards/ChartCard.common';\n\nexport type LineChartTraceData = PlotlyData & {\n  x?: number[] | undefined;\n  y?: number[];\n  uuid?: string;\n  metricKey?: string;\n};\n\n// Display markers only if there are less than 60 points in the single data trace\nconst MARKER_DISPLAY_THRESHOLD = 60;\n\nconst getDataTraceForRun = ({\n  runEntry,\n  metricKey,\n  xAxisKey,\n  selectedXAxisMetricKey,\n  useDefaultHoverBox,\n  lineSmoothness,\n  lineShape,\n  lineDash,\n  displayPoints,\n  displayOriginalLine: originalLine,\n  xAxisScaleType,\n  expression,\n  evaluateExpression,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey?: RunsMetricsLinePlotProps['metricKey'];\n  xAxisKey: RunsMetricsLinePlotProps['xAxisKey'];\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n  useDefaultHoverBox: RunsMetricsLinePlotProps['useDefaultHoverBox'];\n  lineSmoothness: RunsMetricsLinePlotProps['lineSmoothness'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  lineDash?: Dash;\n  displayPoints?: boolean;\n  displayOriginalLine?: boolean;\n  xAxisScaleType?: 'linear' | 'log';\n  expression?: RunsChartsLineChartExpression;\n  evaluateExpression?: (\n    expression: RunsChartsLineChartExpression,\n    variables: Record<string, number>,\n  ) => number | undefined;\n}): LineChartTraceData => {\n  if (!runEntry.metricsHistory) {\n    return {};\n  }\n\n  let sortedMetricsHistory: MetricEntity[] = [];\n  if (expression && evaluateExpression) {\n    sortedMetricsHistory = getExpressionChartsSortedMetricHistory({\n      expression,\n      runEntry,\n      evaluateExpression,\n      xAxisKey,\n    });\n  } else if (metricKey !== undefined) {\n    sortedMetricsHistory = runEntry.metricsHistory[metricKey]?.sort((a, b) =>\n      xAxisKey === RunsChartsLineChartXAxisType.STEP ? a.step - b.step : a.timestamp - b.timestamp,\n    );\n  } else {\n    return {};\n  }\n\n  let xValues;\n  let yValues;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    const ySteps = new Set((sortedMetricsHistory ?? []).map(({ step }) => step));\n    const xValuesWithSteps = prepareXAxisDataForMetricType(ySteps, runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map(({ step }) => step);\n    const xSteps = new Set(stepOrder);\n    const yValueHistory = orderBySteps(sortedMetricsHistory ?? [], stepOrder).filter(({ step }) => xSteps.has(step));\n\n    xValues = xValuesWithSteps.map(({ value }) => value);\n    yValues = yValueHistory.map(({ value }) => normalizeChartValue(value));\n  } else {\n    xValues = prepareMetricHistoryByAxisType(sortedMetricsHistory, xAxisKey);\n    yValues = sortedMetricsHistory?.map(({ value }) => normalizeChartValue(value));\n\n    if (xAxisScaleType === 'log') {\n      // If the log scale is used, we want to remove all <=0 values from X axis (and their corresponding Y values).\n      const firstNonZeroXIndex = xValues.findIndex((x) => x > 0);\n      if (firstNonZeroXIndex !== -1) {\n        xValues = xValues.slice(firstNonZeroXIndex);\n        yValues = yValues.slice(firstNonZeroXIndex);\n      }\n    }\n  }\n\n  // If there are any duplicate X values, use linear line shape\n  // to avoid bending splines in the wrong direction\n  const optimizedLineShape = containsDuplicateXValues(xValues) ? 'linear' : lineShape;\n\n  // Use chart card's configuration or if its unset, use the automatic behavior by checking the number of points\n  const shouldDisplayMarkers = !originalLine && (displayPoints ?? xValues.length < MARKER_DISPLAY_THRESHOLD);\n\n  const containsSingleValue = yValues?.length === 1;\n\n  const hoverinfo = (() => {\n    if (originalLine) {\n      return 'skip';\n    }\n    if (useDefaultHoverBox) {\n      return undefined;\n    }\n    return 'none';\n  })();\n\n  return {\n    // Let's add UUID to each run so it can be distinguished later (e.g. on hover)\n    uuid: runEntry.uuid,\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    // The actual value is on Y axis\n    y: EMA(yValues ?? [], originalLine ? 0 : lineSmoothness),\n    // Save the metric history\n    metricHistory: sortedMetricsHistory,\n    metricKey: metricKey || expression?.expression,\n    hovertext: runEntry.runInfo?.runName || '',\n    text: 'x',\n    textposition: 'outside',\n    textfont: {\n      size: 11,\n    },\n    mode: containsSingleValue || shouldDisplayMarkers ? 'lines+markers' : 'lines',\n    hovertemplate: useDefaultHoverBox ? createTooltipTemplate(runEntry.runInfo?.runName || '') : undefined,\n    hoverinfo,\n    hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n    type: 'scatter',\n    line: { dash: lineDash, shape: optimizedLineShape },\n    marker: {\n      color: originalLine ? createFadedTraceColor(runEntry.color, 0.15) : runEntry.color,\n    },\n  } as LineChartTraceData;\n};\n\nconst getBandTraceForRun = ({\n  runEntry,\n  metricKey,\n  lineShape,\n  xAxisKey,\n  selectedXAxisMetricKey,\n  xAxisScaleType,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey: RunsMetricsLinePlotProps['metricKey'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  xAxisKey: RunsChartsLineChartXAxisType;\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n  xAxisScaleType?: 'linear' | 'log';\n}): LineChartTraceData => {\n  if (!runEntry.aggregatedMetricsHistory) {\n    return {};\n  }\n\n  // Get upper and lower boundaries to draw a band\n  const { max, min } = runEntry.aggregatedMetricsHistory[metricKey];\n\n  let xMins, xMaxes, yMins, yMaxes;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    if (!runEntry.metricsHistory) {\n      return {};\n    }\n    const ySteps = new Set(max.map(({ step }) => step));\n    const xValuesWithSteps = prepareXAxisDataForMetricType(ySteps, runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map((e) => e.step);\n    const xSteps = new Set(stepOrder);\n    const xValues = xValuesWithSteps.map((e) => e.value);\n\n    yMins = orderBySteps(min, stepOrder)\n      .filter(({ step }) => xSteps.has(step))\n      .map(({ value }) => normalizeChartValue(value))\n      .reverse();\n    yMaxes = orderBySteps(max, stepOrder)\n      .filter(({ step }) => xSteps.has(step))\n      .map(({ value }) => normalizeChartValue(value));\n    xMins = xValues.slice().reverse();\n    xMaxes = xValues;\n  } else {\n    // Reverse one of the arrays so that the band is drawn correctly\n    const minReversed = min.slice().reverse();\n    xMins = prepareMetricHistoryByAxisType(minReversed, xAxisKey);\n    xMaxes = prepareMetricHistoryByAxisType(max, xAxisKey);\n    yMins = minReversed.map(({ value }) => normalizeChartValue(value));\n    yMaxes = max.map(({ value }) => normalizeChartValue(value));\n\n    if (xAxisScaleType === 'log') {\n      // If the log scale is used, we want to remove all <=0 values from X axis (and their corresponding Y values).\n      const firstNonZeroXIndex = xMaxes.findIndex((x) => isNumber(x) && x > 0);\n      const lastNonZeroXIndex = xMins.length - xMins.findIndex((x) => isNumber(x) && x > 0);\n      if (firstNonZeroXIndex !== -1 && lastNonZeroXIndex !== -1) {\n        xMaxes = xMaxes.slice(firstNonZeroXIndex);\n        yMaxes = yMaxes.slice(firstNonZeroXIndex);\n        xMins = xMins.slice(0, lastNonZeroXIndex - 1);\n        yMins = yMins.slice(0, lastNonZeroXIndex - 1);\n      }\n    }\n  }\n\n  // Place a null value in the middle to create a gap, otherwise Plotly will\n  // connect the lines and the fill will be drawn incorrectly\n  const xValues = [...xMins, null, ...xMaxes];\n  const bandValues = [...yMins, null, ...yMaxes];\n\n  return {\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    y: bandValues,\n    fillcolor: createFadedTraceColor(runEntry.color, 0.2),\n    hovertemplate: undefined,\n    hoverlabel: undefined,\n    hoverinfo: 'skip',\n    line: { color: 'transparent', shape: lineShape },\n    fill: 'tozeroy',\n    type: 'scatter',\n  } as LineChartTraceData;\n};\n\n/**\n * This function takes a list of metric entities and returns a copy ordered by\n * the step order provided. This is used in metric-type X axes, where the Y values\n * need to be ordered by the X values.\n *\n * For example:\n * dataPoints = [{step: 0, value: 1}, {step: 1, value: 2}, {step: 2, value: 3}]\n * stepOrder = [2, 0, 1]\n * return = [{step: 2, value: 3}, {step: 0, value: 1}, {step: 1, value: 2}]\n */\nconst orderBySteps = (dataPoints: MetricEntity[], stepOrder: number[]) => {\n  const stepIndexes = stepOrder.reduce((acc, step, idx) => {\n    acc[step] = idx;\n    return acc;\n  }, {} as Record<number, number>);\n\n  // if there's a step mismatch, send all non-existing values to the end\n  return dataPoints.slice().sort((a, b) => (stepIndexes[a.step] ?? Infinity) - (stepIndexes[b.step] ?? Infinity));\n};\n\nexport interface RunsMetricsSingleTraceTooltipData {\n  xValue: string | number;\n  yValue: number;\n  index: number;\n  label: string;\n  traceUuid?: string;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsCompareMultipleTracesTooltipData {\n  tooltipLegendItems: {\n    uuid: string;\n    color?: string;\n    dashStyle?: Dash;\n    displayName: string;\n    value?: string | number;\n  }[];\n  xValue: string | number;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  xAxisKeyLabel: string;\n  hoveredDataPoint?: RunsMetricsSingleTraceTooltipData;\n}\n\nexport interface RunsMetricsLinePlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   * NOTE: used only as a fallback in V2 charts\n   */\n  metricKey: string;\n\n  /**\n   * Determines which metric keys to display in V2 charts\n   * NOTE: this prop may not be present in V1 chart configs\n   */\n  selectedMetricKeys?: string[];\n\n  /**\n   * Smoothing factor for EMA\n   */\n  lineSmoothness?: number;\n\n  /**\n   * X axis mode\n   */\n  xAxisScaleType?: 'linear' | 'log';\n\n  /**\n   * Y axis mode\n   */\n  scaleType?: 'linear' | 'log';\n\n  /**\n   * Use spline or polyline. Spline is default mode.\n   */\n  lineShape?: 'linear' | 'spline';\n\n  /**\n   * Choose X axis mode - numeric step or absolute time\n   */\n  xAxisKey?: RunsChartsLineChartXAxisType;\n\n  /**\n   * Choose Y axis mode - metric or expressions\n   */\n  yAxisKey?: RunsChartsLineChartYAxisType;\n\n  /**\n   * Array of expressions to evaluate\n   */\n  yAxisExpressions?: RunsChartsLineChartExpression[];\n\n  /**\n   * Name of the metric to use for the X axis. Used when xAxisKey is set to 'metric'\n   */\n  selectedXAxisMetricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>[];\n\n  /**\n   * Currently visible range on x-axis.\n   */\n  xRange?: [number | string, number | string];\n\n  /**\n   * Currently visible range on y-axis\n   */\n  yRange?: [number | string, number | string];\n\n  /**\n   * If set to true, only x-axis can be zoomed by dragging\n   */\n  lockXAxisZoom?: boolean;\n\n  /**\n   * Display points on the line chart. Undefined means \"auto\" mode, i.e. display points only when\n   * there are fewer than 60 datapoints on the chart.\n   */\n  displayPoints?: boolean;\n\n  /**\n   * Current ordering of the chart in the list.\n   * Helps to recalculate tooltip legend repositioning in case of reordering.\n   */\n  positionInSection?: number;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  doubleClick: 'autosize',\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nconst createTooltipTemplate = (runName: string) =>\n  `<b>${runName}</b>:<br>` +\n  '<b>%{xaxis.title.text}:</b> %{x}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Prepares dataset's X axis according to selected visualization type: step, time-wall and time-relative\n *\n * NOTE: metric-type X axes are handled by `prepareXAxisDataForMetricType()`, since we need to retain\n *       step information in order to format the Y axis data correctly.\n */\nconst prepareMetricHistoryByAxisType = (\n  metricHistory?: MetricEntity[],\n  axisType?: RunsMetricsLinePlotProps['xAxisKey'],\n) => {\n  if (!metricHistory) {\n    return [];\n  }\n  if (axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      if (shouldEnableRelativeTimeDateAxis()) {\n        return metricHistory.map(({ timestamp }) => timestamp - minTimestamp + EPOCH_RELATIVE_TIME);\n      }\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / 1000); // Milliseconds -> seconds\n    }\n    return metricHistory.map(({ step }) => step);\n  } else if (shouldEnableRelativeTimeDateAxis() && axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / HOUR_IN_MILLISECONDS);\n    }\n  } else if (axisType === RunsChartsLineChartXAxisType.TIME) {\n    return metricHistory.map(({ timestamp }) => timestamp);\n  }\n\n  return metricHistory.map(({ step }) => step);\n};\n\n/**\n * Prepares dataset's X axis when axisType is 'metric'. This is separate from\n * `prepareMetricHistoryByAxisType` because we need to keep track of the `step`\n * in addition to the `value`, so that the Y axis data can be associated to the\n * correct X datapoint.\n */\nconst prepareXAxisDataForMetricType = (\n  ySteps: Set<number>,\n  metricHistory?: MetricEntity[],\n): Array<{\n  value: number | undefined;\n  step: number;\n}> => {\n  if (!metricHistory) {\n    return [];\n  }\n\n  return metricHistory\n    .filter((datapoint) => ySteps.has(datapoint.step))\n    .map((datapoint) => ({\n      value: normalizeChartValue(datapoint.value),\n      step: datapoint.step,\n    }))\n    .sort((a, b) => {\n      // sort by value in ascending order\n      return Number(a.value) - Number(b.value);\n    });\n};\n\nconst getXAxisPlotlyType = (\n  xAxisKey: RunsChartsLineChartXAxisType,\n  xAxisScaleType: 'linear' | 'log',\n  dynamicXAxisKey: RunsChartsLineChartXAxisType,\n) => {\n  if (\n    xAxisKey === RunsChartsLineChartXAxisType.TIME ||\n    (shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE)\n  ) {\n    return 'date';\n  }\n  if (xAxisKey === RunsChartsLineChartXAxisType.STEP && xAxisScaleType === 'log') {\n    return 'log';\n  }\n  return 'linear';\n};\n\n/**\n * Implementation of plotly.js chart displaying\n * line plot comparing metrics' history for a given\n * set of experiments runs\n */\nexport const RunsMetricsLinePlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    selectedMetricKeys,\n    scaleType = 'linear',\n    xAxisScaleType = 'linear',\n    xAxisKey = RunsChartsLineChartXAxisType.STEP,\n    yAxisKey = RunsChartsLineChartYAxisType.METRIC,\n    yAxisExpressions = [],\n    selectedXAxisMetricKey = '',\n    lineSmoothness = 70,\n    className,\n    margin = runsChartDefaultMargin,\n    lineShape = 'linear',\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    xRange,\n    yRange,\n    lockXAxisZoom,\n    fullScreen,\n    displayPoints,\n    onSetDownloadHandler,\n    positionInSection = 0,\n  }: RunsMetricsLinePlotProps) => {\n    const { theme } = useDesignSystemTheme();\n    const { evaluateExpression } = useChartExpressionParser();\n\n    const dynamicXAxisKey = useMemo(() => {\n      let dynamicXAxisKey = xAxisKey;\n      if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n        const metricKeys = selectedMetricKeys || [metricKey];\n        let maxDiff = 0;\n        runsData.forEach((runData) => {\n          const metricHistory = runData.metricsHistory;\n          if (metricHistory) {\n            metricKeys.forEach((metricKey) => {\n              if (metricHistory[metricKey]) {\n                const { timestamp: minTimestamp } = minBy(metricHistory[metricKey], 'timestamp') || {};\n                const { timestamp: maxTimestamp } = maxBy(metricHistory[metricKey], 'timestamp') || {};\n                if (maxTimestamp && minTimestamp) {\n                  const diff = maxTimestamp - minTimestamp;\n                  maxDiff = Math.max(maxDiff, diff);\n                }\n              }\n            });\n          }\n        });\n\n        if (maxDiff >= LINE_CHART_RELATIVE_TIME_THRESHOLD) {\n          dynamicXAxisKey = RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS;\n        }\n      }\n      return dynamicXAxisKey;\n    }, [runsData, selectedMetricKeys, metricKey, xAxisKey]);\n\n    const getTraceAndOriginalTrace = (props: any) => {\n      const dataTrace = getDataTraceForRun(props);\n      const originalLineProps = {\n        ...props,\n        lineSmoothness: 0,\n        useDefaultHoverBox: false,\n        displayPoints: false,\n        displayOriginalLine: true,\n      };\n      const originalDataTrace = getDataTraceForRun(originalLineProps);\n      return [dataTrace, originalDataTrace];\n    };\n\n    const plotData = useMemo(() => {\n      // Generate a data trace for each metric in each run\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .map((runEntry) => {\n          if (\n            shouldEnableChartExpressions() &&\n            xAxisKey !== RunsChartsLineChartXAxisType.METRIC &&\n            yAxisKey === RunsChartsLineChartYAxisType.EXPRESSION\n          ) {\n            return yAxisExpressions.flatMap((expression: RunsChartsLineChartExpression, idx: number) => {\n              return getTraceAndOriginalTrace({\n                runEntry,\n                expression,\n                xAxisKey: dynamicXAxisKey,\n                selectedXAxisMetricKey,\n                useDefaultHoverBox,\n                lineSmoothness,\n                lineShape,\n                lineDash: lineDashStyles[idx % lineDashStyles.length],\n                displayPoints,\n                xAxisScaleType,\n                evaluateExpression,\n              });\n            });\n          } else {\n            return (\n              metricKeys\n                // Discard creating traces for metrics that don't have any history for a given run\n                .filter((metricKey) => !isEmpty(runEntry.metricsHistory?.[metricKey]))\n                .flatMap((metricKey, idx) => {\n                  return getTraceAndOriginalTrace({\n                    runEntry,\n                    metricKey,\n                    xAxisKey: dynamicXAxisKey,\n                    selectedXAxisMetricKey,\n                    useDefaultHoverBox,\n                    lineSmoothness,\n                    lineShape,\n                    lineDash: lineDashStyles[idx % lineDashStyles.length],\n                    displayPoints,\n                    xAxisScaleType,\n                  });\n                })\n            );\n          }\n        })\n        .flat();\n    }, [\n      runsData,\n      lineShape,\n      dynamicXAxisKey,\n      lineSmoothness,\n      metricKey,\n      useDefaultHoverBox,\n      selectedMetricKeys,\n      selectedXAxisMetricKey,\n      displayPoints,\n      xAxisScaleType,\n      yAxisKey,\n      yAxisExpressions,\n      evaluateExpression,\n      xAxisKey,\n    ]);\n\n    const bandsData = useMemo(() => {\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .filter(({ groupParentInfo }) => groupParentInfo)\n        .flatMap((runEntry) =>\n          metricKeys.map((metricKey) =>\n            getBandTraceForRun({\n              runEntry,\n              metricKey,\n              lineShape,\n              xAxisKey: dynamicXAxisKey,\n              selectedXAxisMetricKey,\n              xAxisScaleType,\n            }),\n          ),\n        );\n    }, [lineShape, metricKey, runsData, selectedMetricKeys, dynamicXAxisKey, selectedXAxisMetricKey, xAxisScaleType]);\n\n    const plotDataWithBands = useMemo(() => [...bandsData, ...plotData], [plotData, bandsData]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      plotDataWithBands,\n      highlightLineTraces,\n      bandsData.length,\n    );\n\n    const xAxisPlotlyType = getXAxisPlotlyType(xAxisKey, xAxisScaleType, dynamicXAxisKey);\n\n    const xAxisKeyLabel = useMemo(() => {\n      if (dynamicXAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n        return selectedXAxisMetricKey;\n      }\n\n      return formatMessage(getChartAxisLabelDescriptor(dynamicXAxisKey));\n    }, [formatMessage, dynamicXAxisKey, selectedXAxisMetricKey]);\n\n    const yAxisParams: Partial<LayoutAxis> = useMemo(() => {\n      return {\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        type: scaleType === 'log' ? 'log' : 'linear',\n        fixedrange: lockXAxisZoom,\n        range: yRange,\n        autorange: yRange === undefined,\n        tickformat: 'f',\n      };\n    }, [scaleType, lockXAxisZoom, theme, yRange]);\n\n    const xAxisParams: Partial<LayoutAxis> = useMemo(() => {\n      return {\n        title: xAxisKeyLabel,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        range: xRange,\n        autorange: xRange === undefined,\n        type: xAxisPlotlyType,\n      };\n    }, [theme, xAxisKeyLabel, xRange, xAxisPlotlyType]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: xAxisParams,\n      yaxis: yAxisParams,\n      showlegend: false,\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const updatedLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n          yaxis: yAxisParams,\n          xaxis: { ...current.xaxis, ...xAxisParams },\n          showlegend: false,\n        };\n\n        if (isEqual(updatedLayout, current)) {\n          return current;\n        }\n        return updatedLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxisParams, yAxisParams, width, height, xAxisKeyLabel]);\n\n    const containsMultipleMetricKeys = useMemo(() => (selectedMetricKeys?.length || 0) > 1, [selectedMetricKeys]);\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    const themedPlotlyLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    // When switching axis title, Plotly.js mutates its layout object\n    // internally which leads to desync problems and automatic axis range\n    // ends up with an invalid value. In order to fix it, we are mutating\n    // axis object and injecting metric key as title in\n    // the render phase.\n    // It could be fixed by wrapping plotly.js directly instead of using\n    // react-plotly.js - but the effort does not correspond to the plan of\n    // moving away from plotly soon.\n    const immediateLayout = layout;\n    if (immediateLayout.xaxis) {\n      immediateLayout.xaxis.title = xAxisKeyLabel;\n      immediateLayout.xaxis.type = xAxisPlotlyType;\n      if (xRange) {\n        immediateLayout.xaxis.range = xRange;\n      }\n      immediateLayout.xaxis.automargin = true;\n      immediateLayout.xaxis.tickformat =\n        shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE\n          ? '%H:%M:%S'\n          : undefined;\n    }\n    immediateLayout.template = { layout: themedPlotlyLayout };\n\n    if (immediateLayout.yaxis && yRange) {\n      immediateLayout.yaxis.range = yRange;\n      immediateLayout.yaxis.automargin = true;\n      immediateLayout.yaxis.tickformat = 'f';\n    }\n\n    const legendLabelData = useMemo(\n      () => getLineChartLegendData(runsData, selectedMetricKeys, metricKey, yAxisKey, yAxisExpressions),\n      [runsData, selectedMetricKeys, metricKey, yAxisKey, yAxisExpressions],\n    );\n\n    const {\n      scanlineElement,\n      initHandler,\n      updateHandler: updateHandlerMultipleRuns,\n      onPointHover: hoverCallbackMultipleRuns,\n      onPointUnhover: unhoverCallbackMultipleRuns,\n    } = useRunsMultipleTracesTooltipData({\n      legendLabelData,\n      plotData,\n      runsData,\n      containsMultipleMetricKeys,\n      onHover,\n      onUnhover: unhoverCallback,\n      xAxisKeyLabel,\n      xAxisKey: dynamicXAxisKey,\n      xAxisScaleType: xAxisKey === RunsChartsLineChartXAxisType.STEP ? xAxisScaleType : 'linear',\n      setHoveredPointIndex,\n      positionInSection,\n    });\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallbackMultipleRuns);\n\n    // Prepare data for image download handler\n    useEffect(() => {\n      // Check if we are using multiple metric keys. If so, we also need to append\n      // the metric key to  the trace name in the exported image.\n      const usingMultipleMetricKeys = (selectedMetricKeys?.length || 0) > 1;\n      const dataToExport = usingMultipleMetricKeys\n        ? plotDataWithBands.map((dataTrace) =>\n            dataTrace.metricKey\n              ? {\n                  ...dataTrace,\n                  name: `${dataTrace.name} (${dataTrace.metricKey})`,\n                }\n              : dataTrace,\n          )\n        : plotDataWithBands;\n\n      const layoutToExport: Partial<Layout> = {\n        ...layout,\n        showlegend: true,\n        legend: {\n          orientation: 'h',\n        },\n      };\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotDataWithBands, selectedMetricKeys?.length]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotDataWithBands}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={(figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n            updateHandlerMultipleRuns(figure, graphDiv);\n            onUpdate?.(figure, graphDiv);\n          }}\n          layout={immediateLayout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallbackMultipleRuns}\n          onInitialized={initHandler}\n          fallback={<RunsChartCardLoadingPlaceholder />}\n        />\n        {scanlineElement}\n      </div>\n    );\n\n    return (\n      <RunsMetricsLegendWrapper labelData={legendLabelData} fullScreen={fullScreen}>\n        {chart}\n      </RunsMetricsLegendWrapper>\n    );\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.scatterlayer g.trace': {\n      transition: 'var(--trace-transition)',\n    },\n    '.scatterlayer.is-highlight g.trace:not(.is-band)': {\n      opacity: 'var(--trace-opacity-dimmed-low) !important',\n    },\n    '.scatterlayer g.trace.is-hover-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight path.point': {\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n    '.scatterlayer.is-highlight g.trace.is-band:not(.is-band-highlighted)': {\n      opacity: 'var(--trace-opacity-dimmed) !important',\n    },\n  },\n};\n","var _path, _circle, _ellipse, _circle2, _circle3, _ellipse2, _ellipse3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartScatter({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 3.98301,\n    cy: 12.4746,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse || (_ellipse = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 9.40684,\n    cy: 10.8475,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })), _circle2 || (_circle2 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 5.6102,\n    cy: 8.1356,\n    r: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _circle3 || (_circle3 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 9.40684,\n    cy: 6.50852,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse2 || (_ellipse2 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 13.7457,\n    cy: 5.96616,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _ellipse3 || (_ellipse3 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 16.4576,\n    cy: 2.46128,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartScatter);\nexport default __webpack_public_path__ + \"static/media/chart-scatter.69118d0023a6ff3973f7fa913834ac47.svg\";\nexport { ForwardRef as ReactComponent };","import { Empty, NoIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useUpdateExperimentViewUIState } from '../../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { useCallback } from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport const RunsChartsNoDataFoundIndicator = () => {\n  const updateUIState = useUpdateExperimentViewUIState();\n  const { theme } = useDesignSystemTheme();\n\n  const hideEmptyCharts = useCallback(() => {\n    updateUIState((state) => ({ ...state, hideEmptyCharts: true }));\n  }, [updateUIState]);\n\n  return (\n    <div\n      css={{\n        flex: 1,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        paddingLeft: theme.spacing.lg,\n        paddingRight: theme.spacing.lg,\n      }}\n    >\n      <Empty\n        description={\n          <FormattedMessage\n            defaultMessage=\"No chart data available for the currently visible runs. Select other runs or <link>hide empty charts.</link>\"\n            description=\"Experiment tracking > runs charts > indication displayed when no corresponding data is found to be used in chart-based run comparison\"\n            values={{\n              link: (chunks) => (\n                <Typography.Link\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsnodatafoundindicator.tsx_31\"\n                  onClick={hideEmptyCharts}\n                >\n                  {chunks}\n                </Typography.Link>\n              ),\n            }}\n          />\n        }\n        image={<NoIcon />}\n      />\n    </div>\n  );\n};\n","import { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useContext, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport type {\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { RunsMetricsBarPlotHoverData } from '../components/RunsMetricsBarPlot';\nimport { ChartsTraceHighlightSource, useRunsChartTraceHighlight } from './useRunsChartTraceHighlight';\nimport { RUNS_CHARTS_UI_Z_INDEX } from '../utils/runsCharts.const';\n\nexport interface RunsChartsTooltipBodyProps<TContext = any, TChartData = any, THoverData = any> {\n  runUuid: string;\n  hoverData: THoverData;\n  chartData: TChartData;\n  contextData: TContext;\n  closeContextMenu: () => void;\n  isHovering?: boolean;\n  mode: RunsChartsTooltipMode;\n}\n\nexport interface RunsChartsChartMouseEvent {\n  x: number;\n  y: number;\n  originalEvent?: MouseEvent;\n}\n\nexport enum RunsChartsTooltipMode {\n  Simple = 1,\n  MultipleTracesWithScanline = 2,\n}\n\nexport type RunsChartsTooltipBodyComponent<C = any, T = any> = React.ComponentType<RunsChartsTooltipBodyProps<C, T>>;\n\nconst RunsChartsTooltipContext = React.createContext<{\n  selectedRunUuid: string | null;\n  closeContextMenu: () => void;\n  resetTooltip: () => void;\n  destroyTooltip: () => void;\n  updateTooltip: (\n    runUuid: string,\n    mode: RunsChartsTooltipMode,\n    chartData?: any,\n    event?: RunsChartsChartMouseEvent,\n    additionalData?: any,\n  ) => void;\n} | null>(null);\n\nexport enum ContextMenuVisibility {\n  HIDDEN,\n  HOVER,\n  VISIBLE,\n}\n\nexport const containsMultipleRunsTooltipData = (\n  hoverData: RunsMetricsBarPlotHoverData | RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData,\n): hoverData is RunsCompareMultipleTracesTooltipData => hoverData && 'tooltipLegendItems' in hoverData;\n\n/**\n * Extract first ancestor HTML element in the hierarchy, even if the target is an SVG element.\n * Necessary for proper behavior of '.contains()'\n */\nconst extractHTMLAncestorElement = (element: Element | EventTarget | null) => {\n  if (element === null || !(element instanceof Element)) {\n    return null;\n  }\n  if (element instanceof HTMLElement) {\n    return element;\n  }\n\n  let currentElement: Element | null = element;\n  while (currentElement && !(currentElement instanceof HTMLElement)) {\n    currentElement = currentElement.parentElement;\n  }\n\n  return currentElement;\n};\n\n/**\n * Context and DOM container necessary for chart context menu to work.\n * Can wrap multiple charts.\n */\nexport const RunsChartsTooltipWrapper = <\n  // Type for the context data passed to the tooltip, e.g. list of all runs\n  TContext = any,\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  THover = any,\n>({\n  className,\n  children,\n  contextData,\n  component: Component,\n  hoverOnly = false,\n}: React.PropsWithChildren<{\n  className?: string;\n  contextData: TContext;\n  component: React.ComponentType<RunsChartsTooltipBodyProps<TContext, THover>>;\n  hoverOnly?: boolean;\n}>) => {\n  // A reference to the viewport-wide element containing the context menu\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // A reference to the tooltip/context-menu element\n  const ctxMenuRef = useRef<HTMLDivElement>(null);\n\n  // Mutable value containing current mouse position\n  const currentPos = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  // Mutable value containing current snapped mouse position, provided externally by the tooltip data providers\n  // Used instead of `currentPos` when the tooltip is in the \"multiple runs\" mode\n  const currentSnappedCoordinates = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const [mode, setMode] = useState<RunsChartsTooltipMode>(RunsChartsTooltipMode.Simple);\n\n  // Current visibility of the tooltip/context-menu\n  const [contextMenuShown, setContextMenuShown] = useState<ContextMenuVisibility>(ContextMenuVisibility.HIDDEN);\n\n  const [tooltipDisplayParams, setTooltipDisplayParams] = useState<any | null>(null);\n  const [hoveredRunUuid, setHoveredRunUuid] = useState<string>('');\n\n  // Apart from run uuid, It's also possible to set bonus axis data (helpful for line charts with data lineage)\n  const [additionalAxisData, setAdditionalAxisData] = useState<any>(null);\n\n  // Stores data about the run that has been clicked, but mouse has not been released.\n  const focusedRunData = useRef<{ x: number; y: number; runUuid: string } | null>(null);\n\n  // Mutable version of certain state values, used in processes outside the React event lifecycle\n  const mutableContextMenuShownRef = useRef<ContextMenuVisibility>(contextMenuShown);\n  const mutableHoveredRunUuid = useRef(hoveredRunUuid);\n  const mutableTooltipDisplayParams = useRef(tooltipDisplayParams);\n  const mutableAdditionalAxisData = useRef(additionalAxisData);\n\n  // Get the higlighting function from the context\n  const { highlightDataTrace } = useRunsChartTraceHighlight();\n\n  // This method applies the tooltip position basing on the mouse position\n  const applyPositioning = useCallback(\n    (isChangingVisibilityMode = false) => {\n      if (!ctxMenuRef.current || !containerRef.current) {\n        return;\n      }\n\n      // For the X coordinate, If the tooltip is in the \"multiple runs\" mode, use the snapped coordinates.\n      // Otherwise, use the current mouse position.\n      let targetX =\n        mode === RunsChartsTooltipMode.MultipleTracesWithScanline\n          ? currentSnappedCoordinates.current.x\n          : currentPos.current.x;\n\n      let targetY = currentPos.current.y;\n\n      const currentCtxMenu = ctxMenuRef.current;\n      const containerRect = containerRef.current.getBoundingClientRect();\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        // In particular cases, the tooltip container can not take entire viewport size\n        // so we need to adjust the position of the tooltip\n        targetX -= containerRect.x;\n        targetY -= containerRect.y;\n      }\n\n      ctxMenuRef.current.style.left = '0px';\n      ctxMenuRef.current.style.top = '0px';\n      ctxMenuRef.current.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n\n      // This function is used to reposition the tooltip if it's out of the viewport\n      const reposition = () => {\n        const menuRect = currentCtxMenu.getBoundingClientRect();\n\n        if (targetX + menuRect.width >= containerRect.width) {\n          targetX -= menuRect.width;\n        }\n\n        if (targetY + menuRect.height >= containerRect.height) {\n          targetY -= menuRect.height;\n        }\n\n        currentCtxMenu.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n      };\n\n      // If the tooltip changes it's visibility mode during the process, defer repositioning to the next frame\n      // to make sure that the position is correct after possible change of the tooltip size.\n      // Otherwise, reposition immediately to save computation cycles.\n      if (isChangingVisibilityMode) {\n        requestAnimationFrame(reposition);\n      } else {\n        reposition();\n      }\n    },\n    [mode],\n  );\n\n  // Save mutable visibility each time a stateful one changes\n  useEffect(() => {\n    mutableContextMenuShownRef.current = contextMenuShown;\n  }, [contextMenuShown]);\n\n  // This function returns X and Y of the target element relative to the container\n  const getCoordinatesForTargetElement = useCallback((targetElement: HTMLElement, event: MouseEvent) => {\n    const targetRect = targetElement.getBoundingClientRect();\n    const containerRect = containerRef.current?.getBoundingClientRect() || { left: 0, top: 0 };\n    const x = event.offsetX + (targetRect.left - containerRect.left);\n    const y = event.offsetY + (targetRect.top - containerRect.top);\n    return { x, y };\n  }, []);\n\n  const mouseMove: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      // Apply only if the tooltip is in the hover mode\n      if (\n        mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER &&\n        ctxMenuRef.current &&\n        containerRef.current\n      ) {\n        focusedRunData.current = null;\n        const targetElement = extractHTMLAncestorElement(event.target);\n        if (targetElement) {\n          currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n          applyPositioning();\n        }\n      }\n    },\n    [applyPositioning, getCoordinatesForTargetElement],\n  );\n\n  // This callback is being fired on every new run being hovered\n  const updateTooltip = useCallback(\n    (\n      runUuid: string,\n      mode: RunsChartsTooltipMode,\n      chartData?: any,\n      event?: RunsChartsChartMouseEvent,\n      additionalRunData?: any,\n    ) => {\n      mutableHoveredRunUuid.current = runUuid;\n      mutableTooltipDisplayParams.current = chartData;\n      mutableAdditionalAxisData.current = additionalRunData;\n\n      // If the tooltip is visible and hardwired to the position, don't change it\n      if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      // Update the event-specific data in the state\n      setTooltipDisplayParams(chartData);\n\n      // If the mouse button has been clicked on a run but hover\n      // has been lost, do nothing\n      if (!runUuid && focusedRunData.current?.runUuid) {\n        return;\n      }\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        currentSnappedCoordinates.current.x = event?.x || 0;\n      }\n\n      // Set the mode - single run or multiple runs\n      setMode(mode);\n\n      // Update the currently hovered run\n      setHoveredRunUuid((currentRunUuid) => {\n        if (additionalRunData) {\n          setAdditionalAxisData(additionalRunData);\n        }\n        // If the tooltip was hidden or it's shown but it's another run,\n        // make sure that the state is updated\n        if (\n          mutableContextMenuShownRef.current === ContextMenuVisibility.HIDDEN ||\n          (mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER && runUuid !== currentRunUuid)\n        ) {\n          setContextMenuShown(ContextMenuVisibility.HOVER);\n          return runUuid;\n        }\n        return currentRunUuid;\n      });\n    },\n    [],\n  );\n\n  const mouseDownCapture: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n      // Saves the current position and hovered run ID after lowering the mouse button,\n      // we use it afterwards to confirm that user has clicked on the same run and scrubbing/zooming\n      // didn't occur in the meanwhile\n      if (event.button === 0 && mutableHoveredRunUuid.current) {\n        focusedRunData.current = {\n          x: event.pageX,\n          y: event.pageY,\n          runUuid: mutableHoveredRunUuid.current,\n        };\n      }\n    },\n    [hoverOnly],\n  );\n\n  // Callback for the click event for the tooltip area, checks if context menu needs to be shown.\n  // We're not using `mouseup` because plotly.js hijacks the event by appending drag cover to the document on `mousedown`.\n  const tooltipAreaClicked: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n\n      const clickedInTheSamePlace = () => {\n        const epsilonPixels = 5;\n\n        return (\n          focusedRunData.current?.runUuid &&\n          Math.abs(event.pageX - focusedRunData.current.x) < epsilonPixels &&\n          Math.abs(event.pageY - focusedRunData.current.y) < epsilonPixels\n        );\n      };\n\n      // We're interested in displaying the context menu only if\n      // mouse is in the same position as when lowering the button,\n      // this way we won't display it when zooming on the chart.\n      if (focusedRunData.current && clickedInTheSamePlace()) {\n        // If the context menu is already visible, we need to reposition it and provide\n        // the updated run UUID\n        if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n          setHoveredRunUuid(focusedRunData.current.runUuid);\n          setAdditionalAxisData(mutableAdditionalAxisData.current);\n          const targetElement = extractHTMLAncestorElement(event.nativeEvent.target);\n          if (targetElement) {\n            currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n            applyPositioning(true);\n          }\n        } else {\n          // If the context menu was not visible before (it was a tooltip), just enable it.\n          setContextMenuShown(ContextMenuVisibility.VISIBLE);\n          applyPositioning(true);\n        }\n        event.stopPropagation();\n      }\n      // Since the mouse button is up, reset the currently focused run\n      focusedRunData.current = null;\n    },\n    [applyPositioning, hoverOnly, getCoordinatesForTargetElement],\n  );\n\n  // Exposed function used to hide the context menu\n  const closeContextMenu = useCallback(() => setContextMenuShown(ContextMenuVisibility.HIDDEN), []);\n\n  // Set up main listeners in the useLayoutEffect hook\n  useLayoutEffect(() => {\n    if (!containerRef.current) {\n      return undefined;\n    }\n\n    // Find the DOM root - it can be either document or a shadow root\n    const domRoot = containerRef.current.getRootNode() as Document;\n\n    // This function is being called on every click in the document,\n    // it's used to dismiss the shown context menu\n    const rootClickListener = (e: MouseEvent) => {\n      // We're interested only in dismissing context menu mode, tooltip is fine\n      if (mutableContextMenuShownRef.current !== ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      const targetElement = extractHTMLAncestorElement(e.target);\n\n      if (!targetElement) {\n        return;\n      }\n\n      // Check if the click event occurred within the\n      // context menu\n      const contextMenuClicked =\n        targetElement instanceof HTMLElement &&\n        ctxMenuRef?.current instanceof HTMLElement &&\n        ctxMenuRef.current.contains(targetElement);\n\n      // Dismiss the context menu only if click didn't occur on\n      // the context menu content or on another run\n      if (!contextMenuClicked && !focusedRunData.current?.runUuid) {\n        setContextMenuShown(ContextMenuVisibility.HIDDEN);\n      }\n    };\n    domRoot.addEventListener('click', rootClickListener, { capture: true });\n\n    return () => {\n      domRoot.removeEventListener('click', rootClickListener, { capture: true });\n    };\n  }, [getCoordinatesForTargetElement, applyPositioning]);\n\n  // Callback used to reset the tooltip, fired when the mouse leaves the run\n  const resetTooltip = useCallback(() => {\n    mutableHoveredRunUuid.current = '';\n    if (focusedRunData.current?.runUuid || mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n      return;\n    }\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Callback used to remove the tooltip,\n  const destroyTooltip = useCallback((force = false) => {\n    mutableHoveredRunUuid.current = '';\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Export the currently selected run ID. Set to \"null\" if there is nothing selected.\n  const selectedRunUuid = useMemo(() => {\n    if (contextMenuShown !== ContextMenuVisibility.VISIBLE) {\n      return null;\n    }\n    return hoveredRunUuid;\n  }, [contextMenuShown, hoveredRunUuid]);\n\n  // When the selected data trace changes, report the highlight event\n  useEffect(\n    () =>\n      highlightDataTrace(selectedRunUuid, {\n        source: ChartsTraceHighlightSource.CHART,\n        // Block the highlight event so it won't change as long as the tooltip is in selected mode\n        shouldBlock: Boolean(selectedRunUuid),\n      }),\n    [highlightDataTrace, selectedRunUuid],\n  );\n\n  const contextValue = useMemo(\n    () => ({ updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu }),\n    [updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu],\n  );\n\n  // We're displaying tooltip if:\n  // - it's not in the hidden mode\n  // - it's in the single run tooltip mode and hovered run is not empty\n  // - it's in the multiple runs tooltip mode\n  const displayTooltip =\n    contextMenuShown !== ContextMenuVisibility.HIDDEN &&\n    (mode === RunsChartsTooltipMode.MultipleTracesWithScanline || hoveredRunUuid !== '');\n\n  return (\n    <RunsChartsTooltipContext.Provider value={contextValue}>\n      {/* The element below wraps all the children (where charts are expected to be mounted)\n      and tracks mouse movement inside */}\n      <div\n        onMouseMove={mouseMove}\n        onMouseDownCapture={mouseDownCapture}\n        onClickCapture={tooltipAreaClicked}\n        css={{ height: '100%' }}\n      >\n        {children}\n      </div>\n      {/* The element below houses the tooltip/context menu */}\n      <div css={styles.contextMenuContainer} className={className} ref={containerRef}>\n        {displayTooltip && (\n          <div\n            ref={ctxMenuRef}\n            css={styles.contextMenuWrapper}\n            data-testid=\"tooltip-container\"\n            style={{\n              userSelect: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'unset',\n              pointerEvents: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'all',\n            }}\n          >\n            {/* A tooltip body component passed from the props */}\n            <Component\n              runUuid={hoveredRunUuid}\n              hoverData={additionalAxisData}\n              chartData={tooltipDisplayParams}\n              contextData={contextData}\n              isHovering={contextMenuShown === ContextMenuVisibility.HOVER}\n              closeContextMenu={closeContextMenu}\n              mode={mode}\n            />\n          </div>\n        )}\n      </div>\n    </RunsChartsTooltipContext.Provider>\n  );\n};\n\n/**\n * This hook is used to wire up tooltip to particular experiment runs chart.\n * Returns \"setTooltip\" and \"resetTooltip\" functions that should be called\n * upon chart's \"onHover\" and \"onUnhover\" events. \"setTooltip\" function consumes\n * the runUuid that was hovered on.\n */\nexport const useRunsChartsTooltip = <\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  TChart = any,\n  TAxisData = any,\n>(\n  chartData?: TChart,\n  mode = RunsChartsTooltipMode.Simple,\n) => {\n  const contextValue = useContext(RunsChartsTooltipContext);\n\n  if (!contextValue) {\n    throw new Error(\n      'You must invoke useRunsChartsTooltip() in a component being ancestor of <RunsChartsTooltipWrapper />!',\n    );\n  }\n\n  const { updateTooltip, resetTooltip, selectedRunUuid, closeContextMenu, destroyTooltip } = contextValue;\n  const { highlightDataTrace } = useRunsChartTraceHighlight();\n\n  const setTooltip = useCallback(\n    (runUuid = '', event?: RunsChartsChartMouseEvent, additionalAxisData?: TAxisData) => {\n      updateTooltip(runUuid, mode, chartData, event, additionalAxisData);\n      highlightDataTrace(runUuid, {\n        source: ChartsTraceHighlightSource.CHART,\n      });\n    },\n    [updateTooltip, chartData, mode, highlightDataTrace],\n  );\n\n  const resetTooltipWithHighlight = useCallback(() => {\n    resetTooltip();\n    highlightDataTrace(null);\n  }, [resetTooltip, highlightDataTrace]);\n\n  return { setTooltip, resetTooltip: resetTooltipWithHighlight, selectedRunUuid, closeContextMenu, destroyTooltip };\n};\n\nconst styles = {\n  contextMenuContainer: {\n    overflow: 'hidden',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    position: 'fixed',\n    pointerEvents: 'none',\n    zIndex: RUNS_CHARTS_UI_Z_INDEX.TOOLTIP_CONTAINER,\n  } as Interpolation<Theme>,\n  contextMenuWrapper: (theme: Theme) => ({\n    zIndex: RUNS_CHARTS_UI_Z_INDEX.TOOLTIP,\n    position: 'absolute' as const,\n    padding: theme.spacing.sm,\n    backgroundColor: theme.colors.backgroundPrimary,\n    border: `1px solid ${theme.colors.border}`,\n    left: -999,\n    top: -999,\n    borderRadius: theme.general.borderRadiusBase,\n    boxShadow: theme.general.shadowLow,\n  }),\n  overlayElement: (): Interpolation<Theme> => ({\n    '&::after': {\n      content: '\"\"',\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'transparent',\n    },\n  }),\n};\n","import { CheckCircleIcon, ClockIcon, XCircleIcon, useDesignSystemTheme } from '@databricks/design-system';\n\nconst ErrorIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <XCircleIcon css={{ color: theme.colors.textValidationDanger }} />;\n};\n\nconst FinishedIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <CheckCircleIcon css={{ color: theme.colors.textValidationSuccess }} />;\n};\n\nexport const RunStatusIcon = ({ status }: { status: string }) => {\n  switch (status) {\n    case 'FAILED':\n    case 'KILLED':\n      return <ErrorIcon />;\n    case 'FINISHED':\n      return <FinishedIcon />;\n    case 'SCHEDULED':\n    case 'RUNNING':\n      return <ClockIcon />; // This one is the same color as the link\n    default:\n      return null;\n  }\n};\n","var _path, _rect, _rect2, _rect3, _rect4;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartBar({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 3.16943,\n    y: 10.5763,\n    width: 2.16949,\n    height: 3.25424,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 6.42371,\n    y: 5.15259,\n    width: 2.16949,\n    height: 8.67797,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 9.67798,\n    y: 8.40686,\n    width: 2.16949,\n    height: 5.42373,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 12.9323,\n    y: 1.89832,\n    width: 2.16949,\n    height: 11.9322,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartBar);\nexport default __webpack_public_path__ + \"static/media/chart-bar.0fd4a63680fba840a7b69fbf07969f79.svg\";\nexport { ForwardRef as ReactComponent };","import { useMemo } from 'react';\nimport type { RunGroupingAggregateFunction } from '../../experiment-page/utils/experimentPage.row-types';\nimport invariant from 'invariant';\nimport {\n  removeOutliersFromMetricHistory,\n  type RunsChartsRunData,\n} from '../../runs-charts/components/RunsCharts.common';\nimport {\n  createAggregatedMetricHistory,\n  createValueAggregatedMetricHistory,\n  type SyntheticMetricHistory,\n} from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { uniq, type Dictionary, compact, pick, isNil } from 'lodash';\nimport type { SampledMetricsByRun } from '../../runs-charts/hooks/useSampledMetricHistory';\nimport type { MetricHistoryByName } from '../../../types';\n\nexport interface UseGroupedChartRunDataParams {\n  ungroupedRunsData: RunsChartsRunData[];\n  enabled: boolean;\n  aggregateFunction?: RunGroupingAggregateFunction;\n  metricKeys: string[];\n  sampledDataResultsByRunUuid: Dictionary<SampledMetricsByRun>;\n  selectedXAxisMetricKey?: string;\n  ignoreOutliers: boolean;\n}\n\n/**\n * Returns a new array of RunsChartsRunData with aggregated metrics for grouped runs.\n * In order to make rendering of the confidence interval possible, the returned dataset contains\n * min, max and average values for each metric while respecting the metric history.\n */\nexport const useGroupedChartRunData = ({\n  ungroupedRunsData,\n  enabled,\n  aggregateFunction,\n  metricKeys,\n  sampledDataResultsByRunUuid,\n  selectedXAxisMetricKey,\n  ignoreOutliers,\n}: UseGroupedChartRunDataParams) => {\n  return useMemo(() => {\n    if (!enabled || !aggregateFunction) {\n      return ungroupedRunsData;\n    }\n\n    // Extract groups from the result set and calculate aggregated metrics\n    const perGroupData: RunsChartsRunData[] = ungroupedRunsData\n      .filter(({ groupParentInfo }) => groupParentInfo)\n      .map((group) => {\n        const aggregatedMetricsHistory: Record<string, SyntheticMetricHistory> = {};\n        metricKeys.forEach((metricKey) => {\n          invariant(group.groupParentInfo, 'groupParentInfo should be defined');\n\n          const aggregatedRunUuidsInGroup =\n            group.groupParentInfo.runUuidsForAggregation ?? group.groupParentInfo.runUuids;\n\n          let aggregatedMetricsHistoryForMetric;\n          if (!isNil(selectedXAxisMetricKey)) {\n            aggregatedMetricsHistoryForMetric = createValueAggregatedMetricHistory(\n              pick(sampledDataResultsByRunUuid, aggregatedRunUuidsInGroup),\n              metricKey,\n              selectedXAxisMetricKey,\n              ignoreOutliers,\n            );\n          } else {\n            const metricsHistoryInGroup = compact(\n              aggregatedRunUuidsInGroup.flatMap((runUuid) => {\n                const metricsHistory = sampledDataResultsByRunUuid[runUuid]?.[metricKey]?.metricsHistory;\n                if (ignoreOutliers) {\n                  return metricsHistory ? removeOutliersFromMetricHistory(metricsHistory) : undefined;\n                }\n                return metricsHistory;\n              }),\n            );\n\n            // Get all step numbers from all runs in the group\n            const steps = uniq(metricsHistoryInGroup.map((h) => h.step)).sort((a, b) => a - b);\n\n            aggregatedMetricsHistoryForMetric = createAggregatedMetricHistory(steps, metricKey, metricsHistoryInGroup);\n          }\n\n          aggregatedMetricsHistory[metricKey] = aggregatedMetricsHistoryForMetric;\n        });\n        const metricsHistory = metricKeys.reduce<MetricHistoryByName>((acc, key) => {\n          const history = aggregatedMetricsHistory[key][aggregateFunction];\n          if (history && history.length > 0) {\n            acc[key] = history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...group,\n          metricsHistory,\n          aggregatedMetricsHistory,\n        };\n      });\n\n    const ungroupedRuns = ungroupedRunsData.filter(({ belongsToGroup }) => belongsToGroup === false);\n\n    return [...perGroupData, ...ungroupedRuns];\n  }, [\n    metricKeys,\n    sampledDataResultsByRunUuid,\n    ungroupedRunsData,\n    enabled,\n    aggregateFunction,\n    selectedXAxisMetricKey,\n    ignoreOutliers,\n  ]);\n};\n","import {\n  DEFAULT_LIFECYCLE_FILTER,\n  DEFAULT_MODEL_VERSION_FILTER,\n  DEFAULT_ORDER_BY_ASC,\n  DEFAULT_ORDER_BY_KEY,\n  DEFAULT_START_TIME,\n} from '../../../constants';\nimport type { DatasetSummary, LIFECYCLE_FILTER, MODEL_VERSION_FILTER } from '../../../types';\n\n/**\n * Defines persistable model representing sort and filter values\n * used by runs table and controls\n */\nexport interface ExperimentPageSearchFacetsState {\n  /**\n   * SQL-like query string used to filter runs, e.g. \"params.alpha = '0.5'\"\n   */\n  searchFilter: string;\n\n  /**\n   * Canonical order_by key like \"params.`alpha`\". May be null to indicate the table\n   * should use the natural row ordering provided by the server.\n   */\n  orderByKey: string;\n\n  /**\n   * Whether the order imposed by orderByKey should be ascending or descending.\n   */\n  orderByAsc: boolean;\n\n  /**\n   * Filter key to show results based on start time\n   */\n  startTime: string;\n\n  /**\n   * Lifecycle filter of runs to display\n   */\n  lifecycleFilter: LIFECYCLE_FILTER;\n\n  /**\n   * Datasets filter of runs to display\n   */\n  datasetsFilter: DatasetSummary[];\n\n  /**\n   * Filter of model versions to display\n   */\n  modelVersionFilter: MODEL_VERSION_FILTER;\n}\n\n/**\n * Defines default experiment page search facets state.\n */\nexport const createExperimentPageSearchFacetsState = (): ExperimentPageSearchFacetsState => ({\n  searchFilter: '',\n  orderByKey: DEFAULT_ORDER_BY_KEY,\n  orderByAsc: DEFAULT_ORDER_BY_ASC,\n  startTime: DEFAULT_START_TIME,\n  lifecycleFilter: DEFAULT_LIFECYCLE_FILTER,\n  datasetsFilter: [],\n  modelVersionFilter: DEFAULT_MODEL_VERSION_FILTER,\n});\n","// eslint-disable-next-line import/no-extraneous-dependencies\nimport { type DragDropManager, createDragDropManager } from 'dnd-core';\nimport { useLayoutEffect, useRef, useState } from 'react';\nimport { useDrag, useDrop, DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nexport interface useDragAndDropElementProps {\n  /**\n   * Unique drag element identifier, used in drop events\n   */\n  dragKey: string;\n  /**\n   * Group key - items are droppable only within a single group\n   */\n  dragGroupKey: string;\n  /**\n   * Callback function, conveys both dragged and target element key\n   */\n  onDrop: (draggedKey: string, targetDropKey: string) => void;\n\n  /**\n   * If true, drag and drop will be disabled\n   */\n  disabled?: boolean;\n}\n\ninterface DraggedItem {\n  key: string;\n  groupKey: string;\n}\n\n/**\n * A hook enabling drag-and-drop capabilities for any component.\n * Used component will serve as both DnD source and target.\n */\nexport const useDragAndDropElement = ({\n  dragGroupKey,\n  dragKey,\n  onDrop,\n  disabled = false,\n}: useDragAndDropElementProps) => {\n  const dropListener = useRef(onDrop);\n\n  dropListener.current = onDrop;\n\n  const [{ isOver, draggedItem }, dropTargetRef] = useDrop<\n    DraggedItem,\n    never,\n    { isOver: boolean; draggedItem: DraggedItem }\n  >(\n    {\n      canDrop: () => !disabled,\n      accept: `dnd-${dragGroupKey}`,\n      drop: ({ key: sourceKey }: { key: string }, monitor) => {\n        if (sourceKey === dragKey || monitor.didDrop()) {\n          return;\n        }\n        dropListener.current(sourceKey, dragKey);\n      },\n      collect: (monitor) => ({ isOver: monitor.isOver({ shallow: true }), draggedItem: monitor.getItem() }),\n    },\n    [disabled, dragGroupKey, dragKey],\n  );\n\n  const [{ isDragging }, dragHandleRef, dragPreviewRef] = useDrag(\n    {\n      canDrag: () => !disabled,\n      type: `dnd-${dragGroupKey}`,\n      item: { key: dragKey, groupKey: dragGroupKey },\n      collect: (monitor) => ({\n        isDragging: monitor.isDragging(),\n      }),\n    },\n    [disabled, dragGroupKey, dragKey],\n  );\n\n  const isDraggingOtherGroup = Boolean(draggedItem && draggedItem.groupKey !== dragGroupKey);\n\n  return { dropTargetRef, dragHandleRef, dragPreviewRef, isDragging, isOver, isDraggingOtherGroup };\n};\n\n/**\n * Create a scoped DndProvider that will limit its functionality to a single root element.\n * It should prevent HTML5Backend collisions, see:\n * https://github.com/react-dnd/react-dnd/blob/7c88c37489a53b5ac98699c46a506a8e085f1c03/packages/backend-html5/src/HTML5BackendImpl.ts#L107-L109\n */\nexport const DragAndDropProvider: React.FC = ({ children }) => {\n  const rootElementRef = useRef<HTMLDivElement>(null);\n  const [manager, setManager] = useState<DragDropManager | null>(null);\n\n  useLayoutEffect(() => {\n    const rootElement = rootElementRef.current;\n    const dragDropManager = createDragDropManager(HTML5Backend, undefined, { rootElement });\n    setManager(dragDropManager);\n    return () => {\n      dragDropManager.getBackend().teardown();\n    };\n  }, []);\n\n  return (\n    <div css={{ display: 'contents' }} ref={rootElementRef}>\n      {manager && <DndProvider manager={manager}>{children}</DndProvider>}\n    </div>\n  );\n};\n","import type { PlotMouseEvent } from 'plotly.js';\nimport { useEffect, useRef } from 'react';\n\n/**\n * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n * so in order to achieve updated behavior we need to wrap each onHover callback with an\n * immutable callback that will call mutable implementation.\n */\nexport const useMutableChartHoverCallback = <T extends (event: Readonly<PlotMouseEvent>) => void>(callback: T) => {\n  const mutableRef = useRef<T>(callback);\n\n  useEffect(() => {\n    mutableRef.current = callback;\n  }, [callback]);\n\n  return (event: Readonly<PlotMouseEvent>) => {\n    mutableRef.current(event);\n  };\n};\n","import { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\n\nexport const useImageSliderStepMarks = ({\n  data,\n  selectedImageKeys,\n}: {\n  data: RunsChartsRunData[];\n  selectedImageKeys: string[];\n}) => {\n  const stepMarks = data.reduce((acc, run: RunsChartsRunData) => {\n    for (const imageKey of Object.keys(run.images)) {\n      if (selectedImageKeys?.includes(imageKey)) {\n        const metadata = run.images[imageKey];\n        for (const meta of Object.values(metadata)) {\n          if (meta.step !== undefined) {\n            acc[meta.step] = {\n              style: { display: 'none' },\n              label: '',\n            };\n          }\n        }\n      }\n    }\n    return acc;\n  }, {} as Record<number, any>);\n\n  return {\n    stepMarks,\n    maxMark: Math.max(...Object.keys(stepMarks).map(Number)),\n    minMark: Math.min(...Object.keys(stepMarks).map(Number)),\n  };\n};\n","var _rect, _line, _line2, _line3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartImage({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 0.5,\n    y: 0.5,\n    width: 15,\n    height: 15,\n    stroke: \"#C4C4C4\"\n  })), _line || (_line = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 8.5,\n    y1: 0.800049,\n    x2: 8.5,\n    y2: 16,\n    stroke: \"#C4C4C4\"\n  })), _line2 || (_line2 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 5.69995,\n    x2: -2.63656e-8,\n    y2: 5.69995,\n    stroke: \"#C4C4C4\"\n  })), _line3 || (_line3 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 10.9,\n    x2: -2.63656e-8,\n    y2: 10.9,\n    stroke: \"#C4C4C4\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartImage);\nexport default __webpack_public_path__ + \"static/media/chart-image.cc434c4dc50780966344e2385a15f8fe.svg\";\nexport { ForwardRef as ReactComponent };"],"names":["_path","_circle","_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","SvgIconVisibleFill","title","titleId","props","svgRef","width","height","viewBox","fill","xmlns","ref","id","d","stroke","cx","cy","strokeWidth","ForwardRef","flattenString","input","isArray","join","persistSearchStateFieldSerializers","searchFilter","deserializeLocalStorage","deserializeQueryString","orderByAsc","serializeQueryString","toString","datasetsFilter","inputs","inputsWithoutExperimentId","map","name","digest","context","btoaUtf8","JSON","stringify","parsedResult","parse","atobUtf8","Array","compareRunCharts","compareRunsMode","serializeLocalStorage","EXPERIMENT_PAGE_QUERY_PARAM_KEYS","EXPERIMENT_PAGE_QUERY_PARAM_IS_PREVIEW","useExperimentPageSearchFacets","queryParams","useSearchParams","pickedValues","useMemo","pick","fromEntries","entries","isPreview","get","orderByKey","startTime","lifecycleFilter","modelVersionFilter","areValuesEmpty","keys","experimentId","useParams","queryParamsExperimentIds","experimentIds","comparedExperimentIds","getComparedExperimentIds","deserializedFields","resultObject","field","_persistSearchStateFi2","deserializeFn","deserializeFieldsFromQueryString","omitBy","isNil","createExperimentPageSearchFacetsState","useUpdateExperimentPageSearchFacets","setParams","partialFacets","options","newParams","_persistSearchStateFi","serializeFn","serializeFieldsToQueryString","currentParams","forEach","key","value","set","delete","findChartStepsByTimestampForRuns","sampledMetrics","runUuids","metricKey","range","stepRangesPerRun","compact","runUuid","_sampledMetrics$runUu","metricHistoryForRun","findChartStepsByTimestamp","currentMetricHistory","useDefaultIfNotFound","flatHistory","orderBy","values","metricsHistory","flat","lowerBound","Date","valueOf","upperBound","lowerEntry","first","undefined","index","entry","timestamp","upperEntry","last","isUndefined","step","min","bound","max","findAbsoluteTimestampRangeForRelativeRange","currentlyVisibleMetrics","relativeRange","multiplier","_minBy","runData","_","runMetrics","visibleMetricHistoryForRun","flatMap","metric","_metric$metricsHistor","timestampOffset","minBy","getV2ChartTitle","cardConfig","shouldEnableChartExpressions","yAxisKey","RunsChartsLineChartYAxisType","EXPRESSION","_cardConfig$yAxisExpr","expressions","yAxisExpressions","exp","expression","selectedMetricKeys","SUPPORTED_DOWNLOAD_FORMATS","RunsChartsLineChartCard","config","chartRunData","onDelete","onEdit","onDownloadFullMetricHistoryCsv","groupBy","fullScreen","setFullScreenChart","autoRefreshEnabled","hideEmptyCharts","globalLineChartConfig","isInViewport","isInViewportProp","isInViewportDeferred","isInViewportDeferredProp","positionInSection","reorderProps","_config$ignoreOutlier","xAxisKey","selectedXAxisMetricKey","lineSmoothness","useLineChartGlobalConfig","toggleFullScreenChart","useCallback","subtitle","slicedRuns","filter","hidden","reverse","isGrouped","some","groupParentInfo","isEmptyDataset","_config$selectedMetri","metricKeys","metricsInRuns","metrics","intersection","uniq","runUuidsToFetch","g","belongsToGroup","_r$runInfo","runInfo","_r$runInfo2","yAxisKeys","_config$yAxisExpressi","fallback","_config$selectedMetri2","reduce","acc","variables","variable","add","Set","from","getYAxisKeys","xAxisKeys","concat","setTooltip","resetTooltip","destroyTooltip","selectedRunUuid","useRunsChartsTooltip","RunsChartsTooltipMode","MultipleTracesWithScanline","aggregateFunction","sampledMetricsByRunUuid","useSelector","state","entities","shallowEqual","yRangeLocal","setYRangeLocal","useState","yMin","yMax","setOffsetTimestamp","stepRange","xRangeLocal","setXRangeLocal","useCompareRunChartSelectedRange","scaleType","xMin","xMax","offsetTimestamp","RunsChartsLineChartXAxisType","TIME","isString","TIME_RELATIVE","isNumber","STEP","Math","floor","ceil","xAxisScaleType","resultsByRunUuid","isLoading","isRefreshing","useSampledMetricHistory","enabled","maxResults","useEffect","sampledData","run","_resultsByRunUuid$run","_resultsByRunUuid$run2","history","uuid","ignoreOutliers","removeOutliersFromMetricHistory","sampledGroupData","useGroupedChartRunData","ungroupedRunsData","sampledDataResultsByRunUuid","METRIC","chartData","imageDownloadHandler","setImageDownloadHandler","useChartImageDownloadHandler","renderChartBody","renderSkeleton","chartBody","_jsx","css","styles","lineChartCardWrapper","children","RunsChartCardLoadingPlaceholder","RunsMetricsLinePlot","runsData","useDefaultHoverBox","onHover","onUnhover","onUpdate","chartLayoutUpdated","layout","yAxisMin","yAxisMax","xAxisMin","xAxisMax","autorange","yAxisAutorange","newYRange","yaxis","isEqual","xAxisAutorange","newXRange","xaxis","ungroupedRunUuids","groupedRunUuids","_groupParentInfo$runU","shouldEnableRelativeTimeDateAxis","TIME_RELATIVE_HOURS","timestampRange","xRange","yRange","displayPoints","onSetDownloadHandler","onClickDownload","format","_config$selectedMetri3","_config$selectedMetri4","savedChartTitle","downloadChartMetricHistoryCsv","_d$runInfo","group","_group$groupParentInf","RunsChartCardWrapper","dragGroupKey","RunsChartsChartsDragGroup","GENERAL_AREA","supportedDownloadFormats","isHidden","RunsChartsNoDataFoundIndicator","overflow","_ref","_ref2","RunsChartsScatterChartCard","theme","useDesignSystemTheme","datasetName","_jsxs","_css","flex","display","alignItems","gap","spacing","xs","Typography","Text","ellipsis","bold","_Fragment","Tag","componentId","_config$xaxis$dataAcc","_config$yaxis$dataAcc","dataAccessKey","scatterChartCardWrapper","RunsScatterPlot","xAxis","yAxis","paramsToExport","metricsToExport","axis","type","push","downloadChartDataCsv","RunsChartsContourChartCard","zaxis","contourChartCardWrapper","RunsContourPlot","zAxis","_path2","_g","_defs","SvgParallelChartPlaceholder","strokeLinecap","opacity","x1","y1","x2","y2","gradientUnits","stopColor","offset","NotConfiguredParallelCoordsPlaceholder","ParallelChartSvg","Title","marginTop","md","color","level","FormattedMessage","defaultMessage","marginBottom","Button","onClick","_ref3","_ref4","UnsupportedDataPlaceholder","textAlign","_ref5","RunsChartsParallelChartCard","updateUIState","useUpdateExperimentViewUIState","configuredChartRunData","showAllRuns","containsStringValues","_config$selectedParam","selectedParams","paramKey","dataTrace","_dataTrace$params$par","isNaN","Number","params","updateVisibleOnlySetting","_state$compareRunChar","newCompareRunCharts","existingChartConfig","isConfigured","parallelCoordsData","configured","isParallelChartConfigured","processParallelCoordinateData","selectedMetrics","closeContextMenu","containsUnsupportedValues","displaySubtitle","parallelChartCardWrapper","LazyParallelCoordinatesPlot","data","axesRotateThreshold","fullScreenEnabled","tooltip","PARALLEL_CHARTS_AREA","additionalMenuContent","DropdownMenu","Separator","CheckboxItem","checked","ItemIndicator","cursor","NotConfiguredDifferenceChartPlaceholder","RunsChartsDifferenceChartCard","_config$compareGroups","Boolean","compareGroups","confirmChartCardConfiguration","useConfirmChartCardConfigurationFn","showChangeFromBaselineToggle","showChangeFromBaseline","showDifferencesOnlyToggle","showDifferencesOnly","formatMessage","useIntl","DifferenceViewPlot","previewData","setCardConfig","setter","showTooltip","DISABLED_GROUP_WHEN_GROUPBY","includes","chartName","toggles","toggleLabel","currentToggle","setToggle","RunsChartsImageChartCard","containerRef","useRef","containerWidth","setContainerWidth","tmpConfig","setTmpConfig","updateStep","newStep","tmpStepChange","currentConfig","imageKeys","DEFAULT_IMAGE_GRID_CHART_NAME","stepMarks","maxMark","minMark","useImageSliderStepMarks","selectedImageKeys","stepMarkLength","shouldDisplayImageLimitIndicator","tags","LOG_IMAGE_TAG_INDICATOR","NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE","flexDirection","sm","ImageGridPlot","justifyContent","LineSmoothSlider","onChange","marks","disabled","onAfterChange","cardBodyToRender","RunsChartsCardRaw","sectionIndex","onStartEditChart","onRemoveChart","canMoveDown","canMoveUp","previousChartUuid","nextChartUuid","onReorderWith","editProps","commonChartProps","RunsChartType","PARALLEL","DIFFERENCE","IMAGE","BAR","RunsChartsBarChartCard","LINE","SCATTER","CONTOUR","RunsChartsCard","memo","_path3","SvgChartContour","originalCardConfig","result","globalXAxisKey","useGlobalLineSmoothing","useGlobalXaxisKey","globalSelectedXAxisMetricKey","START_TIME_COLUMN_OFFSET","ALL","LAST_HOUR","LAST_24_HOURS","LAST_7_DAYS","LAST_30_DAYS","LAST_YEAR","SQL_SYNTAX_PATTERN","RegExp","RUNS_AUTO_REFRESH_INTERVAL","detectSqlSyntaxInSearchQuery","test","createQuickRegexpSearchFilter","replace","createSearchRunsParams","searchFacetsState","referenceTime","pageToken","runViewType","LIFECYCLE_FILTER","ACTIVE","ViewType","ACTIVE_ONLY","DELETED_ONLY","runsPinned","createOrderByExpression","startTimeExpression","createStartTimeExpression","createFilterExpression","datasetsFilterExpression","shouldUseRegexpBasedAutoRunsSearchFilter","activeFilters","createDatasetsFilterExpression","dataset","shouldFetchParents","shouldNestChildrenAndFetchParents","ATTRIBUTE_COLUMN_SORT_KEY","DATE","RUNS_SEARCH_MAX_RESULTS","fetchModelVersionsForRuns","runsPayload","actionCreator","dispatch","runsWithLogModelHistory","EXPERIMENT_LOG_MODEL_HISTORY_TAG","promises","chunk","MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER","runsChunk","action","run_id","info","getUUID","Promise","all","isSearchFacetsFilterUsed","currentSearchFacetsState","DEFAULT_LIFECYCLE_FILTER","DEFAULT_MODEL_VERSION_FILTER","DEFAULT_START_TIME","DRAGGABLE_CARD_HANDLE_CLASS","DRAGGABLE_CARD_TRANSITION_NAME","DRAGGABLE_CARD_TRANSITION_VAR","RunsChartCardWrapperRaw","noop","onMoveUp","onMoveDown","usingCustomTitle","React","gridTemplateRows","backgroundColor","colors","backgroundPrimary","padding","paddingBottom","border","borderRadius","general","borderRadiusBase","transition","position","marginRight","className","DragIcon","String","withoutMargins","LegacyInfoTooltip","heightSm","Spinner","lg","toggle","Switch","label","icon","FullscreenIcon","Root","modal","Trigger","asChild","OverflowIcon","Content","align","minWidth","Item","chartEntry","chartComponentWrapper","textSecondary","fontSize","verticalAlign","forwardRef","style","PLOT_CONFIG","displaylogo","scrollZoom","modeBarButtonsToRemove","markerSize","margin","runsChartDefaultMargin","layoutHeight","layoutWidth","setContainerDiv","containerDiv","isDynamicSizeSupported","useDynamicPlotSize","plotData","xValues","yValues","tooltipData","_xAxisData","_xAxis$dataAccessKey","_yAxisData","_yAxis$dataAccessKey","displayName","runName","xAxisData","yAxisData","x","y","primary","customdata","text","hovertemplate","hoverinfo","hoverlabel","runsChartHoverlabel","mode","textposition","marker","size","plotlyThemedLayout","createThemedPlotlyLayout","setLayout","tickfont","template","current","newLayout","setHoveredPointIndex","useRenderRunsChartTraceHighlight","highlightScatterTraces","hoverCallback","points","_points$","_points$$customdata","_points$0$pointIndex","_points$2","pointCustomDataRunUuid","pointIndex","unhoverCallback","mutableHoverCallback","useMutableChartHoverCallback","legendLabelData","getLegendDataFromRuns","dataToExport","trace","createChartImageDownloadHandler","chart","commonRunsChartStyles","chartWrapper","scatterChartHighlightStyles","LazyPlot","useResizeHandler","RunsMetricsLegendWrapper","labelData","TraceLabel","dashStyle","textOverflow","flexShrink","maxWidth","TraceLabelColorIndicator","strokeDasharray","dashType","getDashArray","pathYOffset","typography","fontSizeSm","STROKE_WIDTH","RunsMetricsLegend","flexWrap","alignContent","overflowY","overflowX","labelDatum","_labelDatum$uuid","RunsChartsConfigureField","RunsChartsMetricParamSelect","metricKeyList","paramKeyList","isEmpty","LegacySelect","selectFull","dangerouslySetAntdProps","showSearch","OptGroup","Option","makeCanonicalSortKey","param","RunsChartsMetricParamSelectV2","metricOptions","paramOptions","SimpleSelect","target","contentProps","matchTriggerWidth","maxHeight","SimpleSelectOptionGroup","SimpleSelectOption","runsChartsRunCountDefaultOptions","RunsChartsConfigureMetricWithDatasetSelect","metricKeysByDataset","find","RunsChartsConfigureBarChart","onStateChange","_state$dataAccessKey","updateMetric","runsCountToCompare","emptyMetricsList","RunsChartsConfigureParallelChart","updateSelectedParams","updateSelectedMetrics","emptyParamsList","renderMetricSelectorV2","placeholder","ExpressionInput","chartExpression","updateYAxisExpression","removeYAxisExpression","compileExpression","useChartExpressionParser","isValidExpression","setIsValidExpression","Input","compiledExpression","rpn","validateAndUpdate","validationState","CloseIcon","RunsChartsYAxisMetricAndExpressionSelector","usingChartExpressions","temporaryChartExpressions","setTemporaryChartExpressions","updateYAxisExpressionTemporary","newExpressions","removeYAxisExpressionTemporary","splice","handler","setTimeout","clearTimeout","updateYAxisKey","Radio","Group","PlusIcon","addNewYAxisExpressionTemporary","USE_GLOBAL_SETTING_KEY","renderXAxisMetricSelector","updateSelectedXAxisMetricKey","preventDefault","stopPropagation","safeLog","log10","safePow","pow","RunsChartsConfigureLineChart","_state$range","_state$range2","_state$range3","_state$range4","_state$range5","_state$range6","_state$range7","_state$range8","intl","localAxisRange","setLocalAxisRange","updateXAxisKey","useGlobal","selectedYAxisMetricKey","isInvalidLogValue","updateXAxisScaleType","isLogType","newXMin","newXMax","prev","updateYAxisType","newYMin","newYMax","updateIgnoreOutliers","updateSmoothing","updateXAxisWhenConfirmed","inTransitionState","updateYAxisWhenConfirmed","a","b","invalidMessage","FormUI","Message","message","METRIC_AXIS_PREFIX","textOverflowMode","startsWith","slice","Tooltip","content","side","QuestionMarkIcon","timeStepQuestionMarkIcon","LegacyTooltip","placement","updateXAxisScaleMin","updateXAxisScaleMax","activeLabel","inactiveLabel","disabledLabel","paddingTop","updateYAxisScaleMin","updateYAxisScaleMax","Spacer","delayDuration","SegmentedControlGroup","SegmentedControlButton","InfoSmallIcon","svg","RunsChartsConfigureLineChartPreview","connect","mapStateToProps","metricsByRunUuid","areStatesEqual","nextState","prevState","RunsChartsConfigureLineChartPreviewImpl","_cardConfig$ignoreOut","_cardConfig$range","_cardConfig$range2","_cardConfig$range3","_cardConfig$range4","_r$runInfo$runUuid","_g$runUuid","metricKeysToFetch","_cardConfig$selectedM","checkValidRange","rangeMin","rangeMax","RunsChartsConfigureContourChart","updateAxis","canonicalKey","isCanonicalSortKeyOfType","extractCanonicalSortKey","_state$xaxis","_state$yaxis","_state$zaxis","firstMetric","firstParam","RunsChartsConfigureScatterChart","RunsChartsConfigureDifferenceChart","updateCompareGroups","compareGroup","updateChartName","updateShowChangeFromBaseline","updateShowDifferencesOnly","Checkbox","defaultValue","DifferenceCardConfigCompareGroup","_state$compareGroups","groupedCondition","isChecked","RunsChartsConfigureImageChart","imageKeyList","handleUpdate","imageKey","_currentConfig$imageK","_currentConfig$imageK2","DialogCombobox","multiSelect","DialogComboboxTrigger","onClear","handleClear","DialogComboboxContent","DialogComboboxOptionList","_state$imageKeys","DialogComboboxOptionListCheckboxItem","RunsChartsConfigureScatterChartWithDatasets","_metricKeysByDataset$","_paramKeyList$map","handleChange","foundMetric","foundParam","_state$axis","getSelectedValue","foundMetricOption","foundParamOption","selectedXValue","selectedYValue","previewComponentsMap","RunsChartsConfigureBarChartPreview","_cardConfig$dataAcces","dataKey","RunsMetricsBarPlot","displayRunNames","displayMetricKey","barChartCardDefaultMargin","RunsChartsConfigureContourChartPreview","RunsChartsConfigureParallelChartPreview","_cardConfig$selectedP","filteredData","Empty","description","image","NoIcon","RunsChartsConfigureScatterChartPreview","RunsChartsConfigureImageChartPreview","_cardConfig$imageKeys","RunsChartsConfigureModal","onCancel","onSubmit","supportedChartTypes","isChartTypeSupported","borderStyle","actionDefaultBorderDefault","currentFormState","setCurrentFormState","isEditing","updateChartType","emptyChartCard","RunsChartsCardConfig","getEmptyChartCardByType","images","sort","disableSaveButton","_lineCardConfig$selec","Modal","visible","onOk","okButtonProps","cancelText","okText","bodyStyle","gridTemplateColumns","borderTop","borderBottom","borderRight","chartType","chartTypeOption","ChartBarIcon","ChartScatterIcon","ChartLineIcon","ChartParallelIcon","ChartContourIcon","ChartDifferenceIcon","ChartImageIcon","RunsChartsTooltipWrapper","contextData","runs","component","RunsChartsTooltipBody","hoverOnly","PreviewComponent","renderPreviewChartType","iconSize","RUNS_CHARTS_UI_Z_INDEX","CARD_PREVIEW","CARD_DRAGGED","TOOLTIP_CONTAINER","SEARCH_BAR","TOOLTIP","ParallelCoordinatesPlot","Suspense","LegacySkeleton","ExperimentPageUISetStateContext","ExperimentPageUIStateContextProvider","setUIState","Provider","useToggleRowVisibilityCallback","tableRows","useGroupedValuesInCharts","immediateTableRows","toggleRowUsingVisibilityMap","groupOrRunUuid","isCurrentlyVisible","currentUIState","RUNS_VISIBILITY_MODE","CUSTOM","_immediateTableRows$c","newRunsVisibilityMap","runsVisibilityMap","currentToggledGroupInfo","rowUuid","shouldEnableToggleIndividualRunsInGroups","SHOWALL","HIDEALL","FIRST_10_RUNS","FIRST_20_RUNS","runsHiddenMode","runsHidden","toggleRowVisibility","_immediateTableRows$c2","currentlyHiddenRows","newHiddenRows","allRunsHidden","currentGroupOrRunUuid","shouldUseRunRowsVisibilityMap","heightBuffer","GET_METRIC_HISTORY_BULK_INTERVAL","gql","shouldUseGraphql","shouldEnableGraphQLSampledMetrics","legacyResult","useDispatch","store","rangeKey","createChartAxisRangeKey","anyRunRefreshing","anyRunLoading","returnValues","metricsByMetricKey","dataByMetricKey","_store$entities$sampl","_store$entities$sampl2","runMetricData","loading","refreshing","keyBy","left","right","refreshFn","runUuidsChunk","getSampledMetricHistoryBulkAction","refreshTimeoutRef","autoRefreshEnabledRef","runUuidsSerialized","hookUnmounted","fetchMetricsFn","async","isAutoRefreshing","split","scheduleRefresh","Utils","logErrorAndNotifyUser","window","EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL","then","refresh","useSampledMetricHistoryREST","graphQlResult","useSampledMetricHistoryGraphQL","_range$","_range$2","_data$mlflowGetMetric6","refetch","startPolling","stopPolling","networkStatus","error","useQuery","skip","notifyOnNetworkStatusChange","pollInterval","onCompleted","_data$mlflowGetMetric","_data$mlflowGetMetric2","_data$mlflowGetMetric3","_data$mlflowGetMetric4","mlflowGetMetricHistoryBulkInterval","apiError","code","displayGlobalErrorNotification","Error","runIds","startStep","endStep","_data$mlflowGetMetric5","metricsByRunId","runId","_metricsByRunId$runId","NetworkStatus","setVariables","poll","useExperimentIds","location","useLocation","normalizedLocationSearch","decodeURIComponent","search","compareExperimentIdsQueryParam","qs","substring","experimentIdsRaw","highlightChartTracesFn","traceSelector","parentSelector","parent","hoverIndex","selectIndex","numberOfBands","_parent$querySelector","_parent$querySelector3","deselected","_parent$querySelector2","_parent$querySelector4","_parent$querySelector5","_parent$querySelector6","querySelector","classList","remove","querySelectorAll","bandTraceIndex","highlightBarTraces","highlightLineTraces","highlightFn","lastRunsData","selectedTraceIndex","findIndex","hoveredPointIndex","onHighlightChange","useRunsChartTraceHighlight","shouldEnableUnifiedChartDataTraceHighlight","lastSelectedTraceIndex","highlightChangeListener","newExtern","externallyHighlightedRunIndex","ChartsTraceHighlightSource","RunsChartsSetHighlightContext","createContext","highlightDataTrace","RunsChartsSetHighlightContextProvider","highlightListenerFns","block","contextValue","traceUuid","shouldBlock","source","notifyListeners","fn","listener","createElement","useContext","useRunsHighlightTableRow","containerElementRef","highlightedClassName","findInFlexColumns","getRowUuid","_containerElementRef$","_containerElementRef$2","existingHighlightedRowElement","additionalSelectorPrefix","rowElement","TABLE","cellMouseOverHandler","isGroupRow","dataTraceUuid","cellMouseOutHandler","ColumnHeaderCell","enableSorting","canonicalSortKey","tableContext","updateSearchFacets","selectedCanonicalSortKey","role","paddingLeft","paddingRight","actionTertiaryTextHover","handleSortBy","newOrderByAsc","SortAscendingIcon","SortDescendingIcon","DateCellRenderer","runStatus","cellWrapper","formatTimestamp","RunStatusIcon","status","timeSinceStr","TrimmedText","maxSize","allowShowMore","dataTestId","trimmedText","substr","showMore","setShowMore","expandButton","RunDescriptionCellRenderer","getRunDescriptionFromTags","ExperimentNameCellRenderer","Link","to","Routes","getExperimentPageRoute","basename","ModelLink","model","isUc","registeredModelName","registeredModelVersion","flavors","artifactPath","originalLoggedModel","RegisteredModelOkIcon","actionPrimaryBackgroundDefault","ModelsIcon","ModelRegistryRoutes","getModelVersionPageRoute","getRunPageRoute","renderModelName","tooltipBody","shouldUnifyLoggedModelsAndRegisteredModels","_originalLoggedModel$","_originalLoggedModel$2","loggedModelExperimentId","experiment_id","loggedModelId","model_id","_originalLoggedModel$3","originalModelLink","getExperimentLoggedModelDetailsPage","_ref6","_ref7","LoggedModelV3Link","_model$info","_model$info2","_ref8","ModelsCellRenderer","registeredModels","loggedModels","loggedModelsV3","modelsLegacy","mergeLoggedAndRegisteredModels","modelVersions","registeredModelVersions","useExperimentLoggedModelRegisteredVersions","registeredModelVersionsByLoggedModel","shouldUseGetLoggedModelsBatchAPI","modelVersion","_modelVersion$sourceL","_modelVersion$sourceL2","sourceLoggedModel","_modelVersion$display","_modelVersion$version","_modelVersion$sourceL3","_modelVersion$sourceL4","_modelVersion$sourceL5","displayedName","version","isUCModelName","artifact_uri","registeredModelsToDisplay","allModels","uniqBy","_model$registeredMode","containsModels","Overflow","_model$info3","_model$info$model_id","_model$info4","modelId","loggedModelRegisteredVersions","ModelsHeaderCellRenderer","isUsingUnifiedModels","ATTRIBUTE_COLUMN_LABELS","MODELS","InfoTooltip","VersionCellRenderer","renderSourceVersion","VisibleIcon","Icon","VisibleFillIcon","MOUSE_DELAYS","mouseEnterDelay","mouseLeaveDelay","RunVisibilityControlButton","rowHidden","buttonHidden","button","VisibleOffIcon","grey400","visuallyHidden","isRowVisible","iconFontSize","grey500","ExperimentViewRunsTableHeaderContext","usingCustomVisibility","ExperimentViewRunsTableHeaderContextProvider","useExperimentViewRunsTableHeaderContext","labels","visibility","groups","defineMessages","unhide","hide","pinning","unpin","pin","RowActionsCellRenderer","runDateAndNestInfo","visibilityControl","isVisibilityButtonDisabled","RunRowVisibilityControl","Disabled","pinned","runUuidToToggle","isRowHidden","visibilityMessageDescriptor","pinningMessageDescriptor","isVisibilityButtonHidden","Hidden","isRemainingRunsGroup","actionsContainer","onToggleVisibility","actionCheckbox","showOnlyInCompareMode","pinnable","uuidToPin","existingState","PinFillIcon","PinIcon","random","prevProps","nextProps","_prevProps$data$group","_nextProps$data$group","RowActionsCellRendererSuppressKeyboardEvents","event","HTMLElement","contains","appearance","RowActionsHeaderCellRendererV2","actionButton","RadioGroup","onValueChange","RadioItem","DashIcon","RowActionsHeaderCellRenderer","_props$eGridHeader","selectAllCheckbox","eGridHeader","ariaLabel","background","GroupParentCellRenderer","isComparingRuns","invariant","getRunColor","useGetExperimentRunColor","saveRunColor","useSaveExperimentRunColor","onExpandToggle","groupId","doOpen","groupsExpanded","groupName","getRunGroupDisplayName","groupIsDisplayedInCharts","urlToRunUuidsFilter","createSearchFilterFromRunGroupInfo","searchParams","URLSearchParams","expanderOpen","ChevronDownIcon","ChevronRightIcon","RunColorPill","onChangeColor","colorValue","groupUuid","marginLeft","NewWindowIcon","RunNameCellRenderer","onExpand","hasExpander","childrenIds","renderingAsParent","hideRunColorControl","expanderWrapper","nestLevel","expanderButton","MinusSquareIcon","PlusSquareIcon","runLink","tabIndex","link","fontSizeBase","minHeight","textDecoration","LoadMoreRowRenderer","loadMoreRunsFunc","SingleDataset","datasetWithTags","onDatasetSelected","appendComma","inPopover","contextTag","MLFLOW_RUN_DATASET_CONTEXT_TAG","TableIcon","Popover","Close","textTransform","DatasetsCellRenderer","datasets","expandRows","containerElement","datasetsVisible","setDatasetsVisible","ellipsisVisible","setEllipsisVisible","clampedDatasets","datasetsLength","callback","throttle","availableHeight","contentRect","elementsFit","stackedHeight","i","item","clientHeight","availableWidth","stackedWidth","clientWidth","partiallyVisibleDatasets","resizeObserver","ResizeObserver","observe","disconnect","moreItemsToShow","datasetsToShow","DatasetsCellRendererSuppressKeyboardEvents","HTMLButtonElement","AggregateMetricValueCell","valueFormatted","_data$groupParentInfo","cellClassIsOrderedBy","colDef","_colDef$headerCompone","headerComponentParams","getActionsColumnWidth","BASE_RUN_ACTIONS_COLUMN_WIDTH","createParamFieldName","EXPERIMENT_FIELD_PREFIX_PARAM","createTagFieldName","EXPERIMENT_FIELD_PREFIX_TAG","UntrackedSpinner","defaultKeyboardNavigationSuppressor","TAGS_TO_COLUMNS_MAP","USER","COLUMN_TYPES","ATTRIBUTES","RUN_NAME","SOURCE","VERSION","DESCRIPTION","getRowId","getRowIsLoadMore","rowNode","isLoadMoreRow","getAdjustableAttributeColumns","isComparingExperiments","DATASET","EXPERIMENT_NAME","useRunsColumnDefinitions","selectedColumns","compareExperiments","onTogglePin","tagKeyList","columnApi","cumulativeColumns","useCumulativeColumnKeys","cachedMetricKeys","cachedParamKeys","cachedTagKeys","paramKeys","tagKeys","usingCompactViewport","useMediaQuery","responsive","breakpoints","columnSet","columns","valueGetter","checkboxSelection","headerComponent","headerCheckboxSelection","headerName","cellClass","cellRenderer","cellRendererParams","resizable","suppressKeyboardEvent","isRunColumnDynamicSized","colId","headerTooltip","sortable","equals","runA","runB","_runA$groupParentInfo","_runB$groupParentInfo","cellClassRules","initialWidth","dateInfo1","dateInfo2","DURATION","experimentName1","experimentName2","initialHide","tags1","tags2","getSourceName","version1","version2","models1","models2","METRICS","_customMetricColumnDe","_customMetricColumnDe2","customMetricColumnDef","customMetricBehaviorDefs","fieldName","EXPERIMENT_FIELD_PREFIX_METRIC","getQualifiedEntityName","tooltipValueGetter","_params$data","initialColumnWidth","valueFormatter","cellRendererSelector","is-previewable-cell","PARAMS","tooltipField","TAGS","tagKey","canonicalSortKeys","setColumnVisible","EXPERIMENTS_DEFAULT_COLUMN_SETUP","autoSizePadding","menuIcon","suppressMenu","suppressMovable","ExperimentViewRunsEmptyTable","isFiltered","onClearFilters","noResultsWrapper","noResults","FilterIcon","chunks","href","LoggingRunsDocUrl","rel","BeakerIcon","inset","CLASS_OUT_OF_VIEWPORT","CLASS_IS_HIDDEN","CLASS_IS_MINIMIZED","AG_GRID_CLS","ExperimentViewRunsTableAddColumnCTA","gridContainerElement","isInitialized","moreRunsAvailable","moreAvailableRunsTableColumnCount","ctaRef","savedContainerRef","immediateMoreRunsAvailable","initialize","targetElement","rootElement","refLeftElem","refCenterElem","refHeaderElem","refBodyViewport","gridAreaWidth","leftColContainerWidth","leftColContainerHeight","centerColContainerWidth","colContainerHeight","headerHeight","_savedContainerRef$cu","_savedContainerRef$cu2","_savedContainerRef$cu3","_savedContainerRef$cu4","calculatedLeft","calculatedTop","loadMoreRowHeight","calculatedHeight","transform","columnContainer","buttonContainer","PlusCircleIcon","buttonIcon","caption","borderDecorative","top","willChange","pointerEvents","whiteSpace","strong","ExperimentViewRunsTableStatusBar","allRunsCount","statusBar","agGridSelectRunRows","isSelected","gridApi","forEachNode","node","_node$data","childRunDateInfo","childrenRunUuid","setSelected","ExperimentViewRunsTable","experiments","updateViewState","onAddColumnClicked","rowsData","viewState","uiState","setUrlSearchFacets","runListHidden","tagsList","setGridApi","setColumnApi","filteredTagKeys","getVisibleTagKeyList","expandersVisible","row","_row$runDateAndNestIn","toggleRowExpanded","parentId","runsExpanded","currentRunsExpanded","togglePinnedRow","existingFacets","gridReadyHandler","api","handleRowSelected","onSelectionChange","selectedUUIDs","getSelectedRows","runsSelected","aggregate","curr","isParent","selectedRunRows","rowData","every","agGridSelectGroupRows","useExperimentTableSelectRowHandler","runInfos","columnDefs","gridSizeHandler","sizeColumnsToFit","showLoadingOverlay","hideOverlay","setRowData","uniqueId","allAvailableColumnsCount","hasSelectedAllColumns","runUuidsMatchingFilter","useLayoutEffect","deselectAll","resetRowHeights","rowHeightGetterFn","EXPERIMENT_RUNS_TABLE_ROW_HEIGHT","datasetColumnId","getDatasetsCellHeight","datasetColumnShown","_data$datasets","datasetsCount","sidebarPreviewData","setSidebarPreviewData","handleCellClicked","column","_column$getParent","columnGroupId","getParent","getGroupId","header","getColDef","previewPaneVisible","displayAddColumnsCTA","displayPreviewSidebar","displayRunsTable","displayStatusBar","displayEmptyState","gridStyles","useExperimentAgGridTableStyles","MLFlowAgGridLoader","defaultColDef","rowSelection","onGridReady","onSelectionChanged","getRowHeight","onRowSelected","suppressRowClickSelection","suppressColumnMoveAnimation","suppressScrollOnNewData","isFullWidthRow","fullWidthCellRenderer","fullWidthCellRendererParams","suppressFieldDotNotation","enableCellTextSelection","components","agColumnHeader","loadingOverlayComponent","SourceCellRenderer","suppressNoRowsOverlay","loadingOverlayComponentParams","showImmediately","rowBuffer","onCellClicked","onGridSizeChanged","onCellMouseOver","onCellMouseOut","maxBlocksInCache","cacheBlockSize","maxConcurrentDatasourceRequests","suppressModelUpdateAfterUpdateTransaction","immutableData","getRowNodeId","suppressPropertyNamesCheck","suppressAnimationFrame","PreviewSidebar","copyText","headerText","onClose","empty","agGridOverrides","usingCustomHeaderComponent","gridColors","rowForeground","textPrimary","rowBackground","rowBackgroundHover","tableBackgroundUnselectedHover","rowBackgroundSelected","tableBackgroundSelectedDefault","rowBackgroundHoverSelected","tableBackgroundSelectedHover","columnSortedBy","blue400","headerBackground","backgroundSecondary","headerTextColor","headerGroupTextColor","borderColor","headerBorderColor","checkboxBorderColor","checkboxBorderColorChecked","checkboxBackgroundColorChecked","overlayBackground","getGridColors","zIndex","borderLeft","DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE","getDifferenceChartDisplayedValue","val","places","toFixed","DifferenceChartCellDirection","isDifferent","abs","DIFFERENCE_PLOT_EXPAND_COLUMN_ID","DIFFERENCE_PLOT_HEADING_COLUMN_ID","getDifferencePlotJSONRows","getChildren","parsedRowWithoutHeadingCol","schema","_parsedRowWithoutHead","newParsedRow","_parsedRowWithoutHead2","jsonSchema","isAllJson","parsedRow","json","parsed","validateParseJSON","commonSchema","extractMaximumCommonSchema","schema1","schema2","collectKeys","CellDifference","direction","paragraphColor","NEGATIVE","ArrowDownIcon","POSITIVE","ArrowUpIcon","SAME","actionDisabledBackground","borders","borderRadiusSm","userSelect","DifferencePlotDataCell","getValue","original","columnDef","_columnDef$meta","isBaseline","baselineColumnUuid","meta","rowDifference","differenceView","diff","DifferencePlotRunHeaderCell","_columnDef$meta2","traceData","updateBaselineColumnUuid","fontWeight","ExpandCell","toggleExpand","getCanExpand","getIsExpanded","modelMetrics","systemMetrics","parameters","attributes","getDifferenceViewDataGroups","headingColumnId","getMetrics","filterCondition","runDataKeys","runDataAttribute","hasDifference","MLFLOW_SYSTEM_METRIC_PREFIX","getVisibleTagValues","DifferenceCardAttributes","attribute","attributeData","_runData$runInfo","user","getUser","getSourceVersion","models","getLoggedModelsFromTags","baselineColumn","nonBaselineColumns","dataTracesReverse","dataRows","MODEL_METRICS","SYSTEM_METRICS","PARAMETERS","cell","enableResizing","accessorKey","_traceData$uuid","expanded","setExpanded","table","useReactTable","getCoreRowModel","getExpandedRowModel","columnResizeMode","enableExpanding","getSubRows","getRowCanExpand","subRows","columnPinning","tableContainerRef","getVirtualItems","getTotalSize","useVirtualizer","count","rows","getScrollElement","estimateSize","paddingStart","expandedRows","Table","TableRow","isHeader","getLeafHeaders","isPinned","getIsPinned","TableHeader","setColumnSizing","multiline","getStart","getSize","flexBasis","wrapContent","flexRender","getContext","start","getVisibleCells","isNameColumn","TableCell","depth","_rect","_rect2","_rect3","_rect4","_rect5","_rect6","_rect7","_rect8","_rect9","_rect0","_rect1","_rect10","_rect11","_rect12","_rect13","_rect14","_rect15","_rect16","SvgChartDifference","ImageGridSingleKeyPlot","displayRuns","imageMetadata","EmptyImageGridPlot","imageMetadataByStep","metadata","lineHeightMd","ImagePlotWithHistory","metadataByStep","ImageGridMultipleKeyPlot","grid","scrollable","MIN_GRID_IMAGE_SIZE","containsLoggedImages","filteredPreviewData","rowGap","CopyButton","showLabel","CopyIcon","MetricChartsAccordion","activeKey","onActiveKeyChange","disableCollapse","getPrefixedClassName","clsPrefix","classItem","classItemActive","classHeader","classContent","classContentBox","classArrow","outlineColor","outlineStyle","lineHeight","Accordion","dangerouslyAppendEmotionCSS","expandIconPosition","RunsChartsAddChartMenu","onAddChart","addChartButton","IconWrapper","iconWrapper","RunsChartsSectionHeader","section","sectionChartsLength","addNewChartCard","onDeleteSection","onAddSection","editSection","onSetEditSection","onSetSectionName","onSectionReorder","isExpanded","hideExtraControls","tmpSectionName","setTmpSectionName","isDraggingHandle","setIsDraggingHandle","sectionNameRef","confirmButtonRef","sectionNameWidth","setSectionNameWidth","isDeleteSectionModalOpen","setIsDeleteSectionModalOpen","trim","isCurrentlyEdited","isCurrentlyHovered","setIsCurrentlyHovered","dragHandleRef","dragPreviewRef","dropTargetRef","isOver","isDragging","useDragAndDropElement","dragKey","onDrop","onMouseMove","onMouseLeave","element","isDarkMode","blue800","blue100","EDITABLE_LABEL_PADDING_WIDTH","autoFocus","onMouseDown","onMouseUp","onDoubleClick","lineHeightBase","onKeyDown","onPressEnter","onBlur","relatedTarget","PencilIcon","CheckIcon","rotate","addSectionAbove","addSectionBelow","deleteSection","DangerModal","deleteModalConfirm","deleteModalCancel","alignSelf","sharedObserver","entryCallbackMap","WeakMap","observeElement","_sharedObserver","IntersectionObserver","entryCallback","isIntersecting","_sharedObserver2","unobserve","RunsChartsDraggableCard","_translateBy$x","_translateBy$y","setElementRef","useIsInViewport","setIsInViewport","translateBy","onResizeStart","onResize","onResizeStop","cardProps","deferredValue","useDebounce","resizeWidth","setResizeWidth","resizeHeight","setResizeHeight","setIsDragging","origin","setOrigin","setDraggedCardUuid","onDropChartCard","useRunsChartsDraggableGridActionsContext","draggedCardElementRef","onStartDrag","onDrag","onStopDrag","onResizeStartInternal","_draggedCardElementRe","rect","getBoundingClientRect","_rect$width","_rect$height","onResizeInternal","DraggableCore","enableUserSelectHack","onStart","onStop","handle","Resizable","ResizableHandle","overflowing","bottom","actionDefaultIconDefault","RunsChartsDraggablePreview","actionDefaultBackgroundHover","borderWidth","rowHeightSuggestions","PlaceholderSymbol","Symbol","RunsChartsDraggableCardsGridSection","cardsConfig","sectionConfig","sectionId","_sectionConfig$column","_sectionConfig$cardHe","cardHeight","gridBoxRef","draggedCardUuid","useRunsChartsDraggableGridStateContext","setTargetSection","setTargetPosition","onSwapCards","useUpdateRunsChartsUIConfiguration","setColumns","columnCount","_current$compareRunSe","_current$compareRunSe2","compareRunSections","s","setCardHeight","_current$compareRunSe3","_current$compareRunSe4","lastElementCount","setPositionInSection","resizePreview","setResizePreview","findCoords","_gridBoxRef$current","rowCount","col","colGapsCount","passedColGaps","passedRowGaps","cardsToRender","isEmptyChartCard","cardTransforms","newArray","fromIndex","toIndex","newIndex","indexOf","oldIndex","oldCoords","newCoords","deltaX","deltaY","dragPreview","_gridBoxRef$current2","_rect$width2","mouseMove","pos","clientY","clientX","columnSuggestions","setColumnSuggestions","immediateColSuggestion","immediateRowSuggestion","_gridBoxRef$current3","gridBoxRefSize","getColumnSuggestions","gapSize","cols","_immediateColSuggesti","_immediateRowSuggesti","columnSuggestion","rowHeightSuggestion","Global","array","_cardConfig$uuid","_cardConfig$uuid2","_array","_array2","RunsChartsSection","sectionCharts","reorderCharts","insertCharts","isMetricHistoryLoading","startEditChart","removeChart","getChartMetricsAndParams","barConfig","lineConfig","scatterConfig","toLowerCase","parallelConfig","contourConfig","RunsChartsSectionAccordion","noRunsSelectedEmptyState","setEditSection","onActivePanelChange","newCompareRunPanels","shouldDisplaySection","chartConfig","isGenerated","metricSectionId","deleted","newCompareRunSections","isAccordionReordered","addSection","above","idx","newSection","isReordered","appendSection","setSectionName","sectionReorder","sourceSectionId","targetSectionId","sourceSectionIdx","targetSectionIdx","sourceSection","noRunsSelected","sectionsToRender","chartsToRender","compareRunChartsFiltered","chartMatchesFilter","filterRegex","metricOrParam","match","sectionsWithCharts","has","isSearching","Panel","_path4","_path5","SvgChartParallel","MATCH_VARIABLE_REGEX","Operator","Parenthesis","VariableParenthesis","precedence","ADD","SUBTRACT","MULTIPLY","DIVIDE","POWER","NEGATIVE_SIGN","POSITIVE_SIGN","isBinaryOperator","char","isUnaryOperator","variableStringToIndex","popAndValidate","stack","operandCount","lastElement","pop","flushUnaryOperators","output","noVariableExpression","parsedExpression","matches","dedupMatches","matchesMap","parseVariablesAndReplaceWithIndex","cleanedExpression","incrementOperand","isUnarySign","OPEN","CLOSE","num","periodMatches","floatNum","parseFloat","op1","isHigherPrecedence","toRPN","parseInt","evaluateExpression","tokens","token","fromRPN","experimentChartImageDefaultDownloadLayout","paper_bgcolor","plot_bgcolor","experimentChartImageDefaultDownloadSettings","experimentChartImageDefaultDownloadPlotConfig","downloadImage","filename","downloadHandlerRef","downloadHandler","setDownloadHandler","setDownloadHandlerCached","existingHandler","chartTitle","_downloadHandlerRef$c","MLFlowAgGridImpl","cssTheme","l","pad","_config$dataAccessKey","barChartCardWrapper","_customMetricBehavior3","_customMetricBehavior4","_customMetricBehavior","_customMetricBehavior2","runsToExport","PlotlyLikeFormattedTime","FormattedDate","year","month","day","FormattedTime","hour","hourCycle","minute","second","fractionalSecondDigits","PlotlyLikeFormattedTimestamp","RunsMultipleTracesTooltipBody","hoverData","tooltipLegendItems","hoveredDataPoint","singleTraceHoverData","xValue","xAxisKeyLabel","metricEntity","hoveredTraceUuid","displayedXValueLabel","getChartAxisLabelDescriptor","columnGap","textPlaceholder","RunsChartsUIConfigurationContext","RunsChartsUIConfigurationContextProvider","updateChartsUIState","useReorderRunsChartsFn","sourceChartUuid","targetChartUuid","_current$compareRunCh","newChartsOrder","newSectionsState","indexSource","c","indexTarget","sourceChart","targetChart","isSameMetricSection","newSourceChart","configuredCard","serializedCard","serialize","_current$compareRunCh2","existingChartCard","useInsertRunsChartsFn","_current$compareRunCh3","useRemoveRunsChartFn","configToDelete","_current$compareRunCh4","_current$compareRunCh5","setup","useSearchLoggedModelsQuery","orderByField","searchQuery","selectedFilterDatasets","orderByDatasetName","orderByDatasetDigest","_last","queryKey","isFetching","fetchNextPage","useInfiniteQuery","queryFn","pageParam","requestBody","experiment_ids","order_by","field_name","ascending","dataset_name","dataset_digest","page_token","loggedModelsDataRequest","getAjaxUrl","cacheTime","getNextPageParam","lastPage","next_page_token","refetchOnWindowFocus","retry","pages","page","nextPageToken","loadMoreResults","RunsChartsFullScreenModal","fullScreenChart","tooltipContextValue","tooltipComponent","footer","verticalSizing","onReorderCharts","doubleClick","showTips","barWidth","ids","names","_d$metrics$metricKey","normalizeChartValue","textValues","_d$metrics$metricKey3","customMetricBehaviorDef","_d$metrics$metricKey2","getFixedPointValue","textfont","orientation","hovermode","tickformat","chartAxisTickFormat","showticklabels","fixedrange","_points$0$data","yValue","layoutToExport","automargin","highlightStyles","DEFAULT_COLOR_SCALE","reverseScale","runsChartDefaultContourMargin","colorScale","zValues","_xAxisData$xAxis$key","_yAxisData$yAxis$key","_zAxisData$zAxis$key","zAxisData","z","layers","zAxisTitle","line","unshift","connectgaps","contours","coloring","colorscale","reversescale","colorbar","family","ticks","standoff","_scatterPoints$pointI","_customdata","scatterPoints","curveNumber","RunsChartsDraggableGridStateContext","targetSection","RunsChartsDraggableGridActionsContext","RunsChartsDraggableCardsGridContextProvider","visibleChartCards","targetSectionUuid","setTargetSectionUuid","immediateDraggedCardUuid","immediateTargetSectionId","targetLocalPosition","draggedChartUuid","targetPosition","sourceCard","sourceSectionCards","chartCard","resultChartsList","visibleSectionCards","originalIndex","clampedLocalPosition","targetIndex","targetSectionCards","sortBy","_targetSectionCards$i","stateContextValue","actionsContextValue","DragAndDropProvider","createLineChartValuesBox","activeRun","_hoverData$metricEnti","_hoverData$yValue","metricKeyFromConfig","metricValue","getTooltipXValue","_hoverData$xValue","_hoverData$xValue2","ValuesBox","isHovering","createBarChartValuesBox","displayValue","createScatterChartValuesBox","_xaxis$dataAccessKey","_xaxis$dataAccessKey2","_activeRun$metrics$xK","_activeRun$params$xKe","_activeRun$metrics$yK","_activeRun$params$yKe","xKey","yKey","xLabel","yLabel","createContourChartValuesBox","_activeRun$metrics$xK2","_activeRun$params$xKe2","_activeRun$metrics$yK2","_activeRun$params$yKe2","_activeRun$metrics$zK","_activeRun$params$zKe","zKey","zValue","createParallelChartValuesBox","paramsList","metricsList","_getDataTraceLink","onHideRun","getDataTraceLink","containsMultipleRunsTooltipData","metricSuffix","contentWrapper","colorPill","actionsWrapper","SvgChartLine","strokeLinejoin","PLOTLY_DRAGLAYER_SELECTOR","parseMicroseconds","plotlyAxisBoundary","_plotlyAxisBoundary$m","microsecondsString","getCompareValue","getDataTraceForRun","runEntry","lineShape","lineDash","displayOriginalLine","originalLine","_yValues","_runEntry$runInfo","_yValues2","_runEntry$runInfo2","_runEntry$runInfo3","sortedMetricsHistory","getExpressionChartsSortedMetricHistory","xDataPointsPerVariable","_runEntry$metricsHist","elements","compareValue","xDataPoints","xDataPoint","obj","_runEntry$metricsHist2","_elements$find","expressionValue","_sortedMetricsHistory","_sortedMetricsHistory2","ySteps","xValuesWithSteps","prepareXAxisDataForMetricType","stepOrder","xSteps","yValueHistory","orderBySteps","_sortedMetricsHistory3","prepareMetricHistoryByAxisType","firstNonZeroXIndex","optimizedLineShape","containsDuplicateXValues","shouldDisplayMarkers","containsSingleValue","EMA","metricHistory","hovertext","createTooltipTemplate","dash","shape","createFadedTraceColor","dataPoints","stepIndexes","_stepIndexes$a$step","_stepIndexes$b$step","Infinity","axisType","minTimestamp","EPOCH_RELATIVE_TIME","HOUR_IN_MILLISECONDS","datapoint","lockXAxisZoom","dynamicXAxisKey","maxDiff","maxTimestamp","maxBy","LINE_CHART_RELATIVE_TIME_THRESHOLD","getTraceAndOriginalTrace","originalLineProps","lineDashStyles","bandsData","getBandTraceForRun","_runEntry$runInfo4","aggregatedMetricsHistory","xMins","xMaxes","yMins","yMaxes","minReversed","lastNonZeroXIndex","bandValues","fillcolor","plotDataWithBands","xAxisPlotlyType","getXAxisPlotlyType","yAxisParams","xAxisParams","showlegend","updatedLayout","containsMultipleMetricKeys","themedPlotlyLayout","immediateLayout","getLineChartLegendData","scanlineElement","initHandler","updateHandler","updateHandlerMultipleRuns","onPointHover","hoverCallbackMultipleRuns","onPointUnhover","unhoverCallbackMultipleRuns","useRunsMultipleTracesTooltipData","chartBoundaries","containerLeftPixels","plotWidthPixels","plotOffsetPixels","lowerBoundValue","valueRange","mainContainer","dragLayer","initialized","scanlineElementRef","currentHoveredDataPoint","visibleXValues","initializedFigure","setInitializedFigure","immediateHoverData","immediateLegendLabelData","immediateRunsData","immediatePlotData","immediateXValuesData","immediateFigure","setupBoundaries","figure","_figure$layout$xaxis","_figure$layout$xaxis$","_figure$layout$xaxis2","_figure$layout$xaxis3","_lowerBoundary","_upperBoundary","lowerAxisValue","upperAxisValue","lowerBoundary","getTime","upperBoundary","updateContainerPosition","containerRect","dragLayerRect","onUpdatePlotHandler","graphDiv","onInitPlotHandler","requestAnimationFrame","pointerLeavePlotCallback","Element","onPointHoverCallback","_hoveredPoint$curveNu","_hoveredPointData$met","hoveredPoint","hoveredPointData","singleTraceData","onPointUnhoverCallback","getClosestXValue","pointerClientX","boundaries","resultX","currentStep","tooltipDataUpdateHandler","closestXValue","legendEntry","_correspondingDataTra","_correspondingDataTra2","correspondingDataEntry","correspondingDataTrace","xIndex","leading","windowResizeHandler","hoverHandler","_immediateHoverData$c","_immediateHoverData$c2","closestXValueLeftInPixels","originalEvent","addEventListener","removeEventListener","legend","onInitialized","_ellipse","_circle2","_circle3","_ellipse2","_ellipse3","SvgChartScatter","rx","ry","fillOpacity","RunsChartsTooltipContext","ContextMenuVisibility","extractHTMLAncestorElement","currentElement","parentElement","Component","ctxMenuRef","currentPos","currentSnappedCoordinates","setMode","Simple","contextMenuShown","setContextMenuShown","HIDDEN","tooltipDisplayParams","setTooltipDisplayParams","hoveredRunUuid","setHoveredRunUuid","additionalAxisData","setAdditionalAxisData","focusedRunData","mutableContextMenuShownRef","mutableHoveredRunUuid","mutableTooltipDisplayParams","mutableAdditionalAxisData","applyPositioning","isChangingVisibilityMode","targetX","targetY","currentCtxMenu","reposition","menuRect","getCoordinatesForTargetElement","_containerRef$current","targetRect","offsetX","offsetY","HOVER","nativeEvent","updateTooltip","additionalRunData","_focusedRunData$curre","VISIBLE","currentRunUuid","mouseDownCapture","pageX","pageY","tooltipAreaClicked","clickedInTheSamePlace","_focusedRunData$curre2","domRoot","getRootNode","rootClickListener","_focusedRunData$curre3","capture","_focusedRunData$curre4","force","CHART","displayTooltip","onMouseDownCapture","onClickCapture","contextMenuContainer","contextMenuWrapper","boxShadow","shadowLow","overlayElement","ErrorIcon","XCircleIcon","textValidationDanger","FinishedIcon","CheckCircleIcon","textValidationSuccess","ClockIcon","SvgChartBar","aggregatedRunUuidsInGroup","runUuidsForAggregation","aggregatedMetricsHistoryForMetric","metricsHistoryInGroup","_sampledDataResultsBy","_sampledDataResultsBy2","steps","h","createAggregatedMetricHistory","createValueAggregatedMetricHistory","DEFAULT_ORDER_BY_KEY","DEFAULT_ORDER_BY_ASC","dropListener","draggedItem","useDrop","canDrop","accept","drop","sourceKey","monitor","didDrop","collect","shallow","getItem","useDrag","canDrag","groupKey","isDraggingOtherGroup","rootElementRef","manager","setManager","dragDropManager","createDragDropManager","HTML5Backend","getBackend","teardown","DndProvider","mutableRef","_line","_line2","_line3","SvgChartImage"],"sourceRoot":""}