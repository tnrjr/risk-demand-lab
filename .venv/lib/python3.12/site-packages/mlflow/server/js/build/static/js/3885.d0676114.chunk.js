"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[3885],{2250:function(e,t,n){n.d(t,{$:function(){return i}});var a=n(43683),r=n(63528),s=n(31014),o=n(98590);const i=({onSuccess:e,existingTagKeys:t=[],useV3Apis:n})=>{const{showEditTagsModal:i,EditTagsModal:l}=(0,a.Q)({saveTagsHandler:async(e,t,a)=>{if(!e.traceRequestId)return;const s=e.traceRequestId,o=a.filter((({key:e,value:n})=>!t.some((({key:t,value:a})=>t===e&&n===a)))),i=t.filter((({key:e})=>!a.some((({key:t})=>e===t))));return Promise.all([...o.map((({key:e,value:t})=>n?r.x.setExperimentTraceTagV3(s,e,t):r.x.setExperimentTraceTag(s,e,t))),...i.map((({key:e})=>n?r.x.deleteExperimentTraceTagV3(s,e):r.x.deleteExperimentTraceTag(s,e)))])},valueRequired:!0,allAvailableTags:t.filter((e=>e&&!e.startsWith(o.nt))),onSuccess:e});return{showEditTagsModalForTrace:(0,s.useCallback)((e=>{var t;if(!e.request_id)return;const n=(null===(t=e.tags)||void 0===t?void 0:t.filter((({key:e})=>e&&!e.startsWith(o.nt))))||[];i({traceRequestId:e.request_id,tags:n||[]})}),[i]),EditTagsModal:l}}},17297:function(e,t,n){n.d(t,{nX:function(){return a},wO:function(){return r}});const a=()=>!0,r=()=>!0},43683:function(e,t,n){n.d(t,{Q:function(){return T}});var a=n(89555),r=n(9133),s=n(31014),o=n(59403),i=n(23823),l=n(68048),u=n(88464),c=n(88443),d=n(13369),m=n(50111);var f={name:"4zleql",styles:"display:block"};function p(e){return t=>function(e,t){const n=(0,u.A)(),{theme:i}=(0,o.u)(),c=e.props.searchValue.toLowerCase();return(0,s.useMemo)((()=>{if(!c)return e;if((0,r.sortedIndexOf)(t,c)>=0)return e;const o=/^[^,.:/=\-\s]+$/.test(c);return s.cloneElement(e,{flattenOptions:[{data:{value:c,disabled:!o,style:{color:o?i.colors.actionTertiaryTextDefault:i.colors.actionDisabledText},children:(0,m.Y)(l.LegacyTooltip,{title:o?void 0:n.formatMessage({id:"fWEvZL",defaultMessage:", . : / - = and blank spaces are not allowed"}),placement:"right",children:(0,m.FD)("span",{css:f,children:[(0,m.Y)(l.PlusIcon,{css:(0,a.AH)({marginRight:i.spacing.sm},"")}),n.formatMessage({id:"IJbauF",defaultMessage:'Add tag "{tagKey}"'},{tagKey:c})]})})},key:c,groupOption:!1},...e.props.flattenOptions]})}),[t,e,c,n,i])}(t,e)}var v={name:"1d3w5wq",styles:"width:100%"};function g({allAvailableTags:e,control:t,onKeyChangeCallback:n}){const a=(0,u.A)(),[r,o]=(0,s.useState)(!1),i=(0,s.useRef)(null),{field:c,fieldState:f}=(0,d.as)({control:t,name:"key",rules:{required:{message:a.formatMessage({id:"RlBbjb",defaultMessage:"A tag key is required"}),value:!0}}});return(0,m.Y)(l.LegacySelect,{allowClear:!0,ref:i,dangerouslySetAntdProps:{showSearch:!0,dropdownRender:p(e)},css:v,placeholder:a.formatMessage({id:"8ALhnh",defaultMessage:"Type a key"}),value:c.value,defaultValue:c.value,open:r,onDropdownVisibleChange:e=>{o(e)},filterOption:(e,t)=>null===t||void 0===t?void 0:t.value.toLowerCase().includes(e.toLowerCase()),onSelect:e=>{c.onChange(e),null===n||void 0===n||n(e)},onClear:()=>{c.onChange(void 0),null===n||void 0===n||n(void 0)},validationState:f.error?"error":void 0,children:e.map((e=>(0,m.Y)(l.LegacySelect.Option,{value:e,children:e},e)))})}var h=n(98597),y=n(52350);function _(e){return new Map(e.map((e=>[e.key,e])))}var N={name:"82a6rk",styles:"flex:1"},E={name:"82a6rk",styles:"flex:1"};const T=({onSuccess:e,saveTagsHandler:t,allAvailableTags:n,valueRequired:f=!1,title:p})=>{const v=(0,s.useRef)(),[T,M]=(0,s.useState)(""),{theme:k}=(0,o.u)(),[w,b]=(0,s.useState)(new Map),[C,R]=(0,s.useState)(new Map),[x,S]=(0,s.useState)(!1),O=(0,d.mN)({defaultValues:{key:void 0,value:""}}),I=()=>S(!1),D=(0,s.useCallback)((e=>{v.current=e,b(_(e.tags||[])),R(_(e.tags||[])),O.reset(),S(!0)}),[O]),L=async()=>{v.current&&(M(""),G(!0),t(v.current,Array.from(w.values()),Array.from(C.values())).then((()=>{I(),null===e||void 0===e||e(),G(!1)})).catch((e=>{var t;G(!1),M(e instanceof y.s?null===(t=e.getUserVisibleError())||void 0===t?void 0:t.message:e.message)})))},U=(0,u.A)(),Y=O.watch(),[V,G]=(0,s.useState)(!1),F=(0,s.useMemo)((()=>!(0,r.isEqual)((0,r.sortBy)(Array.from(w.values()),"key"),(0,r.sortBy)(Array.from(C.values()),"key"))),[w,C]),K=Y.key||Y.value,H=F&&K;return{EditTagsModal:(0,m.FD)(i.d,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_135",destroyOnClose:!0,visible:x,title:null!==p&&void 0!==p?p:(0,m.Y)(c.A,{id:"TBX+Gs",defaultMessage:"Add/Edit tags"}),onCancel:I,footer:(0,m.FD)(o.y,{children:[(0,m.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_147",dangerouslyUseFocusPseudoClass:!0,onClick:I,css:(0,a.AH)({marginRight:F?0:k.spacing.sm},""),children:U.formatMessage({id:"2a/rR8",defaultMessage:"Cancel"})}),H?(0,m.Y)(A,{formValues:Y,isLoading:V,onSaveTask:L}):(0,m.Y)(l.LegacyTooltip,{title:F?void 0:U.formatMessage({id:"16onEc",defaultMessage:"Please add or remove one or more tags before saving"}),children:(0,m.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_174",dangerouslyUseFocusPseudoClass:!0,disabled:!F,loading:V,type:"primary",onClick:L,children:U.formatMessage({id:"801Xh4",defaultMessage:"Save tags"})})})]}),children:[(0,m.FD)("form",{onSubmit:O.handleSubmit((()=>{if(f&&!Y.value.trim())return;const e=new Map(C);e.set(Y.key,Y),R(e),O.reset()})),css:(0,a.AH)({display:"flex",alignItems:"flex-end",gap:k.spacing.md},""),children:[(0,m.FD)("div",{css:(0,a.AH)({minWidth:0,display:"flex",gap:k.spacing.md,flex:1},""),children:[(0,m.FD)("div",{css:N,children:[(0,m.Y)(l.FormUI.Label,{htmlFor:"key",children:U.formatMessage({id:"crTWax",defaultMessage:"Key"})}),(0,m.Y)(g,{allAvailableTags:n||[],control:O.control,onKeyChangeCallback:e=>{var t;const n=e?C.get(e):void 0;O.setValue("value",null!==(t=null===n||void 0===n?void 0:n.value)&&void 0!==t?t:"")}})]}),(0,m.FD)("div",{css:E,children:[(0,m.Y)(l.FormUI.Label,{htmlFor:"value",children:f?U.formatMessage({id:"tHrp+A",defaultMessage:"Value"}):U.formatMessage({id:"4B8k46",defaultMessage:"Value (optional)"})}),(0,m.Y)(l.RHFControlledComponents.Input,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_223",name:"value",control:O.control,"aria-label":f?U.formatMessage({id:"tHrp+A",defaultMessage:"Value"}):U.formatMessage({id:"4B8k46",defaultMessage:"Value (optional)"}),placeholder:U.formatMessage({id:"FFe+Ug",defaultMessage:"Type a value"})})]})]}),(0,m.Y)(l.LegacyTooltip,{title:U.formatMessage({id:"tx3aAM",defaultMessage:"Add tag"}),children:(0,m.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_248",htmlType:"submit","aria-label":U.formatMessage({id:"tx3aAM",defaultMessage:"Add tag"}),children:(0,m.Y)(l.PlusIcon,{})})})]}),T&&(0,m.Y)(l.FormUI.Message,{type:"error",message:T}),(0,m.Y)("div",{css:(0,a.AH)({display:"flex",rowGap:k.spacing.xs,flexWrap:"wrap",marginTop:k.spacing.sm},""),children:Array.from(C.values()).map((e=>(0,m.Y)(h.t,{isClosable:!0,tag:e,onClose:()=>(({key:e})=>{R((t=>(t.delete(e),new Map(t))))})(e)},e.key)))})]}),showEditTagsModal:D,isLoading:V}};var M={name:"1y0ex1",styles:"max-width:400px"};function A({isLoading:e,formValues:t,onSaveTask:n}){const s=(0,u.A)(),{theme:i}=(0,o.u)(),l=`${`${(0,r.truncate)(t.key,{length:20})||"_"}`}${t.value?`:${(0,r.truncate)(t.value,{length:20})}`:""}`,c=s.formatMessage({id:"wcSVYI",defaultMessage:'Are you sure you want to save and close without adding "{tag}"'},{tag:l});return(0,m.FD)(o.ax.Root,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_309",children:[(0,m.Y)(o.ax.Trigger,{asChild:!0,children:(0,m.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_306",dangerouslyUseFocusPseudoClass:!0,loading:e,type:"primary",children:s.formatMessage({id:"801Xh4",defaultMessage:"Save tags"})})}),(0,m.FD)(o.ax.Content,{align:"end","aria-label":c,children:[(0,m.Y)(o.T.Paragraph,{css:M,children:c}),(0,m.Y)(o.ax.Close,{asChild:!0,children:(0,m.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_316",onClick:n,children:s.formatMessage({id:"mv6CY3",defaultMessage:"Yes, save and close"})})}),(0,m.Y)(o.ax.Close,{asChild:!0,children:(0,m.Y)(o.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_324",type:"primary",css:(0,a.AH)({marginLeft:i.spacing.sm},""),children:s.formatMessage({id:"geizp1",defaultMessage:"Cancel"})})}),(0,m.Y)(o.ax.Arrow,{})]})]})}},46932:function(e,t,n){n.d(t,{BS:function(){return f},CL:function(){return $},Hq:function(){return j},I$:function(){return B},LS:function(){return g},MF:function(){return R},N7:function(){return G},OS:function(){return D},PC:function(){return K},Q0:function(){return Y},W0:function(){return L},ZI:function(){return X},bn:function(){return V},f7:function(){return N},g_:function(){return I},h8:function(){return H},ij:function(){return p},in:function(){return q},jW:function(){return x},tC:function(){return v},vL:function(){return _},vl:function(){return U},x0:function(){return P}});var a=n(89555),r=n(9133),s=n(48563),o=n(86494),i=n(92151),l=n(79912),u=n(76901),c=n(36784),d=n(38237),m=n(50111);const f="model-trace-info-v3",p=e=>{};function v(e){switch(e){case s.UG.LLM:return s.Dy.MODELS;case s.UG.CHAIN:return s.Dy.CHAIN;case s.UG.AGENT:return s.Dy.AGENT;case s.UG.TOOL:return s.Dy.WRENCH;case s.UG.CHAT_MODEL:return s.Dy.MODELS;case s.UG.RETRIEVER:return s.Dy.SEARCH;case s.UG.PARSER:return s.Dy.CODE;case s.UG.EMBEDDING:return s.Dy.NUMBERS;case s.UG.RERANKER:return s.Dy.SORT;case s.UG.MEMORY:return s.Dy.SAVE;case s.UG.FUNCTION:return s.Dy.FUNCTION;case s.UG.UNKNOWN:return s.Dy.UNKNOWN;default:return s.Dy.FUNCTION}}function g(e){switch(e){case s.UG.LLM:return"LLM";case s.UG.CHAIN:return"Chain";case s.UG.AGENT:return"Agent";case s.UG.TOOL:return"Tool";case s.UG.CHAT_MODEL:return"Chat model";case s.UG.RETRIEVER:return"Retriever";case s.UG.PARSER:return"Parser";case s.UG.EMBEDDING:return"Embedding";case s.UG.RERANKER:return"Reranker";case s.UG.MEMORY:return"Memory";case s.UG.FUNCTION:return"Function";case s.UG.UNKNOWN:return"Unknown";default:return e}}function h(e){try{return JSON.parse(e)}catch(t){return e}}const y=(e,t)=>{if(!t)return[];const n=[],a={inputs:null===e||void 0===e?void 0:e.inputs,outputs:null===e||void 0===e?void 0:e.outputs,attributes:null===e||void 0===e?void 0:e.attributes,events:null===e||void 0===e?void 0:e.events};return(0,r.map)(a,((a,r)=>{if("events"===r)return void n.push(...((e,t)=>{const n=e.events;if(!n)return[];const a=[];return n.forEach(((n,r)=>{const s=n.attributes;s&&Object.keys(s).forEach((o=>{const i=o.toLowerCase().includes(t),l=Y(n.name,r,o);i&&a.push({span:e,section:"events",key:l,isKeyMatch:!0,matchIndex:0});const u=JSON.stringify(s[o]).toLowerCase().split(t).length-1;for(let t=0;t<u;t++)a.push({span:e,section:"events",key:l,isKeyMatch:!1,matchIndex:t})}))})),a})(e,t));I(a).forEach((a=>{a.key.toLowerCase().includes(t)&&n.push({span:e,section:r,key:a.key,isKeyMatch:!0,matchIndex:0});const s=a.value.toLowerCase().split(t).length-1;for(let t=0;t<s;t++)n.push({span:e,section:r,key:a.key,isKeyMatch:!1,matchIndex:t})}))})),n};function _(e,t,n){var a,r;const s=t.toLowerCase().trim(),o=Object.values(n.spanTypeDisplayState).every((e=>e));if(""===s&&o)return{filteredTreeNodes:[e],matches:[]};const i=null!==(a=e.children)&&void 0!==a?a:[],l=[],u=[];i.forEach((e=>{const{filteredTreeNodes:t,matches:a}=_(e,s,n);l.push(...t),u.push(...a)}));const c=(null!==(r=e.title)&&void 0!==r?r:"").toLowerCase(),d=y(e,s),m=d.length>0||c.includes(s),f=!e.type||n.spanTypeDisplayState[e.type],p=m&&f,v=l.length>0,g=G(e)>0;return p||n.showParents&&v||n.showExceptions&&g?{filteredTreeNodes:[{...e,children:l}],matches:d.concat(u)}:{filteredTreeNodes:l,matches:u}}function N(e,t){var n;if((0,r.isNil)(t)||(0,r.isNil)(e))return;if(e.key===t)return e;const a=null!==(n=e.children)&&void 0!==n?n:[];for(const r of a){const e=N(r,t);if(e)return e}}const E=(e,t,n,a,s,i)=>{var l,u,c,d,f,p,g,y;const _=h(null===(l=e.attributes)||void 0===l?void 0:l["mlflow.spanType"]),N=h(null===(u=e.attributes)||void 0===u?void 0:u["mlflow.spanInputs"]),E=h(null===(c=e.attributes)||void 0===c?void 0:c["mlflow.spanOutputs"]),T=w(e),M=k(e),A=null!==(d=s[M])&&void 0!==d?d:[];var R;T||A.push(...null!==(R=s[""])&&void 0!==R?R:[]);const x=h(null===(f=e.attributes)||void 0===f?void 0:f["mlflow.chat.messages"]),S=h(null===(p=e.attributes)||void 0===p?void 0:p["mlflow.message.format"]),O=((e,t,n,a)=>{var s,o;if(Array.isArray(e)&&e.every(B))return(0,r.compact)(e.map(X));const i=null!==(s=j(t,null===a||void 0===a?void 0:a["mlflow.message.format"]))&&void 0!==s?s:[],l=null!==(o=j(n,null===a||void 0===a?void 0:a["mlflow.message.format"]))&&void 0!==o?o:[];return 0!==i.length&&0!==l.length?i.concat(l):void 0})(x,N,E,S?{"mlflow.message.format":S}:void 0),I=((e,t)=>{var n;return Array.isArray(e)&&e.every(K)?e:Array.isArray(null===t||void 0===t?void 0:t.tools)&&null!==t&&void 0!==t&&null!==(n=t.tools)&&void 0!==n&&n.every(K)?t.tools:void 0})(h(null===(g=e.attributes)||void 0===g?void 0:g["mlflow.chat.tools"]),N),D=(0,r.mapValues)((0,r.omitBy)(e.attributes,((e,t)=>t.startsWith("mlflow."))),(e=>h(e))),L=e.events,U=(Number(b(e))-t)/1e3,Y=(Number(null!==(y=C(e))&&void 0!==y?y:n)-t)/1e3;return{title:e.name,icon:(0,m.Y)(o.P,{type:v(_),hasException:G(e)>0,isRootSpan:!T}),type:_,key:M,start:U,end:Y,children:a,inputs:N,outputs:E,attributes:D,events:L,chatMessages:O,chatTools:I,parentId:T,assessments:A,traceId:i}},T=(e,t)=>{if(t)try{return(e=>{const t=atob(e),n=t.length;let a="";for(let r=0;r<n;r++)a+=t.charCodeAt(r).toString(16).padStart(2,"0");return a})(e)}catch(n){return e}return e.startsWith("0x")?e.slice(2):e};function M(e){return"trace_metadata"in e}function A(e){return"start_time_unix_nano"in e}function k(e){var t,n;return A(e)?T(e.span_id,!0):T(null!==(t=null===(n=e.context)||void 0===n?void 0:n.span_id)&&void 0!==t?t:"",!1)}function w(e){var t,n;return A(e)?T(null!==(t=e.parent_span_id)&&void 0!==t?t:"",!0):T(null!==(n=e.parent_id)&&void 0!==n?n:"",!1)}function b(e){return A(e)?Number(e.start_time_unix_nano):Number(e.start_time)}function C(e){return A(e)?Number(e.end_time_unix_nano):Number(e.end_time)}function R(e){var t;return M(e.info)?e.info.trace_id:null!==(t=e.info.request_id)&&void 0!==t?t:""}function x(e){var t,n;const a=R(e),i=null!==(t=null===(n=e.trace_data)||void 0===n?void 0:n.spans)&&void 0!==t?t:e.data.spans,l={},u={};i.forEach((e=>{const t=k(e);l[t]=e,u[t]=[]})),i.forEach((e=>{const t=k(e),n=w(e);if(n){if(!u[n])throw new Error("Tree structure is malformed!");u[n].push(t)}}));const c=i.find((e=>!w(e)));if((0,r.isNil)(c))return null;return function t(n){var r,i,d;const f=l[n],p=Number(b(c)),g=Number(C(c)),h=u[n].map(t),y=S(e.info);if(A(f)||"parent_id"in f)return E(f,p,g,h,y,a);const _=null!==(r=f.span_type)&&void 0!==r?r:s.UG.UNKNOWN;return{title:f.name,icon:(0,m.Y)(o.P,{type:v(_)}),type:_,key:f.context.span_id,start:Number(f.start_time)-p,end:Number(null!==(i=f.end_time)&&void 0!==i?i:g)-p,children:h,inputs:f.inputs,outputs:f.outputs,attributes:f.attributes,events:f.events,parentId:null!==(d=f.parent_id)&&void 0!==d?d:f.parent_span_id,assessments:[],traceId:a}}(k(c))}const S=e=>{let t=[];var n;M(e)?t=null!==(n=e.assessments)&&void 0!==n?n:[]:t=O(e.tags);const a=(0,r.keyBy)(t,"assessment_id");Object.values(a).forEach((e=>{if(e.overrides){const t=a[e.overrides];e.overriddenAssessment=t}})),t=Object.values(a);const s=t.reduce(((e,t)=>{var n;const a=null!==(n=t.span_id)&&void 0!==n?n:"";return e[a]||(e[a]=[]),e[a].push(t),e}),{});return Object.keys(s).forEach((e=>{s[e].sort(((e,t)=>new Date(t.last_update_time).getTime()-new Date(e.last_update_time).getTime()))})),s},O=e=>{if(!e)return[];return(Array.isArray(e)?e:Object.entries(e).map((([e,t])=>({key:e,value:t})))).filter((({key:e})=>e.startsWith("mlflow.assessment."))).map((({value:e})=>JSON.parse(e)))};const I=e=>(0,r.isNil)(e)?[]:Array.isArray(e)||(0,r.isString)(e)||(0,r.isNumber)(e)||(0,r.isBoolean)(e)?[{key:"",value:JSON.stringify(e,null,2)}]:Object.entries(e).map((([e,t])=>({key:e,value:JSON.stringify(t,null,2)}))),D=({searchFilter:e,data:t,activeMatchBackgroundColor:n,inactiveMatchBackgroundColor:s,containsActiveMatch:o,activeMatch:i,scrollToActiveMatch:l})=>{const u=new RegExp(`(${(0,r.escapeRegExp)(e.trim())})`,"gi"),c=t.split(u),d=[];let f=0;for(let r=0;r<c.length;r++)if(c[r].toLowerCase().includes(e.toLowerCase().trim())){const e=o&&i.matchIndex===f,t=e?n:s,u=(0,m.Y)("span",{ref:e?l:null,css:(0,a.AH)({backgroundColor:t,scrollMarginTop:50},""),children:c[r]},r);f++,d.push(u)}else d.push(c[r]);return d},L=e=>(0,r.has)(e,"page_content"),U=e=>e.type===s.UG.RETRIEVER&&Array.isArray(e.outputs)&&e.outputs.length>0&&(0,r.every)(e.outputs,L),Y=(e,t,n)=>`${e}-${t}-${n}`,V=e=>{var t;return(null!==(t=e.events)&&void 0!==t?t:[]).filter((e=>"exception"===e.name))},G=e=>V(e).length,F=e=>!(0,r.isNil)(e)&&(!(!(0,r.isNil)(e.type)&&!(0,r.isString)(e.type))&&(!(!(0,r.isNil)(e.description)&&!(0,r.isString)(e.description))&&!(!(0,r.isNil)(e.enum)&&!Array.isArray(e.enum)))),K=e=>{var t;if((0,r.isNil)(e)||"function"!==e.type||!(0,r.has)(e,"function.name"))return!1;const n=null===(t=e.function)||void 0===t?void 0:t.parameters;if(!(0,r.isNil)(n)){const e=n.required;if(!(0,r.isNil)(e)&&(!Array.isArray(e)||!e.every(r.isString)))return!1;const t=n.properties;if(!(0,r.isNil)(t)&&!Object.values(t).every(F))return!1}return!0},H=e=>{var t,n;return e&&(0,r.isString)(e.id)&&(0,r.isString)(null===(t=e.function)||void 0===t?void 0:t.arguments)&&(0,r.isString)(null===(n=e.function)||void 0===n?void 0:n.name)},W=e=>!(!(0,r.isNil)(e)&&!(0,r.isString)(e))||!!(0,r.isArray)(e)&&e.every((e=>(e=>{switch(e.type){case"text":case"input_text":case"output_text":return(0,r.isString)(e.text);case"image_url":const{image_url:t}=e;return!(0,r.isNil)(t)&&(0,r.isString)(t.url)&&((0,r.isNil)(t.detail)||["auto","low","high"].includes(t.detail));case"input_audio":const{input_audio:n}=e;return!(0,r.isNil)(n)&&(0,r.isString)(n.data)&&((0,r.isNil)(n.format)||["wav","mp3"].includes(n.format));default:return!1}})(e))),B=e=>{if(!e)return!1;if(e.tool_calls){if(!Array.isArray(e.tool_calls))return!1;if(!e.tool_calls.every(H))return!1}return"reasoning"===e.type||!!W(e.content)&&("user"===e.role||"assistant"===e.role||"system"===e.role||"tool"===e.role)},P=e=>Array.isArray(e)&&e.length>0&&e.every((e=>{return(0,r.has)(e,"message")&&(t=e.message,!!B(t)&&((0,r.isNil)(t.content)||(0,r.isString)(t.content)));var t})),q=e=>e&&P(e.choices),j=(e,t)=>{var n,a,s,o,m,f,p,v,g,h,y,_;try{if(Array.isArray(e)&&e.length>0&&e.every(B))return(0,r.compact)(e.map(X));switch(t){case"langchain":const t=null!==(n=(0,i.HD)(e))&&void 0!==n?n:(0,i.oI)(e);if(t)return t;break;case"llamaindex":const r=null!==(a=(0,l.H)(e))&&void 0!==a?a:(0,i.W3)(e);if(r)return r;break;case"openai":const N=null!==(s=null!==(o=null!==(m=(0,i.a8)(e))&&void 0!==m?m:(0,i.bS)(e))&&void 0!==o?o:(0,i.n_)(e))&&void 0!==s?s:(0,i.AG)(e);if(N)return N;break;case"dspy":const E=null!==(f=(0,i.iU)(e))&&void 0!==f?f:(0,i.Pn)(e);if(E)return E;break;case"gemini":const T=null!==(p=(0,i.DE)(e))&&void 0!==p?p:(0,i.Sy)(e);if(T)return T;break;case"anthropic":const M=null!==(v=(0,i.KF)(e))&&void 0!==v?v:(0,i.pL)(e);if(M)return M;break;case"openai-agent":const A=null!==(g=(0,u.xW)(e))&&void 0!==g?g:(0,u.m$)(e);if(A)return A;break;case"autogen":const k=null!==(h=(0,c.n)(e))&&void 0!==h?h:(0,c.u)(e);if(k)return k;break;case"bedrock":const w=null!==(y=(0,d.Y)(e))&&void 0!==y?y:(0,d.f)(e);if(w)return w;break;default:const b=null!==(_=(0,i.a8)(e))&&void 0!==_?_:(0,i.bS)(e);if(b)return b}return null}catch(N){return null}},$=e=>{var t;let n=null===(t=e.function)||void 0===t?void 0:t.arguments;try{n=JSON.stringify(JSON.parse(n),null,2)}catch(a){}return{id:e.id,function:{arguments:n,name:e.function.name}}},J=e=>{if((0,r.isNil)(e)||(0,r.isString)(e))return e;return e.map((e=>{var t;switch(e.type){case"text":case"input_text":case"output_text":return e.text;case"image_url":const n=null===e||void 0===e||null===(t=e.image_url)||void 0===t?void 0:t.url;return n?`![](${n})`:"[image]";case"input_audio":return"[audio]"}})).filter((e=>void 0!==e)).join("\n\n")},X=e=>{var t;return"reasoning"===e.type?null:{...e,content:J(e.content),tool_calls:null===(t=e.tool_calls)||void 0===t?void 0:t.map($)}}},48563:function(e,t,n){n.d(t,{Dy:function(){return r},UG:function(){return a},VZ:function(){return s},cC:function(){return o}});let a=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.FUNCTION="FUNCTION",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),r=function(e){return e.MODELS="models",e.DOCUMENT="document",e.CONNECT="connect",e.SEARCH="search",e.SORT="sort",e.UNKNOWN="unknown",e.FUNCTION="function",e.CODE="code",e.NUMBERS="numbers",e.WRENCH="wrench",e.AGENT="agent",e.CHAIN="chain",e.USER="user",e.SYSTEM="system",e.SAVE="save",e}({}),s=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.MEMORY="MEMORY",e.UNKNOWN="UNKNOWN",e}({}),o=function(e){return e.JSON="json",e.TEXT="text",e.MARKDOWN="markdown",e}({})},80870:function(e,t,n){n.d(t,{ModelTraceExplorer:function(){return a.a},ModelTraceSpanType:function(){return r.VZ}});var a=n(13453);n(31014),n(7450);n(46932);var r=n(48563)},98597:function(e,t,n){n.d(t,{t:function(){return g}});var a=n(89555),r=n(68048),s=n(59403),o=n(31014),i=n(88464),l=n(23823),u=n(56412),c=n(50111);const{Paragraph:d}=s.T;var m={name:"zjik7",styles:"display:flex"},f={name:"1ff36h2",styles:"flex-grow:1"};const p=o.memo((e=>{const{theme:t}=(0,s.u)();return(0,c.Y)(l.d,{componentId:"codegen_mlflow_app_src_common_components_keyvaluetagfullviewmodal.tsx_17",title:"Tag: "+e.tagKey,visible:e.isKeyValueTagFullViewModalVisible,onCancel:()=>e.setIsKeyValueTagFullViewModalVisible(!1),children:(0,c.FD)("div",{css:m,children:[(0,c.Y)(d,{css:f,children:(0,c.Y)("pre",{css:(0,a.AH)({backgroundColor:t.colors.backgroundPrimary,marginTop:t.spacing.sm,whiteSpace:"pre-wrap",wordBreak:"break-all"},""),children:e.tagValue})}),(0,c.Y)("div",{css:(0,a.AH)({marginTop:t.spacing.sm},""),children:(0,c.Y)(u.i,{copyText:e.tagValue,showLabel:!1,icon:(0,c.Y)(r.CopyIcon,{}),"aria-label":"Copy"})})]})})}));function v(e=!0){return e?{overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap",whiteSpace:"nowrap"}:{whiteSpace:"nowrap"}}const g=({isClosable:e=!1,onClose:t,tag:n,enableFullViewModal:l=!1,charLimit:u=30,maxWidth:d=300,className:m})=>{const f=(0,i.A)(),[g,h]=(0,o.useState)(!1),{shouldTruncateKey:y,shouldTruncateValue:_}=function(e,t=30){const{key:n,value:a}=e,r=n.length+a.length,s=n.length>a.length,o=s?a.length:n.length;return r<=t?{shouldTruncateKey:!1,shouldTruncateValue:!1}:o>t/2?{shouldTruncateKey:!0,shouldTruncateValue:!0}:{shouldTruncateKey:s,shouldTruncateValue:!s}}(n,u),N=l&&(y||_),E=f.formatMessage({id:"ZXUtU8",defaultMessage:"Click to see more"});return(0,c.FD)("div",{children:[(0,c.Y)(r.Tag,{componentId:"codegen_mlflow_app_src_common_components_keyvaluetag.tsx_60",closable:e,onClose:t,title:n.key,className:m,children:(0,c.Y)(r.LegacyTooltip,{title:N?E:"",children:(0,c.FD)("span",{css:(0,a.AH)({maxWidth:d,display:"inline-flex"},""),onClick:()=>N?h(!0):void 0,children:[(0,c.Y)(s.T.Text,{bold:!0,title:n.key,css:v(y),children:n.key}),n.value&&(0,c.FD)(s.T.Text,{title:n.value,css:v(_),children:[": ",n.value]})]})})}),(0,c.Y)("div",{children:g&&(0,c.Y)(p,{tagKey:n.key,tagValue:n.value,isKeyValueTagFullViewModalVisible:g,setIsKeyValueTagFullViewModalVisible:h})})]})}}}]);
//# sourceMappingURL=3885.d0676114.chunk.js.map